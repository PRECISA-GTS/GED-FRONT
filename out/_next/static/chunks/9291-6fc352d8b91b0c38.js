"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9291],{88771:function(e,t,s){var a=s(85893),o=s(11163),n=s.n(o),i=s(67294),l=s(60664),r=s(49837),d=s(91359),c=s(79072),u=s(87536),x=s(86501),m=s(45061),p=s(47842),h=s(86887),v=s(64165),f=s(60565),Z=s(83830),g=s(29308),j=s(67569),D=s(41088),b=s(40039);let C=e=>{var t,s;let{id:o,newChange:C,manualUrl:w,handleModalClose:y,handleConfirmNew:I,btnClose:S,outsideID:P}=e,[N,O]=(0,i.useState)(!1),[M,E]=(0,i.useState)(null),q=n(),A=o&&o>0?"edit":"new",k=q.pathname,{title:F}=(0,i.useContext)(f.f),{setId:T}=(0,i.useContext)(Z.X),{loggedUnity:V,user:U}=(0,i.useContext)(b.V),{startLoading:_,stopLoading:R}=(0,D.Z)(),{trigger:z,handleSubmit:W,reset:X,register:B,control:G,formState:{errors:H}}=(0,u.cI)({mode:"onChange"}),J=async e=>{let t={...e,usuarioID:U.usuarioID,unidadeID:V.unidadeID};_();try{"new"===A?await l.h.post("/cadastros/classificacao-produto/new/insertData",t).then(e=>{P?I(e.data):(q.push("/cadastros/classificacao-produto"),T(e.data)),x.ZP.success(v.OD.successNew)}):"edit"===A&&(await l.h.post("/cadastros/classificacao-produto/updateData/".concat(o),t),x.ZP.success(v.OD.successUpdate))}catch(s){s.response&&409===s.response.status?x.ZP.error(v.OD.errorRepeated):console.log(s)}finally{R()}},K=async()=>{try{await l.h.delete("".concat(k,"/").concat(o,"/").concat(U.usuarioID,"/").concat(V.unidadeID)),T(null),O(!1),x.ZP.success(v.OD.successDelete)}catch(e){e.response&&409===e.response.status?(x.ZP.error(v.OD.pendingDelete),O(!1)):console.log(e)}},L=async()=>{try{"edit"===A?await l.h.post("".concat(k,"/getData/").concat(o),{id:o}).then(e=>{E(e.data),X(e.data)}):E({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,i.useEffect)(()=>{L(),setTimeout(()=>{z()},300)},[o]),(0,a.jsxs)(a.Fragment,{children:[!M&&(0,a.jsx)(p.Z,{}),M&&(0,a.jsxs)("form",{onSubmit:W(J),id:"formItem",children:[(0,a.jsx)(h.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,disabled:!1,manualUrl:w,btnClose:S,handleModalClose:y,handleSubmit:()=>W(J),btnDelete:"edit"===A,onclickDelete:()=>O(!0),type:A,outsideID:P}),(0,a.jsx)(r.Z,{children:(0,a.jsx)(d.Z,{children:(0,a.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(g.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:G,errors:null==H?void 0:null===(t=H.fields)||void 0===t?void 0:t.nome}),(0,a.jsx)(j.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==M?void 0:null===(s=M.fields)||void 0===s?void 0:s.status,typePage:A,register:B})]})})})]}),(0,a.jsx)(m.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+F.title,openModal:N,handleClose:()=>O(!1),handleSubmit:K,btnCancel:!0,btnConfirm:!0})]})};t.Z=C},69291:function(e,t,s){s.d(t,{Z:function(){return q}});var a=s(85893),o=s(11163),n=s.n(o),i=s(67294),l=s(60565),r=s(83830),d=s(60664),c=s(49837),u=s(91359),x=s(79072),m=s(59742),p=s(54225),h=s(87536),v=s(86501),f=s(47842),Z=s(45061),g=s(86887),j=s(64165),D=s(29308),b=s(84220),C=s(67569),w=s(40039),y=s(21609),I=s(88475),S=s(44373);let P=e=>{let{getValues:t,removeAnexo:s,setValue:o,control:n,register:l,errors:r,type:c}=e,[u,x]=(0,i.useState)([]),m=async()=>{let e=await d.h.post("/cadastros/produto/getFormularios");console.log("--> ",e.data),x(e.data)};return(0,i.useEffect)(()=>{m()},[]),t("anexos")&&t("anexos").map((e,d)=>{var x,m,p,h,v,f;return(0,a.jsxs)(i.Fragment,{children:[(0,a.jsx)(D.Z,{md:6,title:"Nome",name:"anexos[".concat(d,"].nome"),required:!0,control:n,errors:null==r?void 0:null===(x=r.anexos)||void 0===x?void 0:null===(m=x[d])||void 0===m?void 0:m.nome}),(0,a.jsx)(b.Z,{xs:12,md:3,title:"Formul\xe1rio",name:"anexos[".concat(d,"].formulario"),value:e.formulario,required:!0,options:null!=u?u:[],register:l,setValue:o,control:n,errors:null==r?void 0:null===(p=r.anexos)||void 0===p?void 0:null===(h=p[d])||void 0===h?void 0:h.formulario,helpText:"Formul\xe1rio em que ser\xe1 solicitado esse anexo para este produto"}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Obrigat\xf3rio",name:"anexos[".concat(d,"].obrigatorio"),value:1==e.obrigatorio,typePage:c,register:l}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"anexos[".concat(d,"].status"),value:1==e.obrigatorio,typePage:c,register:l}),(0,a.jsx)(I.Z,{xs:4,md:1,title:"Remover",index:d,removeItem:s,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"}),(0,a.jsx)(D.Z,{xs:11,md:12,multiline:!0,items:4,title:"Descri\xe7\xe3o (opcional)",name:"anexos[".concat(d,"].descricao"),control:n,errors:null==r?void 0:null===(v=r.anexos)||void 0===v?void 0:null===(f=v[d])||void 0===f?void 0:f.descricao}),d<t("anexos").length-1&&(0,a.jsx)(S.Z,{})]},d)})};var N=s(41088),O=s(88771),M=s(1322);let E=e=>{var t,s,o,I;let{id:S,btnClose:E,handleConfirmNew:q,handleModalClose:A,newChange:k,manualUrl:F,outsideID:T}=e,[V,U]=(0,i.useState)(!1),[_,R]=(0,i.useState)(null),z=n(),W=S&&S>0?"edit":"new",X=z.pathname,{title:B}=(0,i.useContext)(l.f),{setId:G}=(0,i.useContext)(r.X),{loggedUnity:H,user:J}=(0,i.useContext)(w.V),[K,L]=(0,i.useState)([]),[Q,Y]=(0,i.useState)(!1),{startLoading:$,stopLoading:ee}=(0,N.Z)(),[et,es]=(0,i.useState)(!1),[ea,eo]=(0,i.useState)(!1),{trigger:en,handleSubmit:ei,setValue:el,reset:er,control:ed,getValues:ec,formState:{errors:eu},register:ex}=(0,h.cI)({mode:"onChange"}),em=async e=>{$();let t={...e,unidadeID:H.unidadeID,usuarioID:J.usuarioID,removedItems:K};console.log(t);try{"new"===W?await d.h.post("cadastros/produto/new/insertData",t).then(e=>{q?q(e.data,"produtos"):(z.push("".concat((0,j.g_)(X))),G(e.data.id)),v.ZP.success(j.OD.successNew)}):"edit"===W&&(await d.h.post("".concat(X,"/updateData/").concat(S),t),v.ZP.success(j.OD.successUpdate))}catch(s){s.response&&409===s.response.status?v.ZP.error(j.OD.errorRepeated):console.log(s)}finally{ee()}},ep=async()=>{try{await d.h.delete("".concat(X,"/").concat(S,"/").concat(J.usuarioID,"/").concat(H.unidadeID)),G(null),U(!1),v.ZP.success(j.OD.successDelete)}catch(e){e.response&&409===e.response.status?(v.ZP.error(j.OD.pendingDelete),U(!1)):console.log(e)}},eh=async()=>{try{let e="new"===W?"cadastros/produto/new/getData/".concat(H.unidadeID):"".concat(X,"/getData/").concat(S,"/").concat(H.unidadeID);await d.h.post(e).then(e=>{R(e.data),er(e.data)})}catch(t){console.log(t)}},ev=(e,t)=>{e.produtoAnexoID&&L([...K,e.produtoAnexoID]);let s=ec("anexos").filter((e,s)=>s!==t);el("anexos",s),Y(!Q)},ef=()=>{let e=[...ec("anexos"),{nome:"",obrigatorio:1,status:1,descricao:"",observacao:""}];el("anexos",e),Y(!Q)},eZ=()=>{es(!0)},eg=async()=>{eo(!0)},ej=e=>{es(!1),el("classificacao.fields",e),eo(!ea)};return(0,i.useEffect)(()=>{eh(),setTimeout(()=>{en()},300)},[S]),(0,i.useEffect)(()=>{k&&ei(em)()},[k]),(0,a.jsxs)(a.Fragment,{children:[!_&&(0,a.jsx)(f.Z,{}),_&&(0,a.jsxs)("form",{onSubmit:ei(em),className:"space-y-3",children:[(0,a.jsx)(g.Z,{btnCancel:!0,btnNew:!q,btnSave:!0,btnClose:E,manualUrl:F,handleModalClose:A,handleSubmit:()=>ei(em),btnDelete:"edit"===W,onclickDelete:()=>U(!0),type:W,outsideID:T}),(0,a.jsx)(c.Z,{children:(0,a.jsx)(u.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(D.Z,{xs:11,md:5,title:"Nome",name:"fields.nome",required:!0,control:ed,errors:null==eu?void 0:null===(t=eu.fields)||void 0===t?void 0:t.nome}),(0,a.jsx)(b.Z,{xs:12,md:3,title:"Unidade de medida",name:"unidadeMedida.fields",value:null==_?void 0:_.unidadeMedida.fields,required:!0,options:_.unidadeMedida.options,register:ex,setValue:el,control:ed,errors:null==eu?void 0:null===(s=eu.unidadeMedida)||void 0===s?void 0:s.fields,helpText:"Selecione a unidade de medida"}),(0,a.jsx)(b.Z,{xs:12,md:3,title:"Classificação",name:"classificacao.fields",value:null==_?void 0:null===(o=_.classificacao)||void 0===o?void 0:o.fields,options:_.classificacao.options,register:ex,setValue:el,control:ed,errors:null==eu?void 0:null===(I=eu.classificacao)||void 0===I?void 0:I.fields,helpText:"Selecione a classificação",createNew:eZ}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:_.fields.status,typePage:W,register:ex})]})})}),(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(m.Z,{title:"Anexos"}),(0,a.jsx)(u.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(P,{getValues:ec,removeAnexo:ev,setValue:el,control:ed,register:ex,errors:eu,type:W},Q),(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{variant:"outlined",color:"primary",sx:{mt:1},startIcon:(0,a.jsx)(y.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ef()},children:"Inserir Anexo"})})]})})]})]}),(0,a.jsx)(Z.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+B.title,openModal:V,handleClose:()=>U(!1),handleSubmit:ep,btnCancel:!0,btnConfirm:!0}),(0,a.jsx)(M.Z,{title:"Nova Classifica\xe7\xe3o de Produto",size:"md",openModal:et,setOpenModal:es,handleSave:eg,children:(0,a.jsx)(O.Z,{manualUrl:"/cadastros/classificacao-produto",btnClose:!0,handleModalClose:()=>es(!1),newChange:ea,handleConfirmNew:ej,outsideID:!0})})]})};var q=E},1322:function(e,t,s){var a=s(85893),o=s(95398),n=s(44642),i=s(1890),l=s(77745);s(67294);let r=e=>{let{title:t,setOpenModal:s,openModal:r,children:d,size:c}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(i.Z,{open:r,onClose:()=>s(!1),fullWidth:!!c,maxWidth:c||null,children:[(0,a.jsx)(l.Z,{id:"form-dialog-title",children:t}),(0,a.jsx)(o.Z,{children:(0,a.jsx)(n.Z,{children:d})})]})})};t.Z=r}}]);