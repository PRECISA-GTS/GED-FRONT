"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1276],{88771:function(e,a,s){var t=s(85893),i=s(11163),n=s.n(i),l=s(67294),o=s(60664),c=s(49837),d=s(91359),r=s(79072),u=s(87536),m=s(86501),x=s(45061),f=s(47842),h=s(65698),p=s(71798),j=s(60565),Z=s(83830),D=s(29308),g=s(67569),b=s(41088),w=s(40039);let v=e=>{var a;let{id:s,newChange:i,manualUrl:v,handleModalClose:C,handleConfirmNew:y,btnClose:S,outsideID:I}=e,[P,N]=(0,l.useState)(!1),[O,M]=(0,l.useState)(null),q=n(),V=s&&s>0?"edit":"new",k=q.pathname,{title:T}=(0,l.useContext)(j.f),{setId:z}=(0,l.useContext)(Z.X),{loggedUnity:E,user:U}=(0,l.useContext)(w.V),{startLoading:F,stopLoading:L}=(0,b.Z)(),_=(0,u.cI)({mode:"onChange"}),A=async e=>{let a={...e,usuarioID:U.usuarioID,unidadeID:E.unidadeID};F();try{"new"===V?await o.h.post("/cadastros/classificacao-produto/new/insertData",a).then(e=>{I?y(e.data):(q.push("/cadastros/classificacao-produto"),z(e.data)),m.ZP.success(p.OD.successNew)}):"edit"===V&&(await o.h.post("/cadastros/classificacao-produto/updateData/".concat(s),a),m.ZP.success(p.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(p.OD.errorRepeated):console.log(t)}finally{L()}},R=async()=>{try{await o.h.delete("".concat(k,"/").concat(s,"/").concat(U.usuarioID,"/").concat(E.unidadeID)),z(null),N(!1),m.ZP.success(p.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(p.OD.pendingDelete),N(!1)):console.log(e)}},H=async()=>{try{"edit"===V?await o.h.post("".concat(k,"/getData/").concat(s),{id:s}).then(e=>{M(e.data),_.reset(e.data)}):M({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{H(),setTimeout(()=>{_.trigger()},300)},[s]),(0,t.jsxs)(t.Fragment,{children:[!O&&(0,t.jsx)(f.Z,{}),O&&(0,t.jsxs)("form",{onSubmit:_.handleSubmit(A),id:"formItem",children:[(0,t.jsx)(h.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,disabled:!1,manualUrl:v,btnClose:S,handleModalClose:C,handleSubmit:()=>_.handleSubmit(A),btnDelete:"edit"===V,onclickDelete:()=>N(!0),type:V,outsideID:I}),(0,t.jsx)(c.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(r.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(D.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:_}),(0,t.jsx)(g.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==O?void 0:null===(a=O.fields)||void 0===a?void 0:a.status,typePage:V,form:_})]})})})]}),(0,t.jsx)(x.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+T.title,openModal:P,handleClose:()=>N(!1),handleSubmit:R,btnCancel:!0,btnConfirm:!0})]})};a.Z=v},31276:function(e,a,s){s.d(a,{Z:function(){return q}});var t=s(85893),i=s(11163),n=s.n(i),l=s(67294),o=s(60565),c=s(83830),d=s(60664),r=s(49837),u=s(91359),m=s(79072),x=s(87536),f=s(86501),h=s(47842),p=s(45061),j=s(65698),Z=s(71798),D=s(29308),g=s(84220);s(67569);var b=s(40039),w=s(21609);s(88475);var v=s(41088),C=s(88771),y=s(1322),S=s(3893),I=s(17575),P=s(80562),N=s(54225);let O=e=>{let{form:a,data:s}=e,{fields:i,append:n,remove:o}=(0,x.Dq)({control:a.control,name:"fields.analises"}),c=e=>({minimo:a.watch("fields.analises[".concat(e,"].minimo")),maximo:a.watch("fields.analises[".concat(e,"].maximo"))}),d=e=>{a.setValue("fields.analises[".concat(e,"].status"),1===a.watch("fields.analises[".concat(e,"].status"))?0:1)};return a.watch("fields.usaLaboratorio")&&(0,t.jsx)(r.Z,{children:(0,t.jsx)(u.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsxs)("div",{className:"flex items-center gap-2 pb-1 pt-2",children:[(0,t.jsx)("div",{className:"",children:(0,t.jsx)(w.Z,{icon:"entypo:lab-flask",className:"text-3xl"})}),(0,t.jsx)("div",{className:"flex flex-col gap-0",children:(0,t.jsx)("p",{className:"text-xl",children:"An\xe1lises"})})]})}),i.map((e,s)=>{let{minimo:i,maximo:n}=c(s);return(0,t.jsxs)(l.Fragment,{children:[(0,t.jsx)("input",{type:"hidden",name:"fields.analises[".concat(s,"].id"),value:e.id}),(0,t.jsx)(D.Z,{xs:12,md:3,title:"Nome",name:"fields.analises[".concat(s,"].nome"),required:!0,form:a,opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"Unidade",name:"fields.analises[".concat(s,"].unidade"),required:!0,form:a,helpText:"%, UI/g",opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"M\xednimo",name:"fields.analises[".concat(s,"].minimo"),required:!a.watch("fields.analises[".concat(s,"].maximo")),form:a,errorText:parseFloat(a.watch("fields.analises[".concat(s,"].minimo")))>=parseFloat(a.watch("fields.analises[".concat(s,"].maximo")))&&"O m\xednimo deve ser menor que o m\xe1ximo",opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"M\xe1ximo",name:"fields.analises[".concat(s,"].maximo"),required:!a.watch("fields.analises[".concat(s,"].minimo")),form:a,errorText:parseFloat(a.watch("fields.analises[".concat(s,"].minimo")))>=parseFloat(a.watch("fields.analises[".concat(s,"].maximo")))&&"O m\xe1ximo deve ser maior que o m\xednimo",opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"Ajuda/Dica/M\xe9todo",name:"fields.analises[".concat(s,"].ajuda"),form:a,opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsxs)(m.ZP,{item:!0,xs:12,md:1,className:"flex items-center",children:[(0,t.jsx)(I.Z,{title:1===a.getValues("fields.analises[".concat(s,"].status"))?"Desativar item":"Ativar item",placement:"top",children:(0,t.jsx)(P.Z,{color:1===a.getValues("fields.analises[".concat(s,"].status"))?"error":"primary",size:"small",onClick:()=>d(s),children:(0,t.jsx)(w.Z,{icon:1===a.getValues("fields.analises[".concat(s,"].status"))?"heroicons-outline:ban":"tabler:check"})})}),(0,t.jsx)(I.Z,{title:"Remover item",placement:"top",children:(0,t.jsx)(P.Z,{color:"error",size:"small",onClick:()=>o(s),children:(0,t.jsx)(w.Z,{icon:"tabler:trash-filled"})})})]})]},e.id)}),(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsx)(N.Z,{variant:"outlined",color:"primary",onClick(){n({id:null,nome:"",unidade:"",minimo:"",maximo:"",ajuda:""}),a.trigger()},startIcon:(0,t.jsx)(w.Z,{icon:"material-symbols:add-circle-outline-rounded"}),children:"Inserir"})})]})})})},M=e=>{var a;let{id:s,btnClose:i,handleConfirmNew:w,handleModalClose:I,newChange:P,manualUrl:N,outsideID:M}=e,[q,V]=(0,l.useState)(!1),[k,T]=(0,l.useState)(null),z=n(),E=s&&s>0?"edit":"new",U=z.pathname,{title:F}=(0,l.useContext)(o.f),{setId:L}=(0,l.useContext)(c.X),{loggedUnity:_,user:A}=(0,l.useContext)(b.V),[R,H]=(0,l.useState)([]),[X,B]=(0,l.useState)(!1),{startLoading:G,stopLoading:J}=(0,v.Z)(),[K,Q]=(0,l.useState)(!1),[W,Y]=(0,l.useState)(!1),$=(0,x.cI)({mode:"onChange"}),ee=async e=>{G();let a={...e,unidadeID:_.unidadeID,usuarioID:A.usuarioID,removedItems:R};console.log("onSubmit: ",a);try{"new"===E?await d.h.post("cadastros/produto/new/insertData",a).then(e=>{w?w(e.data,"produtos"):(z.push("".concat((0,Z.g_)(U))),L(e.data.id)),f.ZP.success(Z.OD.successNew)}):"edit"===E&&(await d.h.post("".concat(U,"/updateData/").concat(s),a),f.ZP.success(Z.OD.successUpdate))}catch(t){t.response&&409===t.response.status?f.ZP.error(Z.OD.errorRepeated):console.log(t)}finally{J()}},ea=async()=>{try{await d.h.delete("".concat(U,"/").concat(s,"/").concat(A.usuarioID,"/").concat(_.unidadeID)),L(null),V(!1),f.ZP.success(Z.OD.successDelete)}catch(e){e.response&&409===e.response.status?(f.ZP.error(Z.OD.pendingDelete),V(!1)):console.log(e)}},es=async()=>{try{let e="new"===E?"cadastros/produto/new/getData/".concat(_.unidadeID):"".concat(U,"/getData/").concat(s,"/").concat(_.unidadeID);await d.h.post(e).then(e=>{console.log("\uD83D\uDE80 ~ getData:",e.data),T(e.data),$.reset(e.data)})}catch(a){console.log(a)}},et=()=>{Q(!0)},ei=async()=>{Y(!0)},en=e=>{Q(!1),$.setValue("classificacao.fields",e),Y(!W)};return(0,l.useEffect)(()=>{es(),setTimeout(()=>{$.trigger()},300)},[s]),(0,l.useEffect)(()=>{P&&$.handleSubmit(ee)()},[P]),(0,t.jsxs)(t.Fragment,{children:[!k&&(0,t.jsx)(h.Z,{}),k&&(0,t.jsxs)("form",{onSubmit:$.handleSubmit(ee),className:"space-y-3",children:[(0,t.jsx)(j.Z,{btnCancel:!0,btnNew:!w,btnSave:!0,btnClose:i,manualUrl:N,handleModalClose:I,handleSubmit:()=>$.handleSubmit(ee),btnDelete:"edit"===E,onclickDelete:()=>V(!0),type:E,outsideID:M}),(0,t.jsx)(r.Z,{children:(0,t.jsx)(u.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(D.Z,{xs:11,md:4,title:"Nome",name:"fields.nome",required:!0,form:$}),(0,t.jsx)(g.Z,{xs:12,md:3,title:"Unidade de medida",name:"unidadeMedida.fields",value:null==k?void 0:k.unidadeMedida.fields,required:!0,options:k.unidadeMedida.options,form:$,helpText:"Selecione a unidade de medida"}),(0,t.jsx)(g.Z,{xs:12,md:3,title:"Classificação",name:"classificacao.fields",value:null==k?void 0:null===(a=k.classificacao)||void 0===a?void 0:a.fields,options:k.classificacao.options,helpText:"Selecione a classificação",createNew:et,form:$}),(0,t.jsx)(S.Z,{xs:"12",md:"2",title:"Limpeza",name:"fields.limpeza",value:k.fields.limpeza,form:$,helpText:"Este produto ser\xe1 listado nos formul\xe1rios do POP2 de Limpeza e Higieniza\xe7\xe3o"}),(0,t.jsx)(S.Z,{xs:"12",md:"2",title:"Usa Laborat\xf3rio",name:"fields.usaLaboratorio",value:k.fields.usaLaboratorio,form:$,helpText:"Habilita o uso do laborat\xf3rio com a inser\xe7\xe3o de itens de an\xe1lise"})]})})}),(0,t.jsx)(O,{form:$,data:k.analises})]}),(0,t.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+F.title,openModal:q,handleClose:()=>V(!1),handleSubmit:ea,btnCancel:!0,btnConfirm:!0}),(0,t.jsx)(y.Z,{title:"Nova Classifica\xe7\xe3o de Produto",size:"md",openModal:K,setOpenModal:Q,handleSave:ei,children:(0,t.jsx)(C.Z,{manualUrl:"/cadastros/classificacao-produto",btnClose:!0,handleModalClose:()=>Q(!1),newChange:W,handleConfirmNew:en,outsideID:!0})})]})};var q=M}}]);