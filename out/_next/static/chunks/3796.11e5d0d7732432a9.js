"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3796],{62094:function(e,a,o){var t=o(85893),n=o(11163),s=o.n(n),l=o(67294),i=o(60664),r=o(49837),d=o(91359),c=o(79072),u=o(87536),m=o(86501),p=o(45061),x=o(71798),h=o(65698),f=o(47842),g=o(60565),D=o(83830),v=o(29308),b=o(67569),I=o(41088),j=o(40039);let Z=e=>{let{id:a,btnClose:o,handleModalClose:n,setNewChange:Z,newChange:C,outsideID:y,handleConfirmNew:S,manualUrl:w}=e,[P,F]=(0,l.useState)(!1),[M,E]=(0,l.useState)(null),{setId:N}=(0,l.useContext)(D.X),V=s(),k=a&&a>0?"edit":"new",A=V.pathname,{title:O}=(0,l.useContext)(g.f),{startLoading:R,stopLoading:q}=(0,I.Z)(),{user:H,loggedUnity:_}=(0,l.useContext)(j.V),z=(0,u.cI)({mode:"onChange"}),T=async e=>{let o={...e,usuarioID:H.usuarioID,unidadeID:_.unidadeID};R();try{"new"===k?await i.h.post("cadastros/tipo-veiculo/new/insertData",o).then(e=>{y?(N(y),S(e.data.value)):(V.push("".concat((0,x.g_)(A))),N(e.data.id)),m.ZP.success(x.OD.successNew)}):"edit"===k&&(await i.h.post("".concat(A,"/updateData/").concat(a),o),m.ZP.success(x.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(x.OD.errorRepeated):console.log(t)}finally{q()}},U=async()=>{try{await i.h.delete("".concat(A,"/").concat(a,"/").concat(H.usuarioID,"/").concat(_.unidadeID)),N(null),F(!1),m.ZP.success(x.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(x.OD.pendingDelete),F(!1)):console.log(e)}},B=async()=>{try{"edit"===k?await i.h.post("".concat(A,"/getData/").concat(a),{id:a}).then(e=>{E(e.data),z.reset(e.data)}):E({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{B(),setTimeout(()=>{z.trigger()},300)},[a]),(0,t.jsxs)(t.Fragment,{children:[!M&&(0,t.jsx)(f.Z,{}),M&&(0,t.jsxs)("form",{onSubmit:z.handleSubmit(T),children:[(0,t.jsx)(h.Z,{btnCancel:!0,btnNew:!S,btnSave:!0,manualUrl:w,btnClose:o,handleModalClose:n,handleSubmit:()=>z.handleSubmit(T),btnDelete:"edit"===k,onclickDelete:()=>F(!0),type:k,outsideID:y}),(0,t.jsx)(r.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(v.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:z}),(0,t.jsx)(b.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==M?void 0:M.fields.status,typePage:k,form:z})]})})})]}),(0,t.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+O.title,openModal:P,handleClose:()=>F(!1),handleSubmit:U,btnCancel:!0,btnConfirm:!0})]})};a.Z=Z},76904:function(e,a,o){var t=o(85893),n=o(11163),s=o.n(n),l=o(67294),i=o(60664),r=o(49837),d=o(91359),c=o(79072),u=o(87536),m=o(86501),p=o(45061),x=o(65698),h=o(71798),f=o(60565),g=o(83830),D=o(40039),v=o(29308),b=o(67569),I=o(41088);let j=e=>{let{id:a,btnClose:o,handleModalClose:n,setNewChange:j,newChange:Z,outsideID:C,handleConfirmNew:y,manualUrl:S}=e,[w,P]=(0,l.useState)(!1),[F,M]=(0,l.useState)(null),{setId:E}=(0,l.useContext)(g.X),N=s(),V=a&&a>0?"edit":"new",k=N.pathname,{title:A}=(0,l.useContext)(f.f),{loggedUnity:O,user:R}=(0,l.useContext)(D.V),{startLoading:q,stopLoading:H}=(0,I.Z)(),_=(0,u.cI)({mode:"onChange"}),z=async e=>{let o={...e,usuarioID:R.usuarioID,unidadeID:O.unidadeID};try{"new"===V?await i.h.post("cadastros/transportador/new/insertData",o).then(e=>{C?(E(C),y(e.data.value)):(N.push("".concat((0,h.g_)(k))),E(e.data.id)),m.ZP.success(h.OD.successNew)}):"edit"===V&&(await i.h.post("".concat(k,"/updateData/").concat(a),o),m.ZP.success(h.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(h.OD.errorRepeated):console.log(t)}finally{H()}},T=async()=>{try{await i.h.delete("".concat(k,"/").concat(a,"/").concat(R.usuarioID,"/").concat(O.unidadeID)),E(null),P(!1),m.ZP.success(h.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(h.OD.pendingDelete),P(!1)):console.log(e)}},U=async()=>{try{"edit"===V?await i.h.post("".concat(k,"/getData/").concat(a),{id:a}).then(e=>{M(e.data),_.reset(e.data)}):M({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{U(),setTimeout(()=>{_.trigger()},300)},[a]),(0,t.jsxs)(t.Fragment,{children:[F&&(0,t.jsxs)("form",{onSubmit:_.handleSubmit(z),children:[(0,t.jsx)(x.Z,{btnCancel:!0,btnNew:!y,btnSave:!0,manualUrl:S,btnClose:o,handleModalClose:n,handleSubmit:()=>_.handleSubmit(z),btnDelete:"edit"===V,onclickDelete:()=>P(!0),type:V,outsideID:C}),(0,t.jsx)(r.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(v.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:_}),(0,t.jsx)(b.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==F?void 0:F.fields.status,typePage:V,form:_})]})})})]}),(0,t.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+A.title,openModal:w,handleClose:()=>P(!1),handleSubmit:T,btnCancel:!0,btnConfirm:!0})]})};a.Z=j},73796:function(e,a,o){o.d(a,{Z:function(){return $}});var t=o(85893),n=o(67294),s=o(87536),l=o(99734),i=o(34282),r=o(29308),d=o(23895),c=o(7071),u=o(61953),m=o(49837),p=o(91359),x=o(79072),h=o(55343),f=o(29630),g=o(11163),D=o.n(g),v=o(71798),b=o(60664),I=o(65698),j=o(83830),Z=o(40039),C=o(39976),y=o(86501),S=o(66136),w=o(82755),P=o(44373),F=o(56531),M=o(50287),E=o(84220),N=o(22841),V=o(75158),k=o(17575),A=o(80562),O=o(21609);let R=e=>{let{index:a,disabled:o,form:l,apresentacoes:i}=e,{fields:d,append:c,remove:u}=(0,s.Dq)({control:l.control,name:"produtos[".concat(a,"].variacoes")}),m=()=>{c({quantidade:"0,000",dataFabricacao:"",lote:"",apresentacao:"",dataValidade:""})},p=e=>{u(e)};return(0,t.jsx)(t.Fragment,{children:d&&d.map((e,s)=>(0,t.jsxs)(n.Fragment,{children:[(0,t.jsx)("input",{type:"hidden",value:e.recebimentoMpProdutoID,name:"produtos[".concat(a,"].variacoes[").concat(s,"].recebimentoMpProdutoID"),...l.register("produtos[".concat(a,"].variacoes[").concat(s,"].recebimentoMpProdutoID"))}),(0,t.jsx)(r.Z,{xs:12,md:2,title:"Quantidade",name:"produtos[".concat(a,"].variacoes[").concat(s,"].quantidade"),disabled:o,mask:"fractioned3",form:l,value:e.quantidade}),(0,t.jsx)(M.Z,{xs:12,md:2,title:"Data da fabrica\xe7\xe3o",value:e.dataFabricacao,name:"produtos[".concat(a,"].variacoes[").concat(s,"].dataFabricacao"),disabled:o,typeValidation:"dataPassado",form:l}),(0,t.jsx)(r.Z,{xs:12,md:2,title:"N\xba Lote",name:"produtos[".concat(a,"].variacoes[").concat(s,"].lote"),disabled:o,form:l}),(0,t.jsx)(E.Z,{xs:12,md:3,title:"Apresenta\xe7\xe3o",name:"produtos[".concat(a,"].variacoes[").concat(s,"].apresentacao"),options:null!=i?i:[],value:e.apresentacao,type:"string",disabled:o,form:l}),(0,t.jsx)(M.Z,{xs:12,md:2,title:"Data de validade",value:e.dataValidade,name:"produtos[".concat(a,"].variacoes[").concat(s,"].dataValidade"),disabled:o,form:l}),(0,t.jsx)(x.ZP,{item:!0,xs:12,md:1,children:(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-1",children:[(0,t.jsx)(k.Z,{title:"Inserir varia\xe7\xe3o",placement:"top",children:(0,t.jsx)(A.Z,{color:"primary","aria-label":"delete",disabled:o||s<d.length-1,onClick:()=>m(),children:(0,t.jsx)(O.Z,{icon:"icons8:plus"})})}),(0,t.jsx)(k.Z,{title:"Remover varia\xe7\xe3o",placement:"top",children:(0,t.jsx)(A.Z,{color:"error","aria-label":"delete",disabled:o||1===d.length,onClick:()=>p(s),children:(0,t.jsx)(O.Z,{icon:"icons8:minus"})})})]})})]},e.id))})},q=e=>{let{form:a,index:o,produto:n,handleCheck:s,disabled:l,apresentacoes:i}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(x.ZP,{container:!0,spacing:4,sx:{pb:2},children:[(0,t.jsx)("input",{type:"hidden",value:n.produtoID,name:"produtos[".concat(o,"].produtoID"),...a.register("produtos[".concat(o,"].produtoID"))}),(0,t.jsx)(x.ZP,{item:!0,xs:12,md:12,children:(0,t.jsx)(N.Z,{control:(0,t.jsx)(V.Z,{onClick:e=>s(e,o),checked:!!n.checked_,disabled:l}),label:n.nome,size:"small",sx:{marginRight:"4px","&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})}),n.checked_&&(0,t.jsx)(R,{index:o,disabled:l,form:a,apresentacoes:i},o)]})})};var H=o(83542);let _=e=>{var a,o;let{form:l,recebimentoMpID:i,modelo:d,values:c,fields:h,disabled:g,getAddressByCep:D,nameSelected:v,setNameSelected:I,columnSelected:j,setColumnSelected:C,openModalNew:y,setOpenModalNew:S,newChange:w,setNewChange:N}=e,{loggedUnity:V}=(0,n.useContext)(Z.V),[k,A]=(0,n.useState)([]),[R,_]=(0,n.useState)([]),[z,T]=(0,n.useState)([]),{fields:U,append:B,remove:G,update:W}=(0,s.Dq)({control:l.control,name:"produtos"}),L=async()=>{let e=await b.h.post("/formularios/fornecedor/getFornecedoresAprovados",{unidadeID:V.unidadeID,recebimentoMpID:i,modelo:d});T(e.data)},X=async e=>{let a=await b.h.post("/formularios/recebimento-mp/getProdutosRecebimento",{recebimentoMpID:i,fornecedorCnpj:e,unidadeID:V.unidadeID});G(),a.data.forEach(e=>B(e))},J=(e,a)=>{var o;let{checked:t}=e.target,n={...U[a],checked_:t,variacoes:(null===(o=U[a])||void 0===o?void 0:o.variacoes.length)>0?[...U[a].variacoes]:[{quantidade:"0,000"}]};W(a,n)},K=async()=>{try{let e=await b.h.get("/cadastros/apresentacao");_(e.data)}catch(a){console.log("\uD83D\uDE80 ~ error:",a)}};return(0,n.useEffect)(()=>{var e;K(),L(),c&&X(null===(e=c.fornecedor)||void 0===e?void 0:e.cnpj_)},[c]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.Z,{style:{height:"100%"},children:(0,t.jsxs)(p.Z,{children:[(0,t.jsxs)(x.ZP,{container:!0,alignItems:"stretch",spacing:6,children:[(0,t.jsx)(x.ZP,{item:!0,xs:12,sx:{textAlign:"right"},children:(0,t.jsx)(H.Z,{data:null!==(a=null==c?void 0:c.departamentos)&&void 0!==a?a:[]})}),(0,t.jsx)(M.Z,{xs:12,md:2,title:"Data do recebimento",name:"fieldsHeader.data",type:"date",value:null!==(o=null==c?void 0:c.data)&&void 0!==o?o:new Date,disabled:g,typeValidation:"dataPassado",daysValidation:365,alertRequired:!0,form:l}),(0,t.jsx)(r.Z,{xs:12,md:2,title:"Hora do recebimento",name:"fieldsHeader.hora",type:"time",disabled:g,alertRequired:!0,form:l}),(0,t.jsx)(E.Z,{xs:12,md:8,title:"Fornecedor",name:"fieldsHeader.fornecedor",type:"string",options:null!=z?z:[],onChange:e=>X(null==e?void 0:e.cnpj_),value:null==c?void 0:c.fornecedor,disabled:g,form:l,alertRequired:!0}),(0,t.jsx)(F.Z,{fields:h,values:h,getAddressByCep:D,disabled:g,nameSelected:v,setNameSelected:I,columnSelected:j,setColumnSelected:C,openModalNew:y,setOpenModalNew:S,newChange:w,setNewChange:N,form:l})]}),(0,t.jsxs)(x.ZP,{container:!0,alignItems:"stretch",spacing:6,sx:{mt:2},children:[(0,t.jsxs)(x.ZP,{item:!0,xs:12,children:[(0,t.jsxs)(f.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},className:"flex items-center gap-1",children:[(0,t.jsx)(O.Z,{icon:"ph:plant",className:"text-primary"}),"Produtos aprovados do fornecedor"]}),U&&0==U.length&&(0,t.jsx)(f.Z,{color:"warning",variant:"subtitle1",className:"italic",children:(0,t.jsxs)(u.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(O.Z,{icon:"typcn:warning",color:"#FFC107"}),(0,t.jsx)("p",{children:"Nenhum fornecedor selecionado!"})]})})]}),(0,t.jsx)(x.ZP,{item:!0,xs:12,children:U&&U.length>0&&U.map((e,a)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q,{index:a,produto:e,handleCheck:J,disabled:g,form:l,apresentacoes:R},e.id),a<U.length-1&&(0,t.jsx)(P.Z,{})]}))})]})]})})})};var z=o(41088),T=o(92629),U=o(1503),B=o(76904),G=o(1322),W=o(62094),L=o(934),X=o(91757),J=o(60565),K=o(26526),Q=o(27666);let Y=e=>{var a;let o;let{id:g,model:P}=e,{menu:F,user:M,hasPermission:E,loggedUnity:N,hasSectorPermission:V}=(0,n.useContext)(Z.V),[k,A]=(0,n.useState)(!1),{setTitle:O}=(0,n.useContext)(J.f),[R,q]=(0,n.useState)(!1),[H,Y]=(0,n.useState)(!1),[$,ee]=(0,n.useState)(!1),[ea,eo]=(0,n.useState)(!1),[et,en]=(0,n.useState)(!1),[es,el]=(0,n.useState)(!0),[ei,er]=(0,n.useState)(null),[ed,ec]=(0,n.useState)([]),[eu,em]=(0,n.useState)(null),{createNewNotification:ep}=(0,n.useContext)(C.u),[ex,eh]=(0,n.useState)(!1),[ef,eg]=(0,n.useState)([]),[eD,ev]=(0,n.useState)([]),[eb,eI]=(0,n.useState)([]),[ej,eZ]=(0,n.useState)(null),[eC,ey]=(0,n.useState)([]),[eS,ew]=(0,n.useState)(null),[eP,eF]=(0,n.useState)(""),[eM,eE]=(0,n.useState)(!1),[eN,eV]=(0,n.useState)(!1),[ek,eA]=(0,n.useState)({status:!1,errors:[]}),[eO,eR]=(0,n.useState)(null),{settings:eq}=(0,n.useContext)(S.J6),{setId:eH}=(0,n.useContext)(j.X),{isLoading:e_,startLoading:ez,stopLoading:eT}=(0,z.Z)(),[eU,eB]=(0,n.useState)(!1),{setReportParameters:eG,sendPdfToServer:eW}=(0,U.Gc)(),[eL,eX]=(0,n.useState)(!1),[eJ,eK]=(0,n.useState)(!1),[eQ,eY]=(0,n.useState)(null),[e$,e0]=(0,n.useState)(null),[e1,e3]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),e6=D(),e2=g&&g>0?"edit":"new",e7="edit"==e2?e6.pathname:(0,v.g_)(e6.pathname),e9=(0,s.cI)({mode:"onChange"}),e8=()=>{eH(ei.modelo.id),e6.push("/configuracoes/formularios/recebimento-mp/")},e5=async e=>{let a={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:M.usuarioID,papelID:M.papelID,unidadeID:N.unidadeID}};try{eo(!0),await b.h.post("".concat(e7,"/changeFormStatus/").concat(g),a).then(e=>{y.ZP.success(v.OD.successUpdate),eo(!1),au(eu,null,null)})}catch(o){console.log(o)}finally{A(!k)}},e4={id:1,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,t.jsx)(X.Z,{}),disabled:!!et||!E(e6.pathname,"editar"),route:null,type:null,action:e5,modal:!0,size:"sm",icon:"heroicons:lock-open",identification:null,ncPending:!0},ae=[];1==M.papelID&&eP.status>=40&&ae.push(e4),1==M.papelID&&(o=!1,F.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(o=!0)})})}),o)&&ae.push({id:2,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:e8,modal:!1,icon:"bi:gear",identification:null});let aa=async()=>{},ao=()=>{ez();try{b.h.post("".concat(e7,"/getData"),{id:null!=g?g:0,type:e2,profissionalID:M.profissionalID,unidadeID:N.unidadeID,modeloID:null!=P?P:0}).then(e=>{var a,o,t,n;console.log("getData: ",e.data),eg(e.data.fieldsHeader),ev(e.data.fieldsFooter),eI(e.data.fields),ey(e.data.blocos),ec(e.data.grupoAnexo),eF(e.data.info),er(e.data.unidade),eZ(e.data.link),ew(e.data.ultimaMovimentacao),ad(e.data.blocos),e9.reset(e.data);let s=v.WR[null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(o=a.info)||void 0===o?void 0:o.status];em(s),e3({status:!!(1==M.papelID&&e.data.info.status<40&&V(null!==(n=null===(t=e.data.fieldsHeader)||void 0===t?void 0:t.departamentos)&&void 0!==n?n:[])),message:e.data.info.status>40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":e.data.info.status<40?"Formul\xe1rio aberto para preenchimento!":40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o!":null,messageType:"info"}),aa()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e)}finally{eT()}},at=!1,an=[],as=(e,a)=>{e9.setError(e,{type:"manual",message:"Campo obrigat\xf3rio"}),an.push(a),at=!0},al=()=>{e9.clearErrors(),e9.getValues("fieldsHeader.data")||as("fieldsHeader.data","Data da avalia\xe7\xe3o"),e9.getValues("fieldsHeader.hora")||as("fieldsHeader.hora","Hora da avalia\xe7\xe3o"),null==eb||eb.forEach((e,a)=>{let o=e.tabela?"fields[".concat(a,"].").concat(e.tabela):"fields[".concat(a,"].").concat(e.nomeColuna),t=e9.getValues(o);1!==e.obrigatorio||t||as(o,null==e?void 0:e.nomeCampo)}),eC.forEach((e,a)=>{e.itens.forEach((e,o)=>{let t=e9.getValues("blocos[".concat(a,"].itens[").concat(o,"].resposta"));(null==e?void 0:e.obrigatorio)!==1||t||(e9.setError("blocos[".concat(a,"].itens[").concat(o,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),an.push(null==e?void 0:e.nome),at=!0),e.respostaConfig&&1==e.respostaConfig.anexo&&e.respostaConfig.anexosSolicitados.length>0&&e.respostaConfig.anexosSolicitados.forEach((t,n)=>{1==t.obrigatorio&&t.anexos&&0==t.anexos.length&&(e9.setError("blocos[".concat(a,"].itens[").concat(o,"].respostaConfig.anexosSolicitados[").concat(n,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),an.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==t?void 0:t.nome)),at=!0)})})}),ed&&ed.length>0&&ed.forEach((e,a)=>{e.itens.forEach((o,t)=>{1===o.obrigatorio&&0==o.anexos.length&&(e9.setError("grupoAnexo[".concat(a,"].itens[").concat(t,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),an.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==o?void 0:o.nome)),at=!0)})}),eA({status:at,errors:an})},ai=async e=>{if(9===e.length){let a=e.replace(/[^0-9]/g,"");try{let o=await b.h.get("https://viacep.com.br/ws/".concat(a,"/json/"));o.data.localidade?(eb.forEach(async(e,a)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await setValue("fields[".concat(a,"].logradouro"),o.data.logradouro),await setValue("fields[".concat(a,"].bairro"),o.data.bairro),await setValue("fields[".concat(a,"].cidade"),o.data.localidade),await setValue("fields[".concat(a,"].estado"),o.data.uf))}),y.ZP.success("Endere\xe7o encontrado!")):y.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},ar=e=>{eR(e),al(),ad(eC),eE(!0)},ad=e=>{let a=!0;e.forEach(e=>{e.itens.forEach(e=>{e.resposta&&1==e.resposta.bloqueiaFormulario&&(a=!1)})}),el(a)},ac=async e=>{e.conclusion=!0,await e9.handleSubmit(am)(e)},au=(e,a,o)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(g," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:g,tipoNotificacaoID:6,usuarioGeradorID:M.usuarioID,usuarioID:0,unidadeID:N.unidadeID,papelID:1};if(n&&(ep(n),a)){let s={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(g," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:o,tipoNotificacaoID:5,usuarioGeradorID:M.usuarioID,usuarioID:0,unidadeID:N.unidadeID,papelID:1};ep(s)}},am=async function(e){var a,o;let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===t.conclusion&&(e.concluiForm=!0,e.info.status=null!==(a=t.status)&&void 0!==a?a:eP.status,e.obsConclusao=t.obsConclusao);let n={form:e,auth:{usuarioID:M.usuarioID,profissionalID:null!==(o=M.profissionalID)&&void 0!==o?o:0,papelID:M.papelID,unidadeID:N.unidadeID}},s=n.form.produtos.some(e=>!0===e.checked_);if(!s){y.ZP.error("\xc9 necess\xe1rio selecionar pelo menos um produto!");return}if(!0!=g){eE(!1);try{"edit"==e2?await b.h.post("".concat(e7,"/updateData/").concat(g),n).then(a=>{y.ZP.success(v.OD.successUpdate),au(e.status,e.naoConformidade,null)}):"new"==e2?await b.h.post("".concat(e7,"/insertData"),n).then(e=>{eH(e.data.recebimentoMpID),e6.push("".concat(e7)),y.ZP.success(v.OD.successNew)}):y.ZP.error(v.OD.error)}catch(l){console.log("erro da fun\xe7\xe3o update/email",l)}finally{A(!k)}}},ap=async(e,a)=>{q(!0);let o=e.target.files;if(o&&o.length>0){var t;let n=new FormData;for(let s=0;s<o.length;s++)n.append("files[]",o[s]);n.append("usuarioID",M.usuarioID),n.append("unidadeID",N.unidadeID),n.append("grupoAnexoItemID",null!==(t=a.grupoAnexoItemID)&&void 0!==t?t:null),await b.h.post("".concat(e7,"/saveAnexo/").concat(g,"/grupo-anexo/").concat(M.usuarioID,"/").concat(ei.unidadeID),n).then(e=>{let a=e9.getValues();am(a)}).catch(e=>{var a,o,t;y.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")}).finally(()=>{q(!1),A(!k)})}},ax=async(e,a)=>{ee(!0);let o=e.target.files;if(o&&o.length>0){var t,n;let s=new FormData;for(let l=0;l<o.length;l++)s.append("files[]",o[l]);s.append("usuarioID",M.usuarioID),s.append("unidadeID",N.unidadeID),s.append("parRecebimentoMpModeloBlocoID",null!==(t=a.parRecebimentoMpModeloBlocoID)&&void 0!==t?t:null),s.append("itemOpcaoAnexoID",null!==(n=a.itemOpcaoAnexoID)&&void 0!==n?n:null),await b.h.post("".concat(e7,"/saveAnexo/").concat(g,"/item/").concat(M.usuarioID,"/").concat(ei.unidadeID),s).then(e=>{let a=e9.getValues();am(a)}).catch(e=>{var a,o,t;y.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!!!!")}).finally(()=>{ee(!1),A(!k)})}},ah=async e=>{e&&await b.h.delete("".concat(e7,"/deleteAnexo/").concat(g,"/").concat(e.anexoID,"/").concat(ei.unidadeID,"/").concat(M.usuarioID,"/item")).then(e=>{let a=e9.getValues();am(a)}).catch(e=>{var a,o,t;y.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")}).finally(()=>{ao()})},af=e=>{e.preventDefault();let a=e9.getValues();am(a)};(0,n.useEffect)(()=>{O({icon:"icon-park-outline:receive",title:"Recebimento de MP",subtitle:{id:g,count:1,new:!1}}),ao()},[g,k]),(0,n.useEffect)(()=>{al()},[e_]);let ag=async e=>{eK(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("form",{onSubmit:e=>af(e),children:[(0,t.jsx)(I.Z,{id:g,btnCancel:!0,btnSave:!eP.concluido,btnSend:1==M.papelID&&eP.status>=30&&!eP.concluido,btnPrint:"edit"==e2,btnDelete:eP.status<40&&"edit"===e2,onclickDelete:()=>eB(!0),handleSubmit:()=>e9.handleSubmit(am),handleSend:ar,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir",title:"Recebimento de MP",btnStatus:1==M.papelID&&"edit"==e2,handleBtnStatus:()=>eh(!0),type:e2,status:eu,actions:ae.length>0,actionsData:ae,module:"recebimentoMp",actionsNC:eP.naoConformidade&&eP.status>40},g),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[eu&&(0,t.jsx)(c.Z,{size:"small",skin:"light",color:eu.color,label:eu.title,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}}),ei&&ei.modelo&&(0,t.jsx)(c.Z,{size:"small",HeaderFiel:!0,skin:"light",label:ei.modelo.nome,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}})]}),(0,t.jsxs)(u.Z,{display:"flex",flexDirection:"column",sx:{gap:6},children:[(0,t.jsx)(K.Z,{description:eP.cabecalhoModelo}),ei&&(0,t.jsx)(_,{nameSelected:e$,setNameSelected:e0,columnSelected:eQ,setColumnSelected:eY,openModalNew:eJ,setOpenModalNew:eK,newChange:eL,setNewChange:eX,recebimentoMpID:g,modelo:ei.modelo,values:ef,fields:eb,disabled:!e1.status,getAddressByCep:ai,form:e9},ei.unidadeID),"new"===e2&&(0,t.jsx)(Q.Z,{}),eC&&"edit"===e2&&eC.map((e,a)=>(0,t.jsx)(l.Z,{form:e9,index:a,bloco:e,blockKey:"parRecebimentoMpModeloBlocoID",setBlocos:ey,blocos:eC,disabled:et,handleFileSelect:ax,handleRemoveAnexoItem:ah,status:eP.status})),ed&&ed.map((e,a)=>{var o;return(0,t.jsx)(d.Z,{values:{grupo:e,loadingFile:R,indexGrupo:a,handleFileSelect:ap,handleRemove:handleRemoveAnexoGroup,folder:"grupo-anexo",disabled:!e1.status,error:null===(o=e9.formState)||void 0===o?void 0:o.errors}},a)}),eP&&"edit"===e2&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.Z,{children:(0,t.jsx)(p.Z,{children:(0,t.jsx)(x.ZP,{container:!0,spacing:4,children:(0,t.jsx)(x.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(h.Z,{fullWidth:!0,children:[(0,t.jsx)(f.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(r.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:3,value:eP.obs,disabled:!e1.status,form:e9})]})})})})})}),(0,t.jsx)(L.Z,{id:g,parFormularioID:2},k),ex&&(0,t.jsx)(i.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(g," do Recebimento de MP."),id:g,parFormularioID:2,formStatus:eP.status,hasFormPending:et,canChangeStatus:!1,openModal:ex,handleClose:()=>eh(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:!1}),(0,t.jsx)(w.Z,{openModal:eM,handleClose(){eE(!1),al()},title:"Concluir Recebimento de MP",text:"Deseja realmente concluir este formul\xe1rio?",info:eP,canChange:!et,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:ac,listErrors:ek,canApprove:es,hasNaoConformidade:!0,type:"recebimentoMp",unity:ei,values:eD,formularioID:2,modeloID:null==ei?void 0:null===(a=ei.modelo)||void 0===a?void 0:a.id,form:e9}),(0,t.jsx)(T.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/recebimento-mp/delete/".concat(g),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eU,handleClose:()=>eB(!1)})]})]})]}),(0,t.jsx)(G.Z,{title:"transportadorID"==eQ?"Novo transportador":"tipoVeiculoID"==eQ?"Novo tipo de veiculo":"",size:"md",openModal:eJ,setOpenModal:eK,children:"transportadorID"==eQ?(0,t.jsx)(B.Z,{btnClose:!0,handleModalClose:()=>eK(!1),setNewChange:eX,newChange:eL,outsideID:!0,handleConfirmNew:ag,manualUrl:"/cadastros/transportador"}):"tipoVeiculoID"==eQ?(0,t.jsx)(W.Z,{btnClose:!0,handleModalClose:()=>eK(!1),setNewChange:eX,newChange:eL,outsideID:!0,handleConfirmNew:ag,manualUrl:"/cadastros/tipo-veiculo"}):null})]})};var $=Y}}]);