"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8806],{59742:function(e,a,o){o.d(a,{Z:function(){return w}});var t=o(63366),r=o(87462),s=o(67294),i=o(86010),n=o(94780),l=o(29630),d=o(78884),c=o(67074),u=o(1588),m=o(34867);function f(e){return(0,m.Z)("MuiCardHeader",e)}let x=(0,u.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var p=o(85893);let h=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],g=e=>{let{classes:a}=e;return(0,n.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},f,a)},Z=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,a)=>(0,r.Z)({[`& .${x.title}`]:a.title,[`& .${x.subheader}`]:a.subheader},a.root)})({display:"flex",alignItems:"center",padding:16}),j=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,a)=>a.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),v=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,a)=>a.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),b=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,a)=>a.content})({flex:"1 1 auto"}),C=s.forwardRef(function(e,a){let o=(0,d.Z)({props:e,name:"MuiCardHeader"}),{action:s,avatar:n,className:c,component:u="div",disableTypography:m=!1,subheader:f,subheaderTypographyProps:x,title:C,titleTypographyProps:w}=o,y=(0,t.Z)(o,h),P=(0,r.Z)({},o,{component:u,disableTypography:m}),D=g(P),I=C;null==I||I.type===l.Z||m||(I=(0,p.jsx)(l.Z,(0,r.Z)({variant:n?"body2":"h5",className:D.title,component:"span",display:"block"},w,{children:I})));let S=f;return null==S||S.type===l.Z||m||(S=(0,p.jsx)(l.Z,(0,r.Z)({variant:n?"body2":"body1",className:D.subheader,color:"text.secondary",component:"span",display:"block"},x,{children:S}))),(0,p.jsxs)(Z,(0,r.Z)({className:(0,i.Z)(D.root,c),as:u,ref:a,ownerState:P},y,{children:[n&&(0,p.jsx)(j,{className:D.avatar,ownerState:P,children:n}),(0,p.jsxs)(b,{className:D.content,ownerState:P,children:[I,S]}),s&&(0,p.jsx)(v,{className:D.action,ownerState:P,children:s})]}))});var w=C},48806:function(e,a,o){o.d(a,{Z:function(){return M}});var t=o(85893),r=o(11163),s=o.n(r),i=o(67294),n=o(60664),l=o(66136),d=o(83830),c=o(49837),u=o(91359),m=o(79072),f=o(17575),x=o(80562),p=o(55343),h=o(44731),g=o(59742),Z=o(29630),j=o(21609),v=o(87536),b=o(47842),C=o(86501),w=o(65698),y=o(71798),P=o(49540),D=o(40039),I=o(29308),S=o(84220),q=o(3893),F=o(82747),k=o(9041),N=o(54225),R=o(67836);let T=e=>{let{register:a,errors:o,setShowNewPassword:r,showNewPassword:s,watch:n}=e,[l,d]=(0,i.useState)({showPassword:!1,showConfirmPassword:!1}),c=()=>{d({...l,showPassword:!l.showPassword})},u=e=>{e.preventDefault()},f=()=>{d({...l,showConfirmPassword:!l.showConfirmPassword})},h=e=>{e.preventDefault()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.ZP,{item:!0,xs:6,md:4,children:(0,t.jsx)(p.Z,{fullWidth:!0,children:(0,t.jsx)(N.Z,{variant:"outlined",size:"large",startIcon:(0,t.jsx)(j.Z,{icon:"uil:padlock"}),onClick:()=>r(!s),children:"Alterar senha"})})}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.ZP,{item:!0,xs:6,sm:4,children:(0,t.jsx)(R.Z,{fullWidth:!0,label:"Nova senha",id:"input-password",variant:"outlined",size:"small",type:l.showPassword?"text":"password",name:"senha",error:!!o.senha,helperText:o.senha&&o.senha.message,InputProps:{endAdornment:(0,t.jsx)(k.Z,{position:"end",children:(0,t.jsx)(x.Z,{edge:"end",onClick:c,onMouseDown:u,children:(0,t.jsx)(j.Z,{icon:l.showPassword?"mdi:eye-outline":"mdi:eye-off-outline"})})})},...a("senha",{minLength:{value:4,message:"Senha deve ter pelo menos 4 caracteres"}})})}),(0,t.jsx)(m.ZP,{item:!0,xs:6,sm:4,children:(0,t.jsx)(R.Z,{fullWidth:!0,label:"Confirmar nova senha",id:"input-confirm-password",variant:"outlined",size:"small",type:l.showConfirmPassword?"text":"password",name:"confirmaSenha",error:!!o.confirmaSenha,helperText:o.confirmaSenha&&o.confirmaSenha.message,InputProps:{endAdornment:(0,t.jsx)(k.Z,{position:"end",children:(0,t.jsx)(x.Z,{edge:"end",onClick:f,onMouseDown:h,children:(0,t.jsx)(j.Z,{icon:l.showConfirmPassword?"mdi:eye-outline":"mdi:eye-off-outline"})})})},onChange(e){setLenghtPassword(e.target.value)},...a("confirmaSenha",{validate:e=>e===n("senha")||"As senhas n\xe3o coincidem"})})})]})]})};var E=o(92629);let z=e=>{var a,o,r,k,N;let{id:R}=e,{user:z,setUser:M,loggedUnity:A,setLoggedUnity:V}=(0,i.useContext)(D.V),{setId:O}=(0,i.useContext)(d.X);R=1===z.papelID?R:A.unidadeID;let[H,J]=(0,i.useState)(!1),[U,_]=(0,i.useState)(),[$,B]=(0,i.useState)(!1),[Y,L]=(0,i.useState)(),[W,Q]=(0,i.useState)(null),[X,G]=(0,i.useState)(!1),K=s(),ee=R&&R>0?"edit":"new",ea=1===z.papelID?K.pathname:"/configuracoes/unidade",eo=(0,i.useRef)(null),{settings:et}=(0,i.useContext)(l.J6),er=et.mode,[es,ei]=(0,i.useState)([]),en=(0,v.cI)({mode:"onChange"}),el=async e=>{if(9==e.length){let a=e.replace(/\D/g,"");n.h.get("https://viacep.com.br/ws/"+a+"/json/").then(e=>{e.data.localidade?(en.setValue("fields.logradouro",e.data.logradouro),en.setValue("fields.bairro",e.data.bairro),en.setValue("fields.cidade",e.data.localidade),en.setValue("fields.uf",e.data.uf),C.ZP.success("Endere\xe7o encontrado!")):C.ZP.error("Endere\xe7o n\xe3o encontrado!")})}},ed=async e=>{let a=1===e.fields.cpf?(0,F.sw)(e.fields.cnpj):(0,F.zk)(e.fields.cnpj);if(!a){en.setError("fields.cnpj",{type:"required",message:1===e.fields.cpf?"CPF inv\xe1lido":"CNPJ inv\xe1lido"});return}let o={...e,usuarioID:z.usuarioID,unidadeID:A.unidadeID,fields:{...e.fields,fornecedorCategoriaID:e.fields.categoria.id,fornecedorCategoriaRiscoID:e.fields.risco.id,dataCadastro:new Date().toISOString().substring(0,10),dataAtualizacao:new Date().toISOString().substring(0,10)}};delete o.cabecalhoRelatorioTitle,delete o.cabecalhoRelatorio,delete o.fields.riscoID,delete o.fields.categoriaID,delete o.fields.categoria,delete o.fields.risco,delete o.fields.categoriaNome,delete o.fields.riscoNome;try{"new"===ee?await n.h.post("".concat((0,y.g_)(ea),"/new/insertData"),o).then(e=>{K.push("".concat((0,y.g_)(ea))),O(e.data),C.ZP.success(y.OD.successNew)}):"edit"===ee&&(await n.h.post("".concat(ea,"/updateData/").concat(R),o),C.ZP.success(y.OD.successUpdate),B(!1),em()),2===z.papelID&&V({...A,nomeFantasia:e.fields.nomeFantasia,complemento:e.fields.complemento,razaoSocial:e.fields.razaoSocial,responsavel:e.fields.responsavel,email:e.fields.email,telefone1:e.fields.telefone1,telefone2:e.fields.telefone2,cep:e.fields.cep,logradouro:e.fields.logradouro,numero:e.fields.numero,complemento:e.fields.complemento,bairro:e.fields.bairro,cidade:e.fields.cidade,uf:e.fields.uf})}catch(t){t.response&&409===t.response.status?C.ZP.error(y.OD.errorRepeated):console.log(t)}finally{ec()}},ec=async()=>{localStorage.removeItem("loggedUnity"),localStorage.setItem("loggedUnity",JSON.stringify(A))},eu=async()=>{let e=await n.h.post("/configuracoes/formularios/fornecedor/getCategories",{unidadeID:A.unidadeID,allRisks:!0});ei(e.data)};(0,i.useEffect)(()=>{eu()},[]);let em=async()=>{if("edit"==ee)try{var e,a;let o=await n.h.get("".concat(ea,"/").concat(R));en.reset(o.data),_(o.data),L(o.data.fields.cabecalhoRelatorioTitle),Q(null===(e=o.data)||void 0===e?void 0:null===(a=e.fields)||void 0===a?void 0:a.cabecalhoRelatorio)}catch(t){console.log(t)}else _({}),en.reset({fields:{logradouro:"--",bairro:"--",cidade:"--",uf:"--"}});setTimeout(()=>{en.trigger()},300)};(0,i.useEffect)(()=>{em()},[R]);//! Crud imagem cabeçalho relatórios
let ef=()=>{eo.current.click()};console.log("Foto atual",W);let ex=async e=>{let a=e.target.files[0];if(a){let o=new FormData;o.append("files[]",a),o.append("usuarioID",z.usuarioID);let t=a.type.includes("image");if(!t){C.ZP.error("O arquivo selecionado n\xe3o \xe9 uma imagem!");return}await n.h.post("".concat(ea,"/updateData/report/").concat(R,"/").concat(z.usuarioID,"/").concat(A.unidadeID),o).then(e=>{Q(e.data),C.ZP.success("Foto atualizada com sucesso!");let a=JSON.parse(localStorage.getItem("userData"));a.imagem=e.data,localStorage.setItem("userData",JSON.stringify(a)),M(a)}).catch(e=>{var a,o,t;C.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar foto de perfil, tente novamente!")})}},ep=async()=>{try{await n.h.delete("".concat(ea,"/fileReport/").concat(R,"/").concat(z.usuarioID,"/").concat(A.unidadeID)),Q(null),C.ZP.success("Foto removida com sucesso!")}catch(e){console.log(e),C.ZP.error("Erro ao remover foto, tente novamente!")}};return(0,t.jsxs)(t.Fragment,{children:[!U&&(0,t.jsx)(b.Z,{}),U&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("form",{onSubmit:en.handleSubmit(ed),children:[(0,t.jsx)(w.Z,{btnCancel:1===z.papelID,btnSave:!0,handleSubmit:()=>en.handleSubmit(ed),btnDelete:"edit"===ee&&1===z.papelID,onclickDelete:()=>G(!0),type:ee}),(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(E.Z,{title:"Excluir Unidade",description:"Tem certeza que deseja exluir a unidade?",params:{route:"configuracoes/unidade/".concat(R),messageSucceded:"Unidade exclu\xedda com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:X,handleClose:()=>G(!1)}),(0,t.jsx)(u.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:4,children:["edit"==ee&&(0,t.jsx)(m.ZP,{item:!0,xs:12,md:2,children:(0,t.jsxs)(m.ZP,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"140px",position:"relative",border:"".concat("dark"===er?"1px solid #65656E":"1px solid #C5C6CD"),borderRadius:"8px"},children:[W&&(0,t.jsx)(f.Z,{title:"Apagar foto do perfil",placement:"top",children:(0,t.jsx)(x.Z,{size:"small",sx:{position:"absolute",top:"8px",right:"8px",zIndex:"20",color:"white",opacity:"0.8",backgroundColor:"#FF4D49","&:hover":{backgroundColor:"#FF4D49",opacity:"1"}},onClick:ep,children:(0,t.jsx)(j.Z,{icon:"material-symbols:delete-outline"})})}),(0,t.jsx)(f.Z,{title:W?"Alterar foto":"Inserir foto",placement:"top",children:(0,t.jsxs)(p.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},children:[(0,t.jsx)("input",{type:"file",ref:eo,style:{display:"none"},onChange:ex}),(0,t.jsx)(h.Z,{variant:"rounded",alt:"Imagem do cabe\xe7alho do relat\xf3rio",sx:{width:"100%",height:"100%",cursor:"pointer"},onClick:ef,src:null!=W?W:"https://gedagro.com.br/images/report.png"})]})})]})}),(0,t.jsx)(m.ZP,{item:!0,xs:12,md:"new"==ee?12:10,children:(0,t.jsxs)(m.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(I.Z,{xs:12,md:4,title:1===U.fields.cpf?"Nome":"Raz\xe3o Social",name:"fields.razaoSocial",required:!0,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:1===U.fields.cpf?"Apelido":"Nome Fantasia",name:"fields.nomeFantasia",required:!0,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:1===U.fields.cpf?"CPF":"CNPJ",name:"fields.cnpj",mask:1===U.fields.cpf?"cpf":"cnpj",required:!0,disabled:1!==z.papelID,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Respons\xe1vel",name:"fields.responsavel",required:!0,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"E-mail",name:"fields.email",type:"email",required:!0,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Telefone 1",name:"fields.telefone1",mask:"telefone",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Telefone 2",name:"fields.telefone2",mask:"telefone",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"CEP",name:"fields.cep",getAddressByCep:el,mask:"cep",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Rua",name:"fields.logradouro",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"N\xfamero",name:"fields.numero",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Complemento",name:"fields.complemento",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Bairro",name:"fields.bairro",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Cidade",name:"fields.cidade",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"UF",name:"fields.uf",mask:"estado",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Pais",name:"fields.pais",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Principais Clientes",name:"fields.principaisClientes",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"Resgistro de Sipeagro",name:"fields.registroSipeagro",required:!1,form:en}),(0,t.jsx)(I.Z,{xs:12,md:4,title:"IE",name:"fields.ie",required:!1,form:en}),(0,t.jsx)(S.Z,{xs:12,md:4,title:"Categoria",name:"fields.categoria",value:en.getValues("fields.categoria"),onChange(e){en.setValue("fields.risco",null),en.setValue("fields.categoria",e),en.watch("fields.categoria")},required:!0,options:null!=es?es:[],form:en}),(0,t.jsx)(S.Z,{xs:12,md:4,title:"Risco",name:"fields.risco",value:null==U?void 0:null===(a=U.fields)||void 0===a?void 0:a.risco,required:!0,options:null!==(N=(null===(o=en.getValues("fields.categoria"))||void 0===o?void 0:o.riscos)||(null===(r=es.filter(e=>{var a;return e.id==(null==U?void 0:null===(a=U.fields)||void 0===a?void 0:a.categoriaID)})[0])||void 0===r?void 0:r.riscos))&&void 0!==N?N:[],form:en}),(0,t.jsx)(m.ZP,{item:!0,xs:12,md:4}),"edit"==ee&&2==z.papelID&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(T,{register:en.register,errors:null===(k=en.formState)||void 0===k?void 0:k.errors,showNewPassword:$,setShowNewPassword:B,watch:en.watch})})]})})]})})]})]}),"edit"==ee&&1==z.papelID&&(0,t.jsxs)(c.Z,{sx:{mt:4},children:[(0,t.jsx)(g.Z,{title:"Par\xe2metros"}),(0,t.jsx)(u.Z,{children:(0,t.jsx)(m.ZP,{container:!0,spacing:8,children:(0,t.jsxs)(m.ZP,{item:!0,xs:12,md:12,children:[(0,t.jsxs)(m.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(I.Z,{xs:12,md:9,title:"T\xedtulo do relat\xf3rio",name:"fields.tituloRelatorio",required:!1,form:en,helpText:"T\xedtulo que aparecer\xe1 no cabe\xe7alho dos relat\xf3rios"}),(0,t.jsx)(I.Z,{xs:12,md:3,title:"Tamanho m\xe1ximo dos anexos (MB)",name:"fields.anexosTamanhoMaximo",required:!0,form:en}),(0,t.jsx)(q.Z,{title:"Obrigat\xf3rio o produto no formul\xe1rio de qualifica\xe7\xe3o do fornecedor",name:"fields.obrigatorioProdutoFornecedor",value:U.fields.obrigatorioProdutoFornecedor,form:en,helpText:"Com esta op\xe7\xe3o marcada, ser\xe1 obrigat\xf3rio selecionar um ou mais produtos no formul\xe1rio de qualifica\xe7\xe3o do fornecedor."})]}),(0,t.jsx)(m.ZP,{container:!0,spacing:4,children:(0,t.jsx)(m.ZP,{item:!0,xs:12,md:12,children:(0,t.jsx)(q.Z,{title:"Habilita quem preenche o formul\xe1rio de qualifica\xe7\xe3o do fornecedor (F\xe1brica ou Fornecedor)",name:"fields.habilitaQuemPreencheFormFornecedor",value:U.fields.habilitaQuemPreencheFormFornecedor,form:en,helpText:"Com esta op\xe7\xe3o marcada, ser\xe1 definido quem preenche o formul\xe1rio de qualifica\xe7\xe3o do fornecedor na cria\xe7\xe3o de um novo formul\xe1rio, caso contr\xe1rio somente o fornecedor poder\xe1 preencher."})})})]})})})]}),"edit"===ee&&U&&(0,t.jsxs)(Z.Z,{variant:"caption",sx:{display:"flex",justifyContent:"end",p:4},children:["Data de cadastro: ",(0,P.p6)(U.fields.dataCadastro,"DD/MM/YYYY")]})]})]})};var M=z},92629:function(e,a,o){var t=o(85893),r=o(54225),s=o(1890),i=o(77745),n=o(95398),l=o(76779),d=o(29630),c=o(60664),u=o(67294),m=o(83830),f=o(86501),x=o(40039);let p=e=>{let{title:a,description:o,open:p,handleClose:h,params:g}=e,{setId:Z}=(0,u.useContext)(m.X),{user:j,loggedUnity:v}=(0,u.useContext)(x.V),b=async()=>{try{await c.h.delete("".concat(g.route,"/").concat(j.usuarioID,"/").concat(v.unidadeID)),f.ZP.success(g.messageSucceded),Z(null)}catch(e){console.log(e),f.ZP.error(g.MessageError)}finally{h()}};return(0,t.jsxs)(s.Z,{open:p,children:[(0,t.jsx)(i.Z,{id:"form-dialog-title",children:a}),(0,t.jsx)(n.Z,{children:(0,t.jsx)(d.Z,{variant:"body1",children:o})}),(0,t.jsxs)(l.Z,{className:"dialog-actions-dense",children:[(0,t.jsx)(r.Z,{variant:"outlined",color:"secondary",onClick:h,children:"Cancelar"}),(0,t.jsx)(r.Z,{variant:"contained",color:"error",onClick:b,children:"Confirmar"})]})]})};a.Z=p},3893:function(e,a,o){var t=o(85893),r=o(79072),s=o(61953),i=o(22841),n=o(75158),l=o(53934),d=o(67294);let c=e=>{let{form:a,xs:o,md:c,title:u,name:m,value:f,disabled:x,onClick:p,helpText:h,helpTextPosition:g}=e;return(0,d.useEffect)(()=>{x&&a.setValue(m,f)},[x,f,a,m]),(0,t.jsx)(r.ZP,{item:!0,xs:null!=o?o:"12",md:null!=c?c:"12",children:(0,t.jsx)(s.Z,{display:"flex",alignItems:"center",justifyContent:"start",sx:{gap:0},children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Z,{control:(0,t.jsx)(n.Z,{name:m,onClick:p,...a.register(m),defaultChecked:f,disabled:x}),label:u,size:"small",sx:{marginRight:"4px","&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}}),h&&(0,t.jsx)(l.Z,{text:h,position:null!=g?g:"top",className:"relative top-[2px]"})]})})})};a.Z=c},82747:function(e,a,o){function t(e){if(!e||14!==(e=null==e?void 0:e.replace(/[^\d]+/g,"")).length||/^(\d)\1+$/.test(e))return!1;let a=e.length-2,o=e.substring(0,a),t=e.substring(a),r=0,s=a-7;for(let i=a;i>=1;i--)r+=o.charAt(a-i)*s--,s<2&&(s=9);let n=r%11<2?0:11-r%11;if(n!=t.charAt(0))return!1;a+=1,o=e.substring(0,a),r=0,s=a-7;for(let l=a;l>=1;l--)r+=o.charAt(a-l)*s--,s<2&&(s=9);return(n=r%11<2?0:11-r%11)==t.charAt(1)}function r(e){let a;if(!e||11!==(e=e.replace(/[^\d]+/g,"")).length||/^(\d)\1+$/.test(e))return!1;let o=0;for(let t=1;t<=9;t++)o+=parseInt(e.substring(t-1,t))*(11-t);if((10==(a=10*o%11)||11===a)&&(a=0),a!==parseInt(e.substring(9,10)))return!1;o=0;for(let r=1;r<=10;r++)o+=parseInt(e.substring(r-1,r))*(12-r);return(10==(a=10*o%11)||11===a)&&(a=0),a===parseInt(e.substring(10,11))}function s(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}o.d(a,{dI:function(){return s},sw:function(){return r},zk:function(){return t}})}}]);