"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5780],{91359:function(e,o,a){a.d(o,{Z:function(){return g}});var t=a(87462),n=a(63366),r=a(67294),s=a(86010),l=a(94780),i=a(67074),d=a(78884),c=a(1588),u=a(34867);function m(e){return(0,u.Z)("MuiCardContent",e)}(0,c.Z)("MuiCardContent",["root"]);var p=a(85893);let x=["className","component"],f=e=>{let{classes:o}=e;return(0,l.Z)({root:["root"]},m,o)},h=(0,i.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,o)=>o.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),v=r.forwardRef(function(e,o){let a=(0,d.Z)({props:e,name:"MuiCardContent"}),{className:r,component:l="div"}=a,i=(0,n.Z)(a,x),c=(0,t.Z)({},a,{component:l}),u=f(c);return(0,p.jsx)(h,(0,t.Z)({as:l,className:(0,s.Z)(u.root,r),ownerState:c,ref:o},i))});var g=v},49837:function(e,o,a){a.d(o,{Z:function(){return b}});var t=a(87462),n=a(63366),r=a(67294),s=a(86010),l=a(94780),i=a(67074),d=a(78884),c=a(70918),u=a(1588),m=a(34867);function p(e){return(0,m.Z)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var x=a(85893);let f=["className","raised"],h=e=>{let{classes:o}=e;return(0,l.Z)({root:["root"]},p,o)},v=(0,i.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,o)=>o.root})(()=>({overflow:"hidden"})),g=r.forwardRef(function(e,o){let a=(0,d.Z)({props:e,name:"MuiCard"}),{className:r,raised:l=!1}=a,i=(0,n.Z)(a,f),c=(0,t.Z)({},a,{raised:l}),u=h(c);return(0,x.jsx)(v,(0,t.Z)({className:(0,s.Z)(u.root,r),elevation:l?8:void 0,ref:o,ownerState:c},i))});var b=g},62094:function(e,o,a){var t=a(85893),n=a(11163),r=a.n(n),s=a(67294),l=a(60664),i=a(49837),d=a(91359),c=a(79072),u=a(87536),m=a(86501),p=a(45061),x=a(23197),f=a(86887),h=a(47842),v=a(60565),g=a(83830),b=a(29308),j=a(67569),D=a(41088),Z=a(40039);let C=e=>{var o;let{id:a,btnClose:n,handleModalClose:C,setNewChange:y,newChange:I,outsideID:S,handleConfirmNew:w,manualUrl:P}=e,[F,N]=(0,s.useState)(!1),[E,O]=(0,s.useState)(null),{setId:M}=(0,s.useContext)(g.X),V=r(),k=a&&a>0?"edit":"new",A=V.pathname,{title:R}=(0,s.useContext)(v.f),{startLoading:H,stopLoading:z}=(0,D.Z)(),{user:_,loggedUnity:T}=(0,s.useContext)(Z.V),{trigger:q,handleSubmit:W,reset:B,control:U,formState:{errors:X},register:G}=(0,u.cI)({mode:"onChange"}),J=async e=>{let o={...e,usuarioID:_.usuarioID,unidadeID:T.unidadeID};H();try{"new"===k?await l.h.post("cadastros/tipo-veiculo/new/insertData",o).then(e=>{S?(M(S),w(e.data.value)):(V.push("".concat((0,x.g_)(A))),M(e.data.id)),m.ZP.success(x.OD.successNew)}):"edit"===k&&(await l.h.post("".concat(A,"/updateData/").concat(a),o),m.ZP.success(x.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(x.OD.errorRepeated):console.log(t)}finally{z()}},L=async()=>{try{await l.h.delete("".concat(A,"/").concat(a,"/").concat(_.usuarioID,"/").concat(T.unidadeID)),M(null),N(!1),m.ZP.success(x.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(x.OD.pendingDelete),N(!1)):console.log(e)}},K=async()=>{try{"edit"===k?await l.h.post("".concat(A,"/getData/").concat(a),{id:a}).then(e=>{O(e.data),B(e.data)}):O({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,s.useEffect)(()=>{K(),setTimeout(()=>{q()},300)},[a]),(0,t.jsxs)(t.Fragment,{children:[!E&&(0,t.jsx)(h.Z,{}),E&&(0,t.jsxs)("form",{onSubmit:W(J),children:[(0,t.jsx)(f.Z,{btnCancel:!0,btnNew:!w,btnSave:!0,manualUrl:P,btnClose:n,handleModalClose:C,handleSubmit:()=>W(J),btnDelete:"edit"===k,onclickDelete:()=>setOpenDelete(!0),type:k,outsideID:S}),(0,t.jsx)(i.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(b.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:U,errors:null==X?void 0:null===(o=X.fields)||void 0===o?void 0:o.nome}),(0,t.jsx)(j.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==E?void 0:E.fields.status,typePage:k,register:G})]})})})]}),(0,t.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+R.title,openModal:F,handleClose:()=>N(!1),handleSubmit:L,btnCancel:!0,btnConfirm:!0})]})};o.Z=C},76904:function(e,o,a){var t=a(85893),n=a(11163),r=a.n(n),s=a(67294),l=a(60664),i=a(49837),d=a(91359),c=a(79072),u=a(87536),m=a(86501),p=a(45061),x=a(86887),f=a(23197),h=a(60565),v=a(83830),g=a(40039),b=a(29308),j=a(67569),D=a(41088);let Z=e=>{var o;let{id:a,btnClose:n,handleModalClose:Z,setNewChange:C,newChange:y,outsideID:I,handleConfirmNew:S,manualUrl:w}=e,[P,F]=(0,s.useState)(!1),[N,E]=(0,s.useState)(null),{setId:O}=(0,s.useContext)(v.X),M=r(),V=a&&a>0?"edit":"new",k=M.pathname,{title:A}=(0,s.useContext)(h.f),{loggedUnity:R,user:H}=(0,s.useContext)(g.V),{startLoading:z,stopLoading:_}=(0,D.Z)(),{trigger:T,handleSubmit:q,reset:W,control:B,formState:{errors:U},register:X}=(0,u.cI)({mode:"onChange"}),G=async e=>{let o={...e,usuarioID:H.usuarioID,unidadeID:R.unidadeID};try{"new"===V?await l.h.post("cadastros/transportador/new/insertData",o).then(e=>{I?(O(I),S(e.data.value)):(M.push("".concat((0,f.g_)(k))),O(e.data.id)),m.ZP.success(f.OD.successNew)}):"edit"===V&&(await l.h.post("".concat(k,"/updateData/").concat(a),o),m.ZP.success(f.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(f.OD.errorRepeated):console.log(t)}finally{_()}},J=async()=>{try{await l.h.delete("".concat(k,"/").concat(a,"/").concat(H.usuarioID,"/").concat(R.unidadeID)),O(null),F(!1),m.ZP.success(f.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(f.OD.pendingDelete),F(!1)):console.log(e)}},L=async()=>{try{"edit"===V?await l.h.post("".concat(k,"/getData/").concat(a),{id:a}).then(e=>{E(e.data),W(e.data)}):E({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,s.useEffect)(()=>{L(),setTimeout(()=>{T()},300)},[a]),(0,t.jsxs)(t.Fragment,{children:[N&&(0,t.jsxs)("form",{onSubmit:q(G),children:[(0,t.jsx)(x.Z,{btnCancel:!0,btnNew:!S,btnSave:!0,manualUrl:w,btnClose:n,handleModalClose:Z,handleSubmit:()=>q(G),btnDelete:"edit"===V,onclickDelete:()=>setOpenDelete(!0),type:V,outsideID:I}),(0,t.jsx)(i.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(b.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:B,errors:null==U?void 0:null===(o=U.fields)||void 0===o?void 0:o.nome}),(0,t.jsx)(j.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==N?void 0:N.fields.status,typePage:V,register:X})]})})})]}),(0,t.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+A.title,openModal:P,handleClose:()=>F(!1),handleSubmit:J,btnCancel:!0,btnConfirm:!0})]})};o.Z=Z},24527:function(e,o,a){var t=a(85893),n=a(79072),r=a(49837),s=a(91359),l=a(61953),i=a(29630),d=a(21609),c=a(62097);let u=e=>{let{xs:o,md:a,icon:u,title:m,subtitle:p,action:x,handleClick:f}=e,h=(0,c.Z)();return(0,t.jsx)(n.ZP,{item:!0,xs:o,md:a,children:(0,t.jsx)(r.Z,{sx:{"&:hover":{backgroundColor:"".concat(h.palette.action.hover)}},onClick:f,className:"cursor-pointer shadow-xl transition-all",children:(0,t.jsx)(s.Z,{className:"text-center",children:(0,t.jsxs)(l.Z,{display:"flex",flexDirection:"column",alignItems:"center",sx:{gap:3,padding:6},children:[(0,t.jsx)(d.Z,{icon:u,width:38,className:"text-[#F8D552]"}),(0,t.jsx)(i.Z,{variant:"h6",className:"!font-extrabold",children:m}),(0,t.jsx)(i.Z,{variant:"subtitle2",children:p}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(d.Z,{icon:"new"==x?"icon-park-solid:add-one":"edit"==x?"grommet-icons:form-next-link":"tabler:select",width:16}),(0,t.jsx)(i.Z,{variant:"body2",color:"primary",children:"new"==x?"Criar novo":"edit"==x?"Acessar":"Selecionar"})]})]})})})})};o.Z=u},47842:function(e,o,a){var t=a(85893),n=a(70754);let r=e=>{let{show:o,title:a,customTextProps:r,...s}=e;return o&&(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center rounded-lg z-50",children:(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center gap-2 ",children:[(0,t.jsx)(n.Z,{color:"primary",...s}),(0,t.jsx)("p",{className:"opacity-80 text-sm ".concat(r),children:null!=a?a:"Carregando..."})]})})};o.Z=r},73113:function(e,o,a){a.d(o,{Z:function(){return ei}});var t=a(85893),n=a(67294),r=a(87536),s=a(56531),l=a(99734),i=a(34282),d=a(29308),c=a(23895),u=a(7071),m=a(61953),p=a(49837),x=a(91359),f=a(29630),h=a(79072),v=a(55343),g=a(11163),b=a.n(g),j=a(23197),D=a(60664),Z=a(86887),C=a(83830),y=a(40039),I=a(39976),S=a(47842),w=a(86501),P=a(66136),F=a(80377);a(70190);var N=a(50287),E=a(84220),O=a(44731);let M=e=>{var o,a,r;let{value:s}=e,{settings:l}=(0,n.useContext)(P.J6);return(0,t.jsx)(p.Z,{style:{height:"100%"},children:(0,t.jsx)(x.Z,{sx:{textAlign:"center"},children:(0,t.jsx)("div",{className:"flex flex-col items-center gap-1",children:(null==s?void 0:s.nome_)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(O.Z,{variant:"rounded",sx:{width:70,height:70},className:"p-1 ".concat("dark"===l.mode?"!bg-[#e0e0e0]":"!bg-[#f5f5f5]"),children:(0,t.jsx)("img",{src:null!==(o=null==s?void 0:s.foto)&&void 0!==o?o:"/imageDefault/factory.svg",alt:"Imagem da logo da f\xe1brica"})})}),(0,t.jsx)(f.Z,{variant:"subtitle1",sx:{fontWeight:600},children:null==s?void 0:s.nome_}),(0,t.jsx)(f.Z,{variant:"subtitle2",children:null==s?void 0:s.cnpj_}),s.email?(0,t.jsx)(f.Z,{variant:"subtitle2",children:null==s?void 0:s.email}):(0,t.jsx)(f.Z,{variant:"subtitle2",color:"error",sx:{textTransform:"italic"},children:"E-mail n\xe3o informado"}),(null==s?void 0:s.telefone)&&(0,t.jsx)(f.Z,{variant:"subtitle2",children:null!==(a=null==s?void 0:s.telefone)&&void 0!==a?a:"--"}),(null==s?void 0:s.cidade)&&(0,t.jsx)(f.Z,{variant:"subtitle2",children:null!==(r=null==s?void 0:s.cidade)&&void 0!==r?r:"--"})]}):(0,t.jsx)(f.Z,{variant:"subtitle1",children:"-- Selecione um fornecedor --"})})})})};var V=a(22841),k=a(75158),A=a(44373),R=a(3893),H=a(21609);let z=e=>{var o,a,n,r,s,l,i,c,u,m;let{value:p,index:x,apresentacoes:f,setValue:h,register:v,control:g,errors:b,disabled:j}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z,{xs:12,md:2,title:"Quantidade",name:"produtos[".concat(x,"].quantidade"),register:v,control:g,errors:null==b?void 0:null===(o=b.produtos)||void 0===o?void 0:null===(a=o[x])||void 0===a?void 0:a.quantidade,disabled:j}),(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data da fabrica\xe7\xe3o",value:p.dataFabricacao,name:"produtos[".concat(x,"].dataFabricacao"),control:g,errors:null==b?void 0:null===(n=b.produtos)||void 0===n?void 0:null===(r=n[x])||void 0===r?void 0:r.dataFabricacao,disabled:j}),(0,t.jsx)(d.Z,{xs:12,md:2,title:"N\xba Lote",name:"produtos[".concat(x,"].lote"),register:v,control:g,errors:null==b?void 0:null===(s=b.produtos)||void 0===s?void 0:null===(l=s[x])||void 0===l?void 0:l.lote,disabled:j}),(0,t.jsx)(E.Z,{xs:12,md:4,title:"Apresenta\xe7\xe3o",name:"produtos[".concat(x,"].apresentacao"),type:"string",options:null!=f?f:[],register:v,setValue:h,control:g,errors:null==b?void 0:null===(i=b.produtos)||void 0===i?void 0:null===(c=i[x])||void 0===c?void 0:c.apresentacao,disabled:j}),(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data de validade",value:p.dataValidade,name:"produtos[".concat(x,"].dataValidade"),control:g,errors:null==b?void 0:null===(u=b.produtos)||void 0===u?void 0:null===(m=u[x])||void 0===m?void 0:m.dataValidade,disabled:j})]})},_=e=>{let{produtos:o,setProdutos:a,getValues:r,setValue:s,register:l,control:i,errors:d,disabled:c}=e,[u,p]=(0,n.useState)([]),x=async()=>{try{let e=await D.h.get("/cadastros/apresentacao");p(e.data)}catch(o){console.log("\uD83D\uDE80 ~ error:",o)}},v=(e,t)=>{let{checked:n}=e.target;s("produtos[".concat(t,"].checked_"),n);let r=[...o];r[t].checked_=n,a(r)};return(0,n.useEffect)(()=>{x()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700,mb:2},children:"Produtos aprovados do fornecedor"}),o&&0==o.length&&(0,t.jsx)(f.Z,{color:"warning",variant:"subtitle1",className:"italic",children:(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(H.Z,{icon:"typcn:warning",color:"#FFC107"}),(0,t.jsx)("p",{children:"Nenhum fornecedor selecionado!"})]})}),o&&o.length>0&&o.map((e,a)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"hidden",value:e.produtoID,name:"produtos[".concat(a,"].produtoID"),...l("produtos[".concat(a,"].produtoID"))}),(0,t.jsxs)(h.ZP,{container:!0,spacing:4,sx:{pb:2},children:[(0,t.jsx)(h.ZP,{item:!0,xs:12,md:4,children:(0,t.jsx)(V.Z,{control:(0,t.jsx)(k.Z,{onClick:e=>v(e,a),defaultChecked:e.checked_,disabled:c}),label:e.nome,size:"small",sx:{marginRight:"4px","&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})}),(0,t.jsx)(h.ZP,{item:!0,xs:12,md:8,children:(0,t.jsxs)(m.Z,{display:"flex",alignItems:"center",justifyContent:"end",sx:{gap:4,mt:3},children:[(0,t.jsxs)(f.Z,{variant:"body2",children:["\xdaltima avalia\xe7\xe3o: ",e.ultimaAvaliacao]}),(0,t.jsxs)(f.Z,{variant:"body2",children:["Pr\xf3xima avalia\xe7\xe3o: ",e.proximaAvialacao," (",1==e.diasRestantes?"".concat(e.diasRestantes," dia"):"".concat(e.diasRestantes," dias"),")"]})]})}),e&&e.checked_&&(0,t.jsx)(z,{value:e,apresentacoes:u,index:a,setValue:s,register:l,control:i,errors:d,disabled:c},a)]}),a<o.length-1&&(0,t.jsx)(A.Z,{})]},a))]})},T=e=>{var o,a,r,l,i,c,u,m;let{recebimentoMpID:f,modelo:v,values:g,produtosRecebimento:Z,fields:I,disabled:S,register:w,errors:F,getValues:O,setValue:V,control:k,getAddressByCep:A,nameSelected:R,setNameSelected:H,columnSelected:z,setColumnSelected:T,openModalNew:q,setOpenModalNew:W,newChange:B,setNewChange:U}=e,{user:X,loggedUnity:G}=(0,n.useContext)(y.V),[J,L]=(0,n.useState)({}),[K,Q]=(0,n.useState)([]),[Y,$]=(0,n.useState)([]),[ee,eo]=(0,n.useState)(null),[ea,et]=(0,n.useState)([]),[en,er]=(0,n.useState)(!1),{settings:es}=(0,n.useContext)(P.J6);es.mode,b();let{setId:el}=(0,n.useContext)(C.X),ei=(e,o,a,t)=>{let n=new Date(a),r=(0,j.HD)(e,n,t);L(e=>({...e,[o]:r}))},ed=async()=>{let e=await D.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:2,modeloID:v.id});Q(e.data.preenche),eu(e.data.preenche)},ec=async()=>{let e=await D.h.post("/formularios/fornecedor/getFornecedoresAprovados",{unidadeID:G.unidadeID,recebimentoMpID:f,modelo:v});$(e.data),em(g.fornecedor,e.data,!1)},eu=e=>{let o=X.profissionalID,a=e.find(e=>e.id===o);a&&a.id>0&&V("fieldsHeader.profissional",a)},em=(e,o,a)=>{if(er(!en),!e){eo(null),et([]);return}o&&o.forEach(o=>{o.id===e.id&&(!a&&Z&&Z.length>0&&Z.map(e=>{o.produtos.forEach(o=>{o.produtoID===e.produto.id&&(o.checked_=!0)})}),a&&o.produtos.forEach(e=>{e.checked_=!1}),eo(o),et(o.produtos))})};return(0,n.useEffect)(()=>{ec(),ed()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(h.ZP,{container:!0,alignItems:"stretch",spacing:6,children:[(0,t.jsx)(h.ZP,{item:!0,xs:12,md:9,children:(0,t.jsx)(p.Z,{style:{height:"100%"},children:(0,t.jsx)(x.Z,{children:(0,t.jsxs)(h.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data da abertura",name:"fieldsHeader.abertoPor.dataInicio",type:"date",value:null==g?void 0:null===(o=g.abertoPor)||void 0===o?void 0:o.dataInicio,disabled:!0,control:k}),(0,t.jsx)(d.Z,{xs:12,md:2,title:"Hora da abertura",name:"fieldsHeader.abertoPor.horaInicio",type:"time",disabled:!0,register:w,control:k}),(0,t.jsx)(d.Z,{xs:12,md:8,title:"Profissional que abriu",name:"fieldsHeader.abertoPor.profissional.nome",value:null==g?void 0:null===(a=g.abertoPor)||void 0===a?void 0:null===(r=a.profissional)||void 0===r?void 0:r.nome,disabled:!0,register:w,control:k}),(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null!==(m=null==g?void 0:g.data)&&void 0!==m?m:new Date,disabled:S,register:w,control:k,setDateFormat:ei,typeValidation:"dataPassado",daysValidation:365,dateStatus:J,errors:null==F?void 0:null===(l=F.fieldsHeader)||void 0===l?void 0:l.data}),(0,t.jsx)(d.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",type:"time",disabled:S,register:w,control:k,errors:null==F?void 0:null===(i=F.fieldsHeader)||void 0===i?void 0:i.hora}),(0,t.jsx)(E.Z,{xs:12,md:4,title:"Profissional preenchimento",name:"fieldsHeader.profissional",type:"string",options:K,disabled:S,register:w,setValue:V,control:k,errors:null==F?void 0:null===(c=F.fieldsHeader)||void 0===c?void 0:c.profissional}),(0,t.jsx)(s.Z,{register:w,errors:F,setValue:V,control:k,fields:I,values:I,getAddressByCep:A,disabled:S,nameSelected:R,setNameSelected:H,getValues:O,columnSelected:z,setColumnSelected:T,openModalNew:q,setOpenModalNew:W,newChange:B,setNewChange:U}),(0,t.jsx)(E.Z,{xs:12,md:12,title:"Fornecedor",name:"fieldsHeader.fornecedor",type:"string",options:Y,onChange:e=>em(e,Y,!0),value:null==g?void 0:g.fornecedor,disabled:S,register:w,setValue:V,control:k,errors:null==F?void 0:null===(u=F.fieldsHeader)||void 0===u?void 0:u.fornecedor})]})})})}),(0,t.jsx)(h.ZP,{item:!0,xs:12,md:3,children:(0,t.jsx)(M,{value:ee})})]}),(0,t.jsx)(p.Z,{children:(0,t.jsx)(x.Z,{children:(0,t.jsx)(_,{produtos:ea,setProdutos:et,getValues:O,setValue:V,register:w,control:k,errors:F,disabled:S},en)})})]})},q=e=>{var o,a,r,s;let{modeloID:l,values:i,disabled:c,register:u,errors:m,setValue:f,control:v}=e,{user:g}=(0,n.useContext)(y.V),[b,Z]=(0,n.useState)({}),[C,I]=(0,n.useState)([]),S=(e,o,a,t)=>{let n=new Date(a),r=(0,j.HD)(e,n,t);Z(e=>({...e,[o]:r}))},w=async()=>{let e=await D.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:2,modeloID:l});console.log("\uD83D\uDE80 ~ response.data:",e.data),I(e.data.aprova),P(e.data.aprova)},P=e=>{let o=g.profissionalID,a=e.find(e=>e.id===o);a&&a.id>0&&f("fieldsFooter.profissional",a)};return(0,n.useEffect)(()=>{w()},[]),(0,t.jsx)(p.Z,{children:(0,t.jsx)(x.Z,{children:(0,t.jsxs)(h.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data da conclus\xe3o",name:"fieldsFooter.dataConclusao",type:"date",value:null!==(s=null==i?void 0:i.dataConclusao)&&void 0!==s?s:new Date,disabled:c,register:u,control:v,setDateFormat:S,typeValidation:"dataPassado",daysValidation:365,dateStatus:b,errors:null==m?void 0:null===(o=m.fieldsFooter)||void 0===o?void 0:o.dataConclusao}),(0,t.jsx)(d.Z,{xs:12,md:2,title:"Hora da conclus\xe3o",name:"fieldsFooter.horaConclusao",type:"time",disabled:c,register:u,control:v,errors:null==m?void 0:null===(a=m.fieldsFooter)||void 0===a?void 0:a.horaConclusao}),(0,t.jsx)(E.Z,{xs:12,md:8,title:"Profissional que aprova",name:"fieldsFooter.profissional",type:"string",options:null!=C?C:[],disabled:c,register:u,setValue:f,control:v,errors:null==m?void 0:null===(r=m.fieldsFooter)||void 0===r?void 0:r.profissional})]})})})};var W=a(41088),B=a(92629),U=a(1503),X=a(54225),G=a(62135),J=a(99384);let L=e=>{var o,a;let{index:r,value:s,info:l,papelID:i,produtos:c,handlePreenchimentoFornecedor:u,getValues:m,register:p,control:x,setValue:f,errors:v}=e;console.log("\uD83D\uDE80 ~ FieldsFabrica:",s);let{setDateFormat:g,dateStatus:b}=(0,J.Z)(),[j,D]=(0,n.useState)(null!==(o=s.tipo)&&void 0!==o?o:1),Z=e=>{console.log("\uD83D\uDE80 ~ type:",e),D(e),f("naoConformidade.itens[".concat(r,"].tipo"),e)};return(0,t.jsxs)(t.Fragment,{children:[1==i&&(0,t.jsx)(R.Z,{xs:12,md:4,onClick:u,title:"Fornecedor preenche?",name:"naoConformidade.itens[".concat(r,"].fornecedorPreenche"),value:s.fornecedorPreenche,disabled:l.concluido,register:p,helpText:"Se marcado, o fornecedor deve preencher o plano de a\xe7\xe3o com seu acesso ao sistema."}),(0,t.jsxs)(h.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(N.Z,{xs:12,md:3,title:"Data",name:"naoConformidade.itens[".concat(r,"].data"),type:"date",value:null==s?void 0:s.data,disabled:l.concluido||1!=i,register:p,control:x,setDateFormat:g,typeValidation:"dataPassado",daysValidation:999999999999,dateStatus:b,errors:null}),(0,t.jsx)(d.Z,{xs:12,md:3,title:"Hora",name:"naoConformidade.itens[".concat(r,"].hora"),disabled:l.concluido||1!=i,type:"time",register:p,control:x,errors:null}),(0,t.jsx)(E.Z,{xs:12,md:6,title:"Profissional preenchimento",name:"naoConformidade.itens[".concat(r,"].profissionalPreenchimento"),disabled:l.concluido||1!=i,type:"string",options:null!==(a=s.profissionaisOptions.preenchimento)&&void 0!==a?a:[],register:p,setValue:f,control:x,errors:null}),(0,t.jsx)(h.ZP,{item:!0,xs:12,md:3,children:(0,t.jsxs)(G.Z,{color:"primary",fullWidth:!0,className:"mt-1",disabled:l.concluido||1!=i,children:[(0,t.jsx)(X.Z,{onClick:()=>Z(1),variant:1===j?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 px-1",children:[(0,t.jsx)(H.Z,{icon:"ph:plant"}),(0,t.jsx)("p",{className:"capitalize",children:"Produto"})]})}),(0,t.jsx)(X.Z,{onClick:()=>Z(2),variant:2===j?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 py-[2px] px-1",children:[(0,t.jsx)(H.Z,{icon:"mdi:truck-fast-outline"}),(0,t.jsx)("p",{className:"capitalize",children:"Transporte"})]})})]})}),(0,t.jsx)(E.Z,{xs:12,md:9,title:"Produto",name:"naoConformidade.itens[".concat(r,"].produto"),type:"string",disabled:1!=j||l.concluido||1!=i,options:null!=c?c:[],register:p,setValue:f,control:x,errors:null}),s.dynamicFields&&s.dynamicFields.length>0&&s.dynamicFields.map((e,o)=>(0,t.jsx)(d.Z,{xs:12,md:12,multiline:!0,rows:4,title:e.nomeCampo,value:e.valor,disabled:l.concluido||1!=i,name:"naoConformidade.itens[".concat(r,"].dynamicFields[").concat(o,"].value"),required:1==e.obrigatorio,register:p,control:x},o))]})]})},K=e=>{let{index:o,value:a,info:r,papelID:s,register:l,control:i,setValue:c,errors:u}=e,{settings:m}=(0,n.useContext)(P.J6),{setDateFormat:p,dateStatus:x}=(0,J.Z)();return(0,t.jsx)(t.Fragment,{children:a&&a.fornecedorPreenche&&(0,t.jsxs)("div",{className:"".concat("dark"==m.mode?"bg-[#353D39]":"bg-[#E2EAE4]"," p-5 rounded-xl border border-[#4A8B57]"),children:[(0,t.jsx)(f.Z,{variant:"subtitle1",color:"primary",sx:{fontWeight:700,pb:5},children:"Preenchimento realizado pelo Fornecedor"}),(0,t.jsxs)(h.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(d.Z,{xs:12,md:12,multiline:!0,rows:4,title:"Observa\xe7\xf5es do Fornecedor",name:"naoConformidade.itens[".concat(o,"].obsFornecedor"),disabled:r.concluido||2!=s,control:i,errors:null}),(0,t.jsx)(N.Z,{xs:12,md:3,title:"Data",name:"naoConformidade.itens[".concat(o,"].dataFornecedor"),type:"date",value:null==a?void 0:a.dataFornecedor,register:l,disabled:r.concluido||2!=s,control:i,setDateFormat:p,typeValidation:"dataPassado",daysValidation:999999999999,dateStatus:x,errors:null}),(0,t.jsx)(d.Z,{xs:12,md:3,title:"Hora",name:"naoConformidade.itens[".concat(o,"].horaFornecedor"),disabled:r.concluido||2!=s,type:"time",register:l,control:i,errors:null}),(0,t.jsx)(E.Z,{xs:12,md:6,title:"Profissional preenchimento",name:"naoConformidade.itens[".concat(o,"].usuarioFornecedor"),disabled:r.concluido||2!=s,type:"string",options:[],register:l,setValue:c,control:i,errors:null})]})]})})};var Q=a(8519),Y=a(41470);let $=e=>{var o;let{index:a,value:n,info:r,papelID:s,register:l,control:i,setValue:c,handleChangeStatus:u,errors:m}=e,{setDateFormat:p,dateStatus:x}=(0,J.Z)(),v=[{id:1,nome:"Conforme"},{id:2,nome:"N\xe3o Conforme"}];return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(h.ZP,{container:!0,spacing:4,sx:{paddingTop:2},children:[(0,t.jsx)(d.Z,{xs:12,md:12,multiline:!0,rows:4,title:"Conclus\xe3o",name:"naoConformidade.itens[".concat(a,"].conclusao"),disabled:r.concluido||1!=s,control:i,errors:null}),(0,t.jsx)(h.ZP,{item:!0,xs:12,md:12,children:(0,t.jsx)(Y.Z,{row:!0,name:"naoConformidade.itens[".concat(a,"].status"),defaultValue:null==n?void 0:n.status,onChange:e=>u(a,e.target.value),sx:{mt:0},children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(f.Z,{variant:"subtitle2",sx:{pb:0},children:"Avalia\xe7\xe3o Final:"}),v&&v.map((e,o)=>(0,t.jsx)(V.Z,{value:e.id,label:e.nome,control:(0,t.jsx)(Q.Z,{disabled:!1,error:!1,sx:{pr:2}}),disabled:r.concluido||1!=s,fullWidth:!0,sx:{"& .MuiFormControlLabel-label":{fontSize:"0.8rem",color:"text.secondary"},"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}},o))]})})}),(0,t.jsx)(N.Z,{xs:12,md:3,title:"Data",name:"naoConformidade.itens[".concat(a,"].dataConclusao"),type:"date",value:null==n?void 0:n.dataConclusao,disabled:r.concluido||1!=s,register:l,control:i,setDateFormat:p,typeValidation:"dataPassado",daysValidation:999999999999,dateStatus:x,errors:null}),(0,t.jsx)(d.Z,{xs:12,md:3,title:"Hora",name:"naoConformidade.itens[".concat(a,"].horaConclusao"),disabled:r.concluido||1!=s,type:"time",register:l,control:i,errors:null}),(0,t.jsx)(E.Z,{xs:12,md:6,title:"Profissional preenchimento",name:"naoConformidade.itens[".concat(a,"].profissionalConclusao"),disabled:r.concluido||1!=s,type:"string",options:null!==(o=n.profissionaisOptions.conclusao)&&void 0!==o?o:[],register:l,setValue:c,control:i,errors:null})]})})};var ee=a(72819),eo=a(24527);let ea=e=>{let{recebimentoMpID:o,values:a,info:r,getValues:s,register:l,control:i,setValue:d,errors:c}=e;console.log("\uD83D\uDE80 ~ RecebimentoMpNaoConformidade => values: ",a);let{user:m,loggedUnity:v}=(0,n.useContext)(y.V),{settings:g}=(0,n.useContext)(P.J6),[b,Z]=(0,n.useState)(!1),[C,I]=(0,n.useState)([]),[S,F]=(0,n.useState)(!1);console.log("\uD83D\uDE80 ~ models:",C);let N=()=>{Z(!b)},E=()=>{if(0==C.length){w.ZP.error("N\xe3o h\xe1 nenhum modelo de n\xe3o conformidade cadastrado para esta unidade! Por favor cadastre em Configura\xe7\xf5es > Formul\xe1rios.");return}if(1==C.length){O(C[0]);return}C.length>1&&F(!0)},O=e=>{var o,a;console.log("\uD83D\uDE80 ~ model:",e);let t=s("naoConformidade.itens");t.push({parRecebimentoMpNaoConformidadeModeloID:e.parRecebimentoMpNaoConformidadeModeloID,modelo:{id:e.parRecebimentoMpNaoConformidadeModeloID,nome:e.nome},profissionalPreenchimento:null,produto:null,profissionalConclusao:null,data:new Date,hora:(0,j.Xn)(),dataFornecedor:new Date,horaFornecedor:(0,j.Xn)(),dataConclusao:new Date,horaConclusao:(0,j.Xn)(),profissionaisOptions:{preenchimento:null!==(o=e.profissionaisOptions.preenchimento)&&void 0!==o?o:[],conclusao:null!==(a=e.profissionaisOptions.conclusao)&&void 0!==a?a:[]},dynamicFields:e.dynamicFields}),d("naoConformidade.itens",t),Z(!b),w.ZP.success("N\xe3o conformidade inserida. Preencha os campos...")},M=(e,o)=>{let a=s("naoConformidade.itens");a[e].status=o,d("naoConformidade.itens",a)},V=async()=>{try{let e=await D.h.get("/formularios/recebimento-mp/getNaoConformidadeModels/".concat(v.unidadeID));I(e.data)}catch(o){console.log("\uD83D\uDE80 ~ getNcModels ~ error",o)}},k=()=>(0,t.jsx)(h.ZP,{container:!0,spacing:4,children:C&&C.length>0&&C.map((e,o)=>(0,t.jsx)(eo.Z,{xs:12,md:6,icon:"fluent:form-multiple-48-regular",title:e.nome,action:"select",subtitle:"Ciclo de ".concat(e.ciclo," dias"),handleClick(){O(e),F(!1)}},o))});return(0,n.useEffect)(()=>{V()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"".concat("dark"==g.mode?"bg-[#4B3537]":"bg-[#F8E2E2]"," p-5 rounded-xl border border-[#FF4D49] text-center"),children:(0,t.jsx)(f.Z,{color:"error",variant:"subtitle1",sx:{fontWeight:700},children:"Plano de A\xe7\xe3o"})}),(0,t.jsx)(p.Z,{children:(0,t.jsx)(x.Z,{children:(0,t.jsx)(f.Z,{variant:"subtitle1",children:"Deve ser preenchido pelos colaboradores respons\xe1veis pelas a\xe7\xf5es de monitoramento e/ou verifica\xe7\xe3o e/ou respons\xe1vel pela execu\xe7\xe3o da a\xe7\xe3o corretiva."})})}),s("naoConformidade.itens")&&s("naoConformidade.itens").map((e,o)=>(0,t.jsx)(p.Z,{children:(0,t.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",gap:"6px"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(f.Z,{variant:"subtitle1",color:"error",sx:{fontWeight:700},children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(H.Z,{icon:"typcn:warning",color:"#FF4D49"}),(0,t.jsxs)("p",{children:["N\xe3o Conformidade ",o+1]})]})}),(0,t.jsx)(u.Z,{size:"small",skin:"light",label:e.modelo.nome,color:"error",sx:{"& .MuiChip-label":{textTransform:"capitalize"}}})]}),(0,t.jsx)(L,{index:o,value:e,handlePreenchimentoFornecedor:N,getValues:s,info:r,papelID:m.papelID,produtos:a.produtos,register:l,control:i,setValue:d,errors:c},o),(0,t.jsx)(K,{index:o,value:e,info:r,papelID:m.papelID,register:l,control:i,setValue:d,errors:c},o),(0,t.jsx)($,{index:o,value:e,info:r,papelID:m.papelID,register:l,control:i,setValue:d,handleChangeStatus:M,errors:c},o)]})},o)),!r.concluido&&1==m.papelID&&(0,t.jsx)(h.ZP,{container:!0,spacing:4,children:(0,t.jsx)(h.ZP,{item:!0,xs:12,children:(0,t.jsx)(X.Z,{variant:"outlined",color:"primary",onClick:E,startIcon:(0,t.jsx)(H.Z,{icon:"material-symbols:add-circle-outline-rounded"}),sx:{mt:2},children:"Inserir nova n\xe3o conformidade"})})})]}),(0,t.jsx)(ee.Z,{title:"Modelo de N\xe3o Conformidade",description:"Selecione o modelo de n\xe3o conformidade que deseja inserir. O mesmo pode ser gerenciado em Configura\xe7\xf5es > Formul\xe1rios.",setOpenModal:F,openModal:S,children:(0,t.jsx)(k,{})})]})};var et=a(76904),en=a(1322),er=a(62094),es=a(934);let el=e=>{var o;let a;let{id:s}=e,{menu:g,user:N,loggedUnity:E}=(0,n.useContext)(y.V);console.log("\uD83D\uDE80 ~ FormRecebimentoMp ~ user",N);let[O,M]=(0,n.useState)(!1),[V,k]=(0,n.useState)(!1),[A,R]=(0,n.useState)(!1),[H,z]=(0,n.useState)(!1),[_,X]=(0,n.useState)(!1),[G,J]=(0,n.useState)(!1),[L,K]=(0,n.useState)(!1),[Q,Y]=(0,n.useState)(null),[$,ee]=(0,n.useState)(!0),[eo,el]=(0,n.useState)(null),[ei,ed]=(0,n.useState)([]),[ec,eu]=(0,n.useState)([]),[em,ep]=(0,n.useState)(null),{createNewNotification:ex}=(0,n.useContext)(I.u),[ef,eh]=(0,n.useState)(!1),[ev,eg]=(0,n.useState)([]),[eb,ej]=(0,n.useState)([]),[eD,eZ]=(0,n.useState)([]),[eC,ey]=(0,n.useState)(null),[eI,eS]=(0,n.useState)([]),[ew,eP]=(0,n.useState)(null),[eF,eN]=(0,n.useState)(""),[eE,eO]=(0,n.useState)(!1),[eM,eV]=(0,n.useState)(!1),[ek,eA]=(0,n.useState)({status:!1,errors:[]}),[eR,eH]=(0,n.useState)(null),{settings:ez}=(0,n.useContext)(P.J6),{setId:e_}=(0,n.useContext)(C.X),{startLoading:eT,stopLoading:eq}=(0,W.Z)(),[eW,eB]=(0,n.useState)(!1),{setReportParameters:eU,sendPdfToServer:eX}=(0,U.Gc)(),[eG,eJ]=(0,n.useState)(!1),[eL,eK]=(0,n.useState)(!1),[eQ,eY]=(0,n.useState)(null),[e$,e0]=(0,n.useState)(null),[e1,e2]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),e3=b(),e8=s&&s>0?"edit":"new",e9=e3.pathname,{reset:e7,register:e4,getValues:e6,setValue:e5,control:oe,watch:oo,handleSubmit:oa,clearErrors:ot,setError:on,formState:{errors:or}}=(0,r.cI)(),os=()=>{e_(eo.modelo.id),e3.push("/configuracoes/formularios/recebimento-mp/")},ol=[];1==N.papelID&&(a=!1,g.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(a=!0)})})}),a)&&ol.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:os,modal:!1,icon:"bi:gear",identification:null});let oi=async()=>{},od=()=>{eT();try{D.h.post("".concat(e9,"/getData/").concat(s),{type:e8,profissionalID:N.profissionalID,unidadeID:E.unidadeID}).then(e=>{var o,a;eg(e.data.fieldsHeader),ej(e.data.fieldsFooter),eZ(e.data.fields),ed(e.data.produtos),eS(e.data.blocos),eu(e.data.grupoAnexo),eN(e.data.info),el(e.data.unidade),ey(e.data.link),eP(e.data.ultimaMovimentacao),op(e.data.blocos),Y(e.data.naoConformidade) //! Seta não conformidades
,e7(e.data);let t=j.WR[null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(a=o.info)||void 0===a?void 0:a.status];ep(t),e2({status:1==N.papelID&&e.data.info.status<40,message:e.data.info.status>40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":e.data.info.status<40?"Formul\xe1rio aberto para preenchimento!":40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o!":null,messageType:"info"}),oi()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e)}finally{eq()}},oc=e=>{console.log("checkErrors => validateForm: ",e,or),ot();let o=!1,a=[];e&&(null==eD||eD.forEach((e,t)=>{let n=e.tabela?"fields[".concat(t,"].").concat(e.tabela):"fields[".concat(t,"].").concat(e.nomeColuna),r=e6(n);1!==e.obrigatorio||r||(on(n,{type:"manual",message:"Campo obrigat\xf3rio"}),a.push(null==e?void 0:e.nomeCampo),o=!0)}),ei&&ei.length>0&&ei.forEach((e,t)=>{e.produtoAnexosDescricao&&e.produtoAnexosDescricao.forEach((n,r)=>{1===n.obrigatorio&&0==n.anexos.length&&(on("produtos[".concat(t,"].produtoAnexosDescricao[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),a.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==n?void 0:n.nome)),o=!0)})}),eI.forEach((e,t)=>{e.itens.forEach((e,n)=>{let r=e6("blocos[".concat(t,"].itens[").concat(n,"].resposta"));(null==e?void 0:e.obrigatorio)!==1||r||(on("blocos[".concat(t,"].itens[").concat(n,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push(null==e?void 0:e.nome),o=!0),e.respostaConfig&&1==e.respostaConfig.anexo&&e.respostaConfig.anexosSolicitados.length>0&&e.respostaConfig.anexosSolicitados.forEach((r,s)=>{1==r.obrigatorio&&r.anexos&&0==r.anexos.length&&(on("blocos[".concat(t,"].itens[").concat(n,"].respostaConfig.anexosSolicitados[").concat(s,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==r?void 0:r.nome)),o=!0)})})}),ec&&ec.length>0&&ec.forEach((e,t)=>{e.itens.forEach((n,r)=>{1===n.obrigatorio&&0==n.anexos.length&&(on("grupoAnexo[".concat(t,"].itens[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),a.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==n?void 0:n.nome)),o=!0)})})),eA({status:o,errors:a})},ou=async e=>{if(9===e.length){let o=e.replace(/[^0-9]/g,"");try{let a=await D.h.get("https://viacep.com.br/ws/".concat(o,"/json/"));a.data.localidade?(eD.forEach(async(e,o)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await e5("fields[".concat(o,"].logradouro"),a.data.logradouro),await e5("fields[".concat(o,"].bairro"),a.data.bairro),await e5("fields[".concat(o,"].cidade"),a.data.localidade),await e5("fields[".concat(o,"].estado"),a.data.uf))}),w.ZP.success("Endere\xe7o encontrado!")):w.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},om=e=>{console.log("abre o modal"),eH(e),oc(!0),eO(!0)},op=e=>{let o=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(o=!1)})}),ee(o)},ox=async e=>{eX(s,eR,"recebimento-mp"),e.conclusion=!0,await oa(oh)(e)},of=(e,o,a)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(s," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:s,tipoNotificacaoID:6,usuarioGeradorID:N.usuarioID,usuarioID:0,unidadeID:E.unidadeID,papelID:1};if(n&&(ex(n),o)){let r={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(s," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:a,tipoNotificacaoID:5,usuarioGeradorID:N.usuarioID,usuarioID:0,unidadeID:E.unidadeID,papelID:1};ex(r)}},oh=async function(e){var o,a;let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===t.conclusion&&(e.concluiForm=!0,e.info.status=null!==(o=t.status)&&void 0!==o?o:eF.status,e.obsConclusao=t.obsConclusao);let n={form:e,auth:{usuarioID:N.usuarioID,profissionalID:null!==(a=N.profissionalID)&&void 0!==a?a:0,papelID:N.papelID,unidadeID:E.unidadeID}};if(eT(),!0!=s)try{"edit"==e8?(J(!0),await D.h.post("".concat(e9,"/updateData/").concat(s),n).then(o=>{w.ZP.success(j.OD.successUpdate),console.log("\uD83D\uDE80 ~ response edit email:",o),J(!1),of(e.status,e.naoConformidade,null)})):"new"==e8?await D.h.post("".concat((0,j.g_)(e9),"/insertData"),n).then(e=>{e3.push("".concat((0,j.g_)(e9))),console.log("\uD83D\uDE80 ~ response new email:",e),e_(e.data),w.ZP.success(j.OD.successNew)}):w.ZP.error(j.OD.error)}catch(r){console.log("errro da fun\xe7\xe3o update/email",r)}finally{eq()}},ov=async(e,o)=>{R(!0);let a=e.target.files;if(a&&a.length>0){var t;let n=new FormData;for(let r=0;r<a.length;r++)n.append("files[]",a[r]);n.append("usuarioID",N.usuarioID),n.append("unidadeID",E.unidadeID),n.append("grupoAnexoItemID",null!==(t=o.grupoAnexoItemID)&&void 0!==t?t:null),await D.h.post("".concat(e9,"/saveAnexo/").concat(s,"/grupo-anexo/").concat(N.usuarioID,"/").concat(eo.unidadeID),n).then(e=>{R(!1);let o=e6();oh(o)}).catch(e=>{var o,a,t;R(!1),w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},og=async(e,o)=>{X(!0);let a=e.target.files;if(a&&a.length>0){var t,n;let r=new FormData;for(let l=0;l<a.length;l++)r.append("files[]",a[l]);r.append("usuarioID",N.usuarioID),r.append("unidadeID",E.unidadeID),r.append("parRecebimentoMpModeloBlocoID",null!==(t=o.parRecebimentoMpModeloBlocoID)&&void 0!==t?t:null),r.append("itemOpcaoAnexoID",null!==(n=o.itemOpcaoAnexoID)&&void 0!==n?n:null),await D.h.post("".concat(e9,"/saveAnexo/").concat(s,"/item/").concat(N.usuarioID,"/").concat(eo.unidadeID),r).then(e=>{X(!1);let o=e6();oh(o)}).catch(e=>{var o,a,t;X(!1),w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!!!!")})}},ob=async e=>{try{var o;let a=await D.h.post("/cadastros/item/getItemConfigs",{itemID:e.itemID,alternativaItemID:null!==(o=e.alternativa.id)&&void 0!==o?o:null}),t=eI.map(o=>({...o,itens:o.itens.map(o=>o.itemID==e.itemID?{...o,respostaConfig:{...a.data}}:o)}));eS(t)}catch(n){console.log("error",n)}},oj=async e=>{e&&await D.h.delete("".concat(e9,"/deleteAnexo/").concat(s,"/").concat(e.anexoID,"/").concat(eo.unidadeID,"/").concat(N.usuarioID,"/item")).then(e=>{let o=e6();oh(o)}).catch(e=>{var o,a,t;w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},oD=e=>{let o=[...eI];o.map((o,a)=>{o.itens.map((o,t)=>{e5("blocos[".concat(a,"].itens[").concat(t,"].resposta"),o.alternativas[e])})}),eS(o=>o.map(o=>({...o,itens:o.itens.map(o=>({...o,resposta:o.alternativas[e]&&o.alternativas[e].id>0?o.alternativas[e]:null}))}))),k(!V);let a=e6();oh(a)};(0,n.useEffect)(()=>{"edit"==e8&&od()},[s,G]),(0,n.useEffect)(()=>{oc(!1)},[]);let oZ=async e=>{console.log("\uD83D\uDE80 ~ data de noivvovov:",e),eK(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z,{show:O}),(0,t.jsxs)("form",{onSubmit:oa(oh),children:[(0,t.jsx)(Z.Z,{btnCancel:!0,btnSave:!eF.concluido,btnSend:1==N.papelID&&eF.status>=30&&!eF.concluido,btnPrint:"edit"==e8,btnDelete:eF.status<40,onclickDelete:()=>eB(!0),actionsData:ol,actions:!0,handleSubmit:()=>oa(oh),handleSend:om,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir Formul\xe1rio",title:"Recebimento de MP",btnStatus:1==N.papelID&&"edit"==e8,handleBtnStatus:()=>eh(!0),type:e8,status:em}),(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[em&&(0,t.jsx)(u.Z,{size:"small",skin:"light",color:em.color,label:em.title,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}}),eo&&eo.modelo&&(0,t.jsx)(u.Z,{size:"small",HeaderFiel:!0,skin:"light",label:eo.modelo.nome,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}})]}),(0,t.jsxs)(m.Z,{display:"flex",flexDirection:"column",sx:{gap:6},children:[eF&&""!=eF.cabecalhoModelo&&(0,t.jsx)(p.Z,{children:(0,t.jsx)(x.Z,{children:(0,t.jsx)(f.Z,{variant:"subtitle1",children:eF.cabecalhoModelo})})}),eo&&(0,t.jsx)(T,{nameSelected:e$,setNameSelected:e0,columnSelected:eQ,setColumnSelected:eY,openModalNew:eL,setOpenModalNew:eK,newChange:eG,setNewChange:eJ,recebimentoMpID:s,modelo:eo.modelo,values:ev,produtosRecebimento:ei,fields:eD,getValues:e6,disabled:!e1.status,register:e4,errors:or,setValue:e5,control:oe,getAddressByCep:ou}),eI&&eI.map((e,o)=>(0,t.jsx)(l.Z,{index:o,blockKey:"parRecebimentoMpModeloBlocoID",handleFileSelect:og,setItemResposta:ob,handleRemoveAnexoItem:oj,setBlocos:eS,changeAllOptions:oD,values:e,control:oe,register:e4,setValue:e5,errors:null==or?void 0:or.blocos,disabled:!e1.status},V)),ec&&ec.map((e,o)=>(0,t.jsx)(c.Z,{values:{grupo:e,loadingFile:A,indexGrupo:o,handleFileSelect:ov,handleRemove:handleRemoveAnexoGroup,folder:"grupo-anexo",disabled:!e1.status,error:or}},o)),eF&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(p.Z,{children:(0,t.jsx)(x.Z,{children:(0,t.jsx)(h.ZP,{container:!0,spacing:4,children:(0,t.jsx)(h.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(v.Z,{fullWidth:!0,children:[(0,t.jsx)(f.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(d.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:eF.obs,disabled:!e1.status,control:oe})]})})})})})}),eo&&eb&&!eb.concluded&&(0,t.jsx)(q,{modeloID:eo.modelo.id,values:eb,register:e4,disabled:!1,errors:or,setValue:e5,control:oe}),eb&&eb.concluded&&(null===(o=eb.conclusion)||void 0===o?void 0:o.profissional)&&(0,t.jsx)(f.Z,{variant:"caption",children:"Conclu\xeddo por ".concat(eb.conclusion.profissional.nome," em ").concat(eb.conclusion.dataFim," ").concat(eb.conclusion.horaFim,".")}),eF.naoConformidade&&(0,t.jsx)(ea,{recebimentoMpID:s,values:Q,info:eF,getValues:e6,register:e4,control:oe,setValue:e5,errors:or}),(0,t.jsx)(es.Z,{id:s,parFormularioID:2}),ef&&(0,t.jsx)(i.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(s," do Recebimento de MP."),id:s,parFormularioID:2,formStatus:eF.status,hasFormPending:L,canChangeStatus:!1,openModal:ef,handleClose:()=>eh(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:!1}),(0,t.jsx)(F.Z,{openModal:eE,handleClose(){eO(!1),oc(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:eF,canChange:!L,register:e4,setValue:e5,getValues:e6,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:ox,listErrors:ek,canApprove:$,hasNaoConformidade:!0,type:"recebimentoMp",unity:eo}),(0,t.jsx)(B.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/recebimento-mp/delete/".concat(s),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eW,handleClose:()=>eB(!1)})]})]}),(0,t.jsx)(en.Z,{title:"transportadorID"==eQ?"Novo transportador":"tipoVeiculoID"==eQ?"Novo tipo de veiculo":"",size:"md",openModal:eL,setOpenModal:eK,children:"transportadorID"==eQ?(0,t.jsx)(et.Z,{btnClose:!0,handleModalClose:()=>eK(!1),setNewChange:eJ,newChange:eG,outsideID:!0,handleConfirmNew:oZ,manualUrl:"/cadastros/transportador"}):"tipoVeiculoID"==eQ?(0,t.jsx)(er.Z,{btnClose:!0,handleModalClose:()=>eK(!1),setNewChange:eJ,newChange:eG,outsideID:!0,handleConfirmNew:oZ,manualUrl:"/cadastros/tipo-veiculo"}):null})]})};var ei=el},25054:function(e,o,a){a.d(o,{w_:function(){return c}});var t=a(67294),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},r=t.createContext&&t.createContext(n),s=["attr","size","title"];function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e}).apply(this,arguments)}function i(e,o){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),a.push.apply(a,t)}return a}function d(e){for(var o=1;o<arguments.length;o++){var a=null!=arguments[o]?arguments[o]:{};o%2?i(Object(a),!0).forEach(function(o){var t,n,r;t=e,n=o,r=a[o],(n=function(e){var o=function(e,o){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var t=a.call(e,o||"default");if("object"!=typeof t)return t;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}(e,"string");return"symbol"==typeof o?o:String(o)}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))})}return e}function c(e){return o=>t.createElement(u,l({attr:d({},e.attr)},o),function e(o){return o&&o.map((o,a)=>t.createElement(o.tag,d({key:a},o.attr),e(o.child)))}(e.child))}function u(e){var o=o=>{var a,{attr:n,size:r,title:i}=e,c=function(e,o){if(null==e)return{};var a,t,n=function(e,o){if(null==e)return{};var a,t,n={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],o.indexOf(a)>=0||(n[a]=e[a]);return n}(e,o);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],!(o.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,s),u=r||o.size||"1em";return o.className&&(a=o.className),e.className&&(a=(a?a+" ":"")+e.className),t.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},o.attr,n,c,{className:a,style:d(d({color:e.color||o.color},o.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&t.createElement("title",null,i),e.children)};return void 0!==r?t.createElement(r.Consumer,null,e=>o(e)):o(n)}}}]);