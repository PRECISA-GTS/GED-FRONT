"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7397],{6624:function(e,a,t){t.d(a,{Z:function(){return E}});var r=t(85893),n=t(11163),o=t.n(n),s=t(54225),d=t(1890),i=t(77745),l=t(95398),c=t(76779),x=t(44642),u=t(40039),m=t(79072),p=t(19604),h=t(29630),j=t(67294),f=t(48432),v=t(99070),Z=t(82555),b=t(74811),g=t(55334),y=t(62813),C=t(83542);t(50287);var P=t(29308);t(84220),t(60664);var D=t(44373),N=t(21609);t(67569);var q=t(42222);let k=e=>{var a,t,n;let{data:o,form:s,setValidParams:d}=e;console.log("\uD83D\uDE80 ~ modal data:",o);let[i,l]=(0,j.useState)(null),{user:c}=(0,j.useContext)(u.V),x=()=>{if(!o)return;let e=o.sort((e,a)=>e.checked_&&!a.checked_?-1:!e.checked_&&a.checked_?1:0);l(e),e.map((e,a)=>{p(e.quantidade,e.quantidadeEntrada,a)})},p=(e,a,t)=>{if(!e||!a)return"--";let r=(0,q.JK)(e),n=(0,q.JK)(a),o=(0,q.Qp)(r-n);s.setValue("productsConclude.".concat(t,".diff"),o)};return(0,j.useEffect)(()=>{x()},[o]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(h.Z,{variant:"body1",color:"primary",sx:{fontWeight:600,mt:6},className:"flex items-center gap-1",children:[(0,r.jsx)(N.Z,{icon:"ph:plant",className:"text-primary"}),"Confer\xeancia dos produtos do Recebimento de MP"]}),i&&i.length>0&&i.map((e,o)=>{var l;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(m.ZP,{container:!0,spacing:4,sx:{mt:4},className:"items-center",children:[(0,r.jsx)(m.ZP,{item:!0,md:12,children:(0,r.jsx)(h.Z,{variant:"body2",sx:{fontWeight:600},children:"".concat(e.nome," ").concat(e.lote?" - Lote: ".concat(e.lote):" - Lote n\xe3o informado")})}),(0,r.jsxs)(m.ZP,{item:!0,md:2,children:[(0,r.jsx)("p",{className:"text-xs opacity-50",children:"Qtd. Recebimento"}),(0,r.jsx)("p",{children:e.quantidade})]}),e.checked_?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"hidden",name:"productsConclude.".concat(o,".recebimentoMpProdutoID"),value:e.recebimentoMpProdutoID,...s.register("productsConclude.".concat(o,".recebimentoMpProdutoID"))}),(0,r.jsx)("input",{type:"hidden",name:"productsConclude.".concat(o,".quantidade"),value:e.quantidade,...s.register("productsConclude.".concat(o,".quantidade"))}),(0,r.jsx)(P.Z,{md:2,title:"Qtd. Entrada",name:"productsConclude.".concat(o,".novaQuantidade"),defaultValue:e.quantidadeEntrada,helpText:"Quantidade recebida",required:!0,disabled:1!=c.papelID,form:s,mask:"fractioned3",onChange(a){(0,q.JK)(s.getValues("productsConclude[".concat(o,"].novaQuantidade")))>(0,q.JK)(e.quantidade)?d(!1):d(!0),p(e.quantidade,a,o)},errorText:(0,q.JK)(s.getValues("productsConclude[".concat(o,"].novaQuantidade")))>(0,q.JK)(e.quantidade)?"Quantidade excedida":null})]}):(0,r.jsxs)(m.ZP,{item:!0,md:2,children:[(0,r.jsx)("p",{className:"text-xs opacity-50",children:"Qtd. Entrada"}),(0,r.jsx)("p",{children:e.quantidadeEntrada})]}),(0,r.jsxs)(m.ZP,{item:!0,md:2,children:[(0,r.jsx)("p",{className:"text-xs opacity-50",children:"Diferen\xe7a"}),(0,r.jsx)("p",{children:s.watch("productsConclude.".concat(o,".diff"))})]}),(0,r.jsxs)(m.ZP,{item:!0,md:2,children:[(0,r.jsx)("p",{className:"text-xs opacity-50",children:"Data Fabrica\xe7\xe3o"}),(0,r.jsx)("p",{children:null!==(a=e.dataFabricacao)&&void 0!==a?a:"--"})]}),(0,r.jsxs)(m.ZP,{item:!0,md:2,children:[(0,r.jsx)("p",{className:"text-xs opacity-50",children:"Apresenta\xe7\xe3o"}),(0,r.jsx)("p",{children:null!==(t=null===(l=e.apresentacao)||void 0===l?void 0:l.nome)&&void 0!==t?t:"--"})]}),(0,r.jsxs)(m.ZP,{item:!0,md:2,children:[(0,r.jsx)("p",{className:"text-xs opacity-50",children:"Data Validade"}),(0,r.jsx)("p",{children:null!==(n=e.dataValidade)&&void 0!==n?n:"--"})]})]}),o<i.length-1&&(0,r.jsx)(D.Z,{sx:{pt:4}})]})})]})},F=e=>{var a,t;let{form:n,title:P,text:D,handleClose:N,openModal:q,conclusionForm:F,status:E,canChange:I,btnCancel:A,btnConfirm:Q,listErrors:V,canApprove:_,hasNaoConformidade:K,handleSend:M,type:J,unity:w,values:W,formularioID:L,modeloID:S,produtos:z,departamentos:R}=e;if(!S)return null;let[T,B]=(0,j.useState)(!0),{user:O,loggedUnity:H,hasSectorPermission:G}=(0,j.useContext)(u.V),[U,X]=(0,j.useState)({}),{data:Y}=(0,Z.O)(),$=o(),ee=$.pathname.split("/")[2],ea=()=>(0,r.jsx)(v.BB,{children:(0,r.jsx)(v.T3,{size:"A4",style:{paddingHorizontal:25},children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{data:Y}),"fornecedor"===ee&&(0,r.jsx)(g.default,{values:Y},Y),(0,r.jsx)(y.Z,{})]})})});return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(d.Z,{fullWidth:!0,maxWidth:"lg",open:q,"aria-labelledby":"form-dialog-title",disableEscapeKeyDown:!0,onClose(e,a){"backdropClick"!==a&&N()},children:[(0,r.jsx)(i.Z,{id:"form-dialog-title",children:(0,r.jsxs)(m.ZP,{container:!0,spacing:6,children:[(0,r.jsx)(m.ZP,{item:!0,xs:12,md:6,children:P}),1===O.papelID&&(0,r.jsx)(m.ZP,{item:!0,xs:12,md:6,sx:{textAlign:"right"},children:(0,r.jsx)(C.Z,{data:null!=R?R:[]})})]})}),(0,r.jsx)(l.Z,{children:(0,r.jsxs)(x.Z,{sx:{mb:3},children:[!G(null!==(a=null==W?void 0:W.departamentos)&&void 0!==a?a:[])&&(0,r.jsx)(p.Z,{severity:"warning",sx:{mb:4},children:(0,r.jsx)(h.Z,{variant:"body2",children:"Seu departamento n\xe3o est\xe1 habilitado para concluir este formul\xe1rio!"})}),E<=40&&(0,r.jsxs)(r.Fragment,{children:[V&&V.status&&(0,r.jsxs)(p.Z,{variant:"outlined",severity:"error",sx:{mt:2},children:["Por favor, verifique os campos abaixo:",(0,r.jsx)(h.Z,{variant:"subtitle1",color:"error",sx:{mt:2},children:V.errors.map((e,a)=>(0,r.jsxs)(h.Z,{variant:"body2",color:"error",children:["- ",e]},a))})]}),V&&2==O.papelID&&!V.status&&(0,r.jsx)(p.Z,{severity:"info",sx:{mt:2},children:2==w.quemPreenche&&"fornecedor"==J?"Ap\xf3s concluir o formul\xe1rio, o mesmo ser\xe1 enviado para an\xe1lise e conclus\xe3o da empresa ".concat(null==w?void 0:w.nomeFantasia,"!"):"Ap\xf3s concluir o formul\xe1rio, o mesmo n\xe3o poder\xe1 mais ser alterado!"}),!_&&(0,r.jsx)(p.Z,{severity:"error",sx:{mt:2},children:"Este formul\xe1rio n\xe3o pode ser aprovado pois possui resposta que gera n\xe3o conformidade"}),1==O.papelID&&(0,r.jsx)(m.ZP,{container:!0,spacing:4,sx:{mt:4},children:(0,r.jsx)(m.ZP,{item:!0,xs:12,children:(0,r.jsx)(f.Z,{title:1==O.papelID?"Avalia\xe7\xe3o final da n\xe3o conformidade:":"Observa\xe7\xe3o",name:"status",value:U,form:n,setResult:X,papelID:O.papelID,hasNaoConformidade:K,options:[{value:80,color:"success",label:"Aceite",disabled:!_},{value:90,color:"error",label:"N\xe3o Aceite"}]})})}),"recebimentoMpNaoConformidade"==J&&(0,r.jsx)(k,{data:z,form:n,setValidParams:B})]}),E>=40&&(0,r.jsx)(h.Z,{variant:"body1",sx:{mt:2},children:"Concluir n\xe3o conformidades do formul\xe1rio? Ap\xf3s concluir, o mesmo n\xe3o poder\xe1 mais ser alterado!"})]})}),(0,r.jsx)(c.Z,{className:"dialog-actions-dense",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 p-2",children:[A&&(0,r.jsx)(s.Z,{variant:"outlined",color:"primary",onClick:N,children:"Fechar"}),Q&&I&&(0,r.jsx)(v.z6,{document:(0,r.jsx)(ea,{}),children(e){let{blob:a,url:n,loading:o,error:d}=e;return(0,r.jsx)(s.Z,{variant:"contained",disabled:!T||!G(null!==(t=null==W?void 0:W.departamentos)&&void 0!==t?t:[])||E<40&&(V&&V.status||1==O.papelID&&!U.status),color:"primary",onClick(){F(U,a)},children:"Concluir"})}})]})})]})})};var E=F},87617:function(e,a,t){var r=t(85893),n=t(22841),o=t(8519);let s=e=>{let{value:a,label:t,disabled:s=!1,errors:d=!1}=e;return(0,r.jsx)(n.Z,{value:a,control:(0,r.jsx)(o.Z,{disabled:s,error:!!d}),label:t,fullWidth:!0,sx:{"& .MuiFormControlLabel-label":{color:"text.secondary"},"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})};a.Z=s}}]);