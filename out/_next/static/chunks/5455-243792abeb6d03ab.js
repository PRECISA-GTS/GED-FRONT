"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5455],{65455:function(e,o,l){l.d(o,{Z:function(){return E}});var n=l(85893),i=l(67294),t=l(87536),a=l(49837),s=l(91359),r=l(79072),d=l(85214),c=l(29630),m=l(61953),u=l(54225),x=l(83830),v=l(11163),p=l.n(v),h=l(60664),j=l(86887),b=l(40039),Z=l(86501),g=l(46749),f=l(47842),C=l(21609),k=l(84220),I=l(29308),S=l(67569),D=l(3893),P=l(17575),w=l(80562),y=l(88475),N=l(1948),q=l(1322);let M=e=>{var o;let{blocks:l,errors:i,control:t,register:d,getValues:x,removeItem:v,addItem:p,removeBlock:h,setValue:j,watch:b,allOptions:Z,openModalConfirmScore:g,setOpenModalConfirmScore:f,itemScore:D,setItemScore:q,createNew:M,viewItem:O}=e;return(0,n.jsx)(n.Fragment,{children:x("blocks")&&l&&x("blocks").map((e,Z)=>{var A,B,E,F,z,V,T,W,R;return(0,n.jsx)(a.Z,{md:12,sx:{mt:4},children:(0,n.jsxs)(s.Z,{children:[(0,n.jsxs)(r.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(I.Z,{className:"order-1",xs:10,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(Z,"].dados.ordem"),value:e.dados.ordem,required:!0,control:t,errors:null==i?void 0:null===(A=i.blocks)||void 0===A?void 0:null===(B=A[Z])||void 0===B?void 0:null===(E=B.dados)||void 0===E?void 0:E.ordem}),(0,n.jsx)(I.Z,{className:"order-3 md:order-2",xs:10,md:9,title:"Nome do Bloco",name:"blocks.[".concat(Z,"].dados.nome"),value:e.dados.nome,required:!0,control:t,errors:null==i?void 0:null===(F=i.blocks)||void 0===F?void 0:null===(z=F[Z])||void 0===z?void 0:null===(V=z.dados)||void 0===V?void 0:V.nome}),(0,n.jsx)(S.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"blocks.[".concat(Z,"].dados.status"),value:null===(T=l[Z])||void 0===T?void 0:null===(W=T.dados)||void 0===W?void 0:W.status,register:d}),(0,n.jsx)(S.Z,{className:"order-4 ",xs:2,md:1,title:"Observa\xe7\xe3o",name:"blocks.[".concat(Z,"].dados.obs"),value:null===(R=l[Z])||void 0===R?void 0:R.dados.obs,register:d})]}),(0,n.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600,mt:4},children:"Itens"}),e.itens&&e.itens.map((e,a)=>{var s,u,p,h,g,f,D,N,q,A,B,E,F,z,V,T,W,R,_,U;return(0,n.jsxs)(r.ZP,{id:"item-".concat(Z,"-").concat(a),container:!0,spacing:2,sx:{my:1},children:[(0,n.jsx)(I.Z,{xs:12,md:1,title:"Sequ\xeancia",name:"blocks.[".concat(Z,"].itens.[").concat(a,"].ordem"),value:e.ordem,required:!0,control:t,errors:null==i?void 0:null===(s=i.blocks)||void 0===s?void 0:null===(u=s[Z])||void 0===u?void 0:null===(p=u.itens)||void 0===p?void 0:null===(h=p[a])||void 0===h?void 0:h.ordem}),(0,n.jsx)(k.Z,{xs:12,md:7,createNew:()=>M(Z,a),title:(null===(f=null===(g=l[Z])||void 0===g?void 0:g.itens[a])||void 0===f?void 0:f.itemID)?"Item [".concat(null===(N=null===(D=l[Z])||void 0===D?void 0:D.itens[a])||void 0===N?void 0:N.itemID,"]"):"Item",name:"blocks.[".concat(Z,"].itens.[").concat(a,"].item"),value:null!==(o=null===(A=null===(q=l[Z])||void 0===q?void 0:q.itens[a])||void 0===A?void 0:A.item)&&void 0!==o?o:null,required:!0,disabled:1==e.hasPending,options:null===(B=l[Z])||void 0===B?void 0:null===(E=B.optionsBlock)||void 0===E?void 0:E.itens,register:d,setValue:j,control:t,errors:null==i?void 0:null===(F=i.blocks)||void 0===F?void 0:null===(z=F[Z])||void 0===z?void 0:null===(V=z.itens)||void 0===V?void 0:null===(T=V[a])||void 0===T?void 0:T.item}),(0,n.jsx)(r.ZP,{item:!0,xs:12,md:1,children:(0,n.jsxs)(m.Z,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[0==a&&(0,n.jsx)(c.Z,{variant:"caption",children:"Detalhes"}),(0,n.jsx)(P.Z,{title:b("blocks.[".concat(Z,"].itens.[").concat(a,"].item"))?"Ver mais detalhes do item selecionado":"Selecione o item",children:(0,n.jsx)(w.Z,{color:"primary",size:"small",onClick(){b("blocks.[".concat(Z,"].itens.[").concat(a,"].item"))&&O(x("blocks.[".concat(Z,"].itens.[").concat(a,"].item")))},sx:{opacity:b("blocks.[".concat(Z,"].itens.[").concat(a,"].item"))?1:.5,disabled:!b("blocks.[".concat(Z,"].itens.[").concat(a,"].item"))},children:(0,n.jsx)(C.Z,{icon:"octicon:info-16",width:"18"})})})]})}),(0,n.jsx)(S.Z,{xs:2,md:1,title:"Ativo",index:a,name:"blocks.[".concat(Z,"].itens.[").concat(a,"].status"),value:null===(R=null===(W=l[Z])||void 0===W?void 0:W.itens[a])||void 0===R?void 0:R.status,register:d}),(0,n.jsx)(S.Z,{xs:2,md:1,title:"Obrigat\xf3rio",index:a,name:"blocks.[".concat(Z,"].itens.[").concat(a,"].obrigatorio"),value:null===(U=null===(_=l[Z])||void 0===_?void 0:_.itens[a])||void 0===U?void 0:U.obrigatorio,register:d}),(0,n.jsx)(y.Z,{xs:2,md:1,title:0==a?"Remover":"",index:Z,removeItem:()=>v(e,Z,a),item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio"})]},a)}),g&&D&&(0,n.jsx)(N.Z,{openModal:g,setOpenModalConfirmScore:f,itemScore:D,setItemScore:q}),(0,n.jsx)(r.ZP,{container:!0,spacing:4,sx:{mt:4},children:(0,n.jsxs)(r.ZP,{item:!0,xs:12,md:12,children:[(0,n.jsx)(u.Z,{variant:"outlined",color:"primary",startIcon:(0,n.jsx)(C.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){p(Z)},children:"Inserir Item"}),(0,n.jsx)(u.Z,{variant:"outlined",color:"error",startIcon:(0,n.jsx)(C.Z,{icon:"tabler:trash-filled"}),onClick(){h(e,Z)},sx:{ml:2},children:"Remover Bloco"})]})})]})},Z)})})};var O=l(82350);l(53934);var A=l(92629);let B=e=>{var o,l,v,P;let{id:w}=e;console.log("\uD83D\uDE80 ~ id:",w);let{setId:y}=(0,i.useContext)(x.X),{loggedUnity:N,user:B}=(0,i.useContext)(b.V),[E,F]=(0,i.useState)(),[z,V]=(0,i.useState)(),[T,W]=(0,i.useState)(null),[R,_]=(0,i.useState)(null),[U,H]=(0,i.useState)(),[L,X]=(0,i.useState)(),[G,J]=(0,i.useState)(!1),[K,Q]=(0,i.useState)(),[Y,$]=(0,i.useState)(!1),[ee,eo]=(0,i.useState)([]),[el,en]=(0,i.useState)([]),[ei,et]=(0,i.useState)(!1),[ea,es]=(0,i.useState)(!1),[er,ed]=(0,i.useState)(!1),[ec,em]=(0,i.useState)(null),[eu,ex]=(0,i.useState)(!1),[ev,ep]=(0,i.useState)(null),[eh,ej]=(0,i.useState)(null),[eb,eZ]=(0,i.useState)(!1),eg=(e,o)=>{es(!0),ep(e),ej(o)},ef=e=>{e&&e.id>0&&(em(e.id),ed(!0))},eC=e=>{es(!1),eS("blocks.[".concat(ev,"].itens.[").concat(eh,"].item"),e)},ek=p(),eI=w&&w>0?"edit":"new";ek.pathname;let{setValue:eS,register:eD,handleSubmit:eP,reset:ew,getValues:ey,control:eN,watch:eq,formState:{errors:eM}}=(0,t.cI)(),eO=async e=>{var o,l,n;let i={id:null!=w?w:null,unidadeID:N.unidadeID,usuarioID:B.usuarioID,model:e.model,header:null!==(o=e.header)&&void 0!==o?o:null,blocks:null!==(l=e.blocks)&&void 0!==l?l:[],arrRemovedBlocks:null!=el?el:[],arrRemovedItems:null!=ee?ee:[],orientacoes:null!==(n=e.orientations)&&void 0!==n?n:null};console.log("\uD83D\uDE80 ~ onSubmit: ",i),V(null);try{"new"===eI?await h.h.put("/configuracoes/formularios/recebimento-mp/insertData",i).then(e=>{Z.ZP.success(g.OD.successUpdate),ek.push("/configuracoes/formularios/recebimento-mp/"),setTimeout(()=>{y(e.data.id)},1e3)}):await h.h.put("/configuracoes/formularios/recebimento-mp/updateData",i).then(e=>{Z.ZP.success(g.OD.successUpdate),$(!Y),ea&&setOutsideLink(!0)})}catch(t){console.log(t)}},eA=(e,o,l,n)=>{let i=n.itens;i=i.filter(o=>{let l=e.itens.some(e=>e.item&&o.id===e.item.id);return!l});let t=[...l];t[o].optionsBlock.itens=i,H(t)},eB=e=>{var o;let l=[...U];l[e].itens.push({ordem:(null===(o=l[e].itens)||void 0===o?void 0:o.length)+1,obs:1,status:1,obrigatorio:1}),H(l),eS("blocks.[".concat(e,"].itens.[").concat(l[e].itens.length-1,"].new"),!0),eA(l[e],e,U,T)},eE=(e,o,l)=>{if(1===U[o].itens.length){Z.ZP.error("Voc\xea deve ter ao menos um item!");return}let n=[...ee];n.push(e),eo(n);let i=[...ey("blocks")];i[o].itens.splice(l,1),eS("blocks",i),H(i),eA(U[o],o,U,T),et(!ei)};console.log("allOptions:",T);let eF=(e,o)=>{let l=!0;if(e&&e.itens.map(e=>{1==e.hasPending&&(l=!1)}),!l){Z.ZP.error("Este bloco n\xe3o pode ser removido pois possui itens respondidos em um formul\xe1rio");return}let n=[...el];n.push(e.dados.parRecebimentoMpModeloBlocoID),en(n);let i=[...U];i.splice(o,1),H(i),eS("blocks",i),Z.ZP.success("Bloco pr\xe9-removido. Salve para concluir!")},ez=()=>{let e=[...ey("blocks")];e.push({dados:{ordem:e.length+1,nome:"",status:1},categorias:[],atividades:[],optionsBlock:{itens:[...T.itens]},itens:[{parFormularioID:2,new:!0,ordem:"1",nome:"",status:1,item:null}]}),eS("blocks",e),H(e)},eV=async e=>{let o=await h.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:2,modeloID:w}),l={...e};l.profissionaisPreenchem=o.data.preenche,l.profissionaisAprovam=o.data.aprova,ew({...ey(),model:l})},eT=()=>{console.log("buscar dados no backend....");try{"new"===eI?F({nome:"",ciclo:"",cabecalho:"",status:1}):h.h.post("/configuracoes/formularios/recebimento-mp/getData/".concat(w),{unidadeID:N.unidadeID}).then(e=>{var o,l;console.log("\uD83D\uDE80 ~ getData: ",e.data),F(e.data.model),V(e.data.header),H(e.data.blocks),W({itens:null===(o=e.data.options)||void 0===o?void 0:o.itens}),_(null===(l=e.data.options)||void 0===l?void 0:l.profissionais),X(e.data.orientations),ew(e.data),eV(e.data.model),setTimeout(()=>{e.data.blocks&&e.data.blocks.map((o,l)=>{eA(o,l,e.data.blocks,e.data.options)})},3e3)})}catch(e){console.log(e)}};(0,i.useEffect)(()=>{eT()},[w,Y]);let eW=async e=>{ex(!0),eT(),es(!1)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{show:!E}),(0,n.jsxs)("form",{onSubmit:eP(eO),children:[(0,n.jsx)(j.Z,{partialRoute:!0,btnCancel:!0,btnSave:!0,handleSubmit:()=>eP(eO),type:eI,btnDelete:!0,onclickDelete:()=>eZ(!0)}),(0,n.jsx)(A.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"/configuracoes/formularios/recebimento-mp/delete/".concat(w),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eb,handleClose:()=>eZ(!1)}),E&&(0,n.jsx)(a.Z,{children:(0,n.jsx)(s.Z,{children:(0,n.jsxs)(r.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(I.Z,{className:"order-1",xs:12,md:8,title:"Modelo",name:"model.nome",value:E.nome,required:!0,control:eN,errors:null==eM?void 0:null===(o=eM.model)||void 0===o?void 0:o.nome}),(0,n.jsx)(I.Z,{className:"order-1",xs:12,md:3,type:"number",title:"Ciclo (dias)",name:"model.ciclo",value:E.ciclo,required:!0,control:eN,helpText:"Ciclo de vencimento deste formul\xe1rio.",errors:null==eM?void 0:null===(l=eM.model)||void 0===l?void 0:l.ciclo}),(0,n.jsx)(S.Z,{className:"order-2 md:order-3",xs:2,md:1,title:"Ativo",name:"model.status",value:E.status,register:eD}),(0,n.jsx)(I.Z,{xs:12,md:12,className:"order-4",title:"Cabe\xe7alho",name:"model.cabecalho",required:!1,value:E.cabecalho,multiline:!0,rows:4,control:eN,helpText:"Texto que ser\xe1 exibido no cabe\xe7alho do formul\xe1rio. Adicione aqui instru\xe7\xf5es e orienta\xe7\xf5es para auxiliar o preenchimento do formul\xe1rio."}),R&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.Z,{xs:12,md:6,className:"order-5",multiple:!0,title:"Profissionais que preenchem",name:"model.profissionaisPreenchem",options:null!=R?R:[],value:null!==(v=null==E?void 0:E.profissionaisPreenchem)&&void 0!==v?v:[],register:eD,setValue:eS,control:eN}),(0,n.jsx)(k.Z,{xs:12,md:6,className:"order-5",multiple:!0,title:"Profissionais que aprovam",name:"model.profissionaisAprovam",options:null!=R?R:[],value:null!==(P=null==E?void 0:E.profissionaisAprovam)&&void 0!==P?P:[],register:eD,setValue:eS,control:eN})]})]})})}),z&&(0,n.jsx)(a.Z,{sx:{mt:4},children:(0,n.jsx)(s.Z,{children:(0,n.jsx)(d.Z,{component:"nav","aria-label":"main mailbox",children:(0,n.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(r.ZP,{item:!0,md:6,children:(0,n.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Nome do Campo"})}),(0,n.jsx)(r.ZP,{item:!0,md:2,children:(0,n.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Mostra"})}),(0,n.jsx)(r.ZP,{item:!0,md:2,children:(0,n.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Obrigat\xf3rio"})}),(0,n.jsx)(r.ZP,{item:!0,md:2,children:(0,n.jsx)(c.Z,{variant:"subtitle1",sx:{fontWeight:600},children:"Ordem"})}),ey("header").map((e,o)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.ZP,{item:!0,md:6,children:(0,n.jsx)(m.Z,{display:"flex",alignItems:"center",sx:{gap:2},children:(0,n.jsx)("p",{children:e.nomeCampo})})}),(0,n.jsx)(D.Z,{xs:"12",md:"2",title:"",name:"header.[".concat(o,"].mostra"),value:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"nome"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||"responsavel"==e.nomeColuna||e.mostra,register:eD,helpText:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"nome"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||"responsavel"==e.nomeColuna?"Campo obrigat\xf3rio":null}),(0,n.jsx)(D.Z,{xs:"12",md:"2",title:"",name:"header.[".concat(o,"].obrigatorio"),value:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"nome"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||"responsavel"==e.nomeColuna||e.obrigatorio,register:eD,helpText:"cnpj"==e.nomeColuna||"razaoSocial"==e.nomeColuna||"nome"==e.nomeColuna||"dataAvaliacao"==e.nomeColuna||"responsavel"==e.nomeColuna?"Campo obrigat\xf3rio":null}),(0,n.jsx)(I.Z,{xs:"12",md:"2",title:"",name:"header.[".concat(o,"].ordem"),value:e.ordem,register:eD,control:eN,type:"number"})]}))]})})})}),!U&&(0,n.jsx)(f.Z,{}),U&&(0,n.jsx)(M,{blocks:U,errors:eM,control:eN,register:eD,watch:eq,removeItem:eE,addItem:eB,getValues:ey,removeBlock:eF,setValue:eS,allOptions:T,openModalConfirmScore:G,setOpenModalConfirmScore:J,itemScore:K,setItemScore:!0,createNew:eg,viewItem:ef},ei),"edit"===eI&&E&&(0,n.jsx)(r.ZP,{item:!0,xs:12,md:12,sx:{mt:4},children:(0,n.jsx)(u.Z,{variant:"outlined",color:"primary",startIcon:(0,n.jsx)(C.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ez()},children:"Inserir Bloco"})}),L&&(0,n.jsx)(a.Z,{md:12,sx:{mt:4},children:(0,n.jsx)(s.Z,{children:(0,n.jsx)(r.ZP,{container:!0,spacing:4,children:(0,n.jsx)(I.Z,{xs:12,md:12,title:"Orienta\xe7\xf5es",name:"orientations.obs",required:!1,value:null==L?void 0:L.obs,multiline:!0,rows:4,control:eN})})})})]}),(0,n.jsx)(q.Z,{title:"Novo item",size:"md",openModal:ea,setOpenModal:es,handleSave:eW,children:(0,n.jsx)(O.Z,{btnClose:!0,handleModalClose:()=>es(!1),setNewChange:ex,newChange:eu,outsideID:w,handleConfirmNew:eC,manualUrl:"/cadastros/item"})}),(0,n.jsx)(q.Z,{title:"Detalhes do Item",size:"md",openModal:er,setOpenModal:ed,children:(0,n.jsx)(O.Z,{id:ec,btnClose:!0,handleModalClose:()=>ed(!1)})})]})};var E=B},1948:function(e,o,l){var n=l(85893),i=l(54225),t=l(1890),a=l(77745),s=l(95398),r=l(76779),d=l(44642),c=l(60664),m=l(61953),u=l(22416),x=l(22841),v=l(16056),p=l(79072),h=l(55343),j=l(67836),b=l(87536),Z=l(86501);let g=e=>{let{openModal:o,setOpenModalConfirmScore:l,itemScore:g,setItemScore:f}=e,C=()=>{l(!1)},{handleSubmit:k,register:I}=(0,b.cI)({}),S=e=>{let o={alternativaID:null==g?void 0:g.alternativaID,pontuacao:(null==e?void 0:e.pontuacao)?1:0,parFornecedorBlocoItemID:null==g?void 0:g.parFornecedorBlocoItemID,alternatives:null==g?void 0:g.alternatives.map((o,l)=>({alternativaItemID:null==o?void 0:o.alternativaItemID,score:e[null==o?void 0:o.nome]}))};c.h.post("/formularios/fornecedor/saveItemScore",{data:o}).then(e=>{l(!1),Z.Am.success("Pontua\xe7\xe3o salva com sucesso!")})};return(0,n.jsx)(n.Fragment,{children:(null==g?void 0:g.alternatives)&&(0,n.jsx)(t.Z,{open:o,onClose:C,"aria-labelledby":"form-dialog-title",children:(0,n.jsxs)("form",{onSubmit:k(S),children:[(0,n.jsx)(a.Z,{id:"form-dialog-title",children:"Pontua\xe7\xe3o das respostas"}),(0,n.jsxs)(s.Z,{children:[(0,n.jsx)(d.Z,{sx:{mb:3},children:"Defina a pontua\xe7\xe3o para cada alternativa"}),(0,n.jsx)(m.Z,{sx:{mb:4},children:(0,n.jsx)(u.Z,{row:!0,children:(0,n.jsx)(x.Z,{label:"Habilitar pontua\xe7\xe3o",control:(0,n.jsx)(v.Z,{name:"pontuacao",...I("pontuacao"),checked:(null==g?void 0:g.pontuacao)==1,onChange(e){f({...g,pontuacao:e.target.checked?1:0})}})})})}),g&&(null==g?void 0:g.alternatives.map((e,o)=>(0,n.jsx)(p.ZP,{md:12,sx:{mb:4},children:(0,n.jsx)("grid",{item:!0,md:12,children:(0,n.jsx)(h.Z,{fullWidth:!0,children:(0,n.jsx)(j.Z,{disabled:1!=g.pontuacao,id:"outlined-basic",label:null==e?void 0:e.nome,...I("".concat(null==e?void 0:e.nome)),name:"".concat(null==e?void 0:e.nome),defaultValue:null==e?void 0:e.score,variant:"outlined",size:"small",type:"number",title:0!=g.pontuacao||"Habilite a pontua\xe7\xe3o para preencher"})})})},o)))]}),(0,n.jsxs)(r.Z,{className:"dialog-actions-dense",children:[(0,n.jsx)(i.Z,{variant:"outlined",color:"primary",onClick:C,children:"Cancelar"}),(0,n.jsx)(i.Z,{variant:"contained",color:"primary",onClick:k(S),children:"Confirmar"})]})]})})})};o.Z=g},1322:function(e,o,l){var n=l(85893),i=l(95398),t=l(44642),a=l(1890),s=l(77745);l(67294);let r=e=>{let{title:o,description:l,setOpenModal:r,openModal:d,children:c,size:m}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(a.Z,{open:d,onClose:()=>r(!1),fullWidth:!!m,maxWidth:m||null,children:[(0,n.jsx)(s.Z,{id:"form-dialog-title",children:o}),(0,n.jsx)(i.Z,{children:(0,n.jsx)(t.Z,{children:c})})]})})};o.Z=r}}]);