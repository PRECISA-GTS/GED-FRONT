"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4247],{80587:function(e,o,a){a(85893),a(21609),a(10179),a(42107),a(88475),a(73731),a(53934)},23895:function(e,o,a){a.d(o,{Z:function(){return A}});var t=a(85893),s=a(67294),n=a(66136),i=a(79072),l=a(17575),r=a(80562),d=a(21609),c=a(10179),u=a(42107),x=a(73731),m=a(53934);let p=e=>{var o;let{key:a,item:s,handleFileClick:n,indexGrupo:p,indexItem:h,selectedItem:v,handleFileSelect:j,handleRemove:f,loadingFile:g,folder:Z,error:b,disabled:D,modeTheme:y,inputRef:A}=e;return console.log("\uD83D\uDE80 ~ AnexoGrid item:",s),(0,t.jsx)(i.ZP,{item:!0,xs:12,md:3,children:(0,t.jsxs)("div",{className:"".concat((null==b?void 0:b[a])?"border border-red-500":"dark"===y?"bg-[#202023]":"bg-[#F6F6F8]"," rounded-lg flex flex-col relative z-10"),children:[(0,t.jsx)("div",{className:"flex items-center justify-center p-2 mt-1 ",children:(0,t.jsx)("p",{className:"font-medium text-sm ",children:s.nome})}),(0,t.jsx)("div",{className:"flex justify-center items-center cursor-pointer p-1 h-[100px] w-full ",disabled:D,onClick(){s.anexo&&s.anexo.path&&s.anexo.exist?window.open(s.anexo.path,"_blank"):D||n(s)},children:(0,t.jsxs)("div",{className:"flex p-1 justify-center items-center gap-2 rounded-lg w-full h-full m-3 border-2 border-dashed hover:border-[#4A8B57] transition-colors ".concat("dark"===y?" border-[#27272a]":"rgba(76, 78, 100, 0.12)"),children:[v&&v.grupoAnexoItemID==s.grupoAnexoItemID&&(0,t.jsx)(x.Z,{show:g,title:"Enviando anexo..."}),(0,t.jsx)("div",{className:"flex items-center gap-3",children:s.anexo&&s.anexo.exist?(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,t.jsx)(u.Z,{data:s.anexo}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)("p",{className:"text-sm opacity-80",children:[s.anexo.nome,(0,t.jsx)("span",{className:"text-xs opacity-50 ml-1",children:"(".concat((s.anexo.size/1024/1024).toFixed(2),"MB)")})]}),s.descricao&&(0,t.jsx)(m.Z,{text:s.descricao})]}),(0,t.jsx)("p",{className:"text-xs opacity-50",children:new Date(s.anexo.time).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})}):(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,t.jsx)(c.Z,{className:"w-8 h-8 ".concat(s.anexo&&s.anexo.exist?"fill-[#666CFF]":"fill-current")}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("h6",{className:"text-sm font-normal opacity-80",children:"Adicione um arquivo"}),s.descricao&&(0,t.jsx)(m.Z,{text:s.descricao})]})]})})]})}),(0,t.jsx)("div",{className:"flex items-center justify-between gap-1 p-2 py-3 pl-4",children:(0,t.jsx)(l.Z,{title:1==s.hasPending?"Este item n\xe3o pode mais ser removido pois j\xe1 foi respondido em um formul\xe1rio":"Remover este item",children:(0,t.jsx)(r.Z,{color:"error",onClick:()=>f(s),disabled:!(null===(o=s.anexo)||void 0===o?void 0:o.exist)||D,children:(0,t.jsx)(d.Z,{icon:"tabler:trash-filled"})})})}),(0,t.jsx)("input",{type:"file",ref:A,style:{display:"none"},onChange:e=>j(e,v,Z)})]})})};a(80587);var h=a(92945),v=a(49837),j=a(91359),f=a(29630),g=a(85390),Z=a(87054),b=function(e){return(0,t.jsx)("svg",{fill:"currentColor",viewBox:"0 0 16 16",height:"1em",width:"1em",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 01.5-.5h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5zm0-4a.5.5 0 01.5-.5h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5zm0-4a.5.5 0 01.5-.5h10a.5.5 0 010 1H3a.5.5 0 01-.5-.5z"})})},D=function(e){return(0,t.jsx)("svg",{fill:"currentColor",viewBox:"0 0 16 16",height:"1em",width:"1em",...e,children:(0,t.jsx)("path",{d:"M1 2.5A1.5 1.5 0 012.5 1h3A1.5 1.5 0 017 2.5v3A1.5 1.5 0 015.5 7h-3A1.5 1.5 0 011 5.5v-3zM2.5 2a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3zm6.5.5A1.5 1.5 0 0110.5 1h3A1.5 1.5 0 0115 2.5v3A1.5 1.5 0 0113.5 7h-3A1.5 1.5 0 019 5.5v-3zm1.5-.5a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3zM1 10.5A1.5 1.5 0 012.5 9h3A1.5 1.5 0 017 10.5v3A1.5 1.5 0 015.5 15h-3A1.5 1.5 0 011 13.5v-3zm1.5-.5a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3zm6.5.5A1.5 1.5 0 0110.5 9h3a1.5 1.5 0 011.5 1.5v3a1.5 1.5 0 01-1.5 1.5h-3A1.5 1.5 0 019 13.5v-3zm1.5-.5a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5h-3z"})})};let y=e=>{let{values:o}=e,[a,l]=(0,s.useState)(null);console.log("\uD83D\uDE80 ~ selectedItem:",a);let{settings:r}=(0,s.useContext)(n.J6),d=r.mode,c=(0,s.useRef)(null),u=e=>{c.current.click(),l(e)};(0,s.useEffect)(()=>{c.current.value=""},[o.handleFileSelect]);let[x,m]=(0,s.useState)("list"),y=(e,o)=>{m(o)};return(0,t.jsx)(v.Z,{sx:{mt:4},children:(0,t.jsxs)(j.Z,{children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsxs)(f.Z,{variant:"subtitle1",sx:{fontWeight:600},children:[o.grupo.nome,(0,t.jsx)(f.Z,{variant:"body2",sx:{mb:2},children:o.grupo.descricao})]}),(0,t.jsx)("div",{children:(0,t.jsxs)(g.Z,{exclusive:!0,color:"primary",value:x,onChange:y,children:[(0,t.jsx)(Z.Z,{value:"list",children:(0,t.jsx)(b,{})}),(0,t.jsx)(Z.Z,{value:"grid",children:(0,t.jsx)(D,{})})]})})]}),(0,t.jsx)(i.ZP,{container:!0,spacing:4,children:o.grupo.itens.map((e,s)=>"list"===x?(0,t.jsx)(h.Z,{modeTheme:d,handleFileClick:u,selectedItem:a,inputRef:c,item:e,loadingFile:o.loadingFile,grupo:o.grupo,indexBlock:o.indexGrupo,indexItem:s,handleFileSelect:o.handleFileSelect,handleRemove:o.handleRemove,folder:o.folder,error:o.error,disabled:o.disabled},"".concat(o.indexGrupo,"-").concat(s)):(0,t.jsx)(p,{modeTheme:d,handleFileClick:u,selectedItem:a,inputRef:c,item:e,loadingFile:o.loadingFile,grupo:o.grupo,indexGrupo:o.indexGrupo,indexItem:s,handleFileSelect:o.handleFileSelect,handleRemove:o.handleRemove,folder:o.folder,error:o.error,disabled:o.disabled},"".concat(o.indexGrupo,"-").concat(s)))})]})})};var A=y},69291:function(e,o,a){a.d(o,{Z:function(){return P}});var t=a(85893),s=a(11163),n=a.n(s),i=a(67294),l=a(60565),r=a(83830),d=a(60664),c=a(49837),u=a(91359),x=a(79072),m=a(59742),p=a(54225),h=a(87536),v=a(86501),j=a(47842),f=a(45061),g=a(86887),Z=a(46749),b=a(29308),D=a(84220),y=a(67569),A=a(40039),w=a(21609),S=a(88475),I=a(44373);let N=e=>{let{getValues:o,removeAnexo:a,setValue:s,control:n,register:l,errors:r,type:c}=e,[u,x]=(0,i.useState)([]),m=async()=>{let e=await d.h.post("/cadastros/produto/getFormularios");console.log("--> ",e.data),x(e.data)};return(0,i.useEffect)(()=>{m()},[]),o("anexos")&&o("anexos").map((e,d)=>{var x,m,p,h,v,j;return(0,t.jsxs)(i.Fragment,{children:[(0,t.jsx)(b.Z,{md:6,title:"Nome",name:"anexos[".concat(d,"].nome"),required:!0,control:n,errors:null==r?void 0:null===(x=r.anexos)||void 0===x?void 0:null===(m=x[d])||void 0===m?void 0:m.nome}),(0,t.jsx)(D.Z,{xs:12,md:3,title:"Formul\xe1rio",name:"anexos[".concat(d,"].formulario"),value:e.formulario,required:!0,options:null!=u?u:[],register:l,setValue:s,control:n,errors:null==r?void 0:null===(p=r.anexos)||void 0===p?void 0:null===(h=p[d])||void 0===h?void 0:h.formulario,helpText:"Formul\xe1rio em que ser\xe1 solicitado esse anexo para este produto"}),(0,t.jsx)(y.Z,{xs:1,md:1,title:"Obrigat\xf3rio",name:"anexos[".concat(d,"].obrigatorio"),value:1==e.obrigatorio,typePage:c,register:l}),(0,t.jsx)(y.Z,{xs:1,md:1,title:"Ativo",name:"anexos[".concat(d,"].status"),value:1==e.obrigatorio,typePage:c,register:l}),(0,t.jsx)(S.Z,{xs:4,md:1,title:"Remover",index:d,removeItem:a,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"}),(0,t.jsx)(b.Z,{xs:11,md:12,multiline:!0,items:4,title:"Descri\xe7\xe3o (opcional)",name:"anexos[".concat(d,"].descricao"),control:n,errors:null==r?void 0:null===(v=r.anexos)||void 0===v?void 0:null===(j=v[d])||void 0===j?void 0:j.descricao}),d<o("anexos").length-1&&(0,t.jsx)(I.Z,{})]},d)})};var C=a(41088);let F=e=>{var o,a;let{id:s,btnClose:S,handleConfirmNew:I,handleModalClose:F,newChange:P,manualUrl:E,outsideID:z}=e,[R,M]=(0,i.useState)(!1),[k,O]=(0,i.useState)(null),T=n(),q=s&&s>0?"edit":"new",V=T.pathname,{title:U}=(0,i.useContext)(l.f),{setId:G}=(0,i.useContext)(r.X),{loggedUnity:_,user:B}=(0,i.useContext)(A.V),[H,L]=(0,i.useState)([]),[W,J]=(0,i.useState)(!1),{startLoading:Q,stopLoading:X}=(0,C.Z)(),{trigger:K,handleSubmit:Y,setValue:$,reset:ee,control:eo,getValues:ea,formState:{errors:et},register:es}=(0,h.cI)(),en=async e=>{Q();let o={...e,unidadeID:_.unidadeID,usuarioID:B.usuarioID,removedItems:H};console.log(o);try{"new"===q?await d.h.post("cadastros/produto/new/insertData",o).then(e=>{I?I(e.data,"produtos"):(T.push("".concat((0,Z.g_)(V))),G(e.data.id)),v.ZP.success(Z.OD.successNew)}):"edit"===q&&(await d.h.post("".concat(V,"/updateData/").concat(s),o),v.ZP.success(Z.OD.successUpdate))}catch(a){a.response&&409===a.response.status?v.ZP.error(Z.OD.errorRepeated):console.log(a)}finally{X()}},ei=async()=>{try{await d.h.delete("".concat(V,"/").concat(s,"/").concat(B.usuarioID,"/").concat(_.unidadeID)),G(null),M(!1),v.ZP.success(Z.OD.successDelete)}catch(e){e.response&&409===e.response.status?(v.ZP.error(Z.OD.pendingDelete),M(!1)):console.log(e)}},el=async()=>{try{let e="new"===q?"cadastros/produto/new/getData":"".concat(V,"/getData/").concat(s);await d.h.post(e).then(e=>{console.log("\uD83D\uDE80 ~ getData:",e.data),O(e.data),ee(e.data)})}catch(o){console.log(o)}},er=(e,o)=>{e.produtoAnexoID&&L([...H,e.produtoAnexoID]);let a=ea("anexos").filter((e,a)=>a!==o);$("anexos",a),J(!W)},ed=()=>{let e=[...ea("anexos"),{nome:"",obrigatorio:1,status:1,descricao:"",observacao:""}];$("anexos",e),J(!W)};return(0,i.useEffect)(()=>{el(),"new"===q&&setTimeout(()=>{K()},300)},[s]),(0,i.useEffect)(()=>{P&&Y(en)()},[P]),(0,t.jsxs)(t.Fragment,{children:[!k&&(0,t.jsx)(j.Z,{}),k&&(0,t.jsxs)("form",{onSubmit:Y(en),className:"space-y-3",children:[(0,t.jsx)(g.Z,{btnCancel:!0,btnNew:!I,btnSave:!0,btnClose:S,manualUrl:E,handleModalClose:F,handleSubmit:()=>Y(en),btnDelete:"edit"===q,onclickDelete:()=>M(!0),type:q,outsideID:z}),(0,t.jsx)(c.Z,{children:(0,t.jsx)(u.Z,{children:(0,t.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(b.Z,{xs:11,md:6,title:"Nome",name:"fields.nome",required:!0,control:eo,errors:null==et?void 0:null===(o=et.fields)||void 0===o?void 0:o.nome}),(0,t.jsx)(D.Z,{xs:12,md:4,title:"Unidade de medida",name:"unidadeMedida.fields",value:null==k?void 0:k.unidadeMedida.fields,required:!0,options:k.unidadeMedida.options,register:es,setValue:$,control:eo,errors:null==et?void 0:null===(a=et.unidadeMedida)||void 0===a?void 0:a.fields,helpText:"Selecione a unidade de medida"}),(0,t.jsx)(y.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:k.fields.status,typePage:q,register:es})]})})}),(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(m.Z,{title:"Anexos"}),(0,t.jsx)(u.Z,{children:(0,t.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(N,{getValues:ea,removeAnexo:er,setValue:$,control:eo,register:es,errors:et,type:q},W),(0,t.jsx)(x.ZP,{item:!0,xs:12,children:(0,t.jsx)(p.Z,{variant:"outlined",color:"primary",sx:{mt:1},startIcon:(0,t.jsx)(w.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ed()},children:"Inserir Anexo"})})]})})]})]}),(0,t.jsx)(f.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+U.title,openModal:R,handleClose:()=>M(!1),handleSubmit:ei,btnCancel:!0,btnConfirm:!0})]})};var P=F},77993:function(e,o,a){a.d(o,{Z:function(){return F}});var t=a(85893),s=a(11163),n=a.n(s),i=a(67294),l=a(60565),r=a(83830),d=a(40039),c=a(60664),u=a(49837),x=a(91359),m=a(79072),p=a(29630),h=a(54225),v=a(21609),j=a(87536),f=a(86501),g=a(45061),Z=a(47842),b=a(86887),D=a(46749),y=a(41088),A=a(84220),w=a(29308),S=a(67569),I=a(88475);let N=e=>{let{getValues:o,removeItem:a,control:s,register:n,errors:i,type:l}=e;return o("items")&&o("items").map((e,o)=>{var r,d,c,u;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.Z,{xs:12,md:3,title:"Nome",name:"items[".concat(o,"].nome"),required:!0,control:s,errors:null==i?void 0:null===(r=i.items)||void 0===r?void 0:null===(d=r[o])||void 0===d?void 0:d.nome}),(0,t.jsx)(w.Z,{xs:12,md:6,title:"Descri\xe7\xe3o",name:"items[".concat(o,"].descricao"),required:!1,control:s,errors:null==i?void 0:null===(c=i.items)||void 0===c?void 0:null===(u=c[o])||void 0===u?void 0:u.descricao}),(0,t.jsx)(S.Z,{xs:4,md:1,title:"Ativo",index:o,name:"items[".concat(o,"].status"),value:e.status,typePage:l,register:n}),(0,t.jsx)(S.Z,{xs:4,md:1,title:"Obrigat\xf3rio",index:o,name:"items[".concat(o,"].obrigatorio"),value:e.obrigatorio,typePage:l,register:n}),(0,t.jsx)(I.Z,{xs:4,md:1,title:"Remover",index:o,removeItem:a,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"})]})})},C=e=>{var o,a,s,I;let{id:C,btnClose:F,handleConfirmNew:P,handleModalClose:E,newChange:z,manualUrl:R,outsideID:M}=e,{setId:k}=(0,i.useContext)(r.X),O=n(),[T,q]=(0,i.useState)(null),[V,U]=(0,i.useState)(!1),G=C&&C>0?"edit":"new",_=O.pathname,{title:B}=(0,i.useContext)(l.f),{loggedUnity:H,user:L}=(0,i.useContext)(d.V),[W,J]=(0,i.useState)(!1),[Q,X]=(0,i.useState)([]),[K,Y]=(0,i.useState)(!1),{startLoading:$,stopLoading:ee}=(0,y.Z)(),{trigger:eo,handleSubmit:ea,setValue:et,reset:es,getValues:en,control:ei,formState:{errors:el},register:er}=(0,j.cI)(),ed=async()=>{try{let e="new"===G?"cadastros/grupo-anexos/new/getData":"".concat(_,"/getData/").concat(C);await c.h.post(e,{unidadeID:H.unidadeID}).then(e=>{q(e.data),es(e.data)})}catch(o){console.log(o)}},ec=()=>{let e=[...en("items"),{nome:"",descricao:"",status:!0,obrigatorio:!0}];et("items",e),Y(!K)},eu=(e,o)=>{if(1===T.items.length){f.ZP.error("\xc9 necess\xe1rio ter pelo menos um item!");return}e.id&&X([...Q,e.id]);let a=en("items").filter((e,a)=>a!==o);et("items",a),Y(!K)},ex=async e=>{let o={...e,usuarioID:L.usuarioID,unidadeID:H.unidadeID};$(),o.removedItems=Q,o.unidade=H.unidadeID;try{"new"===G?await c.h.post("cadastros/grupo-anexos/new/insertData",o).then(e=>{P?P(e.data,"gruposAnexo"):(O.push("".concat((0,D.g_)(_))),k(e.data.id)),f.ZP.success(D.OD.successNew)}):"edit"===G&&(await c.h.post("".concat(_,"/updateData/").concat(C),o),f.ZP.success(D.OD.successUpdate)),J(!W)}catch(a){a.response&&409===a.response.status?f.ZP.error(D.OD.errorRepeated):console.log(a)}finally{ee()}},em=async()=>{try{await c.h.delete("".concat(_,"/deleteData/").concat(C,"/").concat(L.usuarioID,"/").concat(H.unidadeID)),k(null),setOpen(!1),f.ZP.success(D.OD.successDelete),console.log("entrou")}catch(e){e.response&&409===e.response.status?(f.ZP.error(D.OD.pendingDelete),U(!1)):console.log(e)}};return(0,i.useEffect)(()=>{ed(),"new"===G&&setTimeout(()=>{eo()},300)},[C]),(0,i.useEffect)(()=>{z&&ea(ex)()},[z]),(0,t.jsxs)(t.Fragment,{children:[!T&&(0,t.jsx)(Z.Z,{}),T&&(0,t.jsxs)("form",{onSubmit:ea(ex),children:[(0,t.jsx)(b.Z,{btnCancel:!0,btnNew:!P,btnSave:!0,manualUrl:R,btnClose:F,handleModalClose:E,handleSubmit:()=>ea(ex),btnDelete:"edit"===G,onclickDelete:()=>U(!0),type:G,outsideID:M}),(0,t.jsx)(u.Z,{children:T&&(0,t.jsx)(x.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(w.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:ei,errors:null==el?void 0:null===(o=el.fields)||void 0===o?void 0:o.nome}),(0,t.jsx)(S.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:T.fields.status,typePage:G,register:er}),(0,t.jsx)(w.Z,{xs:12,md:12,title:"Descri\xe7\xe3o",name:"fields.descricao",required:!1,control:ei,errors:null==el?void 0:null===(a=el.fields)||void 0===a?void 0:a.descricao}),(0,t.jsx)(A.Z,{xs:12,md:12,title:"Formul\xe1rios",name:"formulario.fields",value:null!==(I=null==T?void 0:T.formulario.fields)&&void 0!==I?I:null,multiple:!0,limitTags:5,required:!0,options:T.formulario.options,register:er,setValue:et,control:ei,errors:null==el?void 0:null===(s=el.formulario)||void 0===s?void 0:s.fields})]})})}),(0,t.jsx)(u.Z,{sx:{mt:4},children:(0,t.jsxs)(x.Z,{children:[(0,t.jsx)(p.Z,{sx:{mb:5},children:"Itens"}),(0,t.jsx)(m.ZP,{container:!0,spacing:3,children:(0,t.jsx)(N,{getValues:en,removeItem:eu,control:ei,register:er,errors:el,type:G},K)}),(0,t.jsx)(h.Z,{variant:"outlined",color:"primary",sx:{mt:4},startIcon:(0,t.jsx)(v.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ec()},children:"Inserir item"})]})})]}),(0,t.jsx)(g.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+B.title,openModal:V,handleClose:()=>U(!1),handleSubmit:em,btnCancel:!0,btnConfirm:!0})]})};var F=C},934:function(e,o,a){var t=a(85893),s=a(49837),n=a(91359),i=a(61953),l=a(67294),r=a(60664),d=a(46749),c=a(21609),u=a(7071),x=a(67074),m=a(17494),p=a(87413),h=a(29630),v=a(72162),j=a(9601),f=a(51221),g=a(36599);let Z=(0,x.ZP)(g.Z)({paddingLeft:0,paddingRight:0,"& .MuiTimelineItem-root":{width:"100%","&:before":{display:"none"}}}),b=e=>{let{parFormularioID:o,id:a}=e,[x,g]=(0,l.useState)(!1),b=async()=>{try{await r.h.post("/formularios/fornecedor/getMovementHistory/".concat(a),{parFormularioID:o}).then(e=>{g(e.data)})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{b()},[]),(0,t.jsx)(s.Z,{children:(0,t.jsxs)(n.Z,{children:[(0,t.jsx)("h2",{className:"font-semibold mb-2",children:"Hist\xf3rico de movimenta\xe7\xf5es"}),(0,t.jsx)(i.Z,{children:(0,t.jsx)(Z,{children:x&&x.length>0&&x.map((e,o)=>(0,t.jsxs)(p.Z,{children:[(0,t.jsxs)(j.Z,{children:[(0,t.jsx)(m.Z,{color:d.WR[e.statusAtual].color}),(0,t.jsx)(f.Z,{})]}),(0,t.jsxs)(v.Z,{sx:{"& svg":{verticalAlign:"bottom",mx:4}},children:[(0,t.jsxs)(i.Z,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(h.Z,{variant:"body2",sx:{mr:2,fontWeight:600,color:"text.primary"},children:[e.data+" - "+e.hora+" ",0==o&&(0,t.jsx)(u.Z,{size:"small",skin:"light",color:d.WR[e.statusAtual].color,label:"Atual",sx:{"& .MuiChip-label":{textTransform:"capitalize"}}})]}),(0,t.jsxs)(h.Z,{variant:"body2",className:"flex items-center",sx:{color:"text.primary"},children:[(0,t.jsx)("span",{children:d.WR[e.statusAnterior].title}),(0,t.jsx)(c.Z,{icon:"mdi:arrow-right"}),(0,t.jsx)("span",{children:d.WR[e.statusAtual].title})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(h.Z,{variant:"caption",className:"flex items-center",children:[(0,t.jsx)(c.Z,{icon:"iconoir:user"}),e.usuario]}),(0,t.jsxs)(h.Z,{variant:"caption",className:"flex items-center gap-0",children:[(0,t.jsx)(c.Z,{icon:"mdi:company"}),e.unidade]})]})]}),null!=e.observacao&&(0,t.jsx)(i.Z,{children:(0,t.jsx)(h.Z,{variant:"caption",children:e.observacao})})]})]}))})})]})})};o.Z=b},70190:function(e,o,a){a.d(o,{Z:function(){return C}});var t=a(85893),s=a(44642),n=a(79072),i=a(61953),l=a(49837),r=a(91359),d=a(29630),c=a(67294),u=a(40039),x=a(82747),m=a(60664),p=a(29308),h=a(84220),v=a(1322),j=a(77993),f=a(69291),g=a(62135),Z=a(54225),b=a(78633),D=a(21609),y=a(431);let A=c.memo(e=>{let{xs:o,md:a,name:s,register:i,setValue:l}=e,[r,d]=(0,c.useState)(1),{setIsNotFactory:u}=(0,y.r7)();return(0,c.useEffect)(()=>{s&&i&&l(s,r)},[s,i,r,l,u]),(0,t.jsxs)(n.ZP,{item:!0,xs:o,md:a,children:[(0,t.jsxs)(g.Z,{color:"primary",children:[(0,t.jsx)(Z.Z,{onClick(){u(!1),d(1)},variant:1===r?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 py-2 px-1",children:[(0,t.jsx)(D.Z,{icon:"mdi:company"}),(0,t.jsx)("p",{className:"capitalize",children:"F\xe1brica"})]})}),(0,t.jsx)(Z.Z,{onClick(){u(!0),d(2)},variant:2===r?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 py-2 px-1",children:[(0,t.jsx)(D.Z,{icon:"mdi:truck-fast-outline"}),(0,t.jsx)("p",{className:"capitalize",children:"Fornecedor"})]})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-4",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)(b.gH_,{})}),(0,t.jsx)("p",{className:"text-sm",children:"".concat(1==r?"F\xe1brica ficar\xe1 respons\xe1vel pelo preenchimento do formul\xe1rio":"Fornecedor ficar\xe1 respons\xe1vel pelo preenchimento do formul\xe1rio, ser\xe1 enviado um e-mail com instru\xe7\xf5es de preenchimento ao fornecedor e a f\xe1brica ir\xe1 monitorar o status")})]}),s&&i&&(0,t.jsx)("input",{type:"hidden",name:s,...i(s),value:r})]})}),w=e=>{var o,a,s,n,l,r,x,g,Z;let{fields:b,params:D,habilitaQuemPreencheFormFornecedor:w,setFields:S,handleCnpj:I,validCnpj:N,getValues:C,control:F,errors:P,setValue:E,register:z,reset:R}=e,{loggedUnity:M}=(0,c.useContext)(u.V),[k,O]=(0,c.useState)([]),[T,q]=(0,c.useState)([]),[V,U]=(0,c.useState)([]),[G,_]=(0,c.useState)(!1),[B,H]=(0,c.useState)(!1),[L,W]=(0,c.useState)(""),[J,Q]=(0,c.useState)(null),{isNotFactory:X,setIsNotFactory:K}=(0,c.useContext)(y.YF),Y=async()=>{let e=await m.h.post("/formularios/fornecedor/getModels",{unidadeID:M.unidadeID});O(e.data)},$=async()=>{let e=await m.h.post("/formularios/fornecedor/getProducts",{unidadeID:M.unidadeID});q(e.data)},ee=async()=>{let e=await m.h.post("/formularios/fornecedor/getGruposAnexo",{unidadeID:M.unidadeID});U(e.data)},eo=()=>{S(null),E("fields.cnpj",""),E("fields.razaoSocial",""),E("fields.email",""),E("fields.modelo",null),E("fields.gruposAnexo",[]),E("fields.produtos",[])};(0,c.useEffect)(()=>{R(),Y(),$(),ee()},[]);let ea=async(e,o)=>{if(H(!1),"gruposAnexo"==o){U(o=>[...o,e]);let a=[...C("fields.gruposAnexo")];a.push(e),E("fields.gruposAnexo",a)}else if("produtos"==o){q(o=>[...o,e]);let t=[...C("fields.produtos")];t.push(e),E("fields.produtos",t)}_(!G)},et=async e=>{H(!0),"gruposAnexo"==e?(W("Novo grupo de anexos"),Q((0,t.jsx)(j.Z,{manualUrl:"/cadastros/grupo-anexos",btnClose:!0,handleModalClose:()=>H(!1),newChange:G,handleConfirmNew:ea,outsideID:!0}))):"produtos"==e&&(W("Novo produto"),Q((0,t.jsx)(f.Z,{manualUrl:"/cadastros/produto",btnClose:!0,handleModalClose:()=>H(!1),newChange:G,handleConfirmNew:ea,outsideID:!0})))},es=async e=>{H(!1)};return k&&T&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Z,{children:[(null==D?void 0:D.habilitaQuemPreencheFormFornecedor)&&(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(A,{xs:12,md:12,register:z,name:"habilitaQuemPreencheFormFornecedor",setValue:E})}),(0,t.jsx)(p.Z,{xs:12,md:12,title:"CNPJ",name:"fields.cnpj",value:null==b?void 0:b.cnpj,onChange:I,clearField:C("fields.cnpj")?eo:null,mask:"cnpj",required:!0,control:F,errors:null==P?void 0:null===(o=P.fields)||void 0===o?void 0:o.cnpj}),!1==N&&(0,t.jsx)(d.Z,{variant:"body2",color:"error",children:"CNPJ inv\xe1lido!"})]}),(0,t.jsx)(p.Z,{xs:12,md:12,title:"Raz\xe3o Social",name:"fields.razaoSocial",value:null==b?void 0:b.razaoSocial,disabled:!N,required:!0,control:F,errors:null==P?void 0:null===(a=P.fields)||void 0===a?void 0:a.razaoSocial}),(0,t.jsx)(p.Z,{xs:12,md:12,title:"Nome Fantasia",name:"fields.nomeFantasia",value:null==b?void 0:b.nomeFantasia,disabled:!N,required:!0,control:F,errors:null==P?void 0:null===(s=P.fields)||void 0===s?void 0:s.nomeFantasia}),X&&(0,t.jsx)(p.Z,{xs:12,md:12,type:"email",title:"E-mail",name:"fields.email",value:null==b?void 0:b.email,disabled:!N,required:!0,control:F,errors:null==P?void 0:null===(n=P.fields)||void 0===n?void 0:n.email}),(0,t.jsx)(h.Z,{xs:12,md:12,title:"Modelo de Formul\xe1rio",name:"fields.modelo",options:k,required:!0,value:null==b?void 0:b.modelo,disabled:!N,register:z,setValue:E,control:F,errors:null==P?void 0:null===(l=P.fields)||void 0===l?void 0:l.modelo}),(0,t.jsx)(h.Z,{xs:12,md:12,title:"Grupos de Anexo",multiple:!0,createNew(){et("gruposAnexo")},name:"fields.gruposAnexo",value:null!==(g=null==b?void 0:b.gruposAnexo)&&void 0!==g?g:[],disabled:!N,options:null!=V?V:[],register:z,setValue:E,control:F,errors:null==P?void 0:null===(r=P.fields)||void 0===r?void 0:r.gruposAnexo}),(0,t.jsx)(h.Z,{xs:12,md:12,title:"Produtos",name:"fields.produtos",value:null!==(Z=null==b?void 0:b.produtos)&&void 0!==Z?Z:[],disabled:!N,multiple:!0,createNew:()=>et("produtos"),required:null==D?void 0:D.obrigatorioProdutoFornecedor,options:null!=T?T:[],register:z,setValue:E,control:F,errors:null==P?void 0:null===(x=P.fields)||void 0===x?void 0:x.produtos}),(0,t.jsx)(v.Z,{title:L,size:"md",openModal:B,setOpenModal:H,handleSave:es,children:J})]})};var S=a(34175);let I=e=>{let{sipeAgro:o}=e;return(0,t.jsx)(l.Z,{sx:{mt:4},children:(0,t.jsx)(r.Z,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)(d.Z,{variant:"body2",children:(0,t.jsxs)("strong",{children:["Dados MAPA - \xdaltima atualiza\xe7\xe3o (",null==o?void 0:o.dataImportacao,")"]})}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Raz\xe3o Social:"})," ",null==o?void 0:o.razaoSocial]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Registro SIPEAGRO:"})," ",null==o?void 0:o.registroSipeAgro]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Situa\xe7\xe3o:"})," ",null==o?void 0:o.situacao]})]})})})},N=e=>{var o,a,p,h,v,j;let{cnpj:f,control:g,setValue:Z,register:b,errors:D,reset:y,getValues:A}=e,[N,C]=(0,c.useState)(!1),{loggedUnity:F}=(0,c.useContext)(u.V),[P,E]=(0,c.useState)(null),[z,R]=(0,c.useState)(null),[M,k]=(0,c.useState)(null),[O,T]=(0,c.useState)(null),q=e=>{18==e.length?(0,x.zk)(e)?(T(!0),U(e),V(e)):T(!1):(T(null),E(null))},V=async e=>{try{let o=await m.h.post("/formularios/fornecedor/mapaSipeAgro",{cnpj:e});console.log("\uD83D\uDE80 ~ sipeagro response.data:",o.data),k(o.data)}catch(a){console.error(a)}},U=async e=>{try{let o=await m.h.post("/formularios/fornecedor/cnpj",{unidadeID:F.unidadeID,cnpj:e}),a={new:o.data.new,fornecedorID:o.data.fornecedorID,data:o.data.dataAvaliacao,modelo:o.data.modelo.nome,produtos:o.data.produtos,gruposAnexo:o.data.gruposAnexo},t="";a.new&&(t=await G(e)),E({...P,cnpj:a.new?(0,S.PK)(t.data.CNPJ):e,status:a.new?t.data.STATUS:"",dataAbertura:a.new?t.data["DATA ABERTURA"]:"",telefone:a.new?t.data.DDD+" "+t.data.TELEFONE:"",razaoSocial:a.new?t.data["RAZAO SOCIAL"]:o.data.fields.razaoSocial,nomeFantasia:a.new?t.data["NOME FANTASIA"]:o.data.fields.nomeFantasia,email:a.new?t.data.EMAIL:o.data.fields.email,cidade:a.new?t.data.MUNICIPIO+"/"+t.data.UF:"",preenchimento:a}),Z("fields.cnpj",e),Z("fields.razaoSocial",a.new?t.data["RAZAO SOCIAL"]:o.data.fields.razaoSocial),Z("fields.nomeFantasia",a.new?t.data["NOME FANTASIA"]:o.data.fields.nomeFantasia),Z("fields.nome",a.new?t.data["NOME FANTASIA"]:""),Z("fields.email",a.new?t.data.EMAIL:o.data.fields.email),Z("fields.modelo",o.data.modelo.id>0?o.data.modelo:null),Z("fields.gruposAnexo",o.data.gruposAnexo),Z("fields.produtos",o.data.produtos)}catch(s){console.error(s)}},G=async e=>{let o=e.replace(/\D/g,""),a=await m.h.get("https://api-publica.speedio.com.br/buscarcnpj?cnpj=".concat(o));return a},_=async()=>{let e={unidadeID:F.unidadeID};try{let o=await m.h.post("/formularios/fornecedor/paramsNewFornecedor",e);R(o.data)}catch(a){console.error(a)}};return(0,c.useEffect)(()=>{C(!N),f&&f.length>0&&q(f)},[]),(0,c.useEffect)(()=>{_()},[]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(s.Z,{children:(0,t.jsxs)(n.ZP,{container:!0,spacing:4,children:[(0,t.jsxs)(n.ZP,{item:!0,xs:12,md:6,children:[(0,t.jsx)(i.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:(0,t.jsx)(w,{setFields:E,fields:null!=P?P:null,params:z,control:g,errors:D,reset:y,setValue:Z,getValues:A,register:b,handleCnpj:q,validCnpj:O},N)}),(0,t.jsx)(l.Z,{sx:{mt:4},children:(0,t.jsx)(r.Z,{children:(0,t.jsxs)(i.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsx)(d.Z,{variant:"body2",children:(0,t.jsx)("strong",{children:"Dados do \xfaltimo formul\xe1rio deste fornecedor"})}),(null==P?void 0:null===(o=P.preenchimento)||void 0===o?void 0:o.new)?(0,t.jsx)(d.Z,{variant:"body2",color:"primary",children:(0,t.jsx)("strong",{children:"Novo fornecedor"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"ID: "})," ",null==P?void 0:null===(a=P.preenchimento)||void 0===a?void 0:a.fornecedorID]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Data de preenchimento:"})," ",null==P?void 0:null===(p=P.preenchimento)||void 0===p?void 0:p.data]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Modelo:"})," ",null==P?void 0:null===(h=P.preenchimento)||void 0===h?void 0:h.modelo]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Grupos de anexo: "}),null==P?void 0:null===(v=P.preenchimento)||void 0===v?void 0:v.gruposAnexo.map((e,o)=>{var a;return"".concat(e.nome).concat(o<(null==P?void 0:null===(a=P.preenchimento)||void 0===a?void 0:a.gruposAnexo.length)-1?", ":"")})]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Produtos: "}),null==P?void 0:null===(j=P.preenchimento)||void 0===j?void 0:j.produtos.map((e,o)=>{var a;return"".concat(e.nome).concat(o<(null==P?void 0:null===(a=P.preenchimento)||void 0===a?void 0:a.produtos.length)-1?", ":"")})]})]})]})})})]}),(0,t.jsxs)(n.ZP,{item:!0,xs:12,md:6,children:[(0,t.jsx)(I,{sipeAgro:M},M),(0,t.jsx)(l.Z,{sx:{mt:4},children:(0,t.jsx)(r.Z,{children:(0,t.jsxs)(i.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsx)(d.Z,{variant:"body2",children:(0,t.jsx)("strong",{children:"Dados consultados da Receita Federal"})}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Raz\xe3o Social:"})," ",null==P?void 0:P.razaoSocial]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Nome Fantasia:"})," ",null==P?void 0:P.nomeFantasia]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"CNPJ:"})," ",null==P?void 0:P.cnpj]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Status:"})," ",null==P?void 0:P.status]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Data Abertura:"})," ",null==P?void 0:P.dataAbertura]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Telefone:"})," ",null==P?void 0:P.telefone]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"E-mail:"})," ",null==P?void 0:P.email]}),(0,t.jsxs)(d.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Cidade:"})," ",null==P?void 0:P.cidade]})]})})})]})]})})})};var C=N},99384:function(e,o,a){var t=a(67294),s=a(46749);let n=()=>{let[e,o]=(0,t.useState)({}),a=(e,a,t,n)=>{let i=new Date(t),l=(0,s.HD)(e,i,n);o(e=>({...e,[a]:l}))};return{setDateFormat:a,dateStatus:e}};o.Z=n}}]);