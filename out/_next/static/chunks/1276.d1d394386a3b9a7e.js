"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1276],{88771:function(e,a,s){var t=s(85893),i=s(11163),n=s.n(i),o=s(67294),l=s(60664),c=s(49837),d=s(91359),r=s(79072),u=s(87536),m=s(86501),x=s(45061),h=s(47842),f=s(65698),p=s(71798),j=s(60565),Z=s(83830),D=s(29308),b=s(67569),g=s(41088),w=s(40039);let v=e=>{var a;let{id:s,newChange:i,manualUrl:v,handleModalClose:C,handleConfirmNew:S,btnClose:I,outsideID:y}=e,[P,N]=(0,o.useState)(!1),[O,M]=(0,o.useState)(null),q=n(),T=s&&s>0?"edit":"new",z=q.pathname,{title:E}=(0,o.useContext)(j.f),{setId:k}=(0,o.useContext)(Z.X),{loggedUnity:U,user:F}=(0,o.useContext)(w.V),{startLoading:L,stopLoading:_}=(0,g.Z)(),A=(0,u.cI)({mode:"onChange"}),R=async e=>{let a={...e,usuarioID:F.usuarioID,unidadeID:U.unidadeID};L();try{"new"===T?await l.h.post("/cadastros/classificacao-produto/new/insertData",a).then(e=>{y?S(e.data):(q.push("/cadastros/classificacao-produto"),k(e.data)),m.ZP.success(p.OD.successNew)}):"edit"===T&&(await l.h.post("/cadastros/classificacao-produto/updateData/".concat(s),a),m.ZP.success(p.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(p.OD.errorRepeated):console.log(t)}finally{_()}},V=async()=>{try{await l.h.delete("".concat(z,"/").concat(s,"/").concat(F.usuarioID,"/").concat(U.unidadeID)),k(null),N(!1),m.ZP.success(p.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(p.OD.pendingDelete),N(!1)):console.log(e)}},H=async()=>{try{"edit"===T?await l.h.post("".concat(z,"/getData/").concat(s),{id:s}).then(e=>{M(e.data),A.reset(e.data)}):M({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,o.useEffect)(()=>{H(),setTimeout(()=>{A.trigger()},300)},[s]),(0,t.jsxs)(t.Fragment,{children:[!O&&(0,t.jsx)(h.Z,{}),O&&(0,t.jsxs)("form",{onSubmit:A.handleSubmit(R),id:"formItem",children:[(0,t.jsx)(f.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,disabled:!1,manualUrl:v,btnClose:I,handleModalClose:C,handleSubmit:()=>A.handleSubmit(R),btnDelete:"edit"===T,onclickDelete:()=>N(!0),type:T,outsideID:y}),(0,t.jsx)(c.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(r.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(D.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:A}),(0,t.jsx)(b.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==O?void 0:null===(a=O.fields)||void 0===a?void 0:a.status,typePage:T,form:A})]})})})]}),(0,t.jsx)(x.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+E.title,openModal:P,handleClose:()=>N(!1),handleSubmit:V,btnCancel:!0,btnConfirm:!0})]})};a.Z=v},31276:function(e,a,s){s.d(a,{Z:function(){return M}});var t=s(85893),i=s(11163),n=s.n(i),o=s(67294),l=s(60565),c=s(83830),d=s(60664),r=s(49837),u=s(91359),m=s(79072),x=s(87536),h=s(86501),f=s(47842),p=s(45061),j=s(65698),Z=s(71798),D=s(29308),b=s(84220);s(67569);var g=s(40039),w=s(21609);s(88475);var v=s(41088),C=s(88771),S=s(1322),I=s(3893),y=s(80562),P=s(54225);let N=e=>{let{form:a,data:s}=e,{fields:i,append:n,remove:l}=(0,x.Dq)({control:a.control,name:"fields.analises"}),c=e=>({minimo:a.watch("fields.analises[".concat(e,"].minimo")),maximo:a.watch("fields.analises[".concat(e,"].maximo"))});return a.watch("fields.usaLaboratorio")&&(0,t.jsx)(r.Z,{children:(0,t.jsx)(u.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsxs)("div",{className:"flex items-center gap-2 pb-1 pt-2",children:[(0,t.jsx)("div",{className:"",children:(0,t.jsx)(w.Z,{icon:"entypo:lab-flask",className:"text-3xl"})}),(0,t.jsx)("div",{className:"flex flex-col gap-0",children:(0,t.jsx)("p",{className:"text-xl",children:"An\xe1lises"})})]})}),i.map((e,s)=>{let{minimo:i,maximo:n}=c(s);return console.log("\uD83D\uDE80 ~ minimo, maximo:",i,n),(0,t.jsxs)(o.Fragment,{children:[(0,t.jsx)("input",{type:"hidden",name:"fields.analises[".concat(s,"].id"),value:e.id}),(0,t.jsx)(D.Z,{xs:12,md:3,title:"Nome",name:"fields.analises[".concat(s,"].nome"),required:!0,form:a}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"Unidade",name:"fields.analises[".concat(s,"].unidade"),required:!0,form:a,helpText:"%, UI/g"}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"M\xednimo",name:"fields.analises[".concat(s,"].minimo"),required:!a.watch("fields.analises[".concat(s,"].maximo")),form:a,errorText:i&&n&&parseFloat(a.watch("fields.analises[".concat(s,"].minimo")))>=parseFloat(a.watch("fields.analises[".concat(s,"].maximo")))&&"O m\xednimo deve ser menor que o m\xe1ximo"}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"M\xe1ximo",name:"fields.analises[".concat(s,"].maximo"),required:!a.watch("fields.analises[".concat(s,"].minimo")),form:a,errorText:i&&n&&parseFloat(a.watch("fields.analises[".concat(s,"].minimo")))>=parseFloat(a.watch("fields.analises[".concat(s,"].maximo")))&&"O m\xe1ximo deve ser maior que o m\xednimo"}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"Ajuda/Dica/M\xe9todo",name:"fields.analises[".concat(s,"].ajuda"),form:a}),(0,t.jsxs)(m.ZP,{item:!0,xs:12,md:1,className:"flex items-center",children:[(0,t.jsx)(y.Z,{color:"error",size:"small",title:"Inativar",children:(0,t.jsx)(w.Z,{icon:"heroicons-outline:ban"})}),(0,t.jsx)(y.Z,{color:"error",size:"small",onClick:()=>l(s),title:"Remover",children:(0,t.jsx)(w.Z,{icon:"tabler:trash-filled"})})]})]},e.id)}),(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsx)(P.Z,{variant:"outlined",color:"primary",onClick(){n({id:null,nome:"",unidade:"",minimo:"",maximo:"",ajuda:""}),a.trigger()},startIcon:(0,t.jsx)(w.Z,{icon:"material-symbols:add-circle-outline-rounded"}),children:"Inserir"})})]})})})},O=e=>{var a;let{id:s,btnClose:i,handleConfirmNew:w,handleModalClose:y,newChange:P,manualUrl:O,outsideID:M}=e,[q,T]=(0,o.useState)(!1),[z,E]=(0,o.useState)(null),k=n(),U=s&&s>0?"edit":"new",F=k.pathname,{title:L}=(0,o.useContext)(l.f),{setId:_}=(0,o.useContext)(c.X),{loggedUnity:A,user:R}=(0,o.useContext)(g.V),[V,H]=(0,o.useState)([]),[X,B]=(0,o.useState)(!1),{startLoading:G,stopLoading:J}=(0,v.Z)(),[K,Q]=(0,o.useState)(!1),[W,Y]=(0,o.useState)(!1),$=(0,x.cI)({mode:"onChange"}),ee=async e=>{G();let a={...e,unidadeID:A.unidadeID,usuarioID:R.usuarioID,removedItems:V};console.log("onSubmit: ",a);try{"new"===U?await d.h.post("cadastros/produto/new/insertData",a).then(e=>{w?w(e.data,"produtos"):(k.push("".concat((0,Z.g_)(F))),_(e.data.id)),h.ZP.success(Z.OD.successNew)}):"edit"===U&&(await d.h.post("".concat(F,"/updateData/").concat(s),a),h.ZP.success(Z.OD.successUpdate))}catch(t){t.response&&409===t.response.status?h.ZP.error(Z.OD.errorRepeated):console.log(t)}finally{J()}},ea=async()=>{try{await d.h.delete("".concat(F,"/").concat(s,"/").concat(R.usuarioID,"/").concat(A.unidadeID)),_(null),T(!1),h.ZP.success(Z.OD.successDelete)}catch(e){e.response&&409===e.response.status?(h.ZP.error(Z.OD.pendingDelete),T(!1)):console.log(e)}},es=async()=>{try{let e="new"===U?"cadastros/produto/new/getData/".concat(A.unidadeID):"".concat(F,"/getData/").concat(s,"/").concat(A.unidadeID);await d.h.post(e).then(e=>{console.log("\uD83D\uDE80 ~ getData:",e.data),E(e.data),$.reset(e.data)})}catch(a){console.log(a)}},et=()=>{Q(!0)},ei=async()=>{Y(!0)},en=e=>{Q(!1),$.setValue("classificacao.fields",e),Y(!W)};return(0,o.useEffect)(()=>{es(),setTimeout(()=>{$.trigger()},300)},[s]),(0,o.useEffect)(()=>{P&&$.handleSubmit(ee)()},[P]),(0,t.jsxs)(t.Fragment,{children:[!z&&(0,t.jsx)(f.Z,{}),z&&(0,t.jsxs)("form",{onSubmit:$.handleSubmit(ee),className:"space-y-3",children:[(0,t.jsx)(j.Z,{btnCancel:!0,btnNew:!w,btnSave:!0,btnClose:i,manualUrl:O,handleModalClose:y,handleSubmit:()=>$.handleSubmit(ee),btnDelete:"edit"===U,onclickDelete:()=>T(!0),type:U,outsideID:M}),(0,t.jsx)(r.Z,{children:(0,t.jsx)(u.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(D.Z,{xs:11,md:4,title:"Nome",name:"fields.nome",required:!0,form:$}),(0,t.jsx)(b.Z,{xs:12,md:3,title:"Unidade de medida",name:"unidadeMedida.fields",value:null==z?void 0:z.unidadeMedida.fields,required:!0,options:z.unidadeMedida.options,form:$,helpText:"Selecione a unidade de medida"}),(0,t.jsx)(b.Z,{xs:12,md:3,title:"Classificação",name:"classificacao.fields",value:null==z?void 0:null===(a=z.classificacao)||void 0===a?void 0:a.fields,options:z.classificacao.options,helpText:"Selecione a classificação",createNew:et,form:$}),(0,t.jsx)(I.Z,{xs:"12",md:"2",title:"Limpeza",name:"fields.limpeza",value:z.fields.limpeza,form:$,helpText:"Este produto ser\xe1 listado nos formul\xe1rios do POP2 de Limpeza e Higieniza\xe7\xe3o"}),(0,t.jsx)(I.Z,{xs:"12",md:"2",title:"Usa Laborat\xf3rio",name:"fields.usaLaboratorio",value:z.fields.usaLaboratorio,form:$,helpText:"Habilita o uso do laborat\xf3rio com a inser\xe7\xe3o de itens de an\xe1lise"})]})})}),(0,t.jsx)(N,{form:$,data:z.analises})]}),(0,t.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+L.title,openModal:q,handleClose:()=>T(!1),handleSubmit:ea,btnCancel:!0,btnConfirm:!0}),(0,t.jsx)(S.Z,{title:"Nova Classifica\xe7\xe3o de Produto",size:"md",openModal:K,setOpenModal:Q,handleSave:ei,children:(0,t.jsx)(C.Z,{manualUrl:"/cadastros/classificacao-produto",btnClose:!0,handleModalClose:()=>Q(!1),newChange:W,handleConfirmNew:en,outsideID:!0})})]})};var M=O}}]);