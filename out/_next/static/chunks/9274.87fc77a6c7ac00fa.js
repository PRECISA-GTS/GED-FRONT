"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9274],{29274:function(e,t,a){var i=a(85893),s=a(11163),l=a.n(s),o=a(67294),n=a(60664),r=a(49837),d=a(91359),u=a(79072),c=a(80562),p=a(54225),v=a(87536),f=a(86501),m=a(45061),x=a(86887),D=a(64165),h=a(60565),g=a(83830),j=a(40039),Z=a(29308),I=a(50287),b=a(41088),S=a(21609),w=a(67569),C=a(84220);let P=e=>{var t,a,s;let{id:P}=e,[y,T]=(0,o.useState)(!1),[N,F]=(0,o.useState)(null),{setId:O}=(0,o.useContext)(g.X),k=l(),E=P&&P>0?"edit":"new",M=k.pathname,{title:q}=(0,o.useContext)(h.f),{loggedUnity:A,user:_}=(0,o.useContext)(j.V),{startLoading:U,stopLoading:z}=(0,b.Z)(),[L,V]=(0,o.useState)([]),Y=new Date().toISOString().substring(0,10),{trigger:W,handleSubmit:H,reset:Q,setValue:R,control:X,formState:{errors:B},register:G}=(0,v.cI)({mode:"onChange"}),J=async e=>{let t={...e,usuarioID:_.usuarioID,unidadeID:A.unidadeID};console.log("\uD83D\uDE80 ~ values:",t);try{"new"===E?await n.h.post("cadastros/setor/new/insertData",t).then(e=>{k.push("".concat((0,D.g_)(M))),O(e.data.id),f.ZP.success(D.OD.successNew)}):"edit"===E&&(await n.h.post("".concat(M,"/updateData/").concat(P),t),f.ZP.success(D.OD.successUpdate))}catch(a){a.response&&409===a.response.status?f.ZP.error(D.OD.errorRepeated):console.log(a)}finally{z()}},K=async()=>{try{await n.h.delete("".concat(M,"/").concat(P,"/").concat(_.usuarioID,"/").concat(A.unidadeID)),O(null),T(!1),f.ZP.success(D.OD.successDelete)}catch(e){e.response&&409===e.response.status?(f.ZP.error(D.OD.pendingDelete),T(!1)):console.log(e)}},$=async()=>{try{if("edit"===E){let e=await n.h.post("".concat(M,"/getData/").concat(P),{id:P});console.log("\uD83D\uDE80 ~ getData: ",e.data),F(e.data),Q(e.data)}else F({fields:{nome:"",status:1,profissionais:[]}}),Q({...N,fields:{...N.fields}})}catch(t){console.log(t)}},ee=async()=>{let e=await n.h.get("/cadastros/profissional?unidadeID=".concat(A.unidadeID,"&papelID=").concat(A.papelID)),t=e.data.filter(e=>1===e.statusID);V(t)};(0,o.useEffect)(()=>{$(),ee(),ea({id:null,dataInicio:Y}),setTimeout(()=>{W()},300)},[P]);let{fields:et,append:ea,remove:ei}=(0,v.Dq)({control:X,name:"fields.profissionais"});return(0,i.jsxs)(i.Fragment,{children:[N&&(0,i.jsxs)("form",{onSubmit:H(J),children:[(0,i.jsx)(x.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,handleSubmit:()=>H(J),btnDelete:"edit"===E,onclickDelete:()=>T(!0),type:E}),(0,i.jsx)(r.Z,{children:(0,i.jsx)(d.Z,{children:(0,i.jsxs)(u.ZP,{container:!0,spacing:5,children:[(0,i.jsx)(Z.Z,{xs:12,md:11,title:"Nome",name:"fields.nome",required:!0,control:X,errors:null==B?void 0:null===(t=B.fields)||void 0===t?void 0:t.nome}),(0,i.jsx)(w.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==N?void 0:null===(a=N.fields)||void 0===a?void 0:a.status,typePage:E,register:G}),(0,i.jsx)(u.ZP,{item:!0,xs:12,children:(0,i.jsxs)("div",{className:"flex items-center gap-2 pb-1 pt-2",children:[(0,i.jsx)("div",{className:"",children:(0,i.jsx)(S.Z,{icon:"material-symbols:engineering-outline",className:"text-3xl"})}),(0,i.jsx)("div",{className:"flex flex-col gap-0",children:(0,i.jsx)("p",{className:"text-xl",children:"Profissionais"})})]})}),et.map((e,t)=>{var a,l,n,r,d,p,v,f,m,x,D,h,g,j,Z;return(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("input",{type:"hidden",name:"fields.profissionais[".concat(t,"].id"),value:e.id}),(0,i.jsx)(C.Z,{xs:12,md:7,title:"Profissional",name:"fields.profissionais[".concat(t,"].profissional"),value:null==N?void 0:null===(a=N.fields)||void 0===a?void 0:null===(l=a.profissionais)||void 0===l?void 0:null===(n=l[t])||void 0===n?void 0:n.profissional,required:!0,options:null!=L?L:[],register:G,setValue:R,control:X,errors:null==B?void 0:null===(r=B.fields)||void 0===r?void 0:null===(d=r.profissionais)||void 0===d?void 0:null===(p=d[t])||void 0===p?void 0:p.profissional}),(0,i.jsx)(I.Z,{xs:12,md:2,title:"Data In\xedcio",name:"fields.profissionais[".concat(t,"].dataInicio"),value:null!==(s=null==N?void 0:null===(v=N.fields)||void 0===v?void 0:null===(f=v.profissionais)||void 0===f?void 0:null===(m=f[t])||void 0===m?void 0:m.dataInicio)&&void 0!==s?s:Y,required:!0,register:G,control:X,errors:null==B?void 0:null===(x=B.fields)||void 0===x?void 0:null===(D=x.profissionais)||void 0===D?void 0:null===(h=D[t])||void 0===h?void 0:h.dataInicio}),(0,i.jsx)(I.Z,{xs:12,md:2,title:"Data Fim",name:"fields.profissionais[".concat(t,"].dataFim"),value:null==N?void 0:null===(g=N.fields)||void 0===g?void 0:null===(j=g.profissionais)||void 0===j?void 0:null===(Z=j[t])||void 0===Z?void 0:Z.dataFim,register:G,control:X}),(0,i.jsx)(u.ZP,{item:!0,xs:12,md:1,className:"flex items-center",children:(0,i.jsx)(c.Z,{color:"error",size:"small",onClick:()=>ei(t),children:(0,i.jsx)(S.Z,{icon:"tabler:trash-filled"})})})]},e.id)}),(0,i.jsx)(u.ZP,{item:!0,xs:12,children:(0,i.jsx)(p.Z,{variant:"outlined",color:"primary",onClick(){ea({id:null,dataInicio:new Date}),W()},startIcon:(0,i.jsx)(S.Z,{icon:"material-symbols:add-circle-outline-rounded"}),children:"Inserir Profissional"})})]})})})]}),(0,i.jsx)(m.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+q.title,openModal:y,handleClose:()=>T(!1),handleSubmit:K,btnCancel:!0,btnConfirm:!0})]})};t.Z=P},50287:function(e,t,a){var i=a(85893),s=a(79072),l=a(55343),o=a(67836),n=a(87536),r=a(62097),d=a(67294),u=a(64165);let c=e=>{let{xs:t,md:a,title:c,required:p,disabled:v,type:f,value:m,name:x,typeValidation:D,errors:h,alertRequired:g,control:j}=e,Z=(0,r.Z)(),[I,b]=(0,d.useState)({}),[S,w]=(0,d.useState)(null);(0,d.useEffect)(()=>{D&&m&&P(D,x,m)},[D,m,x]);let C=e=>{let t=new Date(e+"T00:00:00"),a=t.getUTCDate().toString().padStart(2,"0"),i=(t.getUTCMonth()+1).toString().padStart(2,"0"),s=t.getUTCFullYear();return"".concat(s,"-").concat(i,"-").concat(a)},P=(e,t,a,i)=>{let s=new Date(a+"T00:00:00"),l=(0,u.HD)(e,s,i);b(e=>({...e,[t]:l}))},y=e=>{let t=new Date,a=new Date(e+"T00:00:00");return"dataAtual"===D&&a.toDateString()!==t.toDateString()?(w("A data deve ser a data atual"),!1):"dataPassado"===D&&a>=t?(w("A data deve ser do passado"),!1):"dataFutura"===D&&a<=t?(w("A data deve ser do futuro"),!1):(w(null),!0)};return(0,i.jsx)(s.ZP,{item:!0,xs:t,md:a,sx:{my:1},children:(0,i.jsx)(l.Z,{fullWidth:!0,children:(0,i.jsx)(n.Qr,{name:x,control:j,rules:{required:p},render(e){let{field:t}=e;return(0,i.jsx)(o.Z,{type:null!=f?f:"date",size:"small",label:c,disabled:!!v,defaultValue:m?C(m):"",error:!!h||!!S,helperText:S,onChange(e){let a=e.target.value;y(a)&&(t.onChange(a),D&&P(D,x,a))},variant:"outlined",fullWidth:!0,InputLabelProps:{shrink:!0},inputProps:{min:"dataFutura"===D?new Date().toISOString().split("T")[0]:void 0,max:"dataPassado"===D?new Date().toISOString().split("T")[0]:new Date(new Date().setFullYear(new Date().getFullYear()+50)).toISOString().split("T")[0]},sx:{...g&&!(null==t?void 0:t.value)&&{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:Z.palette.error.main},"&:hover fieldset":{borderColor:Z.palette.error.main},"&.Mui-focused fieldset":{borderColor:Z.palette.error.main}},"& .MuiInputLabel-root":{color:Z.palette.error.main},"& .MuiInputLabel-root.Mui-focused":{color:Z.palette.error.main}}}})}})})})};t.Z=c}}]);