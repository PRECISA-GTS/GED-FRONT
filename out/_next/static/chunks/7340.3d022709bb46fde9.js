"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7340],{17340:function(e,t,s){s.d(t,{Z:function(){return T}});var a=s(85893),o=s(11163),n=s.n(o),i=s(67294),l=s(60565),r=s(83830),d=s(60664),c=s(49837),u=s(91359),m=s(79072),x=s(44373),h=s(87536),f=s(86501),p=s(47842),v=s(45061),j=s(65698),g=s(71798),Z=s(29308),b=s(84220),y=s(21609);s(67569);var D=s(40039),C=s(29630),I=s(61953),S=s(54225),w=s(3893),k=s(88475);let F=e=>{let{data:t,index:s,indexAnexo:o,handleRemoveAnexo:n,form:i}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z.Z,{xs:12,md:9,title:"Nome",name:"fields.opcoes[".concat(s,"].anexos[").concat(o,"].nome"),required:!0,form:i}),(0,a.jsx)(w.Z,{xs:6,md:2,title:"Obrigat\xf3rio",name:"fields.opcoes[".concat(s,"].anexos[").concat(o,"].obrigatorio"),value:t.obrigatorio,form:i}),(0,a.jsx)(k.Z,{xs:6,md:1,title:0==o?"Remover":"",index:s,removeItem:()=>n(t,s,o),item:t,pending:!1,textSuccess:"Remover este anexo",textError:"Este anexo n\xe3o pode mais ser removido pois possui v\xednculo atrelado a ele"})]})};s(74865);let A=e=>{let{data:t,addAnexo:s,register:o,handleRemoveAnexo:n,form:l}=e,[r,d]=(0,i.useState)(!1),[x,h]=(0,i.useState)((()=>{let e=[];return t&&t.map(t=>{e.push(1==t.anexo)}),e})()),f=e=>{let t=[...x];t[e]=!t[e],h(t)};return t&&t.map((e,t)=>(0,a.jsx)(c.Z,{sx:{mt:3},children:(0,a.jsxs)(u.Z,{children:[(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C.Z,{variant:"h6",sx:{my:3},children:(0,a.jsxs)(I.Z,{display:"flex",alignItems:"center",sx:{gap:2},children:[(0,a.jsx)(y.Z,{icon:"akar-icons:edit"}),(0,a.jsx)("p",{children:e.nome})]})}),(0,a.jsxs)(I.Z,{display:"flex",alignItems:"center",sx:{gap:4},children:[(0,a.jsx)(I.Z,{children:(0,a.jsx)(w.Z,{title:"Solicita anexo",name:"fields.opcoes[".concat(t,"].anexo"),onClick:()=>f(t),value:e.anexo,form:l})}),(0,a.jsx)(I.Z,{children:(0,a.jsx)(w.Z,{title:"Gera N\xe3o Conformidade (NC)",name:"fields.opcoes[".concat(t,"].bloqueiaFormulario"),value:e.bloqueiaFormulario,form:l,helpText:"Se marcada esta resposta, bloqueia a aprova\xe7\xe3o do formul\xe1rio e obrigatoriamente gera uma n\xe3o conformidade (Plano de a\xe7\xe3o)"})}),(0,a.jsx)(I.Z,{children:(0,a.jsx)(w.Z,{title:"Observa\xe7\xe3o",name:"fields.opcoes[".concat(t,"].observacao"),value:e.observacao,form:l})})]})]}),x[t]&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C.Z,{variant:"body1",sx:{my:3},children:"Anexos do item"}),(0,a.jsx)(m.ZP,{container:!0,spacing:4,children:e.anexos.map((e,s)=>(0,a.jsx)(F,{index:t,indexAnexo:s,data:e,handleRemoveAnexo:n,form:l},r))}),(0,a.jsx)(I.Z,{sx:{mt:3},children:(0,a.jsx)(S.Z,{type:"button",variant:"outlined",startIcon:(0,a.jsx)(y.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick:()=>s(t),children:"Inserir"})})]})]})}))};var E=s(41088),P=s(19604);let N=e=>{let{data:t}=e,s=n(),{setId:o}=(0,i.useContext)(r.X),l=(e,t)=>{s.push(t),o(e)};return t&&t.length>0&&(0,a.jsx)(c.Z,{className:"mt-2",children:(0,a.jsxs)(u.Z,{children:[(0,a.jsxs)(C.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700,mb:6},className:"flex items-center gap-1",children:[(0,a.jsx)(y.Z,{icon:"clarity:form-line",className:"text-primary"}),"Formul\xe1rios que cont\xe9m este item"]}),t.map((e,t)=>(0,a.jsx)(P.Z,{severity:"info",onClick:()=>l(e.id,e.rota),sx:{mt:2,cursor:"pointer"},children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["".concat(e.nome," (ciclo de ").concat(e.ciclo," ").concat(1===e.ciclo?"dia":"dias",") (").concat(e.status,")"),(0,a.jsx)(y.Z,{icon:"ci:external-link"})]})},t))]})})},q=e=>{var t,s,o,y,C,I,S,w,k,F,P;let{id:q,btnClose:T,handleModalClose:V,setNewChange:O,newChange:_,outsideID:z,modal:R,handleConfirmNew:M,manualUrl:$}=e,[U,W]=(0,i.useState)(!1),[X,G]=(0,i.useState)(!1),[H,K]=(0,i.useState)(!1),[L,B]=(0,i.useState)(!1),[J,Q]=(0,i.useState)(null),Y=n(),ee=q&&q>0?"edit":"new",et=Y.pathname,{title:es}=(0,i.useContext)(l.f),{setId:ea}=(0,i.useContext)(r.X),{loggedUnity:eo,user:en}=(0,i.useContext)(D.V),{startLoading:ei,stopLoading:el}=(0,E.Z)(),er=null!==(P=Y.pathname.split("/")[3])&&void 0!==P?P:"item";console.log("\uD83D\uDE80 ~ formType:",er);let ed=(0,h.cI)({mode:"onChange"}),ec=async e=>{ei();let t={...e,usuarioID:en.usuarioID,unidadeID:eo.unidadeID};try{"new"===ee?await d.h.post("cadastros/item/new/insertData",t).then(e=>{z?(ea(z),M(e.data)):(Y.push("".concat((0,g.g_)(et))),ea(e.data)),f.ZP.success(g.OD.successNew)}):"edit"===ee&&(await d.h.post("/cadastros/item/updateData/".concat(q),t),f.ZP.success(g.OD.successUpdate),eh()),setSavingForm(!savingForm)}catch(s){s.response&&409===s.response.status?f.ZP.error(g.OD.errorRepeated):console.log(s)}finally{el()}},eu=async()=>{try{await d.h.delete("cadastros/item/".concat(q,"/").concat(en.usuarioID,"/").concat(eo.unidadeID)),ea(null),W(!1),f.ZP.success(g.OD.successDelete)}catch(e){e.response&&409===e.response.status?(f.ZP.error(g.OD.pendingDelete),W(!1)):console.log(e)}},em=async()=>{try{await d.h.post("cadastros/item/inactivate/".concat(q),{usuarioID:en.usuarioID,unidadeID:eo.unidadeID}),G(!1),f.ZP.success("Dado inativado com sucesso!")}catch(e){console.log(e)}finally{B(!L)}},ex=async()=>{try{await d.h.post("cadastros/item/activate/".concat(q),{usuarioID:en.usuarioID,unidadeID:eo.unidadeID}),K(!1),f.ZP.success("Dado ativado com sucesso!")}catch(e){console.log(e)}finally{B(!L)}},eh=async()=>{try{await d.h.post("new"===ee?"cadastros/item/new/getData":"cadastros/item/getData/".concat(q),{type:er}).then(e=>{console.log("\uD83D\uDE80 ~ formType response.data:",e.data),Q(e.data),console.log("\uD83D\uDE80 ~ getData:",e.data),ed.reset(e.data)})}catch(e){console.log(e)}},ef=e=>{let t=[...ed.getValues("fields.opcoes")];t[e].anexos.push({nome:"",obrigatorio:!1});let s={...J,fields:{...J.fields,opcoes:t}};Q(s),ed.setValue("fields.opcoes",t)},ep=async e=>{try{let t=await d.h.post("cadastros/item/getAlternatives",{alternativa:e});t.data&&(ed.setValue("fields.opcoes",t.data),Q({...J,fields:{...J.fields,opcoes:t.data}}))}catch(s){console.log(s)}},ev=(e,t,s)=>{let a=[...ed.getValues("fields.opcoes")];a[t].anexos.splice(s,1);let o={...J,fields:{...J.fields,opcoes:a}};Q(o),ed.setValue("fields.opcoes",a),B(!L)};return(0,i.useEffect)(()=>{eh(),setTimeout(()=>{ed.trigger()},300)},[q,L]),(0,i.useEffect)(()=>{_&&handleSubmit(ec)()},[_]),(0,a.jsxs)(a.Fragment,{children:[!J&&(0,a.jsx)(p.Z,{}),J&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("form",{onSubmit:ed.handleSubmit(ec),id:"formItem",children:[(0,a.jsx)(j.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,disabled:J.fields.pending,manualUrl:$,btnClose:T,handleModalClose:V,handleSubmit:()=>ed.handleSubmit(ec),btnDelete:"edit"===ee&&!J.fields.pending,onclickDelete:()=>W(!0),type:ee,modal:R,outsideID:z,btnInactivate:"edit"===ee&&!!J.fields.pending&&1===J.fields.status,onClickInactivate:()=>G(!0),btnActivate:"edit"===ee&&0===J.fields.status,onClickActivate:()=>K(!0)}),(0,a.jsx)(c.Z,{children:(0,a.jsx)(u.Z,{children:(0,a.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(b.Z,{xs:12,md:12,title:"Formul\xe1rios",name:"fields.formulario",value:null==J?void 0:null===(t=J.fields)||void 0===t?void 0:t.formulario,required:!0,options:null==J?void 0:null===(s=J.fields)||void 0===s?void 0:s.opcoesForm,disabled:"novo"!==er&&"item"!==er,form:ed}),(0,a.jsx)(Z.Z,{xs:12,md:12,title:"Nome",name:"fields.nome",required:!0,form:ed}),(0,a.jsx)(b.Z,{xs:12,md:12,title:"Alternativa",name:"fields.alternativa",value:null==J?void 0:null===(o=J.fields)||void 0===o?void 0:o.alternativa,onChange:ep,required:!0,options:null==J?void 0:null===(y=J.fields)||void 0===y?void 0:null===(C=y.alternativa)||void 0===C?void 0:C.opcoes,form:ed}),(0,a.jsx)(Z.Z,{xs:12,md:12,multiline:!0,rows:3,title:"Ajuda do item (mostrado em (?))",name:"fields.ajuda",form:ed}),(0,a.jsx)(x.Z,{})]})})})]}),(0,a.jsx)(A,{data:null==J?void 0:null===(I=J.fields)||void 0===I?void 0:I.opcoes,handleRemoveAnexo:ev,addAnexo:ef,form:ed},L),(0,a.jsx)(N,{data:J.fields.models})]}),(0,a.jsx)(v.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+es.title,openModal:U,handleClose:()=>W(!1),handleSubmit:eu,btnCancel:!0,btnConfirm:!0}),(0,a.jsx)(v.Z,{title:"Inativar "+es.title,text:'<span class="text-red-500">Este item est\xe1 presente em '.concat(null==J?void 0:null===(S=J.fields)||void 0===S?void 0:null===(w=S.models)||void 0===w?void 0:w.length," ").concat((null==J?void 0:null===(k=J.fields)||void 0===k?void 0:null===(F=k.models)||void 0===F?void 0:F.length)===1?"modelo":"modelos",".</span><br/> Tem certeza que deseja inativar?"),openModal:X,handleClose:()=>G(!1),handleSubmit:em,btnCancel:!0,btnConfirm:!0}),(0,a.jsx)(v.Z,{title:"Ativar "+es.title,text:"Tem certeza que deseja ativar?",openModal:H,handleClose:()=>K(!1),handleSubmit:ex,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary"})]})};var T=q},45061:function(e,t,s){var a=s(85893),o=s(54225),n=s(1890),i=s(77745),l=s(95398),r=s(76779),d=s(44642);s(21609);var c=s(19604),u=s(29630),m=s(55343),x=s(67836),h=s(67294),f=s(82747);s(84220),s(29308),s(67569),s(3893),s(88475);let p=e=>{let{title:t,text:s,handleClose:p,openModal:v,handleSubmit:j,cnpj:g,nomeFornecedor:Z,gruposAnexo:b,email:y,setEmail:D,inputEmail:C,btnCancel:I,btnConfirm:S,grupoAnexosFornecedor:w,btnCancelColor:k,btnConfirmColor:F,closeAfterSave:A,listErrors:E}=e,[P,N]=(0,h.useState)(!1);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(n.Z,{open:v,"aria-labelledby":"form-dialog-title",disableEscapeKeyDown:!0,onClose(e,t){"backdropClick"!==t&&p()},children:[(0,a.jsx)(i.Z,{id:"form-dialog-title",children:t}),(0,a.jsxs)(l.Z,{children:[(0,a.jsxs)(d.Z,{sx:{mb:3},children:[(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:s}}),E&&E.status&&(0,a.jsxs)(c.Z,{variant:"outlined",severity:"error",sx:{mt:2},children:["Por favor, verifique os campos abaixo:",(0,a.jsx)(u.Z,{variant:"subtitle1",color:"error",sx:{mt:2},children:E.errors.map((e,t)=>(0,a.jsxs)(u.Z,{variant:"body2",color:"error",children:["- ",e]},t))})]})]}),C&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(m.Z,{sx:{mt:2},fullWidth:!0,children:[(0,a.jsx)(x.Z,{defaultValue:"",type:"email",label:"E-mail do Fornecedor (opcional)",placeholder:"E-mail do Fornecedor (opcional)","aria-describedby":"validation-schema-nome",name:"email",error:(null==y?void 0:y.length)>0&&P,inputProps:{onChange(e){D(e.target.value),N(!(0,f.dI)(e.target.value))}}}),(null==y?void 0:y.length)>0&&P&&(0,a.jsx)(u.Z,{variant:"body2",color:"error",children:"Por favor, insira um e-mail v\xe1lido!"})]}),(0,a.jsx)(c.Z,{severity:"info",sx:{mt:2},children:"Se o e-mail for preenchido, o mesmo receber\xe1 as instru\xe7\xf5es de cadastro e preenchimento do formul\xe1rio no e-mail."})]})]}),(0,a.jsxs)(r.Z,{className:"dialog-actions-dense",children:[I&&(0,a.jsx)(o.Z,{variant:"outlined",color:"primary",onClick:p,children:"Cancelar"}),S&&(0,a.jsx)(o.Z,{variant:"contained",disabled:C&&(null==y?void 0:y.length)>0&&P||E&&E.status,color:F||"error",onClick:C&&g?()=>{j(g,Z,b,y),A&&p()}:C&&!g?()=>{j(y),A&&p()}:()=>{j(),A&&p()},children:"Confirmar"})]})]})})};t.Z=p},67569:function(e,t,s){var a=s(85893),o=s(79072),n=s(61953),i=s(29630),l=s(22841),r=s(75158),d=s(53934);let c=e=>{let{form:t,xs:s,md:c,title:u,index:m,name:x,typePage:h,value:f,edit:p,className:v,helpText:j}=e;return(0,a.jsxs)(o.ZP,{item:!0,xs:s,md:c,className:v,children:[(0,a.jsxs)(n.Z,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,a.jsx)(i.Z,{variant:"caption",children:m&&0!=m?"":u}),(0,a.jsx)(l.Z,{control:(0,a.jsx)(r.Z,{size:"small",sx:{ml:4},...t.register(x),defaultChecked:!0==f||1==f||"new"==h,onChange(e){p&&t.setValue(p,!0)}})})]}),j&&(0,a.jsx)("div",{children:(0,a.jsx)(d.Z,{text:j,position:"top"})})]})};t.Z=c},88475:function(e,t,s){var a=s(85893),o=s(79072),n=s(61953),i=s(29630),l=s(17575),r=s(80562),d=s(21609);let c=e=>{let{xs:t,md:s,icon:c,color:u,title:m,removeItem:x,item:h,pending:f,index:p,textSuccess:v,textError:j}=e;return v=v||"Remover este item",j=j||"Este item n\xe3o pode ser removido pois possui cadastros vinculados a ele",(0,a.jsx)(o.ZP,{item:!0,xs:t,md:s,children:(0,a.jsxs)(n.Z,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,a.jsx)(i.Z,{variant:"caption",children:m}),(0,a.jsx)(l.Z,{title:1==f?j:v,children:(0,a.jsx)(r.Z,{color:null!=u?u:"error",size:"small",onClick(){1!=f&&x(h,p)},sx:{opacity:1==f?.5:1,cursor:1==f?"default":"pointer"},children:(0,a.jsx)(d.Z,{icon:null!=c?c:"tabler:trash-filled"})})})]})})};t.Z=c},82747:function(e,t,s){function a(e){if(!e||14!==(e=null==e?void 0:e.replace(/[^\d]+/g,"")).length||/^(\d)\1+$/.test(e))return!1;let t=e.length-2,s=e.substring(0,t),a=e.substring(t),o=0,n=t-7;for(let i=t;i>=1;i--)o+=s.charAt(t-i)*n--,n<2&&(n=9);let l=o%11<2?0:11-o%11;if(l!=a.charAt(0))return!1;t+=1,s=e.substring(0,t),o=0,n=t-7;for(let r=t;r>=1;r--)o+=s.charAt(t-r)*n--,n<2&&(n=9);return(l=o%11<2?0:11-o%11)==a.charAt(1)}function o(e){let t;if(!e||11!==(e=e.replace(/[^\d]+/g,"")).length||/^(\d)\1+$/.test(e))return!1;let s=0;for(let a=1;a<=9;a++)s+=parseInt(e.substring(a-1,a))*(11-a);if((10==(t=10*s%11)||11===t)&&(t=0),t!==parseInt(e.substring(9,10)))return!1;s=0;for(let o=1;o<=10;o++)s+=parseInt(e.substring(o-1,o))*(12-o);return(10==(t=10*s%11)||11===t)&&(t=0),t===parseInt(e.substring(10,11))}function n(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}s.d(t,{dI:function(){return n},sw:function(){return o},zk:function(){return a}})}}]);