(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{49857:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/configuracoes/produtos",function(){return s(82557)}])},46124:function(e,t,s){"use strict";var a=s(85893),n=s(11163),o=s.n(n),i=s(67294),r=s(60664),d=s(49837),c=s(91359),l=s(79072),u=s(87536),h=s(86501),m=s(45061),x=s(64165),f=s(86887),p=s(47842),g=s(60565),w=s(83830),D=s(40039),v=s(29308),b=s(67569);let j=e=>{var t,s;let{id:n}=e,[j,C]=(0,i.useState)(!1),[S,Z]=(0,i.useState)(null),{setId:P}=(0,i.useContext)(w.X),N=o(),_=n&&n>0?"edit":"new",y=N.pathname,{title:I}=(0,i.useContext)(g.f),{loggedUnity:M}=(0,i.useContext)(D.V),{trigger:z,handleSubmit:O,reset:E,control:k,formState:{errors:T},register:R}=(0,u.cI)(),H=async e=>{let t={fields:{...e.fields,unidadeID:M.unidadeID}};try{"new"===_?await r.h.post("".concat((0,x.g_)(y),"/new/insertData"),t).then(e=>{N.push("".concat((0,x.g_)(y))),P(e.data),h.ZP.success(x.OD.successNew)}):"edit"===_&&(await r.h.post("".concat(y,"/updateData/").concat(n),e),h.ZP.success(x.OD.successUpdate))}catch(s){s.response&&409===s.response.status?h.ZP.error(x.OD.errorRepeated):console.log(s)}},F=async()=>{try{await r.h.delete("".concat(y,"/").concat(n)),P(null),C(!1),h.ZP.success(x.OD.successDelete)}catch(e){e.response&&409===e.response.status?(h.ZP.error(x.OD.pendingDelete),C(!1)):console.log(e)}},X=async()=>{"new"==_&&Z({fields:{nome:"",status:1}});try{let e="new"===_?"".concat((0,x.g_)(y),"/new/getData"):"".concat(y,"/getData/").concat(n);await r.h.post(e,{id:n}).then(e=>{Z(e.data),E(e.data)})}catch(t){console.log(t)}};return(0,i.useEffect)(()=>{X(),"new"===_&&setTimeout(()=>{z()},300)},[n]),(0,a.jsxs)(a.Fragment,{children:[!S&&(0,a.jsx)(p.Z,{}),S&&(0,a.jsx)(d.Z,{children:(0,a.jsxs)("form",{onSubmit:O(H),children:[(0,a.jsx)(f.Z,{btnCancel:!0,btnSave:!0,handleSubmit:()=>O(H),btnDelete:"edit"===_,onclickDelete:()=>C(!0),type:_}),(0,a.jsx)(c.Z,{children:(0,a.jsxs)(l.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(v.Z,{xs:12,md:8,title:"Nome",name:"fields.nome",required:!0,control:k,errors:null==T?void 0:null===(t=T.fields)||void 0===t?void 0:t.nome}),(0,a.jsx)(v.Z,{xs:12,md:3,title:"Unidade de Medida",name:"fields.unidadeMedida",required:!0,control:k,errors:null==T?void 0:null===(s=T.fields)||void 0===s?void 0:s.unidadeMedida}),(0,a.jsx)(b.Z,{xs:2,md:1,title:"Ativo",name:"fields.status",value:null==S?void 0:S.fields.status,typePage:_,register:R})]})})]})}),(0,a.jsx)(m.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+I.title,openModal:j,handleClose:()=>C(!1),handleSubmit:F,btnCancel:!0,btnConfirm:!0})]})};t.Z=j},82557:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return S}});var a=s(85893),n=s(67294),o=s(60664),i=s(49837),r=s(91359),d=s(18104),c=s(75680),l=s(78082),u=s(30944);let h=e=>{let{rows:t,columns:s,buttonsHeader:n,selectedRows:o,setSelectedRows:i,hasChange:r,setHasChange:h}=e,{handleSearch:m,pageSize:x,setPageSize:f,searchText:p,filteredData:g,setData:w,data:D}=(0,u.L0)();return w(t),(0,a.jsx)(d._,{localeText:c.F.components.MuiDataGrid.defaultProps.localeText,checkboxSelection:!0,autoHeight:!0,columns:s,pageSize:x,rowsPerPageOptions:[10,20,30,40,50,100],components:{Toolbar:l.Z},rows:p?g:D,onCellClick(e,t){i(t=>-1===t.indexOf(e.id)?[...t,e.id]:t.filter(t=>t!==e.id)),h(!0)},onPageSizeChange:e=>f(e),selectionModel:o,onSelectionModelChange(e){i(e),h(!0)},sx:{"& .MuiDataGrid-cell":{cursor:"pointer",overflow:"scroll"}},componentsProps:{toolbar:{value:p,clearSearch:()=>m(""),onChange:e=>m(e.target.value),buttonsHeader:n,hasChange:r}}})},m=e=>{let{result:t,columns:s,btnNew:n=!0,btnPrint:o=!0,btnSave:d=!0,handleSave:c,selectedRows:l,setSelectedRows:u,hasChange:m,setHasChange:x,openModal:f}=e;return(0,a.jsx)(i.Z,{children:(0,a.jsx)(r.Z,{sx:{pt:"0"},children:(0,a.jsx)(h,{rows:t,columns:s,buttonsHeader:{btnNew:n,btnPrint:o,btnSave:d,handleSave:c,openModal:f},selectedRows:l,setSelectedRows:u,hasChange:m,setHasChange:x})})})};var x=s(46124),f=s(60565),p=s(83830),g=s(40039),w=s(47842),D=s(11163),v=s(64165),b=s(19604),j=s(86501);let C=()=>{let[e,t]=(0,n.useState)(null),s=(0,D.useRouter)(),i=s.pathname,{setTitle:r}=(0,n.useContext)(f.f),{user:d,loggedUnity:c}=(0,n.useContext)(g.V),{id:l}=(0,n.useContext)(p.X),u=async()=>{await o.h.post(i,{unidadeID:c.unidadeID}).then(e=>{t(e.data),r({title:"Produtos",subtitle:{id:l,count:e.data.length,new:!1}})})},h=async()=>{await o.h.post("".concat(i,"/updateData"),{unidadeID:c.unidadeID,usuarioID:d.usuarioID,products:S}).then(e=>{N(!1),j.Am.success("Dados atualizados com sucesso!"),u()})};(0,n.useEffect)(()=>{u()},[l]);let C=()=>e?e.filter(e=>1===e.checked).map(e=>e.id):[],[S,Z]=(0,n.useState)(C()),[P,N]=(0,n.useState)(!1);(0,n.useEffect)(()=>{e&&Z(C())},[e]);let _=(0,v.OL)(i,[{headerName:"ID",field:"id",size:.1},{headerName:"ID MP",field:"idMinisterio",size:.1},{headerName:"Nome",field:"nome",size:.6},{headerName:"Descri\xe7\xe3o",field:"descricao",size:.2},{headerName:"Categoria",field:"categoria",size:.2},{headerName:"Status",field:{name:"status",cor:"cor"},size:.1}]);return(0,a.jsx)(a.Fragment,{children:e?l&&l>0?(0,a.jsx)(x.Z,{id:l}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{severity:"info",sx:{mb:2},children:"Somente os produtos marcados ficar\xe3o dispon\xedveis para uso nesta unidade."}),(0,a.jsx)(b.Z,{severity:"warning",sx:{mb:2},children:"Produtos j\xe1 vinculados em outros registros o sistema n\xe3o permitir\xe1 desmarcar."}),(0,a.jsx)(m,{result:e,columns:_,btnNew:!1,btnPrint:!1,btnSave:!0,handleSave:h,selectedRows:S,setSelectedRows:Z,hasChange:P,setHasChange:N})]}):(0,a.jsx)(w.Z,{})})};C.acl={action:"read",subject:"acl-page"};var S=C}},function(e){e.O(0,[4738,5206,6887,5061,8428,9774,2888,179],function(){return e(e.s=49857)}),_N_E=e.O()}]);