(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3191],{55867:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/configuracoes/versao",function(){return a(27574)}])},25576:function(e,t,a){"use strict";var s=a(85893),n=a(11163),l=a.n(n),r=a(67294),i=a(60664),o=a(49837),d=a(91359),c=a(79072),u=a(80562),m=a(54225),x=a(87536),p=a(86501),f=a(45061),h=a(86887),v=a(64165),j=a(60565),Z=a(83830),g=a(40039),D=a(29308),b=a(50287),I=a(41088),w=a(21609);let S=e=>{var t,a;let{id:n}=e,[S,C]=(0,r.useState)(!1),[P,N]=(0,r.useState)(null),{setId:y}=(0,r.useContext)(Z.X),k=l(),T=n&&n>0?"edit":"new",F=k.pathname,{title:O}=(0,r.useContext)(j.f),{loggedUnity:_,user:E}=(0,r.useContext)(g.V),{startLoading:L,stopLoading:z}=(0,I.Z)(),{trigger:q,handleSubmit:M,reset:V,control:A,formState:{errors:Q},register:U}=(0,x.cI)({mode:"onChange"}),W=async e=>{let t={...e,usuarioID:E.usuarioID,unidadeID:_.unidadeID};try{"new"===T?await i.h.post("configuracoes/versao/new/insertData",t).then(e=>{k.push("".concat((0,v.g_)(F))),y(e.data.id),p.ZP.success(v.OD.successNew)}):"edit"===T&&(await i.h.post("".concat(F,"/updateData/").concat(n),t),p.ZP.success(v.OD.successUpdate))}catch(a){a.response&&409===a.response.status?p.ZP.error(v.OD.errorRepeated):console.log(a)}finally{z()}},X=async()=>{try{await i.h.delete("".concat(F,"/").concat(n,"/").concat(E.usuarioID,"/").concat(_.unidadeID)),y(null),C(!1),p.ZP.success(v.OD.successDelete)}catch(e){e.response&&409===e.response.status?(p.ZP.error(v.OD.pendingDelete),C(!1)):console.log(e)}},Y=async()=>{try{if("edit"===T)await i.h.post("".concat(F,"/getData/").concat(n),{id:n}).then(e=>{N(e.data),V(e.data)});else{let e=new Date().toISOString().substring(0,10);N({fields:{nome:"",data:e,items:[]}}),V({...P,fields:{...P.fields,data:e}})}}catch(t){console.log(t)}};(0,r.useEffect)(()=>{Y(),H({versaoItemID:null,descricao:"",link:""}),setTimeout(()=>{q()},300)},[n]);let{fields:B,append:H,remove:R}=(0,x.Dq)({control:A,name:"fields.items"}),G=e=>{if(1===B.length){p.ZP.error("A vers\xe3o deve conter pelo menos um item!");return}R(e)};return(0,s.jsxs)(s.Fragment,{children:[P&&(0,s.jsxs)("form",{onSubmit:M(W),children:[(0,s.jsx)(h.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,handleSubmit:()=>M(W),btnDelete:"edit"===T,onclickDelete:()=>C(!0),type:T}),(0,s.jsx)(o.Z,{children:(0,s.jsx)(d.Z,{children:(0,s.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,s.jsx)(D.Z,{xs:12,md:8,title:"Nome",name:"fields.nome",required:!0,control:A,errors:null==Q?void 0:null===(t=Q.fields)||void 0===t?void 0:t.nome}),(0,s.jsx)(b.Z,{xs:12,md:4,title:"Data",name:"fields.data",value:null==P?void 0:P.fields.data,register:U,control:A,errors:null==Q?void 0:null===(a=Q.fields)||void 0===a?void 0:a.data}),(0,s.jsx)(c.ZP,{item:!0,xs:12,children:(0,s.jsxs)("div",{className:"flex items-center gap-2 pb-1 pt-2",children:[(0,s.jsx)("div",{className:"",children:(0,s.jsx)(w.Z,{icon:"ph:code-bold",className:"text-3xl"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,s.jsx)("p",{className:"text-xl",children:"Itens da vers\xe3o"}),(0,s.jsx)("p",{className:"opacity-50",children:"Descreva abaixo as implementa\xe7\xf5es, corre\xe7\xf5es e melhorias realizadas, opcionalmente \xe9 poss\xedvel inserir links para uma melhor demonstra\xe7\xe3o. Estas descri\xe7\xf5es ficar\xe3o dispon\xedveis para todos os clientes."})]})]})}),B.map((e,t)=>{var a,n,l;return(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)("input",{type:"hidden",name:"fields.items[".concat(t,"].versaoItemID"),value:e.versaoItemID}),(0,s.jsx)(D.Z,{xs:12,md:8,title:"Descri\xe7\xe3o",name:"fields.items[".concat(t,"].descricao"),required:!0,control:A,errors:null==Q?void 0:null===(a=Q.fields)||void 0===a?void 0:null===(n=a.items)||void 0===n?void 0:null===(l=n[t])||void 0===l?void 0:l.descricao}),(0,s.jsx)(D.Z,{xs:12,md:3,title:"Link (opcional)",name:"fields.items[".concat(t,"].link"),control:A}),(0,s.jsx)(c.ZP,{item:!0,xs:12,md:1,className:"flex items-center",children:(0,s.jsx)(u.Z,{color:"error",size:"small",onClick:()=>G(t),children:(0,s.jsx)(w.Z,{icon:"tabler:trash-filled"})})})]},e.id)}),(0,s.jsx)(c.ZP,{item:!0,xs:12,children:(0,s.jsx)(m.Z,{variant:"outlined",color:"primary",onClick:()=>H({descricao:"",link:""}),startIcon:(0,s.jsx)(w.Z,{icon:"material-symbols:add-circle-outline-rounded"}),children:"Inserir Item"})})]})})})]}),(0,s.jsx)(f.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+O.title,openModal:S,handleClose:()=>C(!1),handleSubmit:X,btnCancel:!0,btnConfirm:!0})]})};t.Z=S},93250:function(e,t,a){"use strict";var s=a(85893),n=a(49837),l=a(91359),r=a(69175);let i=e=>{let{result:t,columns:a,btnNew:i=!0,btnPrint:o=!0,btnBack:d,openModal:c,modalLog:u}=e;return(0,s.jsx)(n.Z,{children:(0,s.jsx)(l.Z,{sx:{pt:"0"},children:(0,s.jsx)(r.Z,{rows:t,columns:a,modalLog:u,buttonsHeader:{btnNew:i,btnPrint:o,btnBack:d,openModal:c}})})})};t.Z=i},46905:function(e,t,a){"use strict";var s=a(85893),n=a(87536),l=a(79072),r=a(55343),i=a(67836);let o=e=>{let{xs:t,md:a,title:o,name:d,disabled:c,required:u,form:m,onChange:x}=e;return(0,s.jsx)(l.ZP,{item:!0,xs:t,md:a,children:(0,s.jsx)("div",{children:(0,s.jsx)(r.Z,{fullWidth:!0,children:(0,s.jsx)(n.Qr,{name:d,control:m.control,rules:{required:u},render(e){let{field:t}=e;return(0,s.jsx)(i.Z,{label:o,value:null==t?void 0:t.value,placeholder:o,type:"date",size:"small","aria-describedby":"validation-schema-nome",disabled:c,error:!!m.formState.errors[d],onChange(e){let a=e.target.value;t.onChange(a),x&&x(a)},InputLabelProps:{shrink:!0},inputProps:{min:"1900-01-01",max:"2100-01-01"}})}})})})})};t.Z=o},55148:function(e,t,a){"use strict";var s=a(85893),n=a(79072),l=a(55343),r=a(35966),i=a(67836),o=a(87536),d=a(53934),c=a(30944);let u=e=>{let{xs:t,md:a,title:u,options:m,form:x,name:p,limitTags:f,value:h,required:v,disabled:j,multiple:Z,onChange:g,className:D,keyProps:b,createNew:I,helpText:w,helpTextPosition:S}=e,C=I?[{id:null,name:"-- Novo --"},...null!=m?m:[]]:m,{key:P}=(0,c.L0)();return(0,s.jsx)(n.ZP,{item:!0,xs:t,md:a,sx:{my:1},className:D,children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.Z,{fullWidth:!0,children:(0,s.jsx)(o.Qr,{name:p,control:x.control,rules:{required:v},render(e){var t;let{field:a}=e;return(0,s.jsx)(r.Z,{options:C.map(e=>e.name),value:null!=h?h:null===(t=x.getValues(p))||void 0===t?void 0:t.name,onChange(e,t){let a=C.find(e=>e.name===t);x.setValue(p,null!=a?a:null),g&&g(t)},renderInput(e){var t;return(0,s.jsx)(i.Z,{...e,id:"customSelect",size:"small",label:u,placeholder:u,error:!!x.formState.errors[p],helperText:null===(t=x.formState.errors[p])||void 0===t?void 0:t.message})}},b||P)}})}),w&&(0,s.jsx)("div",{className:"absolute right-[60px] top-[12px] ",children:(0,s.jsx)(d.Z,{text:w,position:null!=S?S:"top"})})]})})};t.Z=u},50287:function(e,t,a){"use strict";var s=a(85893),n=a(79072),l=a(55343),r=a(67836),i=a(87536),o=a(62097),d=a(67294),c=a(64165);let u=e=>{let{xs:t,md:a,title:u,required:m,disabled:x,type:p,value:f,name:h,typeValidation:v,errors:j,alertRequired:Z,control:g,opacity:D}=e,b=(0,o.Z)(),[I,w]=(0,d.useState)({}),[S,C]=(0,d.useState)(null);(0,d.useEffect)(()=>{v&&f&&N(v,h,f)},[v,f,h]);let P=e=>{let t=new Date(e+"T00:00:00"),a=t.getUTCDate().toString().padStart(2,"0"),s=(t.getUTCMonth()+1).toString().padStart(2,"0"),n=t.getUTCFullYear();return"".concat(n,"-").concat(s,"-").concat(a)},N=(e,t,a,s)=>{let n=new Date(a+"T00:00:00"),l=(0,c.HD)(e,n,s);w(e=>({...e,[t]:l}))},y=e=>{let t=new Date,a=new Date(e+"T00:00:00");return"dataAtual"===v&&a.toDateString()!==t.toDateString()?(C("A data deve ser a data atual"),!1):"dataPassado"===v&&a>=t?(C("A data deve ser do passado"),!1):"dataFutura"===v&&a<=t?(C("A data deve ser do futuro"),!1):(C(null),!0)};return(0,s.jsx)(n.ZP,{item:!0,xs:t,md:a,sx:{my:1},children:(0,s.jsx)(l.Z,{fullWidth:!0,children:(0,s.jsx)(i.Qr,{name:h,control:g,rules:{required:m},render(e){let{field:t}=e;return(0,s.jsx)(r.Z,{type:null!=p?p:"date",size:"small",label:u,disabled:!!x,defaultValue:f?P(f):"",error:!!j||!!S,helperText:S,onChange(e){let a=e.target.value;y(a)&&(t.onChange(a),v&&N(v,h,a))},variant:"outlined",fullWidth:!0,InputLabelProps:{shrink:!0},inputProps:{min:"dataFutura"===v?new Date().toISOString().split("T")[0]:void 0,max:"dataPassado"===v?new Date().toISOString().split("T")[0]:new Date(new Date().setFullYear(new Date().getFullYear()+50)).toISOString().split("T")[0]},sx:{opacity:D?.4:1,"& .MuiInputBase-input":{padding:"10px 14px"},...Z&&!(null==t?void 0:t.value)&&{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:b.palette.error.main},"&:hover fieldset":{borderColor:b.palette.error.main},"&.Mui-focused fieldset":{borderColor:b.palette.error.main}},"& .MuiInputLabel-root":{color:b.palette.error.main},"& .MuiInputLabel-root.Mui-focused":{color:b.palette.error.main}}}})}})})})};t.Z=u},18443:function(e,t,a){"use strict";a.r(t);var s=a(85893),n=a(67294),l=a(46905),r=a(55148),i=a(51570),o=a(30944);let d=()=>{var e,t;let{form:a,setNames:d,filterDate:c,SelectFilterByName:u,data:m,setFilteredData:x,handleSearch:p,key:f,searchText:h}=(0,o.L0)(),{commonData:v}=(0,i.Lq)(),j=m,Z=async()=>{x(j=await p(j))};return(0,n.useEffect)(()=>{Z()},[f]),(0,n.useEffect)(()=>{d([])},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Z,{xs:12,md:6,title:"Data inicio da avaliac\xe3o",name:"dataInicio",form:a}),(0,s.jsx)(l.Z,{xs:12,md:6,title:"Data Fim da avalia\xe7\xe3o",name:"dataFim",form:a}),(0,s.jsx)(r.Z,{xs:12,md:6,title:"Quem preencheu",name:"quemPreenche",value:null===(e=a.getValues("quemPreenche"))||void 0===e?void 0:e.name,form:a,options:[{id:"1",name:"F\xe1brica"},{id:"2",name:"Fornecedor"}]}),(0,s.jsx)(r.Z,{xs:12,md:6,title:"Status",name:"status",form:a,options:v.status,value:null===(t=a.getValues("status"))||void 0===t?void 0:t.name})]})};t.default=d},27574:function(e,t,a){"use strict";a.r(t);var s=a(85893),n=a(67294),l=a(60664),r=a(93250),i=a(83830),o=a(60565),d=a(40039),c=a(47842),u=a(11163),m=a(64165),x=a(30944),p=a(18443),f=a(25576);let h=()=>{let e=(0,u.useRouter)(),{id:t}=(0,n.useContext)(i.X),a=e.pathname,{setTitle:h}=(0,n.useContext)(o.f),{loggedUnity:v}=(0,n.useContext)(d.V),{filteredData:j,setFilteredData:Z,setData:g,startFilter:D}=(0,x.L0)(),b=async()=>{await l.h.post(a,{unidadeID:v.unidadeID}).then(e=>{Z(e.data),g(e.data),h({title:"Vers\xe3o",subtitle:{id:t,count:e.data.length,new:!1}})})};(0,n.useEffect)(()=>{b(),D((0,s.jsx)(p.default,{}))},[t]);let I=(0,m.OL)(a,[{title:"ID",field:"id",size:.1},{title:"Data",field:"data",size:.2},{title:"Nome",field:"nome",size:.2},{title:"Itens",field:"itens",size:.5}]);return(0,s.jsx)(s.Fragment,{children:j?t&&t>0?(0,s.jsx)(f.Z,{id:t}):(0,s.jsx)(r.Z,{result:j,columns:I}):(0,s.jsx)(c.Z,{})})};t.default=h}},function(e){e.O(0,[4738,172,6887,5061,9525,9774,2888,179],function(){return e(e.s=55867)}),_N_E=e.O()}]);