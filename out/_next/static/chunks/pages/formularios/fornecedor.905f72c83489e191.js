(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7463],{59424:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/fornecedor",function(){return o(38496)}])},92024:function(e,a,o){"use strict";var t=o(85893),n=o(67294),r=o(44731),s=o(62097),i=o(41796),l=o(19550);let d=(0,n.forwardRef)((e,a)=>{let{sx:o,src:n,skin:d,color:c}=e,u=(0,s.Z)(),m=(0,l.Z)(),p=(e,a)=>"light"===e?{...m["".concat(a,"Light")]}:"light-static"===e?{color:m["".concat(a,"Light")].color,backgroundColor:(0,i.$n)(u.palette[a].main,.88)}:{...m["".concat(a,"Filled")]},x={primary:p(d,"primary"),secondary:p(d,"secondary"),success:p(d,"success"),error:p(d,"error"),warning:p(d,"warning"),info:p(d,"info")};return(0,t.jsx)(r.Z,{ref:a,...e,sx:!n&&d&&c?Object.assign(x[c],o):o})});d.defaultProps={skin:"filled",color:"primary"},a.Z=d},77993:function(e,a,o){"use strict";o.d(a,{Z:function(){return P}});var t=o(85893),n=o(11163),r=o.n(n),s=o(67294),i=o(60565),l=o(83830),d=o(40039),c=o(60664),u=o(49837),m=o(91359),p=o(79072),x=o(29630),f=o(54225),h=o(21609),g=o(87536),v=o(86501),j=o(45061),b=o(47842),Z=o(65698),D=o(71798),I=o(41088),y=o(84220),S=o(29308),C=o(67569),F=o(88475);let N=e=>{let{getValues:a,removeItem:o,form:n,type:r}=e;return a("items")&&a("items").map((e,a)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z,{xs:12,md:3,title:"Nome",name:"items[".concat(a,"].nome"),required:!0,form:n}),(0,t.jsx)(S.Z,{xs:12,md:6,title:"Descri\xe7\xe3o",name:"items[".concat(a,"].descricao"),required:!1,form:n}),(0,t.jsx)(C.Z,{xs:4,md:1,title:"Ativo",index:a,name:"items[".concat(a,"].status"),value:e.status,typePage:r,form:n}),(0,t.jsx)(C.Z,{xs:4,md:1,title:"Obrigat\xf3rio",index:a,name:"items[".concat(a,"].obrigatorio"),value:e.obrigatorio,typePage:r,form:n}),(0,t.jsx)(F.Z,{xs:4,md:1,title:"Remover",index:a,removeItem:o,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"})]}))},w=e=>{var a;let{id:o,btnClose:n,handleConfirmNew:F,handleModalClose:w,newChange:P,manualUrl:V,outsideID:E}=e,{setId:A}=(0,s.useContext)(l.X),z=r(),[R,k]=(0,s.useState)(null),[M,O]=(0,s.useState)(!1),T=o&&o>0?"edit":"new",q=z.pathname,{title:H}=(0,s.useContext)(i.f),{loggedUnity:$,user:L}=(0,s.useContext)(d.V),[B,_]=(0,s.useState)(!1),[G,W]=(0,s.useState)([]),[U,J]=(0,s.useState)(!1),{startLoading:Q,stopLoading:X}=(0,I.Z)(),Y=(0,g.cI)({mode:"onChange"}),K=async()=>{try{let e="new"===T?"cadastros/grupo-anexos/new/getData":"".concat(q,"/getData/").concat(o);await c.h.post(e,{unidadeID:$.unidadeID}).then(e=>{k(e.data),Y.reset(e.data)})}catch(a){console.log(a)}},ee=()=>{let e=[...Y.getValues("items"),{nome:"",descricao:"",status:!0,obrigatorio:!0}];Y.setValue("items",e),J(!U)},ea=(e,a)=>{if(1===R.items.length){v.ZP.error("\xc9 necess\xe1rio ter pelo menos um item!");return}e.id&&W([...G,e.id]);let o=getValues("items").filter((e,o)=>o!==a);Y.setValue("items",o),J(!U)},eo=async e=>{let a={...e,usuarioID:L.usuarioID,unidadeID:$.unidadeID};Q(),a.removedItems=G,a.unidade=$.unidadeID;try{"new"===T?await c.h.post("cadastros/grupo-anexos/new/insertData",a).then(e=>{F?F(e.data,"gruposAnexo"):(z.push("".concat((0,D.g_)(q))),A(e.data.id)),v.ZP.success(D.OD.successNew)}):"edit"===T&&(await c.h.post("".concat(q,"/updateData/").concat(o),a),v.ZP.success(D.OD.successUpdate)),_(!B)}catch(t){t.response&&409===t.response.status?v.ZP.error(D.OD.errorRepeated):console.log(t)}finally{X()}},et=async()=>{try{await c.h.delete("".concat(q,"/deleteData/").concat(o,"/").concat(L.usuarioID,"/").concat($.unidadeID)),A(null),setOpen(!1),v.ZP.success(D.OD.successDelete),console.log("entrou")}catch(e){e.response&&409===e.response.status?(v.ZP.error(D.OD.pendingDelete),O(!1)):console.log(e)}};return(0,s.useEffect)(()=>{K(),setTimeout(()=>{Y.trigger()},300)},[o]),(0,s.useEffect)(()=>{P&&Y.handleSubmit(eo)()},[P]),(0,t.jsxs)(t.Fragment,{children:[!R&&(0,t.jsx)(b.Z,{}),R&&(0,t.jsxs)("form",{onSubmit:Y.handleSubmit(eo),children:[(0,t.jsx)(Z.Z,{btnCancel:!0,btnNew:!F,btnSave:!0,manualUrl:V,btnClose:n,handleModalClose:w,handleSubmit:()=>Y.handleSubmit(eo),btnDelete:"edit"===T,onclickDelete:()=>O(!0),type:T,outsideID:E}),(0,t.jsx)(u.Z,{children:R&&(0,t.jsx)(m.Z,{children:(0,t.jsxs)(p.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(S.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:Y}),(0,t.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:R.fields.status,typePage:T,form:Y}),(0,t.jsx)(S.Z,{xs:12,md:12,title:"Descri\xe7\xe3o",name:"fields.descricao",required:!1,form:Y}),(0,t.jsx)(y.Z,{xs:12,md:12,title:"Formul\xe1rios",name:"formulario.fields",value:null!==(a=null==R?void 0:R.formulario.fields)&&void 0!==a?a:null,multiple:!0,limitTags:5,required:!0,options:R.formulario.options,form:Y})]})})}),(0,t.jsx)(u.Z,{sx:{mt:4},children:(0,t.jsxs)(m.Z,{children:[(0,t.jsx)(x.Z,{sx:{mb:5},children:"Itens"}),(0,t.jsx)(p.ZP,{container:!0,spacing:3,children:(0,t.jsx)(N,{getValues:Y.getValues,removeItem:ea,type:T,form:Y},U)}),(0,t.jsx)(f.Z,{variant:"outlined",color:"primary",sx:{mt:4},startIcon:(0,t.jsx)(h.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ee()},children:"Inserir item"})]})})]}),(0,t.jsx)(j.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+H.title,openModal:M,handleClose:()=>O(!1),handleSubmit:et,btnCancel:!0,btnConfirm:!0})]})};var P=w},93250:function(e,a,o){"use strict";var t=o(85893),n=o(49837),r=o(91359),s=o(69175);let i=e=>{let{result:a,columns:o,btnNew:i=!0,btnPrint:l=!0,btnBack:d,openModal:c,modalLog:u,btnNewModal:m,handleNewModal:p,status:x,setStatus:f,setCustomId:h,filters:g=!0}=e;return(0,t.jsx)(n.Z,{className:"h-full",children:(0,t.jsx)(r.Z,{sx:{pt:"0",height:"100%"},children:(0,t.jsx)(s.Z,{rows:a,columns:o,modalLog:u,filters:g,buttonsHeader:{btnNew:i,btnPrint:l,btnBack:d,openModal:c,btnNewModal:m,handleNewModal:p,status:x,setStatus:f,setCustomId:h}})})})};a.Z=i},46905:function(e,a,o){"use strict";var t=o(85893),n=o(87536),r=o(79072),s=o(55343),i=o(67836);let l=e=>{let{xs:a,md:o,title:l,name:d,disabled:c,required:u,form:m,onChange:p}=e;return(0,t.jsx)(r.ZP,{item:!0,xs:a,md:o,children:(0,t.jsx)("div",{children:(0,t.jsx)(s.Z,{fullWidth:!0,children:(0,t.jsx)(n.Qr,{name:d,control:m.control,rules:{required:u},render(e){let{field:a}=e;return(0,t.jsx)(i.Z,{label:l,value:null==a?void 0:a.value,placeholder:l,type:"date",size:"small","aria-describedby":"validation-schema-nome",disabled:c,error:!!m.formState.errors[d],onChange(e){let o=e.target.value;a.onChange(o),p&&p(o)},InputLabelProps:{shrink:!0},inputProps:{min:"1900-01-01",max:"2100-01-01"}})}})})})})};a.Z=l},55148:function(e,a,o){"use strict";var t=o(85893),n=o(79072),r=o(55343),s=o(35966),i=o(67836),l=o(87536),d=o(53934),c=o(30944);let u=e=>{let{xs:a,md:o,title:u,options:m,form:p,name:x,limitTags:f,value:h,required:g,disabled:v,multiple:j,onChange:b,className:Z,keyProps:D,createNew:I,helpText:y,helpTextPosition:S}=e,C=I?[{id:null,name:"-- Novo --"},...null!=m?m:[]]:m,{key:F}=(0,c.L0)();return(0,t.jsx)(n.ZP,{item:!0,xs:a,md:o,sx:{my:1},className:Z,children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(r.Z,{fullWidth:!0,children:(0,t.jsx)(l.Qr,{name:x,control:p.control,rules:{required:g},render(e){var a;let{field:o}=e;return(0,t.jsx)(s.Z,{options:C.map(e=>e.name),value:null!=h?h:null===(a=p.getValues(x))||void 0===a?void 0:a.name,onChange(e,a){let o=C.find(e=>e.name===a);p.setValue(x,null!=o?o:null),b&&b(a)},renderInput(e){var a;return(0,t.jsx)(i.Z,{...e,id:"customSelect",size:"small",label:u,placeholder:u,error:!!p.formState.errors[x],helperText:null===(a=p.formState.errors[x])||void 0===a?void 0:a.message})}},D||F)}})}),y&&(0,t.jsx)("div",{className:"absolute right-[60px] top-[12px] ",children:(0,t.jsx)(d.Z,{text:y,position:null!=S?S:"top"})})]})})};a.Z=u},30140:function(e,a,o){"use strict";o.r(a);var t=o(85893),n=o(67294),r=o(46905),s=o(55148),i=o(51570),l=o(30944);let d=()=>{var e,a;let{form:o,setNames:d,filterDate:c,SelectFilterByName:u,dataSupplier:m,setFilteredDataSupplier:p,handleSearch:x,key:f,setKey:h}=(0,l.L0)(),{commonData:g}=(0,i.Lq)(),v=m,j=async()=>{p(v=await u(v=await u(v=await c(v=await x(v)),"status"),"quemPreenche"))};return(0,n.useEffect)(()=>{j()},[f]),(0,n.useEffect)(()=>{d(["dataInicio","dataFim","quemPreenche","status"])},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Z,{xs:12,md:6,title:"Data in\xedcio da avaliac\xe3o",name:"dataInicio",form:o}),(0,t.jsx)(r.Z,{xs:12,md:6,title:"Data Fim da avalia\xe7\xe3o",name:"dataFim",form:o}),(0,t.jsx)(s.Z,{xs:12,md:6,title:"Status",name:"status",form:o,options:g.status,value:null===(e=o.getValues("status"))||void 0===e?void 0:e.name}),(0,t.jsx)(s.Z,{xs:12,md:6,title:"Quem preencheu",name:"quemPreenche",value:null===(a=o.getValues("quemPreenche"))||void 0===a?void 0:a.name,form:o,options:[{id:"1",name:"F\xe1brica"},{id:"2",name:"Fornecedor"}]})]})};a.default=d},38496:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return eR}});var t=o(85893),n=o(67294),r=o(60664),s=o(93250),i=o(87536),l=o(99734),d=o(34282),c=o(7071),u=o(29308),m=o(23895),p=o(61953),x=o(19604),f=o(49837),h=o(91359),g=o(79072),v=o(55343),j=o(29630),b=o(11163),Z=o.n(b),D=o(71798),I=o(65698),y=o(83830),S=o(40039),C=o(39976),F=o(86501),N=o(82755),w=o(44642),P=o(82747),V=o(84220),E=o(22841),A=o(75158),z=o(1322),R=o(77993),k=o(31276),M=o(63366),O=o(87462),T=o(86010),q=o(94780),H=o(41796),$=o(36622),L=o(67074),B=o(78884),_=o(1588),G=o(34867);function W(e){return(0,G.Z)("MuiButtonGroup",e)}let U=(0,_.Z)("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","fullWidth","vertical","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary"]);var J=o(58907);let Q=["children","className","color","component","disabled","disableElevation","disableFocusRipple","disableRipple","fullWidth","orientation","size","variant"],X=(e,a)=>{let{ownerState:o}=e;return[{[`& .${U.grouped}`]:a.grouped},{[`& .${U.grouped}`]:a[`grouped${(0,$.Z)(o.orientation)}`]},{[`& .${U.grouped}`]:a[`grouped${(0,$.Z)(o.variant)}`]},{[`& .${U.grouped}`]:a[`grouped${(0,$.Z)(o.variant)}${(0,$.Z)(o.orientation)}`]},{[`& .${U.grouped}`]:a[`grouped${(0,$.Z)(o.variant)}${(0,$.Z)(o.color)}`]},a.root,a[o.variant],!0===o.disableElevation&&a.disableElevation,o.fullWidth&&a.fullWidth,"vertical"===o.orientation&&a.vertical]},Y=e=>{let{classes:a,color:o,disabled:t,disableElevation:n,fullWidth:r,orientation:s,variant:i}=e,l={root:["root",i,"vertical"===s&&"vertical",r&&"fullWidth",n&&"disableElevation"],grouped:["grouped",`grouped${(0,$.Z)(s)}`,`grouped${(0,$.Z)(i)}`,`grouped${(0,$.Z)(i)}${(0,$.Z)(s)}`,`grouped${(0,$.Z)(i)}${(0,$.Z)(o)}`,t&&"disabled"]};return(0,q.Z)(l,W,a)},K=(0,L.ZP)("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:X})(({theme:e,ownerState:a})=>(0,O.Z)({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},"contained"===a.variant&&{boxShadow:(e.vars||e).shadows[2]},a.disableElevation&&{boxShadow:"none"},a.fullWidth&&{width:"100%"},"vertical"===a.orientation&&{flexDirection:"column"},{[`& .${U.grouped}`]:(0,O.Z)({minWidth:40,"&:not(:first-of-type)":(0,O.Z)({},"horizontal"===a.orientation&&{borderTopLeftRadius:0,borderBottomLeftRadius:0},"vertical"===a.orientation&&{borderTopRightRadius:0,borderTopLeftRadius:0},"outlined"===a.variant&&"horizontal"===a.orientation&&{marginLeft:-1},"outlined"===a.variant&&"vertical"===a.orientation&&{marginTop:-1}),"&:not(:last-of-type)":(0,O.Z)({},"horizontal"===a.orientation&&{borderTopRightRadius:0,borderBottomRightRadius:0},"vertical"===a.orientation&&{borderBottomRightRadius:0,borderBottomLeftRadius:0},"text"===a.variant&&"horizontal"===a.orientation&&{borderRight:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${"light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`},"text"===a.variant&&"vertical"===a.orientation&&{borderBottom:e.vars?`1px solid rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${"light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`},"text"===a.variant&&"inherit"!==a.color&&{borderColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / 0.5)`:(0,H.Fq)(e.palette[a.color].main,.5)},"outlined"===a.variant&&"horizontal"===a.orientation&&{borderRightColor:"transparent"},"outlined"===a.variant&&"vertical"===a.orientation&&{borderBottomColor:"transparent"},"contained"===a.variant&&"horizontal"===a.orientation&&{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${U.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}},"contained"===a.variant&&"vertical"===a.orientation&&{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${U.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}},"contained"===a.variant&&"inherit"!==a.color&&{borderColor:(e.vars||e).palette[a.color].dark},{"&:hover":(0,O.Z)({},"outlined"===a.variant&&"horizontal"===a.orientation&&{borderRightColor:"currentColor"},"outlined"===a.variant&&"vertical"===a.orientation&&{borderBottomColor:"currentColor"})}),"&:hover":(0,O.Z)({},"contained"===a.variant&&{boxShadow:"none"})},"contained"===a.variant&&{boxShadow:"none"})})),ee=n.forwardRef(function(e,a){let o=(0,B.Z)({props:e,name:"MuiButtonGroup"}),{children:r,className:s,color:i="primary",component:l="div",disabled:d=!1,disableElevation:c=!1,disableFocusRipple:u=!1,disableRipple:m=!1,fullWidth:p=!1,orientation:x="horizontal",size:f="medium",variant:h="outlined"}=o,g=(0,M.Z)(o,Q),v=(0,O.Z)({},o,{color:i,component:l,disabled:d,disableElevation:c,disableFocusRipple:u,disableRipple:m,fullWidth:p,orientation:x,size:f,variant:h}),j=Y(v),b=n.useMemo(()=>({className:j.grouped,color:i,disabled:d,disableElevation:c,disableFocusRipple:u,disableRipple:m,fullWidth:p,size:f,variant:h}),[i,d,c,u,m,p,f,h,j.grouped]);return(0,t.jsx)(K,(0,O.Z)({as:l,role:"group",className:(0,T.Z)(j.root,s),ref:a,ownerState:v},g,{children:(0,t.jsx)(J.Z.Provider,{value:b,children:r})}))});var ea=o(54225),eo=o(78633),et=o(21609);let en=n.memo(e=>{let{form:a,xs:o,md:r,name:s,setIsNotFactory:i}=e,[l,d]=(0,n.useState)(1);return(0,n.useEffect)(()=>{s&&a.register&&a.setValue(s,l)},[s,a.register,l,a.setValue,i]),(0,t.jsxs)(g.ZP,{item:!0,xs:o,md:r,children:[(0,t.jsxs)(ee,{color:"primary",children:[(0,t.jsx)(ea.Z,{onClick(){i(!1),d(1)},variant:1===l?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 py-2 px-1",children:[(0,t.jsx)(et.Z,{icon:"mage:building-tree"}),(0,t.jsx)("p",{className:"capitalize",children:"F\xe1brica"})]})}),(0,t.jsx)(ea.Z,{onClick(){i(!0),d(2)},variant:2===l?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 py-2 px-1",children:[(0,t.jsx)(et.Z,{icon:"mdi:truck-fast-outline"}),(0,t.jsx)("p",{className:"capitalize",children:"Fornecedor"})]})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-4",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)(eo.gH_,{})}),(0,t.jsx)("p",{className:"text-sm",children:"".concat(1==l?"F\xe1brica ficar\xe1 respons\xe1vel pelo preenchimento do formul\xe1rio":"Fornecedor ficar\xe1 respons\xe1vel pelo preenchimento do formul\xe1rio, ser\xe1 enviado um e-mail com instru\xe7\xf5es de preenchimento ao fornecedor e a f\xe1brica ir\xe1 monitorar o status")})]}),s&&a.register&&(0,t.jsx)("input",{type:"hidden",name:s,...a.register(s),value:l})]})});var er=o(431),es=o(3893);let ei=e=>{var a;let{form:o,fields:s,params:i,setFields:l,handleCnpjCpf:d,validCnpj:c,setIsNotFactory:m,isNotFactory:x}=e,{loggedUnity:f}=(0,n.useContext)(S.V),[h,g]=(0,n.useState)([]),[v,b]=(0,n.useState)([]),[Z,D]=(0,n.useState)([]),[I,y]=(0,n.useState)(!1),[C,F]=(0,n.useState)(!1),[N,w]=(0,n.useState)(""),[M,O]=(0,n.useState)(null),[T,q]=(0,n.useState)([]),[H,$]=(0,n.useState)([]),[L,B]=(0,n.useState)(!1),{isCpf:_,setIsCpf:G}=(0,n.useContext)(er.YF),W=async()=>{let e=await r.h.post("/formularios/fornecedor/getModels",{unidadeID:f.unidadeID});g(e.data)},U=async()=>{let e=await r.h.post("/formularios/fornecedor/getProducts",{unidadeID:f.unidadeID});b(e.data)},J=async()=>{var e;let a=await r.h.post("/configuracoes/formularios/fornecedor/getCategories",{unidadeID:f.unidadeID});Q(a.data,null===(e=o.getValues("fields.categoria"))||void 0===e?void 0:e.id),q(a.data)},Q=(e,a)=>{var o;let t=null===(o=e.find(e=>e.id==a))||void 0===o?void 0:o.riscos;$(t)},X=()=>{_&&(!o.getValues("fields.nomeFantasia")||""==o.getValues("fields.nomeFantasia"))&&(setValue("fields.nomeFantasia",o.getValues("fields.razaoSocial")),l({...s,nomeFantasia:o.getValues("fields.razaoSocial")}))},Y=()=>{l(null),o.setValue("fields.cnpj",""),o.setValue("fields.razaoSocial",""),o.setValue("fields.nomeFantasia",""),o.setValue("fields.email",""),o.setValue("fields.categoria",null),o.setValue("fields.risco",null),o.setValue("fields.modelo",null),o.setValue("fields.gruposAnexo",[]),o.setValue("fields.produtos",[])},K=async e=>{d(e,_),await J()};(0,n.useEffect)(()=>{o.reset(),W(),U(),J()},[]),(0,n.useEffect)(()=>{T.length>0&&o.getValues("fields.categoria")&&Q(T,o.getValues("fields.categoria").id)},[T,o.getValues("fields?.categoria")]),(0,n.useEffect)(()=>{o.setValue("fields.cnpj",""),o.trigger("fields.cnpj")},[_,o.trigger]);let ee=async(e,a)=>{if(F(!1),"gruposAnexo"==a){D(a=>[...a,e]);let t=[...o.getValues("fields.gruposAnexo")];t.push(e),o.setValue("fields.gruposAnexo",t)}else if("produtos"==a){b(a=>[...a,e]);let n=[...o.getValues("fields.produtos")];n.push(e),o.setValue("fields.produtos",n)}y(!I)},ea=async e=>{F(!0),"gruposAnexo"==e?(w("Novo grupo de anexos"),O((0,t.jsx)(R.Z,{manualUrl:"/cadastros/grupo-anexos",btnClose:!0,handleModalClose:()=>F(!1),newChange:I,handleConfirmNew:ee,outsideID:!0}))):"produtos"==e&&(w("Novo produto"),O((0,t.jsx)(k.Z,{manualUrl:"/cadastros/produto",btnClose:!0,handleModalClose:()=>F(!1),newChange:I,handleConfirmNew:ee,outsideID:!0})))},eo=async e=>{F(!1)};return(0,n.useEffect)(()=>{let e=o.watch("fields.cnpj"),a=_?(0,P.sw)(e):(0,P.zk)(e);B(a)},[_,o.getValues("fields.cnpj")]),h&&v&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(p.Z,{children:[(null==i?void 0:i.habilitaQuemPreencheFormFornecedor)&&(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(en,{xs:12,md:12,name:"habilitaQuemPreencheFormFornecedor",setIsNotFactory:m,form:o})}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)(u.Z,{xs:12,md:12,title:_?"CPF":"CNPJ",name:"fields.cnpj",value:null==s?void 0:s.cnpj,onChange(e){K(e)},clearField:o.getValues("fields.cnpj")?Y:null,mask:_?"cpf":"cnpj",required:!0,form:o}),!L&&(0,t.jsx)(j.Z,{variant:"body2",color:"error",children:_?"CPF Inválido":"CNPJ Inválido"})]}),(0,t.jsx)(E.Z,{label:"CPF",labelPlacement:"top",control:(0,t.jsx)(A.Z,{checked:_,onChange(e){G(e.target.checked)}}),sx:{position:"relative",top:-10}})]})]}),(0,t.jsx)(u.Z,{xs:12,md:12,title:_?"Nome":"Razão Social",name:"fields.razaoSocial",value:null==s?void 0:s.razaoSocial,onBlur:X,disabled:!c,required:!0,form:o}),(0,t.jsx)(u.Z,{xs:12,md:12,title:_?"Apelido":"Nome Fantasia",name:"fields.nomeFantasia",value:null==s?void 0:s.nomeFantasia,disabled:!c,required:!0,form:o}),x&&(0,t.jsx)(u.Z,{xs:12,md:12,type:"email",title:"E-mail",name:"fields.email",value:null==s?void 0:s.email,disabled:!c,required:!0,form:o}),!x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.Z,{xs:12,md:12,title:"Categoria",name:"fields.categoria",value:null==s?void 0:s.categoria,disabled:!c,onChange(e){o.setValue("fields.categoria",e),o.setValue("fields.risco",null),Q(T,e?e.id:null)},required:!0,options:null!=T?T:[],form:o}),(0,t.jsx)(V.Z,{xs:12,md:12,disabled:null==o.getValues("fields.categoria"),title:"Risco",name:"fields.risco",value:null==s?void 0:s.risco,required:!0,options:null!=H?H:[],form:o})]}),(0,t.jsx)(es.Z,{title:"Prestador de servi\xe7o terceirizado",name:"fields.prestadorServico",value:null==s?void 0:s.prestadorServico,form:o,disabled:!c,helpText:"Fornecedor \xe9 um prestador de servi\xe7os terceirizado (produto \xe9 opcional)"}),(0,t.jsx)(V.Z,{xs:12,md:12,title:"Produtos",name:"fields.produtos",value:null!==(a=null==s?void 0:s.produtos)&&void 0!==a?a:[],disabled:!c,multiple:!0,createNew:()=>ea("produtos"),required:(null==i?void 0:i.obrigatorioProdutoFornecedor)&&!o.watch("fields.prestadorServico"),alertRequired:(null==i?void 0:i.obrigatorioProdutoFornecedor)&&!o.watch("fields.prestadorServico"),options:null!=v?v:[],form:o}),(0,t.jsx)(z.Z,{title:N,size:"md",openModal:C,setOpenModal:F,handleSave:eo,children:M})]})};var el=o(34175);let ed=e=>{var a,o;let{sipeAgro:n}=e,r=()=>{let e=(e,a)=>n&&n[a]&&n[a].includes(e)?(0,t.jsx)(et.Z,{icon:"lets-icons:check-fill",className:"text-green-600 w-full"}):(0,t.jsx)(et.Z,{icon:"lets-icons:check-fill",className:"text-gray-100 w-full"});return(0,t.jsxs)("table",{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{}),(0,t.jsx)("td",{className:"text-center",children:(0,t.jsx)(j.Z,{variant:"caption",children:(0,t.jsx)("strong",{children:"Fabricante"})})}),(0,t.jsx)("td",{className:"text-center",children:(0,t.jsx)(j.Z,{variant:"caption",children:(0,t.jsx)("strong",{children:"Fracionador"})})}),(0,t.jsx)("td",{className:"text-center",children:(0,t.jsx)(j.Z,{variant:"caption",children:(0,t.jsx)("strong",{children:"Importador"})})})]}),[{name:"Aditivo",column:"aditivo"},{name:"Alimento",column:"alimento"},{name:"Concentrado",column:"concentrado"},{name:"Coproduto",column:"coproduto"},{name:"Ingrediente",column:"ingrediente"},{name:"N\xfacleo",column:"nucleo"},{name:"Premix",column:"premix"},{name:"Produto mastig\xe1vel",column:"produtoMastigavel"},{name:"Ra\xe7\xe3o",column:"racao"},{name:"Suplemento",column:"suplemento"}].map((a,o)=>(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-1",children:(0,t.jsx)(j.Z,{variant:"caption",children:(0,t.jsx)("strong",{children:a.name})})}),(0,t.jsx)("td",{className:"py-1",children:e(1,a.column)}),(0,t.jsx)("td",{className:"py-1",children:e(2,a.column)}),(0,t.jsx)("td",{className:"py-1",children:e(3,a.column)})]}))]})};return(0,t.jsx)(f.Z,{sx:{mt:4},children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)(j.Z,{variant:"body2",className:"flex justify-between",children:[(0,t.jsxs)("strong",{children:["Dados MAPA - \xdaltima atualiza\xe7\xe3o (",null!==(o=null==n?void 0:n.dataImportacao)&&void 0!==o?o:"----",")"]}),(0,t.jsxs)("span",{children:["Fonte dos dados:"," ",(0,t.jsx)("a",{className:"text-blue-500 hover:underline",target:"_blank",href:"https://www.gov.br/agricultura/pt-br/assuntos/insumos-agropecuarios/insumos-pecuarios/alimentacao-animal/registro-cadastro",children:"link"})]})]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Raz\xe3o Social:"})," ",null==n?void 0:null===(a=n.razaoSocial)||void 0===a?void 0:a.toUpperCase()]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Registro SIPEAGRO:"})," ",null==n?void 0:n.registroSipeAgro]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"SIPOA:"})," ",["Regi\xe3o Norte","Regi\xe3o Nordeste","Regi\xe3o Centro-Oeste","Regi\xe3o Sudeste","Regi\xe3o Sul","Goi\xe1s","Minas Gerais","Bahia","Paran\xe1","Rio Grande do Sul","S\xe3o Paulo"][(null==n?void 0:n.sipoa)-1]]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Situa\xe7\xe3o:"})," ",null==n?void 0:n.situacao]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Munic\xedpio:"})," ","".concat(null==n?void 0:n.municipio,"/").concat(null==n?void 0:n.uf)]}),(0,t.jsx)(r,{})]})})})},ec=e=>{var a,o,s,i,l,d;let{form:c,cnpj:u,setIsNotFactory:m,isNotFactory:x}=e,[v,b]=(0,n.useState)(!1),{loggedUnity:Z}=(0,n.useContext)(S.V),[D,I]=(0,n.useState)(null),[y,C]=(0,n.useState)(null),[F,N]=(0,n.useState)(null),[V,E]=(0,n.useState)(null),{isCpf:A,setIsCpf:z}=(0,n.useContext)(er.YF),R=(e,a)=>{a&&14==e.length||!a&&18==e.length?(a?(0,P.sw)(e):(0,P.zk)(e))?(E(!0),M(e,a),a||k(e)):E(!1):(E(null),I(null))},k=async e=>{try{let a=await r.h.post("/formularios/fornecedor/mapaSipeAgro",{cnpj:e});N(a.data)}catch(o){console.error(o)}},M=async(e,a)=>{try{let o=await r.h.post("/formularios/fornecedor/cnpj",{type:a?"cpf":"cnpj",unidadeID:Z.unidadeID,cnpj:e}),t={new:o.data.new,fornecedorID:o.data.fornecedorID,data:o.data.dataAvaliacao,modelo:o.data.modelo.nome,produtos:o.data.produtos,gruposAnexo:o.data.gruposAnexo},n="";t.new&&(n=await O(e)),I({...D,cnpj:t.new?(0,el.PK)(n.data.CNPJ):e,status:t.new?n.data.STATUS:"",dataAbertura:t.new?n.data["DATA ABERTURA"]:"",telefone:t.new?n.data.DDD+" "+n.data.TELEFONE:"",razaoSocial:t.new?n.data["RAZAO SOCIAL"]:o.data.fields.razaoSocial,nomeFantasia:t.new?n.data["NOME FANTASIA"]:o.data.fields.nomeFantasia,email:t.new?n.data.EMAIL:o.data.fields.email,cidade:t.new?n.data.MUNICIPIO+"/"+n.data.UF:"",preenchimento:t,telefone:o.data.fields.telefone,cep:o.data.fields.cep,logradouro:o.data.fields.logradouro,numero:o.data.fields.numero,complemento:o.data.fields.complemento,bairro:o.data.fields.bairro,cidade:o.data.fields.cidade,estado:o.data.fields.estado,pais:o.data.fields.pais,ie:o.data.fields.ie,principaisClientes:o.data.fields.principaisClientes,registroSipeagro:o.data.fields.registroSipeagro,categoria:o.data.fields.categoria,risco:o.data.fields.risco}),c.setValue("fields.cnpj",e),c.setValue("fields.razaoSocial",t.new?n.data["RAZAO SOCIAL"]:o.data.fields.razaoSocial),c.setValue("fields.nomeFantasia",t.new?n.data["NOME FANTASIA"]:o.data.fields.nomeFantasia),c.setValue("fields.nome",t.new?n.data["NOME FANTASIA"]:""),c.setValue("fields.email",t.new?n.data.EMAIL:o.data.fields.email),c.setValue("fields.modelo",o.data.modelo.id>0?o.data.modelo:null),c.setValue("fields.gruposAnexo",o.data.gruposAnexo),c.setValue("fields.produtos",o.data.produtos),c.setValue("fields.telefone",o.data.fields.telefone),c.setValue("fields.cep",o.data.fields.cep),c.setValue("fields.logradouro",o.data.fields.logradouro),c.setValue("fields.numero",o.data.fields.numero),c.setValue("fields.complemento",o.data.fields.complemento),c.setValue("fields.bairro",o.data.fields.bairro),c.setValue("fields.cidade",o.data.fields.cidade),c.setValue("fields.estado",o.data.fields.estado),c.setValue("fields.pais",o.data.fields.pais),c.setValue("fields.ie",o.data.fields.ie),c.setValue("fields.principaisClientes",o.data.fields.principaisClientes),c.setValue("fields.registroSipeagro",o.data.fields.registroSipeagro),c.setValue("fields.categoria",o.data.fields.categoria),c.setValue("fields.risco",o.data.fields.risco),getValues("fields.razaoSocial")&&c.clearErrors("fields.razaoSocial"),getValues("fields.nomeFantasia")&&c.clearErrors("fields.nomeFantasia"),getValues("fields.email")&&c.clearErrors("fields.email"),getValues("fields.risco")&&c.clearErrors("fields.risco"),getValues("fields.produtos")&&c.clearErrors("fields.produtos")}catch(s){console.error(s)}},O=async e=>{let a=e.replace(/\D/g,""),o=await r.h.get("https://api-publica.speedio.com.br/buscarcnpj?cnpj=".concat(a));return o},T=async()=>{let e={unidadeID:Z.unidadeID};try{let a=await r.h.post("/formularios/fornecedor/paramsNewFornecedor",e);C(a.data)}catch(o){console.error(o)}};return(0,n.useEffect)(()=>{b(!v),u&&u.length>0&&R(u)},[]),(0,n.useEffect)(()=>{T(),setTimeout(()=>{c.trigger()},300)},[]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(w.Z,{children:(0,t.jsxs)(g.ZP,{container:!0,spacing:4,children:[(0,t.jsxs)(g.ZP,{item:!0,xs:12,md:6,children:[(0,t.jsx)(p.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:(0,t.jsx)(ei,{form:c,setFields:I,fields:null!=D?D:null,params:y,handleCnpjCpf:R,validCnpj:V,setIsNotFactory:m,isNotFactory:x},v)}),(0,t.jsx)(f.Z,{sx:{mt:4},children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)(p.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsx)(j.Z,{variant:"body2",children:(0,t.jsx)("strong",{children:"Dados do \xfaltimo formul\xe1rio deste fornecedor"})}),(null==D?void 0:null===(a=D.preenchimento)||void 0===a?void 0:a.new)?(0,t.jsx)(j.Z,{variant:"body2",color:"primary",children:(0,t.jsx)("strong",{children:"Novo fornecedor"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"ID: "})," ",null==D?void 0:null===(o=D.preenchimento)||void 0===o?void 0:o.fornecedorID]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Data de preenchimento:"})," ",null==D?void 0:null===(s=D.preenchimento)||void 0===s?void 0:s.data]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Modelo:"})," ",null==D?void 0:null===(i=D.preenchimento)||void 0===i?void 0:i.modelo]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Grupos de anexo: "}),null==D?void 0:null===(l=D.preenchimento)||void 0===l?void 0:l.gruposAnexo.map((e,a)=>{var o;return"".concat(e.nome).concat(a<(null==D?void 0:null===(o=D.preenchimento)||void 0===o?void 0:o.gruposAnexo.length)-1?", ":"")})]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Produtos: "}),null==D?void 0:null===(d=D.preenchimento)||void 0===d?void 0:d.produtos.map((e,a)=>{var o;return"".concat(e.nome).concat(a<(null==D?void 0:null===(o=D.preenchimento)||void 0===o?void 0:o.produtos.length)-1?", ":"")})]})]})]})})})]}),(0,t.jsx)(g.ZP,{item:!0,xs:12,md:6,children:A?(0,t.jsx)("div",{className:"flex items-start justify-center mt-24",children:(0,t.jsx)(j.Z,{variant:"body1",children:"Sem dados a serem consultados"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ed,{sipeAgro:F},F),(0,t.jsx)(f.Z,{sx:{mt:4},children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)(p.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsx)(j.Z,{variant:"body2",children:(0,t.jsx)("strong",{children:"Dados consultados da Receita Federal"})}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Raz\xe3o Social:"})," ",null==D?void 0:D.razaoSocial]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Nome Fantasia:"})," ",null==D?void 0:D.nomeFantasia]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"CNPJ:"})," ",null==D?void 0:D.cnpj]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Status:"})," ",null==D?void 0:D.status]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Data Abertura:"})," ",null==D?void 0:D.dataAbertura]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Telefone:"})," ",null==D?void 0:D.telefone]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"E-mail:"})," ",null==D?void 0:D.email]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Cidade:"})," ",null==D?void 0:D.cidade]})]})})})]})})]})})})};var eu=o(66136),em=o(44373);o(80587);var ep=o(92945);let ex=e=>{let{values:a,handleFileSelect:o,handleRemove:r,disabled:s,errors:i}=e,{settings:l}=(0,n.useContext)(eu.J6),d=l.mode,[c,u]=(0,n.useState)(null),m=(0,n.useRef)(null),x=e=>{m.current.click(),u(e)};return(0,n.useEffect)(()=>{m.current&&(m.current.value="")},[o]),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:a&&a.map((e,n)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.ZP,{container:!0,spacing:2,children:(0,t.jsx)(g.ZP,{item:!0,xs:12,sm:6,children:(0,t.jsxs)(p.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(j.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},children:e.nome}),(0,t.jsx)(j.Z,{variant:"body2",children:"(".concat(e.unidadeMedida,")")})]})})},n),e.produtoAnexosDescricao&&e.produtoAnexosDescricao.length>0&&(0,t.jsx)(g.ZP,{container:!0,spacing:4,children:e.produtoAnexosDescricao.map((e,a)=>(0,t.jsx)(ep.Z,{modeTheme:d,handleFileClick:x,selectedItem:c,inputRef:m,item:e,indexBlock:n,indexItem:a,handleFileSelect:o,folder:"produto",handleRemove:r,error:i,disabled:s},"".concat(n,"-").concat(a)))}),e.anexos&&0===e.anexos.length&&(0,t.jsx)(j.Z,{variant:"body2",sx:{mb:2},children:"Este produto n\xe3o exige anexos"}),n<a.length-1&&(0,t.jsx)(em.Z,{sx:{my:4}})]}))})};var ef=o(56531),eh=o(50287),eg=o(83542);let ev=e=>{var a,o,s;let{form:i,modeloID:l,values:d,fields:c,disabled:m,getAddressByCep:p}=e,[x,f]=(0,n.useState)([]),h=async()=>{let e=await r.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:1,modeloID:l});f(e.data.preenche)};return(0,n.useEffect)(()=>{h(),d&&!d.data&&i.setValue("fieldsHeader.data",(0,D.Ux)()),d&&!d.hora&&i.setValue("fieldsHeader.hora",(0,D.Xn)())},[d]),(0,t.jsxs)(g.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(g.ZP,{item:!0,xs:12,sx:{textAlign:"right"},children:(0,t.jsx)(eg.Z,{data:null!==(a=null==d?void 0:d.departamentos)&&void 0!==a?a:[]})}),(0,t.jsx)(eh.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null!==(o=null==d?void 0:d.data)&&void 0!==o?o:(0,D.Ux)(),disabled:m,typeValidation:"dataPassado",daysValidation:365,form:i,alertRequired:!0}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",value:null!==(s=null==d?void 0:d.data)&&void 0!==s?s:(0,D.Xn)(),type:"time",disabled:m,form:i,alertRequired:!0}),(0,t.jsx)(u.Z,{xs:12,md:4,title:d.cpf?"CPF":"CNPJ",name:"fieldsHeader.cnpj",type:"string",mask:d.cpf?"cpf":"cnpj",disabled:!0,form:i,alertRequired:!0}),(0,t.jsx)(u.Z,{xs:12,md:4,title:d.cpf?"Nome":"Raz\xe3o Social",name:"fieldsHeader.razaoSocial",type:"string",disabled:m,form:i,alertRequired:!0}),(0,t.jsx)(u.Z,{xs:12,md:4,title:d.cpf?"Apelido":"Nome fantasia",name:"fieldsHeader.nomeFantasia",type:"string",disabled:m,form:i,alertRequired:!0}),(0,t.jsx)(ef.Z,{fields:c,values:c,getAddressByCep:p,disabled:m,form:i}),d.prestadorServico&&(0,t.jsx)(es.Z,{md:4,title:"Prestador de servi\xe7o terceirizado",name:"fields.prestadorServico",value:!0,form:i,disabled:!0,helpText:"Fornecedor \xe9 um prestador de servi\xe7os terceirizado (produto \xe9 opcional)"})]})};var ej=o(41088),eb=o(92629);o(1503);var eZ=o(934),eD=o(87771);let eI=e=>{var a,o;let{values:n}=e;if(n)return(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center gap-4",children:[(0,t.jsx)(eD.QRz,{size:60,className:"text-yellow-600"}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,t.jsx)("p",{className:"text-2xl font-semibold",children:"Aguardando preenchimento do Fornecedor"}),(0,t.jsx)("p",{children:"Este formul\xe1rio ser\xe1 preenchido pelo fornecedor"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 w-full px-10 text-center pt-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"Nome Fantasia"}),(0,t.jsx)("p",{className:"text-lg",children:n.nomeFantasia})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"Raz\xe3o Social"}),(0,t.jsx)("p",{className:"text-lg",children:n.razaoSocial})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"CNPJ"}),(0,t.jsx)("p",{className:"text-lg",children:n.cnpj})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"Telefone"}),(0,t.jsx)("p",{className:"text-lg",children:null!==(a=n.telefone)&&void 0!==a?a:"--"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"E-mail"}),(0,t.jsx)("p",{className:"text-lg",children:null!==(o=n.email)&&void 0!==o?o:"--"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"Data de Cadastro"}),(0,t.jsx)("p",{className:"text-lg",children:n.dataInicio})]})]})]})})})};var ey=o(82555),eS=o(91757),eC=o(26526);let eF=e=>{var a,o;let s;let{id:b,makeFornecedor:w}=e,{setData:P,data:V}=(0,ey.O)(),[E,A]=(0,n.useState)(!0),[z,R]=(0,n.useState)(null),{menu:k,user:M,loggedUnity:O,hasPermission:T,hasSectorPermission:q}=(0,n.useContext)(S.V),[H,$]=(0,n.useState)(!1),[L,B]=(0,n.useState)(!1),[_,G]=(0,n.useState)(!0),[W,U]=(0,n.useState)(!0),[J,Q]=(0,n.useState)(null),[X,Y]=(0,n.useState)([]),[K,ee]=(0,n.useState)([]),[ea,eo]=(0,n.useState)(!1),[et,en]=(0,n.useState)(null),{createNewNotification:er}=(0,n.useContext)(C.u),[es,ei]=(0,n.useState)(!1),[el,ed]=(0,n.useState)([]),[eu,em]=(0,n.useState)([]),[ep,ef]=(0,n.useState)([]),[eh,eg]=(0,n.useState)(null),[eD,eF]=(0,n.useState)([]),[eN,ew]=(0,n.useState)(null),[eP,eV]=(0,n.useState)(""),[eE,eA]=(0,n.useState)(!1),[ez,eR]=(0,n.useState)({status:!1,errors:[]}),{setId:ek}=(0,n.useContext)(y.X),[eM,eO]=(0,n.useState)([]),[eT,eq]=(0,n.useState)(!1),[eH,e$]=(0,n.useState)(null),{isLoading:eL,startLoading:eB,stopLoading:e_}=(0,ej.Z)(),[eG,eW]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),eU=Z(),eJ=b&&b>0?"edit":"new",eQ=eU.pathname,eX=(0,i.cI)({mode:"onChange"}),eY=async e=>{let a={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:M.usuarioID,papelID:M.papelID,unidadeID:O.unidadeID}};try{$(!0),await r.h.post("".concat(eQ,"/changeFormStatus/").concat(b),a).then(e=>{F.ZP.success(D.OD.successUpdate),$(!1),as(et,null,null)})}catch(o){console.log(o)}finally{eo(!ea)}},eK=()=>{navigator.clipboard.writeText(eh),F.ZP.success("Link copiado com sucesso!")},e0=()=>{ek(J.parFornecedorModeloID),eU.push("/configuracoes/formularios/fornecedor/")},e1={id:1,name:"Gerar novo formul\xe1rio",description:"Gerar um novo formul\xe1rio de preenchimento para este fornecedor.",component:(0,t.jsx)(ec,{cnpj:null==el?void 0:el.cnpj}),disabled:!T(eU.pathname,"inserir"),route:null,type:null,modal:!0,fullHeight:!0,action:w,size:"lg",icon:"fluent:form-new-20-regular",identification:null},e2={id:3,name:"Copiar link do formul\xe1rio",description:"Copiar o link deste formul\xe1rio.",component:(0,t.jsx)(ec,{}),route:null,type:null,action:eK,modal:!1,icon:"solar:copy-outline",identification:null},e3={id:b,name:"Imprimir",nameComponent:"indexFormulario",type:"report",unidadeID:null==J?void 0:J.unidadeID,usuarioID:null==eP?void 0:eP.usuarioID,papelID:null==M?void 0:M.papelID,status:null==eP?void 0:eP.status,route:"formularios/fornecedor",icon:"fluent:print-24-regular",module:"fornecedor"},e4={id:6,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,t.jsx)(eS.Z,{}),disabled:!!_||!T(eU.pathname,"editar"),route:null,type:null,action:eY,modal:!0,size:"sm",icon:"heroicons:lock-open",identification:null},e5=[];1==M.papelID&&(e5.push(e1),(null==eP?void 0:eP.status)>=40&&e5.push(e4)),e5.push(e2),e5.push(e3),1==M.papelID&&(s=!1,k.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(s=!0)})})}),s)&&e5.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:e0,modal:!1,icon:"bi:gear",identification:null});let e6=async()=>{try{console.log("\uD83D\uDE80 ~ verifyFormPending -> hasFormPending -------:",_),await r.h.post("".concat(eQ,"/verifyFormPending/").concat(b),{parFormularioID:1}).then(e=>{G(e.data) //! true/false
})}catch(e){console.log(e)}},e7=()=>{eB();try{r.h.post("".concat(eQ,"/getData/").concat(b),{type:eJ,unidadeID:O.unidadeID}).then(e=>{var a,o,t,n,r;if(!e.data)return;e.data.hasModel||(A(!1),R(e.data)),console.log("\uD83D\uDE80 ~ getData:",e.data),ed(e.data.fieldsHeader),em(e.data.fieldsFooter),ef(e.data.fields),Y(e.data.produtos),eF(e.data.blocos),ee(e.data.grupoAnexo),eV(e.data.info),Q(e.data.unidade),eg(e.data.link),ew(e.data.ultimaMovimentacao),an(e.data.blocos),eX.reset(e.data),e6();let s=[];for(let i=0;i<e.data.fields.length;i++){let l=e.data.fields[i].nomeColuna,d=e.data.fields[i].nomeCampo;for(let c in O){if("telefone"==l&&!eX.getValues("fields[".concat(i,"].").concat(l))){let u=null!==(n=O.telefone1)&&void 0!==n?n:O.telefone2;eX.setValue("fields[".concat(i,"].").concat(l),null!=u?u:"")}c!==l||eX.getValues("fields[".concat(i,"].").concat(l),O[c])||(eX.setValue("fields[".concat(i,"].").concat(l),O[c]),null!==O[c]&&""!==O[c]&&s.push({name:d,value:O[c]}))}}eO(s);let m=D.WR[null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(o=a.info)||void 0===o?void 0:o.status];en(m),eW({status:!!(M.papelID==e.data.unidade.quemPreenche&&e.data.info.status<40&&(q(null!==(r=null===(t=e.data.fieldsHeader)||void 0===t?void 0:t.departamentos)&&void 0!==r?r:[])||2===e.data.unidade.quemPreenche)),message:2==M.papelID&&e.data.info.status>=40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo e enviado pra f\xe1brica, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":1==M.papelID&&e.data.info.status<40?"Somente o fornecedor pode alterar as informa\xe7\xf5es deste formul\xe1rio!":1==M.papelID&&40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o":null,messageType:2==M.papelID?"warning":"info"})}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e)}finally{e_()}},e8=!1,e9=[],ae=(e,a)=>{eX.setError(e,{type:"manual",message:"Campo obrigat\xf3rio"}),e9.push(a),e8=!0},aa=()=>{eX.clearErrors(),eX.getValues("fieldsHeader.data")||ae("fieldsHeader.data","Data da avalia\xe7\xe3o"),eX.getValues("fieldsHeader.hora")||ae("fieldsHeader.hora","Hora da avalia\xe7\xe3o"),eX.getValues("fieldsHeader.razaoSocial")||ae("fieldsHeader.razaoSocial","Raz\xe3o Social"),eX.getValues("fieldsHeader.nomeFantasia")||ae("fieldsHeader.nomeFantasia","Nome Fantasia"),null==ep||ep.forEach((e,a)=>{let o=e.tabela?"fields[".concat(a,"].").concat(e.tabela):"fields[".concat(a,"].").concat(e.nomeColuna),t=eX.getValues(o);1!==e.obrigatorio||t||ae(o,null==e?void 0:e.nomeCampo)}),X&&X.length>0&&X.forEach((e,a)=>{e.produtoAnexosDescricao.forEach((o,t)=>{1===o.obrigatorio&&0==o.anexos.length&&(eX.setError("produtos[".concat(a,"].produtoAnexosDescricao[").concat(t,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),e9.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==o?void 0:o.nome)),e8=!0)})}),eD&&eD.length>0&&eD.forEach((e,a)=>{e.itens.forEach((e,o)=>{let t=eX.getValues("blocos[".concat(a,"].itens[").concat(o,"].resposta"));(null==e?void 0:e.obrigatorio)!==1||t||(eX.setError("blocos[".concat(a,"].itens[").concat(o,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),e9.push(null==e?void 0:e.nome),e8=!0),e.respostaConfig&&1==e.respostaConfig.anexo&&e.respostaConfig.anexosSolicitados.length>0&&e.respostaConfig.anexosSolicitados.forEach((t,n)=>{1==t.obrigatorio&&t.anexos&&0==t.anexos.length&&(eX.setError("blocos[".concat(a,"].itens[").concat(o,"].respostaConfig.anexosSolicitados[").concat(n,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),e9.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==t?void 0:t.nome)),e8=!0)})})}),K&&K.length>0&&K.forEach((e,a)=>{e.itens.forEach((o,t)=>{1===o.obrigatorio&&0==o.anexos.length&&(eX.setError("grupoAnexo[".concat(a,"].itens[").concat(t,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),e9.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==o?void 0:o.nome)),e8=!0)})}),eR({status:e8,errors:e9}),e8&&e9.forEach(e=>{eX.trigger(e)})},ao=async e=>{if(9===e.length){let a=e.replace(/[^0-9]/g,"");try{let o=await r.h.get("https://viacep.com.br/ws/".concat(a,"/json/"));o.data.localidade?(ep.forEach(async(e,a)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await eX.setValue("fields[".concat(a,"].logradouro"),o.data.logradouro),await eX.setValue("fields[".concat(a,"].bairro"),o.data.bairro),await eX.setValue("fields[".concat(a,"].cidade"),o.data.localidade),await eX.setValue("fields[".concat(a,"].estado"),o.data.uf))}),F.ZP.success("Endere\xe7o encontrado!")):F.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},at=async()=>{aa(),eA(!0)},an=e=>{let a=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(a=!1)})}),U(a)},ar=async e=>{e.conclusion=!0,await eX.handleSubmit(ai)(e)},as=(e,a,o)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(b," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:b,tipoNotificacaoID:6,usuarioGeradorID:M.usuarioID,usuarioID:0,unidadeID:O.unidadeID,papelID:1};if(n&&(er(n),a)){let r={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(b," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:o,tipoNotificacaoID:5,usuarioGeradorID:M.usuarioID,usuarioID:0,unidadeID:O.unidadeID,papelID:1};er(r)}},ai=async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];eA(!1),!0===a.conclusion?(e.status=M&&1==M.papelID?a.status:40,e.obsConclusao=a.obsConclusao):eX.clearErrors();let o={form:e,auth:{usuarioID:M.usuarioID,papelID:M.papelID,unidadeID:O.unidadeID},currentStatus:e.info.status};try{"edit"==eJ?($(!0),await r.h.post("".concat(eQ,"/updateData/").concat(b),o).then(a=>{F.ZP.success(D.OD.successUpdate),$(!1);let o=null;a.data&&a.data.naoConformidade&&a.data.id>0&&(eU.push("/formularios/fornecedor/nao-conformidade/"),ek(a.data.id),o=a.data.id),as(e.status,e.naoConformidade,o)})):"new"==eJ?await r.h.post("".concat((0,D.g_)(eQ),"/insertData"),o).then(e=>{eU.push("".concat((0,D.g_)(eQ))),ek(e.data),F.ZP.success(D.OD.successNew)}):F.ZP.error(D.OD.error)}catch(t){console.log(t)}finally{eo(!ea)}},al=async(e,a)=>{let o=e.target.files;if(o&&o.length>0){var t,n,s,i;let l=new FormData;for(let d=0;d<o.length;d++)l.append("files[]",o[d]);l.append("usuarioID",M.usuarioID),l.append("unidadeID",O.unidadeID),l.append("produtoAnexoID",null!==(t=a.produtoAnexoID)&&void 0!==t?t:null);try{await r.h.post("".concat(eQ,"/saveAnexo/").concat(b,"/produto/").concat(M.usuarioID,"/").concat(J.unidadeID),l);let c=eX.getValues();ai(c)}catch(u){F.ZP.error(null!==(i=null===(n=u.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)&&void 0!==i?i:"Erro ao atualizar anexo, tente novamente!")}finally{eo(!ea)}}},ad=async(e,a)=>{let o=e.target.files;if(o&&o.length>0){var t,n,s,i;let l=new FormData;for(let d=0;d<o.length;d++)l.append("files[]",o[d]);l.append("usuarioID",M.usuarioID),l.append("unidadeID",O.unidadeID),l.append("grupoAnexoItemID",null!==(t=a.grupoAnexoItemID)&&void 0!==t?t:null);try{await r.h.post("".concat(eQ,"/saveAnexo/").concat(b,"/grupo-anexo/").concat(M.usuarioID,"/").concat(J.unidadeID),l);let c=eX.getValues();ai(c)}catch(u){F.ZP.error(null!==(i=null===(n=u.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)&&void 0!==i?i:"Erro ao atualizar anexo, tente novamente!")}finally{eo(!ea)}}},ac=async(e,a)=>{let o=e.target.files;if(o&&o.length>0){var t,n,s,i,l;let d=new FormData;for(let c=0;c<o.length;c++)d.append("files[]",o[c]);d.append("usuarioID",M.usuarioID),d.append("unidadeID",O.unidadeID),d.append("parFornecedorModeloBlocoID",null!==(t=a.parFornecedorModeloBlocoID)&&void 0!==t?t:null),d.append("itemOpcaoAnexoID",null!==(n=a.itemOpcaoAnexoID)&&void 0!==n?n:null);try{await r.h.post("".concat(eQ,"/saveAnexo/").concat(b,"/item/").concat(M.usuarioID,"/").concat(J.unidadeID),d);let u=eX.getValues();ai(u)}catch(m){F.ZP.error(null!==(l=null===(s=m.response)||void 0===s?void 0:null===(i=s.data)||void 0===i?void 0:i.message)&&void 0!==l?l:"Erro ao atualizar anexo, tente novamente!")}finally{eo(!ea)}}},au=async e=>{e&&await r.h.delete("".concat(eQ,"/deleteAnexo/").concat(b,"/").concat(e.anexoID,"/").concat(J.unidadeID,"/").concat(M.usuarioID,"/produto")).then(e=>{let a=eX.getValues();ai(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")}).finally(()=>{eo(!ea)})},am=async e=>{e&&await r.h.delete("".concat(eQ,"/deleteAnexo/").concat(b,"/").concat(e.anexoID,"/").concat(J.unidadeID,"/").concat(M.usuarioID,"/grupo-anexo")).then(e=>{let a=eX.getValues();ai(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")}).finally(()=>{eo(!ea)})},ap=async e=>{e&&await r.h.delete("".concat(eQ,"/deleteAnexo/").concat(b,"/").concat(e.anexoID,"/").concat(J.unidadeID,"/").concat(M.usuarioID,"/item")).then(e=>{let a=eX.getValues();ai(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")}).finally(()=>{eo(!ea)})},ax=e=>{e.preventDefault();let a=eX.getValues();ai(a)};return(0,n.useEffect)(()=>{"edit"==eJ&&e7(),P({user:M,report:{id:b}})},[b,ea]),(0,n.useEffect)(()=>{aa()},[eL]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("form",{onSubmit:e=>ax(e),children:[(0,t.jsx)(I.Z,{btnCancel:!0,btnDelete:(null==eP?void 0:eP.status)<40&&1===M.papelID,onclickDelete:()=>eq(!0),btnSave:(null==eP?void 0:eP.status)<40,btnSend:1==M.papelID&&(!!eP&&eP.status>=30&&eP.status<40&&1==J.quemPreenche||!!eP&&40==eP.status&&2==J.quemPreenche)||2==M.papelID&&eP.status<40&&2==J.quemPreenche,btnPrint:"edit"==eJ,actionsData:e5,actions:!0,handleSubmit:()=>eX.handleSubmit(ai),handleSend:at,iconConclusion:"solar:check-read-linear",titleConclusion:"Concluir",title:"Fornecedor",btnStatus:"edit"==eJ,handleBtnStatus:()=>ei(!0),type:eJ,status:et}),E&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[et&&(0,t.jsx)(c.Z,{size:"small",skin:"light",color:et.color,label:et.title,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}}),(0,t.jsx)(c.Z,{size:"small",skin:"light",color:"primary",label:((null==J?void 0:J.quemPreenche)==1?"F\xe1brica":"Fornecedor")+" preenche"}),(0,t.jsx)(c.Z,{size:"small",skin:"light",label:"Modelo ".concat(null==J?void 0:J.modelo)})]}),(0,t.jsxs)(p.Z,{display:"flex",flexDirection:"column",sx:{gap:6},children:[eM&&eM.length>0&&(0,t.jsxs)(x.Z,{severity:"info",sx:{mb:2},children:[(0,t.jsxs)("h1",{children:["Os seguintes campos foram copiados de ",(0,t.jsx)("strong",{children:"Meus Dados"}),":"]}),(0,t.jsx)("div",{className:"pt-2",children:eM.map(e=>(0,t.jsx)("div",{className:"flex opacity-80",children:(0,t.jsx)("p",{children:"- ".concat(e.name," (").concat(e.value,")")})}))})]}),(0,t.jsx)(eC.Z,{description:eP.cabecalhoModelo}),(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:J&&eD&&(0,t.jsx)(ev,{modeloID:J.parFornecedorModeloID,values:el,fields:ep,disabled:!eG.status||_,getAddressByCep:ao,form:eX},eL)})}),X&&X.length>0&&(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(ex,{values:X,handleFileSelect:al,handleRemove:au,disabled:!eG.status||_,errors:null===(a=eX.formState)||void 0===a?void 0:null===(o=a.errors)||void 0===o?void 0:o.produtos},eL)})}),eD&&eD.map((e,a)=>(0,t.jsx)(l.Z,{form:eX,bloco:e,index:a,blockKey:"parFornecedorModeloBlocoID",setBlocos:eF,blocos:eD,disabled:!eG.status||_,handleFileSelect:ac,handleRemoveAnexoItem:ap,status:eP.status,isFornecedorLogged:(null==J?void 0:J.quemPreenche)===2&&2===M.papelID})),K&&K.map((e,a)=>{var o;return(0,t.jsx)(m.Z,{values:{grupo:e,indexGrupo:a,handleFileSelect:ad,handleRemove:am,folder:"grupo-anexo",disabled:!eG.status,error:null===(o=eX.formState)||void 0===o?void 0:o.errors}},a)}),eP&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(g.ZP,{container:!0,spacing:4,children:(0,t.jsx)(g.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(v.Z,{fullWidth:!0,children:[(0,t.jsx)(j.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(u.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:3,value:eP.obs,disabled:!eG.status||_,form:eX})]})})})})})}),es&&(0,t.jsx)(d.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(b," do Fornecedor."),id:b,parFormularioID:1,formStatus:eP.status,hasFormPending:_,canChangeStatus:!_&&2==J.quemPreenche&&eP.status>=40,openModal:es,handleClose:()=>ei(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:eY}),(0,t.jsx)(N.Z,{openModal:eE,handleClose(){eA(!1),aa()},title:"Concluir Fornecedor",text:"Deseja realmente concluir este formul\xe1rio?",info:eP,canChange:!_,form:eX,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:ar,listErrors:ez,handleSend:at,canApprove:!0,type:"fornecedor",unity:J,values:eu,formularioID:1,modeloID:null==J?void 0:J.parFornecedorModeloID}),(0,t.jsx)(eZ.Z,{parFormularioID:1,id:b},ea)]})]}),!E&&(0,t.jsx)(eI,{values:z})]}),(0,t.jsx)(eb.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/fornecedor/delete/".concat(b),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eT,handleClose:()=>eq(!1)})]})};var eN=o(60565),ew=o(72819),eP=o(47842);let eV=e=>{let{values:a}=e;return(0,t.jsx)("div",{children:(0,t.jsxs)(p.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsxs)(j.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"E-mail enviado para: "})," ",null==a?void 0:a.email]}),(0,t.jsxs)(j.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"Link do formul\xe1rio: "})," ",null==a?void 0:a.link]})]})})};var eE=o(30944),eA=o(30140);let ez=()=>{let{user:e,loggedUnity:a}=(0,n.useContext)(S.V),o=(0,b.useRouter)(),i=o.pathname,{setTitle:l}=(0,n.useContext)(eN.f),{id:d,setId:c}=(0,n.useContext)(y.X),[u,m]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1),[f,h]=(0,n.useState)(null),[g,v]=(0,n.useState)(!1),{isCpf:j,setIsCpf:Z}=(0,n.useContext)(er.YF),[I,C]=(0,n.useState)({module:"fornecedor",type:"open"}),{form:N,dataSupplier:w,startFilter:P,SelectFilterByName:V,setFilteredDataSupplier:E,filteredDataSupplier:A,setDataSupplier:z,setKey:R,key:k}=(0,eE.L0)(),M=()=>{m(!0)},O=async()=>{try{let o=await r.h.post("".concat(i,"/getList/"),{unidadeID:a.unidadeID,papelID:e.papelID,cnpj:e.cnpj?e.cnpj:null,status:I});if(!o.data)return;E(o.data),z(o.data),l({icon:"mdi:truck-fast-outline",title:"Fornecedor",subtitle:{id:d,count:o.data.length,new:!1}})}catch(t){console.log(t)}},T=async o=>{try{var t,n,s,i;let l={usuarioID:e.usuarioID,papelID:e.papelID,profissionalID:e.profissionalID,unidadeID:a.unidadeID,values:o.fields,habilitaQuemPreencheFormFornecedor:o.habilitaQuemPreencheFormFornecedor,fornecedorCategoriaID:null===(t=o.fields)||void 0===t?void 0:null===(n=t.categoria)||void 0===n?void 0:n.fornecedorCategoriaID,fornecedorCategoriaRiscoID:null===(s=o.fields)||void 0===s?void 0:null===(i=s.risco)||void 0===i?void 0:i.fornecedorCategoriaRiscoID,isCpf:j};m(!1);let d=await r.h.post("/formularios/fornecedor/makeFornecedor",l);200==d.status&&(F.ZP.success(d.data.message),g?(x(!0),h(d.data.result),O()):c(d.data.result.fornecedorID))}catch(u){console.error("Erro ao enviar email",u)}},q=()=>{let e=null==f?void 0:f.link;e&&(navigator.clipboard.writeText(e),F.ZP.success("Link copiado com sucesso!"))};(0,n.useEffect)(()=>{E([]),z([])},[o.query]),(0,n.useEffect)(()=>{O(),P((0,t.jsx)(eA.default,{}))},[d,o.query,I]);let H=1==e.papelID?[{headerName:"ID",field:"id",size:.4},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:.4,type:"date"},{headerName:"Fornecedor",field:"fornecedor",size:1},{headerName:"Produtos",field:"produtos",size:1},{headerName:"Quem preenche",field:"quemPreenche",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:.5,type:"statusSteps"}]:2==e.papelID?[{headerName:"ID",field:"id",size:.4},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:.4,type:"date"},{headerName:"F\xe1brica",field:"fabrica",size:1},{headerName:"Produtos",field:"produtos",size:1},{headerName:"Respons\xe1vel",field:"responsavel",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:.5,type:"statusSteps"}]:[],$=(0,D.OL)(i,H);return(0,t.jsxs)(t.Fragment,{children:[A?d&&d>0?(0,t.jsx)(eF,{id:d,makeFornecedor:T}):(0,t.jsx)(s.Z,{result:A,columns:$,openModal:1==e.papelID?M:null,btnNew:1==e.papelID,status:I,setStatus:C},"".concat(k,"-").concat(A)):(0,t.jsx)(eP.Z,{show:!0}),(0,t.jsx)(ew.Z,{title:"Habilitar Fornecedor",handleConclusion:T,setOpenModal:m,openModal:u,size:"lg",fullHeight:!0,clone:!0,children:(0,t.jsx)(ec,{setIsNotFactory:v,isNotFactory:g})}),(0,t.jsx)(ew.Z,{title:"Formul\xe1rio enviado ao fornecedor",description:"Um novo formul\xe1rio de qualifica\xe7\xe3o de fornecedor foi enviado",handleCopyLink:q,setOpenModal:x,openModal:p,form:N,children:(0,t.jsx)("div",{children:(0,t.jsx)(eV,{values:f})})})]})};var eR=ez},69175:function(e,a,o){"use strict";o.d(a,{Z:function(){return y}});var t=o(85893),n=o(67294),r=o(3693),s=o(75680),i=o(87653),l=o(83830),d=o(1890),c=o(60664),u=o(11163),m=o(77745),p=o(29630),x=o(95398),f=o(79072),h=o(21609),g=o(80562),v=o(40039),j=o(66136),b=o(92024);let Z=e=>{let{open:a,handleClose:o,row:r}=e,s=(0,u.useRouter)(),[i,l]=(0,n.useState)(null),{loggedUnity:Z}=(0,n.useContext)(v.V),D=s.pathname,{settings:I}=(0,n.useContext)(j.J6),y=I.mode,S=async()=>{let e=await c.h.get("".concat(D,"/getData/").concat(Z.unidadeID,"/").concat(r.id));l(e.data)};return(0,n.useEffect)(()=>{r&&S()},[r]),r&&i&&(0,t.jsxs)(d.Z,{open:a,onClose:o,scroll:"paper",maxWidth:"md",fullWidth:!0,children:[(0,t.jsxs)(m.Z,{id:"customized-dialog-title",sx:{textAlign:"center"},children:[(0,t.jsx)(p.Z,{variant:"h5",component:"span",children:r.nome}),(0,t.jsx)(p.Z,{variant:"body2",children:"Este log #".concat(r.id," gerou um total de ").concat(i.length," ").concat(1==i.length?"script":"scripts")}),(0,t.jsx)(g.Z,{"aria-label":"close",onClick:o,sx:{top:10,right:10,position:"absolute",color:"grey.500"},children:(0,t.jsx)(h.Z,{icon:"mdi:close"})})]}),(0,t.jsxs)(x.Z,{sx:{p:10,mt:8},children:[(0,t.jsxs)(f.ZP,{container:!0,spacing:8,children:[(0,t.jsxs)(f.ZP,{item:!0,md:4,sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsx)(h.Z,{icon:"fluent-mdl2:date-time-mirrored",className:"text-5xl"}),(0,t.jsx)("span",{children:r.dataHora})]}),(0,t.jsxs)(f.ZP,{item:!0,md:4,sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsx)(h.Z,{icon:"majesticons:user-line",className:"text-5xl"}),(0,t.jsx)("span",{children:r.usuario})]}),(0,t.jsxs)(f.ZP,{item:!0,md:4,sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsx)(h.Z,{icon:"material-symbols-light:bring-your-own-ip",className:"text-5xl"}),(0,t.jsx)("span",{children:r.ip})]})]}),(0,t.jsx)("div",{className:"flex flex-col gap-4 mt-8",children:i.map(e=>(0,t.jsxs)("div",{className:"border ".concat("dark"==y?"border-white/20":"border-black/20","   rounded-xl p-4 space-y-4 h-auto"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(b.Z,{skin:"light",color:"insert"==e.operacao?"success":"update"==e.operacao?"warning":"delete"==e.operacao?"error":(e.operacao,"info"),variant:"rounded",sx:{mr:3,width:48,height:48},children:(0,t.jsx)(h.Z,{icon:"insert"==e.operacao?"dashicons:insert":"update"==e.operacao?"akar-icons:edit":"delete"==e.operacao?"mingcute:delete-line":"login"==e.operacao?"ic:round-login":"email"==e.operacao?"mynaui:send":"ic:round-logout"})}),(0,t.jsx)(p.Z,{sx:{color:"text.secondary",marginTop:"-4px"},children:"insert"==e.operacao?"Inclus\xe3o":"update"==e.operacao?"Altera\xe7\xe3o":"delete"==e.operacao?"Exclus\xe3o":"login"==e.operacao?"Login efetuado":"email"==e.operacao?"Envio de E-mail":"Logout efetuado"})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex flex-col justify-end ",children:[(0,t.jsx)(p.Z,{variant:"caption",sx:{color:"text.disabled",textAlign:"right"},children:"Tabela"}),(0,t.jsx)(p.Z,{sx:{color:"text.secondary",marginTop:"-4px"},children:e.tabela})]})})]}),(0,t.jsx)("div",{className:"".concat("dark"===y?"bg-[#212b36]":"bg-[#f7f7f9]"," p-2 rounded-lg"),children:(0,t.jsx)("pre",{children:function(e,a){try{let o=JSON.parse(e),n=JSON.stringify(o,null,2);return n=n.replace(/(\"alterado\": true)/g,'<span style="background-color: #ce9728; padding: 2px 1px; border-radius: 4px">$1</span>'),(0,t.jsx)("pre",{dangerouslySetInnerHTML:{__html:n}})}catch(r){return e}}(e.alteracao,e.operacao)})})]}))}),(0,t.jsx)("div",{})]})]})};var D=o(30944);let I=e=>{let{rows:a,columns:o,filters:d,buttonsHeader:c,modalLog:u}=e,{pageSize:m,setPageSize:p,data:x}=(0,D.L0)(),{setId:f}=(0,n.useContext)(l.X),[h,g]=(0,n.useState)(null),[v,j]=(0,n.useState)(!1);function b(e){let a=e.split("/");return"".concat(a[2],"-").concat(a[1],"-").concat(a[0])}x.slice().sort((e,a)=>"Inativo"===e.status&&"Inativo"!==a.status?1:"Inativo"!==e.status&&"Inativo"===a.status?-1:0),o.map(e=>{"date"===e.type&&(e.sortComparator=(e,a)=>{let o=b(e),t=b(a);return o.localeCompare(t)})});let I=e=>{u?(g(e),j(!0)):(console.log("aqui: ",e.id),c.setCustomId?c.setCustomId(e.id):f(e.id))};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r._,{localeText:s.F.components.MuiDataGrid.defaultProps.localeText,autoHeight:!0,columns:o,pageSize:m,rowsPerPageOptions:[10,20,30,40,50,100],components:{Toolbar:i.Z},rows:a,onCellClick(e,a){I(e.row)},onPageSizeChange:e=>p(e),sx:{"& .MuiDataGrid-cell":{cursor:"pointer",overflow:"scroll"}},componentsProps:{toolbar:{buttonsHeader:c,rows:a,filters:d}}}),(0,t.jsx)(Z,{open:v,handleClose:()=>j(!1),row:h})]})};var y=I}},function(e){e.O(0,[4738,4186,1445,1111,5999,594,172,2187,137,8163,5698,3005,6666,233,1276,9774,2888,179],function(){return e(e.s=59424)}),_N_E=e.O()}]);