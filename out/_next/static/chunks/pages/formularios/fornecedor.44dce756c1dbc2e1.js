(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7463],{59424:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/fornecedor",function(){return o(77735)}])},92024:function(e,a,o){"use strict";var t=o(85893),l=o(67294),n=o(44731),s=o(62097),i=o(41796),r=o(19550);let d=(0,l.forwardRef)((e,a)=>{let{sx:o,src:l,skin:d,color:c}=e,u=(0,s.Z)(),m=(0,r.Z)(),x=(e,a)=>"light"===e?{...m["".concat(a,"Light")]}:"light-static"===e?{color:m["".concat(a,"Light")].color,backgroundColor:(0,i.$n)(u.palette[a].main,.88)}:{...m["".concat(a,"Filled")]},p={primary:x(d,"primary"),secondary:x(d,"secondary"),success:x(d,"success"),error:x(d,"error"),warning:x(d,"warning"),info:x(d,"info")};return(0,t.jsx)(n.Z,{ref:a,...e,sx:!l&&d&&c?Object.assign(p[c],o):o})});d.defaultProps={skin:"filled",color:"primary"},a.Z=d},77993:function(e,a,o){"use strict";o.d(a,{Z:function(){return P}});var t=o(85893),l=o(11163),n=o.n(l),s=o(67294),i=o(60565),r=o(83830),d=o(40039),c=o(60664),u=o(49837),m=o(91359),x=o(79072),p=o(29630),f=o(54225),h=o(21609),v=o(87536),g=o(86501),j=o(45061),D=o(47842),Z=o(92477),I=o(71798),b=o(41088),y=o(84220),S=o(29308),C=o(67569),F=o(88475);let N=e=>{let{getValues:a,removeItem:o,control:l,register:n,errors:s,type:i}=e;return a("items")&&a("items").map((e,a)=>{var r,d,c,u;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z,{xs:12,md:3,title:"Nome",name:"items[".concat(a,"].nome"),required:!0,control:l,errors:null==s?void 0:null===(r=s.items)||void 0===r?void 0:null===(d=r[a])||void 0===d?void 0:d.nome}),(0,t.jsx)(S.Z,{xs:12,md:6,title:"Descri\xe7\xe3o",name:"items[".concat(a,"].descricao"),required:!1,control:l,errors:null==s?void 0:null===(c=s.items)||void 0===c?void 0:null===(u=c[a])||void 0===u?void 0:u.descricao}),(0,t.jsx)(C.Z,{xs:4,md:1,title:"Ativo",index:a,name:"items[".concat(a,"].status"),value:e.status,typePage:i,register:n}),(0,t.jsx)(C.Z,{xs:4,md:1,title:"Obrigat\xf3rio",index:a,name:"items[".concat(a,"].obrigatorio"),value:e.obrigatorio,typePage:i,register:n}),(0,t.jsx)(F.Z,{xs:4,md:1,title:"Remover",index:a,removeItem:o,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"})]})})},w=e=>{var a,o,l,F;let{id:w,btnClose:P,handleConfirmNew:A,handleModalClose:E,newChange:z,manualUrl:k,outsideID:M}=e,{setId:R}=(0,s.useContext)(r.X),q=n(),[O,H]=(0,s.useState)(null),[T,V]=(0,s.useState)(!1),L=w&&w>0?"edit":"new",_=q.pathname,{title:G}=(0,s.useContext)(i.f),{loggedUnity:U,user:B}=(0,s.useContext)(d.V),[J,Q]=(0,s.useState)(!1),[W,X]=(0,s.useState)([]),[Y,K]=(0,s.useState)(!1),{startLoading:$,stopLoading:ee}=(0,b.Z)(),{trigger:ea,handleSubmit:eo,setValue:et,reset:el,getValues:en,control:es,formState:{errors:ei},register:er}=(0,v.cI)({mode:"onChange"}),ed=async()=>{try{let e="new"===L?"cadastros/grupo-anexos/new/getData":"".concat(_,"/getData/").concat(w);await c.h.post(e,{unidadeID:U.unidadeID}).then(e=>{H(e.data),el(e.data)})}catch(a){console.log(a)}},ec=()=>{let e=[...en("items"),{nome:"",descricao:"",status:!0,obrigatorio:!0}];et("items",e),K(!Y)},eu=(e,a)=>{if(1===O.items.length){g.ZP.error("\xc9 necess\xe1rio ter pelo menos um item!");return}e.id&&X([...W,e.id]);let o=en("items").filter((e,o)=>o!==a);et("items",o),K(!Y)},em=async e=>{let a={...e,usuarioID:B.usuarioID,unidadeID:U.unidadeID};$(),a.removedItems=W,a.unidade=U.unidadeID;try{"new"===L?await c.h.post("cadastros/grupo-anexos/new/insertData",a).then(e=>{A?A(e.data,"gruposAnexo"):(q.push("".concat((0,I.g_)(_))),R(e.data.id)),g.ZP.success(I.OD.successNew)}):"edit"===L&&(await c.h.post("".concat(_,"/updateData/").concat(w),a),g.ZP.success(I.OD.successUpdate)),Q(!J)}catch(o){o.response&&409===o.response.status?g.ZP.error(I.OD.errorRepeated):console.log(o)}finally{ee()}},ex=async()=>{try{await c.h.delete("".concat(_,"/deleteData/").concat(w,"/").concat(B.usuarioID,"/").concat(U.unidadeID)),R(null),setOpen(!1),g.ZP.success(I.OD.successDelete),console.log("entrou")}catch(e){e.response&&409===e.response.status?(g.ZP.error(I.OD.pendingDelete),V(!1)):console.log(e)}};return(0,s.useEffect)(()=>{ed(),setTimeout(()=>{ea()},300)},[w]),(0,s.useEffect)(()=>{z&&eo(em)()},[z]),(0,t.jsxs)(t.Fragment,{children:[!O&&(0,t.jsx)(D.Z,{}),O&&(0,t.jsxs)("form",{onSubmit:eo(em),children:[(0,t.jsx)(Z.Z,{btnCancel:!0,btnNew:!A,btnSave:!0,manualUrl:k,btnClose:P,handleModalClose:E,handleSubmit:()=>eo(em),btnDelete:"edit"===L,onclickDelete:()=>V(!0),type:L,outsideID:M}),(0,t.jsx)(u.Z,{children:O&&(0,t.jsx)(m.Z,{children:(0,t.jsxs)(x.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(S.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:es,errors:null==ei?void 0:null===(a=ei.fields)||void 0===a?void 0:a.nome}),(0,t.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:O.fields.status,typePage:L,register:er}),(0,t.jsx)(S.Z,{xs:12,md:12,title:"Descri\xe7\xe3o",name:"fields.descricao",required:!1,control:es,errors:null==ei?void 0:null===(o=ei.fields)||void 0===o?void 0:o.descricao}),(0,t.jsx)(y.Z,{xs:12,md:12,title:"Formul\xe1rios",name:"formulario.fields",value:null!==(F=null==O?void 0:O.formulario.fields)&&void 0!==F?F:null,multiple:!0,limitTags:5,required:!0,options:O.formulario.options,register:er,setValue:et,control:es,errors:null==ei?void 0:null===(l=ei.formulario)||void 0===l?void 0:l.fields})]})})}),(0,t.jsx)(u.Z,{sx:{mt:4},children:(0,t.jsxs)(m.Z,{children:[(0,t.jsx)(p.Z,{sx:{mb:5},children:"Itens"}),(0,t.jsx)(x.ZP,{container:!0,spacing:3,children:(0,t.jsx)(N,{getValues:en,removeItem:eu,control:es,register:er,errors:ei,type:L},Y)}),(0,t.jsx)(f.Z,{variant:"outlined",color:"primary",sx:{mt:4},startIcon:(0,t.jsx)(h.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ec()},children:"Inserir item"})]})})]}),(0,t.jsx)(j.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+G.title,openModal:T,handleClose:()=>V(!1),handleSubmit:ex,btnCancel:!0,btnConfirm:!0})]})};var P=w},93250:function(e,a,o){"use strict";var t=o(85893),l=o(49837),n=o(91359),s=o(69175);let i=e=>{let{result:a,columns:o,btnNew:i=!0,btnPrint:r=!0,btnBack:d,openModal:c,modalLog:u,btnNewModal:m,handleNewModal:x}=e;return(0,t.jsx)(l.Z,{children:(0,t.jsx)(n.Z,{sx:{pt:"0"},children:(0,t.jsx)(s.Z,{rows:a,columns:o,modalLog:u,buttonsHeader:{btnNew:i,btnPrint:r,btnBack:d,openModal:c,btnNewModal:m,handleNewModal:x}})})})};a.Z=i},46905:function(e,a,o){"use strict";var t=o(85893),l=o(87536),n=o(79072),s=o(55343),i=o(67836);let r=e=>{let{xs:a,md:o,title:r,name:d,disabled:c,required:u,form:m,onChange:x}=e;return(0,t.jsx)(n.ZP,{item:!0,xs:a,md:o,children:(0,t.jsx)("div",{children:(0,t.jsx)(s.Z,{fullWidth:!0,children:(0,t.jsx)(l.Qr,{name:d,control:m.control,rules:{required:u},render(e){let{field:a}=e;return(0,t.jsx)(i.Z,{label:r,value:null==a?void 0:a.value,placeholder:r,type:"date",size:"small","aria-describedby":"validation-schema-nome",disabled:c,error:!!m.formState.errors[d],onChange(e){let o=e.target.value;a.onChange(o),x&&x(o)},InputLabelProps:{shrink:!0},inputProps:{min:"1900-01-01",max:"2100-01-01"}})}})})})})};a.Z=r},55148:function(e,a,o){"use strict";var t=o(85893),l=o(79072),n=o(55343),s=o(35966),i=o(67836),r=o(87536),d=o(53934),c=o(30944);let u=e=>{let{xs:a,md:o,title:u,options:m,form:x,name:p,limitTags:f,value:h,required:v,disabled:g,multiple:j,onChange:D,className:Z,keyProps:I,createNew:b,helpText:y,helpTextPosition:S}=e,C=b?[{id:null,name:"-- Novo --"},...null!=m?m:[]]:m,{key:F}=(0,c.L0)();return(0,t.jsx)(l.ZP,{item:!0,xs:a,md:o,sx:{my:1},className:Z,children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(n.Z,{fullWidth:!0,children:(0,t.jsx)(r.Qr,{name:p,control:x.control,rules:{required:v},render(e){var a;let{field:o}=e;return(0,t.jsx)(s.Z,{options:C.map(e=>e.name),value:null!=h?h:null===(a=x.getValues(p))||void 0===a?void 0:a.name,onChange(e,a){let o=C.find(e=>e.name===a);x.setValue(p,null!=o?o:null),D&&D(a)},renderInput(e){var a;return(0,t.jsx)(i.Z,{...e,id:"customSelect",size:"small",label:u,placeholder:u,error:!!x.formState.errors[p],helperText:null===(a=x.formState.errors[p])||void 0===a?void 0:a.message})}},I||F)}})}),y&&(0,t.jsx)("div",{className:"absolute right-[60px] top-[12px] ",children:(0,t.jsx)(d.Z,{text:y,position:null!=S?S:"top"})})]})})};a.Z=u},30140:function(e,a,o){"use strict";o.r(a);var t=o(85893),l=o(67294),n=o(46905),s=o(55148),i=o(51570),r=o(30944);let d=()=>{var e,a;let{form:o,setNames:d,filterDate:c,SelectFilterByName:u,dataSupplier:m,setFilteredDataSupplier:x,handleSearch:p,key:f,setKey:h}=(0,r.L0)(),{commonData:v}=(0,i.Lq)(),g=m,j=async()=>{x(g=await u(g=await u(g=await c(g=await p(g)),"status"),"quemPreenche"))};return(0,l.useEffect)(()=>{j()},[f]),(0,l.useEffect)(()=>{d(["dataInicio","dataFim","quemPreenche","status"])},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Z,{xs:12,md:6,title:"Data in\xedcio da avaliac\xe3o",name:"dataInicio",form:o}),(0,t.jsx)(n.Z,{xs:12,md:6,title:"Data Fim da avalia\xe7\xe3o",name:"dataFim",form:o}),(0,t.jsx)(s.Z,{xs:12,md:6,title:"Status",name:"status",form:o,options:v.status,value:null===(e=o.getValues("status"))||void 0===e?void 0:e.name}),(0,t.jsx)(s.Z,{xs:12,md:6,title:"Quem preencheu",name:"quemPreenche",value:null===(a=o.getValues("quemPreenche"))||void 0===a?void 0:a.name,form:o,options:[{id:"1",name:"F\xe1brica"},{id:"2",name:"Fornecedor"}]})]})};a.default=d},77735:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return eZ}});var t=o(85893),l=o(67294),n=o(60664),s=o(93250),i=o(87536),r=o(99734),d=o(34282),c=o(7071),u=o(29308),m=o(23895),x=o(61953),p=o(19604),f=o(49837),h=o(91359),v=o(79072),g=o(55343),j=o(29630),D=o(11163),Z=o.n(D),I=o(71798),b=o(92477),y=o(83830),S=o(40039),C=o(39976),F=o(86501),N=o(82755),w=o(22416),P=o(22841),A=o(16056);let E=e=>{let{xs:a,md:o,title:l,index:n,name:s,typePage:i,value:r,disabled:d,register:c,...u}=e;return(0,t.jsx)(v.ZP,{item:!0,xs:a,md:o,children:(0,t.jsx)(x.Z,{display:"flex",flexDirection:"column",alignItems:"start",children:(0,t.jsx)(P.Z,{control:(0,t.jsx)(A.Z,{...u,name:s,...c(s),defaultChecked:r,disabled:d,onChange(e){u.onChange&&u.onChange(e.target.checked,n,s,i)}}),label:l,size:"small",sx:{"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})})})},z=e=>{let{data:a,control:o,setValue:n,register:s,errors:i}=e,[r,d]=(0,l.useState)(!0);return n("emailDestinatario",a.email),(0,t.jsxs)("div",{className:"flex flex-col gap-2 pt-2",children:[r&&(0,t.jsx)(u.Z,{name:"emailDestinatario",type:"email",title:"E-mail do destinat\xe1rio",required:!0,control:o,errors:i.emailDestinatario}),(0,t.jsx)(u.Z,{name:"assunto",title:"Assunto",required:!0,register:s,control:o,defaultValue:"",errors:i.assunto}),(0,t.jsx)(u.Z,{name:"descricao",title:"Descri\xe7\xe3o",multiline:!0,rows:4,required:!0,control:o,defaultValue:"",errors:i.descricao}),(0,t.jsxs)(w.Z,{row:!0,children:[(0,t.jsx)(E,{name:"email",title:"E-mail",value:!0,register:s,onChange:()=>d(!r)}),(0,t.jsx)(E,{name:"alerta",title:"Alerta",value:!0,register:s})]})]})};var k=o(44642),M=o(82747),R=o(84220),q=o(75158),O=o(1322),H=o(77993),T=o(69291),V=o(62135),L=o(54225),_=o(78633),G=o(21609);let U=l.memo(e=>{let{xs:a,md:o,name:n,register:s,setValue:i,setIsNotFactory:r}=e,[d,c]=(0,l.useState)(1);return(0,l.useEffect)(()=>{n&&s&&i(n,d)},[n,s,d,i,r]),(0,t.jsxs)(v.ZP,{item:!0,xs:a,md:o,children:[(0,t.jsxs)(V.Z,{color:"primary",children:[(0,t.jsx)(L.Z,{onClick(){r(!1),c(1)},variant:1===d?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 py-2 px-1",children:[(0,t.jsx)(G.Z,{icon:"mdi:company"}),(0,t.jsx)("p",{className:"capitalize",children:"F\xe1brica"})]})}),(0,t.jsx)(L.Z,{onClick(){r(!0),c(2)},variant:2===d?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 py-2 px-1",children:[(0,t.jsx)(G.Z,{icon:"mdi:truck-fast-outline"}),(0,t.jsx)("p",{className:"capitalize",children:"Fornecedor"})]})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-4",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)(_.gH_,{})}),(0,t.jsx)("p",{className:"text-sm",children:"".concat(1==d?"F\xe1brica ficar\xe1 respons\xe1vel pelo preenchimento do formul\xe1rio":"Fornecedor ficar\xe1 respons\xe1vel pelo preenchimento do formul\xe1rio, ser\xe1 enviado um e-mail com instru\xe7\xf5es de preenchimento ao fornecedor e a f\xe1brica ir\xe1 monitorar o status")})]}),n&&s&&(0,t.jsx)("input",{type:"hidden",name:n,...s(n),value:d})]})});var B=o(431);let J=e=>{var a,o,s,i,r,d,c,m;let{fields:p,params:f,habilitaQuemPreencheFormFornecedor:h,setFields:v,handleCnpjCpf:g,validCnpj:D,getValues:Z,control:I,errors:b,setValue:y,register:C,watch:F,trigger:N,reset:w,setIsNotFactory:A,isNotFactory:E}=e,{loggedUnity:z}=(0,l.useContext)(S.V),[k,V]=(0,l.useState)([]),[L,_]=(0,l.useState)([]),[G,J]=(0,l.useState)([]),[Q,W]=(0,l.useState)(!1),[X,Y]=(0,l.useState)(!1),[K,$]=(0,l.useState)(""),[ee,ea]=(0,l.useState)(null),[eo,et]=(0,l.useState)([]),[el,en]=(0,l.useState)([]),[es,ei]=(0,l.useState)(!1),{isCpf:er,setIsCpf:ed}=(0,l.useContext)(B.YF),ec=async()=>{let e=await n.h.post("/formularios/fornecedor/getModels",{unidadeID:z.unidadeID});V(e.data)},eu=async()=>{let e=await n.h.post("/formularios/fornecedor/getProducts",{unidadeID:z.unidadeID});_(e.data)},em=async()=>{var e;let a=await n.h.post("/configuracoes/formularios/fornecedor/getCategories",{unidadeID:z.unidadeID});ex(a.data,null===(e=Z("fields.categoria"))||void 0===e?void 0:e.id),et(a.data)},ex=(e,a)=>{var o;let t=null===(o=e.find(e=>e.id==a))||void 0===o?void 0:o.riscos;en(t)},ep=()=>{er&&(!Z("fields.nomeFantasia")||""==Z("fields.nomeFantasia"))&&(y("fields.nomeFantasia",Z("fields.razaoSocial")),v({...p,nomeFantasia:Z("fields.razaoSocial")}))},ef=()=>{v(null),y("fields.cnpj",""),y("fields.razaoSocial",""),y("fields.nomeFantasia",""),y("fields.email",""),y("fields.categoria",null),y("fields.risco",null),y("fields.modelo",null),y("fields.gruposAnexo",[]),y("fields.produtos",[])},eh=async e=>{g(e,er),await em()};(0,l.useEffect)(()=>{w(),ec(),eu(),em()},[]),(0,l.useEffect)(()=>{eo.length>0&&Z("fields.categoria")&&ex(eo,Z("fields.categoria").id)},[eo,Z("fields.categoria")]),(0,l.useEffect)(()=>{y("fields.cnpj",""),N("fields.cnpj")},[er,N]);let ev=async(e,a)=>{if(Y(!1),"gruposAnexo"==a){J(a=>[...a,e]);let o=[...Z("fields.gruposAnexo")];o.push(e),y("fields.gruposAnexo",o)}else if("produtos"==a){_(a=>[...a,e]);let t=[...Z("fields.produtos")];t.push(e),y("fields.produtos",t)}W(!Q)},eg=async e=>{Y(!0),"gruposAnexo"==e?($("Novo grupo de anexos"),ea((0,t.jsx)(H.Z,{manualUrl:"/cadastros/grupo-anexos",btnClose:!0,handleModalClose:()=>Y(!1),newChange:Q,handleConfirmNew:ev,outsideID:!0}))):"produtos"==e&&($("Novo produto"),ea((0,t.jsx)(T.Z,{manualUrl:"/cadastros/produto",btnClose:!0,handleModalClose:()=>Y(!1),newChange:Q,handleConfirmNew:ev,outsideID:!0})))},ej=async e=>{Y(!1)};return(0,l.useEffect)(()=>{let e=F("fields.cnpj"),a=er?(0,M.sw)(e):(0,M.zk)(e);ei(a)},[er,Z("fields.cnpj")]),k&&L&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(x.Z,{children:[(null==f?void 0:f.habilitaQuemPreencheFormFornecedor)&&(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(U,{xs:12,md:12,register:C,name:"habilitaQuemPreencheFormFornecedor",setValue:y,setIsNotFactory:A})}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)(u.Z,{xs:12,md:12,title:er?"CPF":"CNPJ",name:"fields.cnpj",value:null==p?void 0:p.cnpj,onChange(e){eh(e)},clearField:Z("fields.cnpj")?ef:null,mask:er?"cpf":"cnpj",required:!0,control:I,errors:null==b?void 0:null===(a=b.fields)||void 0===a?void 0:a.cnpj}),!es&&(0,t.jsx)(j.Z,{variant:"body2",color:"error",children:er?"CPF Inválido":"CNPJ Inválido"})]}),(0,t.jsx)(P.Z,{label:"CPF",labelPlacement:"top",control:(0,t.jsx)(q.Z,{checked:er,onChange(e){ed(e.target.checked),g(Z("fields.cnpj"),e.target.checked)}}),sx:{position:"relative",top:-10}})]})]}),(0,t.jsx)(u.Z,{xs:12,md:12,title:er?"Nome":"Razão Social",name:"fields.razaoSocial",value:null==p?void 0:p.razaoSocial,onBlur:ep,disabled:!D,required:!0,control:I,errors:null==b?void 0:null===(o=b.fields)||void 0===o?void 0:o.razaoSocial}),(0,t.jsx)(u.Z,{xs:12,md:12,title:er?"Apelido":"Nome Fantasia",name:"fields.nomeFantasia",value:null==p?void 0:p.nomeFantasia,disabled:!D,required:!0,control:I,errors:null==b?void 0:null===(s=b.fields)||void 0===s?void 0:s.nomeFantasia}),E&&(0,t.jsx)(u.Z,{xs:12,md:12,type:"email",title:"E-mail",name:"fields.email",value:null==p?void 0:p.email,disabled:!D,required:!0,control:I,errors:null==b?void 0:null===(i=b.fields)||void 0===i?void 0:i.email}),!E&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.Z,{xs:12,md:12,title:"Categoria",name:"fields.categoria",value:null==p?void 0:p.categoria,disabled:!D,onChange(e){y("fields.categoria",e),y("fields.risco",null),ex(eo,e?e.id:null)},required:!0,options:null!=eo?eo:[],register:C,setValue:y,control:I,errors:null==b?void 0:null===(r=b.fields)||void 0===r?void 0:r.categoria}),(0,t.jsx)(R.Z,{xs:12,md:12,disabled:null==Z("fields.categoria"),title:"Risco",name:"fields.risco",value:null==p?void 0:p.risco,required:!0,options:null!=el?el:[],register:C,setValue:y,control:I,errors:null==b?void 0:null===(d=b.fields)||void 0===d?void 0:d.risco})]}),(0,t.jsx)(R.Z,{xs:12,md:12,title:"Produtos",name:"fields.produtos",value:null!==(m=null==p?void 0:p.produtos)&&void 0!==m?m:[],disabled:!D,multiple:!0,createNew:()=>eg("produtos"),required:null==f?void 0:f.obrigatorioProdutoFornecedor,options:null!=L?L:[],register:C,setValue:y,control:I,errors:null==b?void 0:null===(c=b.fields)||void 0===c?void 0:c.produtos}),(0,t.jsx)(O.Z,{title:K,size:"md",openModal:X,setOpenModal:Y,handleSave:ej,children:ee})]})};var Q=o(34175);let W=e=>{var a,o;let{sipeAgro:l}=e,n=()=>{let e=(e,a)=>l&&l[a]&&l[a].includes(e)?(0,t.jsx)(G.Z,{icon:"lets-icons:check-fill",className:"text-green-600 w-full"}):(0,t.jsx)(G.Z,{icon:"lets-icons:check-fill",className:"text-gray-100 w-full"});return(0,t.jsxs)("table",{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{}),(0,t.jsx)("td",{className:"text-center",children:(0,t.jsx)(j.Z,{variant:"caption",children:(0,t.jsx)("strong",{children:"Fabricante"})})}),(0,t.jsx)("td",{className:"text-center",children:(0,t.jsx)(j.Z,{variant:"caption",children:(0,t.jsx)("strong",{children:"Fracionador"})})}),(0,t.jsx)("td",{className:"text-center",children:(0,t.jsx)(j.Z,{variant:"caption",children:(0,t.jsx)("strong",{children:"Importador"})})})]}),[{name:"Aditivo",column:"aditivo"},{name:"Alimento",column:"alimento"},{name:"Concentrado",column:"concentrado"},{name:"Coproduto",column:"coproduto"},{name:"Ingrediente",column:"ingrediente"},{name:"N\xfacleo",column:"nucleo"},{name:"Premix",column:"premix"},{name:"Produto mastig\xe1vel",column:"produtoMastigavel"},{name:"Ra\xe7\xe3o",column:"racao"},{name:"Suplemento",column:"suplemento"}].map((a,o)=>(0,t.jsxs)("tr",{className:"border-b",children:[(0,t.jsx)("td",{className:"py-1",children:(0,t.jsx)(j.Z,{variant:"caption",children:(0,t.jsx)("strong",{children:a.name})})}),(0,t.jsx)("td",{className:"py-1",children:e(1,a.column)}),(0,t.jsx)("td",{className:"py-1",children:e(2,a.column)}),(0,t.jsx)("td",{className:"py-1",children:e(3,a.column)})]}))]})};return(0,t.jsx)(f.Z,{sx:{mt:4},children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)(j.Z,{variant:"body2",className:"flex justify-between",children:[(0,t.jsxs)("strong",{children:["Dados MAPA - \xdaltima atualiza\xe7\xe3o (",null!==(o=null==l?void 0:l.dataImportacao)&&void 0!==o?o:"----",")"]}),(0,t.jsxs)("span",{children:["Fonte dos dados:"," ",(0,t.jsx)("a",{className:"text-blue-500 hover:underline",target:"_blank",href:"https://www.gov.br/agricultura/pt-br/assuntos/insumos-agropecuarios/insumos-pecuarios/alimentacao-animal/registro-cadastro",children:"link"})]})]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Raz\xe3o Social:"})," ",null==l?void 0:null===(a=l.razaoSocial)||void 0===a?void 0:a.toUpperCase()]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Registro SIPEAGRO:"})," ",null==l?void 0:l.registroSipeAgro]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"SIPOA:"})," ",["Regi\xe3o Norte","Regi\xe3o Nordeste","Regi\xe3o Centro-Oeste","Regi\xe3o Sudeste","Regi\xe3o Sul","Goi\xe1s","Minas Gerais","Bahia","Paran\xe1","Rio Grande do Sul","S\xe3o Paulo"][(null==l?void 0:l.sipoa)-1]]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Situa\xe7\xe3o:"})," ",null==l?void 0:l.situacao]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Munic\xedpio:"})," ","".concat(null==l?void 0:l.municipio,"/").concat(null==l?void 0:l.uf)]}),(0,t.jsx)(n,{})]})})})},X=e=>{var a,o,s,i,r,d;let{cnpj:c,control:u,setValue:m,register:p,errors:g,clearErrors:D,reset:Z,getValues:I,watch:b,trigger:y,setIsNotFactory:C,isNotFactory:F}=e,[N,w]=(0,l.useState)(!1),{loggedUnity:P}=(0,l.useContext)(S.V),[A,E]=(0,l.useState)(null),[z,R]=(0,l.useState)(null),[q,O]=(0,l.useState)(null),[H,T]=(0,l.useState)(null),{isCpf:V,setIsCpf:L}=(0,l.useContext)(B.YF),_=(e,a)=>{a&&14==e.length||!a&&18==e.length?(a?(0,M.sw)(e):(0,M.zk)(e))?(T(!0),U(e,a),a||G(e)):T(!1):(T(null),E(null))},G=async e=>{try{let a=await n.h.post("/formularios/fornecedor/mapaSipeAgro",{cnpj:e});O(a.data)}catch(o){console.error(o)}},U=async(e,a)=>{try{let o=await n.h.post("/formularios/fornecedor/cnpj",{type:a?"cpf":"cnpj",unidadeID:P.unidadeID,cnpj:e}),t={new:o.data.new,fornecedorID:o.data.fornecedorID,data:o.data.dataAvaliacao,modelo:o.data.modelo.nome,produtos:o.data.produtos,gruposAnexo:o.data.gruposAnexo},l="";t.new&&(l=await X(e)),E({...A,cnpj:t.new?(0,Q.PK)(l.data.CNPJ):e,status:t.new?l.data.STATUS:"",dataAbertura:t.new?l.data["DATA ABERTURA"]:"",telefone:t.new?l.data.DDD+" "+l.data.TELEFONE:"",razaoSocial:t.new?l.data["RAZAO SOCIAL"]:o.data.fields.razaoSocial,nomeFantasia:t.new?l.data["NOME FANTASIA"]:o.data.fields.nomeFantasia,email:t.new?l.data.EMAIL:o.data.fields.email,cidade:t.new?l.data.MUNICIPIO+"/"+l.data.UF:"",preenchimento:t,telefone:o.data.fields.telefone,cep:o.data.fields.cep,logradouro:o.data.fields.logradouro,numero:o.data.fields.numero,complemento:o.data.fields.complemento,bairro:o.data.fields.bairro,cidade:o.data.fields.cidade,estado:o.data.fields.estado,pais:o.data.fields.pais,ie:o.data.fields.ie,principaisClientes:o.data.fields.principaisClientes,registroSipeagro:o.data.fields.registroSipeagro,categoria:o.data.fields.categoria,risco:o.data.fields.risco}),m("fields.cnpj",e),m("fields.razaoSocial",t.new?l.data["RAZAO SOCIAL"]:o.data.fields.razaoSocial),m("fields.nomeFantasia",t.new?l.data["NOME FANTASIA"]:o.data.fields.nomeFantasia),m("fields.nome",t.new?l.data["NOME FANTASIA"]:""),m("fields.email",t.new?l.data.EMAIL:o.data.fields.email),m("fields.modelo",o.data.modelo.id>0?o.data.modelo:null),m("fields.gruposAnexo",o.data.gruposAnexo),m("fields.produtos",o.data.produtos),m("fields.telefone",o.data.fields.telefone),m("fields.cep",o.data.fields.cep),m("fields.logradouro",o.data.fields.logradouro),m("fields.numero",o.data.fields.numero),m("fields.complemento",o.data.fields.complemento),m("fields.bairro",o.data.fields.bairro),m("fields.cidade",o.data.fields.cidade),m("fields.estado",o.data.fields.estado),m("fields.pais",o.data.fields.pais),m("fields.ie",o.data.fields.ie),m("fields.principaisClientes",o.data.fields.principaisClientes),m("fields.registroSipeagro",o.data.fields.registroSipeagro),m("fields.categoria",o.data.fields.categoria),m("fields.risco",o.data.fields.risco),I("fields.razaoSocial")&&D("fields.razaoSocial"),I("fields.nomeFantasia")&&D("fields.nomeFantasia"),I("fields.email")&&D("fields.email"),I("fields.categoria")&&D("fields.categoria"),I("fields.risco")&&D("fields.risco"),I("fields.produtos")&&D("fields.produtos")}catch(s){console.error(s)}},X=async e=>{let a=e.replace(/\D/g,""),o=await n.h.get("https://api-publica.speedio.com.br/buscarcnpj?cnpj=".concat(a));return o},Y=async()=>{let e={unidadeID:P.unidadeID};try{let a=await n.h.post("/formularios/fornecedor/paramsNewFornecedor",e);R(a.data)}catch(o){console.error(o)}};return(0,l.useEffect)(()=>{w(!N),L(!1),c&&c.length>0&&_(c)},[]),(0,l.useEffect)(()=>{Y(),setTimeout(()=>{y()},300)},[]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(k.Z,{children:(0,t.jsxs)(v.ZP,{container:!0,spacing:4,children:[(0,t.jsxs)(v.ZP,{item:!0,xs:12,md:6,children:[(0,t.jsx)(x.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:(0,t.jsx)(J,{setFields:E,fields:null!=A?A:null,params:z,control:u,errors:g,reset:Z,setValue:m,getValues:I,watch:b,trigger:y,register:p,handleCnpjCpf:_,validCnpj:H,setIsNotFactory:C,isNotFactory:F},N)}),(0,t.jsx)(f.Z,{sx:{mt:4},children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)(x.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsx)(j.Z,{variant:"body2",children:(0,t.jsx)("strong",{children:"Dados do \xfaltimo formul\xe1rio deste fornecedor"})}),(null==A?void 0:null===(a=A.preenchimento)||void 0===a?void 0:a.new)?(0,t.jsx)(j.Z,{variant:"body2",color:"primary",children:(0,t.jsx)("strong",{children:"Novo fornecedor"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"ID: "})," ",null==A?void 0:null===(o=A.preenchimento)||void 0===o?void 0:o.fornecedorID]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Data de preenchimento:"})," ",null==A?void 0:null===(s=A.preenchimento)||void 0===s?void 0:s.data]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Modelo:"})," ",null==A?void 0:null===(i=A.preenchimento)||void 0===i?void 0:i.modelo]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Grupos de anexo: "}),null==A?void 0:null===(r=A.preenchimento)||void 0===r?void 0:r.gruposAnexo.map((e,a)=>{var o;return"".concat(e.nome).concat(a<(null==A?void 0:null===(o=A.preenchimento)||void 0===o?void 0:o.gruposAnexo.length)-1?", ":"")})]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Produtos: "}),null==A?void 0:null===(d=A.preenchimento)||void 0===d?void 0:d.produtos.map((e,a)=>{var o;return"".concat(e.nome).concat(a<(null==A?void 0:null===(o=A.preenchimento)||void 0===o?void 0:o.produtos.length)-1?", ":"")})]})]})]})})})]}),(0,t.jsx)(v.ZP,{item:!0,xs:12,md:6,children:V?(0,t.jsx)("div",{className:"flex items-start justify-center mt-24",children:(0,t.jsx)(j.Z,{variant:"body1",children:"Sem dados a serem consultados"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(W,{sipeAgro:q},q),(0,t.jsx)(f.Z,{sx:{mt:4},children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)(x.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsx)(j.Z,{variant:"body2",children:(0,t.jsx)("strong",{children:"Dados consultados da Receita Federal"})}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Raz\xe3o Social:"})," ",null==A?void 0:A.razaoSocial]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Nome Fantasia:"})," ",null==A?void 0:A.nomeFantasia]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"CNPJ:"})," ",null==A?void 0:A.cnpj]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Status:"})," ",null==A?void 0:A.status]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Data Abertura:"})," ",null==A?void 0:A.dataAbertura]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Telefone:"})," ",null==A?void 0:A.telefone]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"E-mail:"})," ",null==A?void 0:A.email]}),(0,t.jsxs)(j.Z,{variant:"caption",children:[(0,t.jsx)("strong",{children:"Cidade:"})," ",null==A?void 0:A.cidade]})]})})})]})})]})})})};var Y=o(66136),K=o(44373);o(80587);var $=o(92945);let ee=e=>{let{values:a,handleFileSelect:o,handleRemove:n,disabled:s,errors:i}=e,{settings:r}=(0,l.useContext)(Y.J6),d=r.mode,[c,u]=(0,l.useState)(null),m=(0,l.useRef)(null),p=e=>{m.current.click(),u(e)};return(0,l.useEffect)(()=>{m.current&&(m.current.value="")},[o]),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:a&&a.map((e,l)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.ZP,{container:!0,spacing:2,children:(0,t.jsx)(v.ZP,{item:!0,xs:12,sm:6,children:(0,t.jsxs)(x.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(j.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},children:e.nome}),(0,t.jsx)(j.Z,{variant:"body2",children:"(".concat(e.unidadeMedida,")")})]})})},l),e.produtoAnexosDescricao&&e.produtoAnexosDescricao.length>0&&(0,t.jsx)(v.ZP,{container:!0,spacing:4,children:e.produtoAnexosDescricao.map((e,a)=>(0,t.jsx)($.Z,{modeTheme:d,handleFileClick:p,selectedItem:c,inputRef:m,item:e,indexBlock:l,indexItem:a,handleFileSelect:o,folder:"produto",handleRemove:n,error:i,disabled:s},"".concat(l,"-").concat(a)))}),e.anexos&&0===e.anexos.length&&(0,t.jsx)(j.Z,{variant:"body2",sx:{mb:2},children:"Este produto n\xe3o exige anexos"}),l<a.length-1&&(0,t.jsx)(K.Z,{sx:{my:4}})]}))})};var ea=o(56531),eo=o(50287),et=o(22991);let el=e=>{var a,o,s,i,r,d,c,m;let{modeloID:x,values:p,fields:f,disabled:h,register:g,errors:j,setValue:D,control:Z,getValues:b,getAddressByCep:y}=e,[S,C]=(0,l.useState)([]),F=async()=>{let e=await n.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:1,modeloID:x});C(e.data.preenche)};return(0,l.useEffect)(()=>{F(),p&&!p.data&&D("fieldsHeader.data",(0,I.Ux)()),p&&!p.hora&&D("fieldsHeader.hora",(0,I.Xn)())},[p]),(0,t.jsxs)(v.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(v.ZP,{item:!0,xs:12,sx:{textAlign:"right"},children:(0,t.jsx)(et.Z,{data:null!==(d=null==p?void 0:p.setores)&&void 0!==d?d:[]})}),(0,t.jsx)(eo.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null!==(c=null==p?void 0:p.data)&&void 0!==c?c:(0,I.Ux)(),disabled:h,register:g,control:Z,typeValidation:"dataPassado",daysValidation:365,errors:null==j?void 0:null===(a=j.fieldsHeader)||void 0===a?void 0:a.data,alertRequired:!0}),(0,t.jsx)(u.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",value:null!==(m=null==p?void 0:p.data)&&void 0!==m?m:(0,I.Xn)(),type:"time",disabled:h,register:g,control:Z,errors:null==j?void 0:null===(o=j.fieldsHeader)||void 0===o?void 0:o.hora,alertRequired:!0}),(0,t.jsx)(u.Z,{xs:12,md:4,title:p.cpf?"CPF":"CNPJ",name:"fieldsHeader.cnpj",type:"string",mask:p.cpf?"cpf":"cnpj",disabled:!0,register:g,control:Z,errors:null==j?void 0:null===(s=j.fieldsHeader)||void 0===s?void 0:s.cnpj,alertRequired:!0}),(0,t.jsx)(u.Z,{xs:12,md:4,title:p.cpf?"Nome":"Raz\xe3o Social",name:"fieldsHeader.razaoSocial",type:"string",disabled:h,register:g,control:Z,errors:null==j?void 0:null===(i=j.fieldsHeader)||void 0===i?void 0:i.razaoSocial,alertRequired:!0}),(0,t.jsx)(u.Z,{xs:12,md:4,title:p.cpf?"Apelido":"Nome fantasia",name:"fieldsHeader.nomeFantasia",type:"string",disabled:h,register:g,control:Z,errors:null==j?void 0:null===(r=j.fieldsHeader)||void 0===r?void 0:r.nomeFantasia,alertRequired:!0}),(0,t.jsx)(ea.Z,{register:g,errors:j,setValue:D,control:Z,getValues:b,fields:f,values:f,getAddressByCep:y,disabled:h})]})};var en=o(41088),es=o(92629),ei=o(1503),er=o(934),ed=o(87771);let ec=e=>{var a,o;let{values:l}=e;if(l)return(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center gap-4",children:[(0,t.jsx)(ed.QRz,{size:60,className:"text-yellow-600"}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,t.jsx)("p",{className:"text-2xl font-semibold",children:"Aguardando preenchimento do Fornecedor"}),(0,t.jsx)("p",{children:"Este formul\xe1rio ser\xe1 preenchido pelo fornecedor"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 w-full px-10 text-center pt-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"Nome Fantasia"}),(0,t.jsx)("p",{className:"text-lg",children:l.nomeFantasia})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"Raz\xe3o Social"}),(0,t.jsx)("p",{className:"text-lg",children:l.razaoSocial})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"CNPJ"}),(0,t.jsx)("p",{className:"text-lg",children:l.cnpj})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"Telefone"}),(0,t.jsx)("p",{className:"text-lg",children:null!==(a=l.telefone)&&void 0!==a?a:"--"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"E-mail"}),(0,t.jsx)("p",{className:"text-lg",children:null!==(o=l.email)&&void 0!==o?o:"--"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm opacity-60",children:"Data de Cadastro"}),(0,t.jsx)("p",{className:"text-lg",children:l.dataInicio})]})]})]})})})};var eu=o(82555),em=o(91757);let ex=e=>{var a;let o;let{id:s,makeFornecedor:D}=e,{setData:w,data:P}=(0,eu.O)(),[A,E]=(0,l.useState)(!0),[k,M]=(0,l.useState)(null),{menu:R,user:q,loggedUnity:O,hasPermission:H,hasSectorPermission:T}=(0,l.useContext)(S.V),[V,L]=(0,l.useState)(!1),[_,G]=(0,l.useState)(!1),[U,B]=(0,l.useState)(!0),[J,Q]=(0,l.useState)(!0),[W,Y]=(0,l.useState)(null),[K,$]=(0,l.useState)([]),[ea,eo]=(0,l.useState)([]),[et,ed]=(0,l.useState)(!1),[ex,ep]=(0,l.useState)(null),{createNewNotification:ef}=(0,l.useContext)(C.u),[eh,ev]=(0,l.useState)(!1),[eg,ej]=(0,l.useState)([]),[eD,eZ]=(0,l.useState)([]),[eI,eb]=(0,l.useState)([]),[ey,eS]=(0,l.useState)(null),[eC,eF]=(0,l.useState)([]),[eN,ew]=(0,l.useState)(null),[eP,eA]=(0,l.useState)(""),[eE,ez]=(0,l.useState)(!1),[ek,eM]=(0,l.useState)({status:!1,errors:[]}),{setId:eR}=(0,l.useContext)(y.X),[eq,eO]=(0,l.useState)([]),[eH,eT]=(0,l.useState)(!1),[eV,eL]=(0,l.useState)(null),{sendPdfToServer:e_}=(0,ei.Gc)(),{isLoading:eG,startLoading:eU,stopLoading:eB}=(0,en.Z)(),[eJ,eQ]=(0,l.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),eW=Z(),eX=s&&s>0?"edit":"new",eY=eW.pathname;console.log("\uD83D\uDE80 ~ canEdit:",eJ.status);let{reset:eK,register:e$,getValues:e0,setValue:e1,control:e2,trigger:e3,handleSubmit:e4,clearErrors:e7,setError:e5,formState:{errors:e8}}=(0,i.cI)({mode:"onChange"}),e9=async e=>{let a={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:q.usuarioID,papelID:q.papelID,unidadeID:O.unidadeID}};try{L(!0),await n.h.post("".concat(eY,"/changeFormStatus/").concat(s),a).then(e=>{F.ZP.success(I.OD.successUpdate),L(!1),ag(ex,null,null)})}catch(o){console.log(o)}finally{ed(!et)}},e6=async e=>{try{if(!e.email&&!e.alerta)return F.ZP.error("Selecione ao menos um tipo de notifica\xe7\xe3o!");let a={titulo:e.assunto,descricao:e.descricao,url:"/formularios/fornecedor/",urlID:s,tipoNotificacaoID:3,usuarioGeradorID:q.usuarioID,usuarioID:0,unidadeID:W.fornecedor.unidadeID,papelID:2,email:e.email,alerta:e.alerta};if(ef(a),e.email){let o={values:e,auth:{id:s,usuarioID:q.usuarioID,papelID:q.papelID,unidadeID:O.unidadeID}};await n.h.post("".concat(eY,"/sendNotification"),o)}let t=e.alerta&&e.email?"E-mail e alerta enviados com sucesso!":e.alerta&&!e.email?"Alerta criado com sucesso!":!e.alerta&&e.email?"E-mail enviado com sucesso!":null;F.ZP.success(t)}catch(l){console.log(l)}},ae=()=>{navigator.clipboard.writeText(ey),F.ZP.success("Link copiado com sucesso!")},aa=()=>{eR(W.parFornecedorModeloID),eW.push("/configuracoes/formularios/fornecedor/")},ao={id:1,name:"Gerar novo formul\xe1rio",description:"Gerar um novo formul\xe1rio de preenchimento para este fornecedor.",component:(0,t.jsx)(X,{cnpj:null==eg?void 0:eg.cnpj}),disabled:!H(eW.pathname,"inserir"),route:null,type:null,modal:!0,fullHeight:!0,action:D,size:"lg",icon:"fluent:form-new-20-regular",identification:null},at={id:2,name:"Gerar notifica\xe7\xe3o",description:"Gerar uma nova notifica\xe7\xe3o para o fornecedor, podendo ser um e-mail e/ou alerta do sistema.",component:(0,t.jsx)(z,{data:{email:null===(a=null==eI?void 0:eI.find(e=>"email"==e.nomeColuna))||void 0===a?void 0:a.email}}),route:null,type:null,modal:!0,action:e6,icon:"cil:bell",identification:null},al={id:3,name:"Copiar link do formul\xe1rio",description:"Copiar o link deste formul\xe1rio.",component:(0,t.jsx)(X,{}),route:null,type:null,action:ae,modal:!1,icon:"solar:copy-outline",identification:null},an={id:s,name:"Imprimir",nameComponent:"indexFormulario",type:"report",unidadeID:null==W?void 0:W.unidadeID,usuarioID:null==eP?void 0:eP.usuarioID,papelID:null==q?void 0:q.papelID,status:null==eP?void 0:eP.status,route:"formularios/fornecedor",icon:"fluent:print-24-regular",module:"fornecedor"},as={id:6,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,t.jsx)(em.Z,{}),disabled:!!U||!H(eW.pathname,"editar"),route:null,type:null,action:e9,modal:!0,size:"sm",icon:"heroicons:lock-open",identification:null},ai=[];1==q.papelID&&(ai.push(ao),(null==eP?void 0:eP.status)>=40&&ai.push(as)),ai.push(at),ai.push(al),ai.push(an),1==q.papelID&&(o=!1,R.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(o=!0)})})}),o)&&ai.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:aa,modal:!1,icon:"bi:gear",identification:null});let ar=async()=>{try{await n.h.post("".concat(eY,"/verifyFormPending/").concat(s),{parFormularioID:1}).then(e=>{B(e.data) //! true/false
})}catch(e){console.log(e)}},ad=()=>{eU();try{n.h.post("".concat(eY,"/getData/").concat(s),{type:eX,unidadeID:O.unidadeID}).then(e=>{var a,o,t,l,n;if(!e.data)return;e.data.hasModel||(E(!1),M(e.data)),console.log("\uD83D\uDE80 ~ getData:",e.data),ej(e.data.fieldsHeader),eZ(e.data.fieldsFooter),eb(e.data.fields),$(e.data.produtos),eF(e.data.blocos),eo(e.data.grupoAnexo),eA(e.data.info),Y(e.data.unidade),eS(e.data.link),ew(e.data.ultimaMovimentacao),ah(e.data.blocos),eK(e.data);let s=[];for(let i=0;i<e.data.fields.length;i++){let r=e.data.fields[i].nomeColuna,d=e.data.fields[i].nomeCampo;for(let c in O){if("telefone"==r&&!e0("fields[".concat(i,"].").concat(r))){let u=null!==(l=O.telefone1)&&void 0!==l?l:O.telefone2;e1("fields[".concat(i,"].").concat(r),null!=u?u:"")}c!==r||e0("fields[".concat(i,"].").concat(r),O[c])||(e1("fields[".concat(i,"].").concat(r),O[c]),null!==O[c]&&""!==O[c]&&s.push({name:d,value:O[c]}))}}eO(s);let m=I.WR[null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(o=a.info)||void 0===o?void 0:o.status];ep(m),eQ({status:!!(q.papelID==e.data.unidade.quemPreenche&&e.data.info.status<40&&(T(null!==(n=null===(t=e.data.fieldsHeader)||void 0===t?void 0:t.setores)&&void 0!==n?n:[])||2===e.data.unidade.quemPreenche)),message:2==q.papelID&&e.data.info.status>=40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo e enviado pra f\xe1brica, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":1==q.papelID&&e.data.info.status<40?"Somente o fornecedor pode alterar as informa\xe7\xf5es deste formul\xe1rio!":1==q.papelID&&40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o":null,messageType:2==q.papelID?"warning":"info"}),ar()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e)}finally{eB()}},ac=!1,au=[],am=(e,a)=>{e5(e,{type:"manual",message:"Campo obrigat\xf3rio"}),au.push(a),ac=!0},ax=()=>{e7(),e0("fieldsHeader.data")||am("fieldsHeader.data","Data da avalia\xe7\xe3o"),e0("fieldsHeader.hora")||am("fieldsHeader.hora","Hora da avalia\xe7\xe3o"),e0("fieldsHeader.razaoSocial")||am("fieldsHeader.razaoSocial","Raz\xe3o Social"),e0("fieldsHeader.nomeFantasia")||am("fieldsHeader.nomeFantasia","Nome Fantasia"),null==eI||eI.forEach((e,a)=>{let o=e.tabela?"fields[".concat(a,"].").concat(e.tabela):"fields[".concat(a,"].").concat(e.nomeColuna),t=e0(o);1!==e.obrigatorio||t||am(o,null==e?void 0:e.nomeCampo)}),K&&K.length>0&&K.forEach((e,a)=>{e.produtoAnexosDescricao.forEach((o,t)=>{1===o.obrigatorio&&0==o.anexos.length&&(e5("produtos[".concat(a,"].produtoAnexosDescricao[").concat(t,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),au.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==o?void 0:o.nome)),ac=!0)})}),eC&&eC.length>0&&eC.forEach((e,a)=>{e.itens.forEach((e,o)=>{let t=e0("blocos[".concat(a,"].itens[").concat(o,"].resposta"));(null==e?void 0:e.obrigatorio)!==1||t||(e5("blocos[".concat(a,"].itens[").concat(o,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),au.push(null==e?void 0:e.nome),ac=!0),e.respostaConfig&&1==e.respostaConfig.anexo&&e.respostaConfig.anexosSolicitados.length>0&&e.respostaConfig.anexosSolicitados.forEach((t,l)=>{1==t.obrigatorio&&t.anexos&&0==t.anexos.length&&(e5("blocos[".concat(a,"].itens[").concat(o,"].respostaConfig.anexosSolicitados[").concat(l,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),au.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==t?void 0:t.nome)),ac=!0)})})}),ea&&ea.length>0&&ea.forEach((e,a)=>{e.itens.forEach((o,t)=>{1===o.obrigatorio&&0==o.anexos.length&&(e5("grupoAnexo[".concat(a,"].itens[").concat(t,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),au.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==o?void 0:o.nome)),ac=!0)})}),eM({status:ac,errors:au}),ac&&au.forEach(e=>{e3(e)})},ap=async e=>{if(9===e.length){let a=e.replace(/[^0-9]/g,"");try{let o=await n.h.get("https://viacep.com.br/ws/".concat(a,"/json/"));o.data.localidade?(eI.forEach(async(e,a)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await e1("fields[".concat(a,"].logradouro"),o.data.logradouro),await e1("fields[".concat(a,"].bairro"),o.data.bairro),await e1("fields[".concat(a,"].cidade"),o.data.localidade),await e1("fields[".concat(a,"].estado"),o.data.uf))}),F.ZP.success("Endere\xe7o encontrado!")):F.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},af=async()=>{ax(),ez(!0)},ah=e=>{let a=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(a=!1)})}),Q(a)},av=async(e,a)=>{1===O.papelID&&e_(s,a,"fornecedor"),e.conclusion=!0,await e4(aj)(e)},ag=(e,a,o)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",l={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(s," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:s,tipoNotificacaoID:6,usuarioGeradorID:q.usuarioID,usuarioID:0,unidadeID:O.unidadeID,papelID:1};if(l&&(ef(l),a)){let n={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(s," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:o,tipoNotificacaoID:5,usuarioGeradorID:q.usuarioID,usuarioID:0,unidadeID:O.unidadeID,papelID:1};ef(n)}},aj=async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ez(!1),!0===a.conclusion?(e.status=q&&1==q.papelID?a.status:40,e.obsConclusao=a.obsConclusao):e7();let o={form:e,auth:{usuarioID:q.usuarioID,papelID:q.papelID,unidadeID:O.unidadeID},currentStatus:e.info.status};try{"edit"==eX?(L(!0),await n.h.post("".concat(eY,"/updateData/").concat(s),o).then(a=>{F.ZP.success(I.OD.successUpdate),L(!1);let o=null;a.data&&a.data.naoConformidade&&a.data.id>0&&(eW.push("/formularios/fornecedor/nao-conformidade/"),eR(a.data.id),o=a.data.id),ag(e.status,e.naoConformidade,o)})):"new"==eX?await n.h.post("".concat((0,I.g_)(eY),"/insertData"),o).then(e=>{eW.push("".concat((0,I.g_)(eY))),eR(e.data),F.ZP.success(I.OD.successNew)}):F.ZP.error(I.OD.error)}catch(t){console.log(t)}finally{ed(!et)}},aD=async(e,a)=>{let o=e.target.files;if(o&&o.length>0){var t,l,i,r;let d=new FormData;for(let c=0;c<o.length;c++)d.append("files[]",o[c]);d.append("usuarioID",q.usuarioID),d.append("unidadeID",O.unidadeID),d.append("produtoAnexoID",null!==(t=a.produtoAnexoID)&&void 0!==t?t:null);try{await n.h.post("".concat(eY,"/saveAnexo/").concat(s,"/produto/").concat(q.usuarioID,"/").concat(W.unidadeID),d);let u=e0();aj(u)}catch(m){F.ZP.error(null!==(r=null===(l=m.response)||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:i.message)&&void 0!==r?r:"Erro ao atualizar anexo, tente novamente!")}finally{ed(!et)}}},aZ=async(e,a)=>{let o=e.target.files;if(o&&o.length>0){var t,l,i,r;let d=new FormData;for(let c=0;c<o.length;c++)d.append("files[]",o[c]);d.append("usuarioID",q.usuarioID),d.append("unidadeID",O.unidadeID),d.append("grupoAnexoItemID",null!==(t=a.grupoAnexoItemID)&&void 0!==t?t:null);try{await n.h.post("".concat(eY,"/saveAnexo/").concat(s,"/grupo-anexo/").concat(q.usuarioID,"/").concat(W.unidadeID),d);let u=e0();aj(u)}catch(m){F.ZP.error(null!==(r=null===(l=m.response)||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:i.message)&&void 0!==r?r:"Erro ao atualizar anexo, tente novamente!")}finally{ed(!et)}}},aI=async(e,a)=>{let o=e.target.files;if(o&&o.length>0){var t,l,i,r,d;let c=new FormData;for(let u=0;u<o.length;u++)c.append("files[]",o[u]);c.append("usuarioID",q.usuarioID),c.append("unidadeID",O.unidadeID),c.append("parFornecedorModeloBlocoID",null!==(t=a.parFornecedorModeloBlocoID)&&void 0!==t?t:null),c.append("itemOpcaoAnexoID",null!==(l=a.itemOpcaoAnexoID)&&void 0!==l?l:null);try{await n.h.post("".concat(eY,"/saveAnexo/").concat(s,"/item/").concat(q.usuarioID,"/").concat(W.unidadeID),c);let m=e0();aj(m)}catch(x){F.ZP.error(null!==(d=null===(i=x.response)||void 0===i?void 0:null===(r=i.data)||void 0===r?void 0:r.message)&&void 0!==d?d:"Erro ao atualizar anexo, tente novamente!")}finally{ed(!et)}}},ab=async e=>{e&&await n.h.delete("".concat(eY,"/deleteAnexo/").concat(s,"/").concat(e.anexoID,"/").concat(W.unidadeID,"/").concat(q.usuarioID,"/produto")).then(e=>{let a=e0();aj(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")}).finally(()=>{ed(!et)})},ay=async e=>{e&&await n.h.delete("".concat(eY,"/deleteAnexo/").concat(s,"/").concat(e.anexoID,"/").concat(W.unidadeID,"/").concat(q.usuarioID,"/grupo-anexo")).then(e=>{let a=e0();aj(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")}).finally(()=>{ed(!et)})},aS=async e=>{e&&await n.h.delete("".concat(eY,"/deleteAnexo/").concat(s,"/").concat(e.anexoID,"/").concat(W.unidadeID,"/").concat(q.usuarioID,"/item")).then(e=>{let a=e0();aj(a)}).catch(e=>{var a,o,t;F.ZP.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")}).finally(()=>{ed(!et)})},aC=e=>{e.preventDefault();let a=e0();aj(a)};return(0,l.useEffect)(()=>{"edit"==eX&&ad(),w({user:q,report:{id:s}})},[s,et]),(0,l.useEffect)(()=>{ax()},[eG]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("form",{onSubmit:e=>aC(e),children:[(0,t.jsx)(b.Z,{btnCancel:!0,btnDelete:(null==eP?void 0:eP.status)<40&&1===q.papelID,onclickDelete:()=>eT(!0),btnSave:(null==eP?void 0:eP.status)<40,btnSend:1==q.papelID&&(!!eP&&eP.status>=30&&eP.status<40&&1==W.quemPreenche||!!eP&&40==eP.status&&2==W.quemPreenche)||2==q.papelID&&eP.status<40&&2==W.quemPreenche,btnPrint:"edit"==eX,actionsData:ai,actions:!0,handleSubmit:()=>e4(aj),handleSend:af,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir",title:"Fornecedor",btnStatus:"edit"==eX,handleBtnStatus:()=>ev(!0),type:eX,status:ex}),A&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[ex&&(0,t.jsx)(c.Z,{size:"small",skin:"light",color:ex.color,label:ex.title,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}}),(0,t.jsx)(c.Z,{size:"small",skin:"light",color:"primary",label:((null==W?void 0:W.quemPreenche)==1?"F\xe1brica":"Fornecedor")+" preenche"}),(0,t.jsx)(c.Z,{size:"small",skin:"light",label:"Modelo ".concat(null==W?void 0:W.modelo)})]}),(0,t.jsxs)(x.Z,{display:"flex",flexDirection:"column",sx:{gap:6},children:[eq&&eq.length>0&&(0,t.jsxs)(p.Z,{severity:"info",sx:{mb:2},children:[(0,t.jsxs)("h1",{children:["Os seguintes campos foram copiados de ",(0,t.jsx)("strong",{children:"Meus Dados"}),":"]}),(0,t.jsx)("div",{className:"pt-2",children:eq.map(e=>(0,t.jsx)("div",{className:"flex opacity-80",children:(0,t.jsx)("p",{children:"- ".concat(e.name," (").concat(e.value,")")})}))})]}),eP&&""!=eP.cabecalhoModelo&&(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)("p",{children:eP.cabecalhoModelo})})}),(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:W&&(0,t.jsx)(el,{modeloID:W.parFornecedorModeloID,values:eg,fields:eI,disabled:!eJ.status||U,register:e$,errors:e8,setValue:e1,control:e2,getValues:e0,getAddressByCep:ap},W.unidadeID)})}),K&&K.length>0&&(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(ee,{values:K,handleFileSelect:aD,handleRemove:ab,disabled:!eJ.status||U,errors:null==e8?void 0:e8.produtos},eG)})}),eC&&eC.map((e,a)=>(0,t.jsx)(r.Z,{bloco:e,index:a,blockKey:"parFornecedorModeloBlocoID",setBlocos:eF,setValue:e1,blocos:eC,getValues:e0,register:e$,control:e2,disabled:!eJ.status||U,errors:null==e8?void 0:e8.blocos,handleFileSelect:aI,handleRemoveAnexoItem:aS,status:eP.status,isFornecedorLogged:(null==W?void 0:W.quemPreenche)===2&&2===q.papelID})),ea&&ea.map((e,a)=>(0,t.jsx)(m.Z,{values:{grupo:e,indexGrupo:a,handleFileSelect:aZ,handleRemove:ay,folder:"grupo-anexo",disabled:!eJ.status,error:e8}},a)),eP&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(f.Z,{children:(0,t.jsx)(h.Z,{children:(0,t.jsx)(v.ZP,{container:!0,spacing:4,children:(0,t.jsx)(v.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(g.Z,{fullWidth:!0,children:[(0,t.jsx)(j.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(u.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:eP.obs,disabled:!eJ.status||U,control:e2})]})})})})})}),eh&&(0,t.jsx)(d.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(s," do Fornecedor."),id:s,parFormularioID:1,formStatus:eP.status,hasFormPending:U,canChangeStatus:!U&&2==W.quemPreenche&&eP.status>=40,openModal:eh,handleClose:()=>ev(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:e9}),(0,t.jsx)(N.Z,{openModal:eE,handleClose(){ez(!1),ax()},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:eP,canChange:!U,register:e$,setValue:e1,getValues:e0,control:e2,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:av,listErrors:ek,handleSend:af,canApprove:!0,type:"fornecedor",unity:W,values:eD,formularioID:1,errors:e8,modeloID:null==W?void 0:W.parFornecedorModeloID}),(0,t.jsx)(er.Z,{parFormularioID:1,id:s},et)]})]}),!A&&(0,t.jsx)(ec,{values:k})]}),(0,t.jsx)(es.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/fornecedor/delete/".concat(s),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eH,handleClose:()=>eT(!1)})]})};var ep=o(60565),ef=o(72819),eh=o(47842);let ev=e=>{let{values:a}=e;return(0,t.jsx)("div",{children:(0,t.jsxs)(x.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsxs)(j.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"E-mail enviado para: "})," ",null==a?void 0:a.email]}),(0,t.jsxs)(j.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"Link do formul\xe1rio: "})," ",null==a?void 0:a.link]})]})})};var eg=o(30944),ej=o(30140);let eD=()=>{let{user:e,loggedUnity:a}=(0,l.useContext)(S.V),o=(0,D.useRouter)(),i=o.pathname,{setTitle:r}=(0,l.useContext)(ep.f),{id:d,setId:c}=(0,l.useContext)(y.X),[u,m]=(0,l.useState)(!1),[x,p]=(0,l.useState)(!1),[f,h]=(0,l.useState)(null),[v,g]=(0,l.useState)(!1),{isCpf:j,setIsCpf:Z}=(0,l.useContext)(B.YF),{form:b,dataSupplier:C,startFilter:N,SelectFilterByName:w,setFilteredDataSupplier:P,filteredDataSupplier:A,setDataSupplier:E,setKey:z,key:k}=(0,eg.L0)(),M=()=>{m(!0)},R=async()=>{console.log("getList");try{let o=await n.h.post("".concat(i,"/getList/"),{unidadeID:a.unidadeID,papelID:e.papelID,cnpj:e.cnpj?e.cnpj:null});if(!o.data)return;P(o.data),E(o.data),r({title:"Fornecedor",subtitle:{id:d,count:o.data.length,new:!1}})}catch(t){console.log(t)}},q=async o=>{try{var t,l,s,i;let r={usuarioID:e.usuarioID,papelID:e.papelID,profissionalID:e.profissionalID,unidadeID:a.unidadeID,values:o.fields,habilitaQuemPreencheFormFornecedor:o.habilitaQuemPreencheFormFornecedor,fornecedorCategoriaID:null===(t=o.fields)||void 0===t?void 0:null===(l=t.categoria)||void 0===l?void 0:l.fornecedorCategoriaID,fornecedorCategoriaRiscoID:null===(s=o.fields)||void 0===s?void 0:null===(i=s.risco)||void 0===i?void 0:i.fornecedorCategoriaRiscoID,isCpf:j};console.log("\uD83D\uDE80 ~ onSubmit:",r),m(!1);let d=await n.h.post("/formularios/fornecedor/makeFornecedor",r);200==d.status&&(F.ZP.success(d.data.message),v?(p(!0),h(d.data.result),R()):c(d.data.result.fornecedorID))}catch(u){console.error("Erro ao enviar email",u)}},O=()=>{let e=null==f?void 0:f.link;e&&(navigator.clipboard.writeText(e),F.ZP.success("Link copiado com sucesso!"))};(0,l.useEffect)(()=>{P([]),E([])},[o.query]),(0,l.useEffect)(()=>{R(),N((0,t.jsx)(ej.default,{}))},[d,o.query]);let H=1==e.papelID?[{headerName:"ID",field:"id",size:.2},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:.7,type:"date"},{headerName:"Fornecedor",field:"fornecedor",size:2},{headerName:"Produtos",field:"produtos",size:1},{headerName:"Quem preenche",field:"quemPreenche",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1,type:"statusSteps"}]:2==e.papelID?[{headerName:"ID",field:"id",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:1,type:"date"},{headerName:"F\xe1brica",field:"fabrica",size:1},{headerName:"Produtos",field:"produtos",size:1},{headerName:"Respons\xe1vel",field:"responsavel",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1,type:"statusSteps"}]:[],T=(0,I.OL)(i,H);return(0,t.jsxs)(t.Fragment,{children:[A?d&&d>0?(0,t.jsx)(ex,{id:d,makeFornecedor:q}):(0,t.jsx)(s.Z,{result:A,columns:T,openModal:1==e.papelID?M:null,btnNew:1==e.papelID},"".concat(k,"-").concat(A)):(0,t.jsx)(eh.Z,{show:!0}),(0,t.jsx)(ef.Z,{title:"Habilitar Fornecedor",handleConclusion:q,setOpenModal:m,openModal:u,size:"lg",fullHeight:!0,children:(0,t.jsx)(X,{setIsNotFactory:g,isNotFactory:v})}),(0,t.jsx)(ef.Z,{title:"Formul\xe1rio enviado ao fornecedor",description:"Um novo formul\xe1rio de qualifica\xe7\xe3o de fornecedor foi enviado",handleCopyLink:O,setOpenModal:p,openModal:x,children:(0,t.jsx)("div",{children:(0,t.jsx)(ev,{values:f})})})]})};var eZ=eD},69175:function(e,a,o){"use strict";o.d(a,{Z:function(){return y}});var t=o(85893),l=o(67294),n=o(18104),s=o(75680),i=o(78082),r=o(83830),d=o(1890),c=o(60664),u=o(11163),m=o(77745),x=o(29630),p=o(95398),f=o(79072),h=o(21609),v=o(80562),g=o(40039),j=o(66136),D=o(92024);let Z=e=>{let{open:a,handleClose:o,row:n}=e,s=(0,u.useRouter)(),[i,r]=(0,l.useState)(null),{loggedUnity:Z}=(0,l.useContext)(g.V),I=s.pathname,{settings:b}=(0,l.useContext)(j.J6),y=b.mode,S=async()=>{let e=await c.h.get("".concat(I,"/getData/").concat(Z.unidadeID,"/").concat(n.id));r(e.data)};return(0,l.useEffect)(()=>{n&&S()},[n]),n&&i&&(0,t.jsxs)(d.Z,{open:a,onClose:o,scroll:"paper",maxWidth:"md",fullWidth:!0,children:[(0,t.jsxs)(m.Z,{id:"customized-dialog-title",sx:{textAlign:"center"},children:[(0,t.jsx)(x.Z,{variant:"h5",component:"span",children:n.nome}),(0,t.jsx)(x.Z,{variant:"body2",children:"Este log #".concat(n.id," gerou um total de ").concat(i.length," ").concat(1==i.length?"script":"scripts")}),(0,t.jsx)(v.Z,{"aria-label":"close",onClick:o,sx:{top:10,right:10,position:"absolute",color:"grey.500"},children:(0,t.jsx)(h.Z,{icon:"mdi:close"})})]}),(0,t.jsxs)(p.Z,{sx:{p:10,mt:8},children:[(0,t.jsxs)(f.ZP,{container:!0,spacing:8,children:[(0,t.jsxs)(f.ZP,{item:!0,md:4,sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsx)(h.Z,{icon:"fluent-mdl2:date-time-mirrored",className:"text-5xl"}),(0,t.jsx)("span",{children:n.dataHora})]}),(0,t.jsxs)(f.ZP,{item:!0,md:4,sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsx)(h.Z,{icon:"majesticons:user-line",className:"text-5xl"}),(0,t.jsx)("span",{children:n.usuario})]}),(0,t.jsxs)(f.ZP,{item:!0,md:4,sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,t.jsx)(h.Z,{icon:"material-symbols-light:bring-your-own-ip",className:"text-5xl"}),(0,t.jsx)("span",{children:n.ip})]})]}),(0,t.jsx)("div",{className:"flex flex-col gap-4 mt-8",children:i.map(e=>(0,t.jsxs)("div",{className:"border ".concat("dark"==y?"border-white/20":"border-black/20","   rounded-xl p-4 space-y-4 h-auto"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(D.Z,{skin:"light",color:"insert"==e.operacao?"success":"update"==e.operacao?"warning":"delete"==e.operacao?"error":(e.operacao,"info"),variant:"rounded",sx:{mr:3,width:48,height:48},children:(0,t.jsx)(h.Z,{icon:"insert"==e.operacao?"dashicons:insert":"update"==e.operacao?"akar-icons:edit":"delete"==e.operacao?"mingcute:delete-line":"login"==e.operacao?"ic:round-login":"email"==e.operacao?"mynaui:send":"ic:round-logout"})}),(0,t.jsx)(x.Z,{sx:{color:"text.secondary",marginTop:"-4px"},children:"insert"==e.operacao?"Inclus\xe3o":"update"==e.operacao?"Altera\xe7\xe3o":"delete"==e.operacao?"Exclus\xe3o":"login"==e.operacao?"Login efetuado":"email"==e.operacao?"Envio de E-mail":"Logout efetuado"})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex flex-col justify-end ",children:[(0,t.jsx)(x.Z,{variant:"caption",sx:{color:"text.disabled",textAlign:"right"},children:"Tabela"}),(0,t.jsx)(x.Z,{sx:{color:"text.secondary",marginTop:"-4px"},children:e.tabela})]})})]}),(0,t.jsx)("div",{className:"".concat("dark"===y?"bg-[#212b36]":"bg-[#f7f7f9]"," p-2 rounded-lg"),children:(0,t.jsx)("pre",{children:function(e,a){try{let o=JSON.parse(e),l=JSON.stringify(o,null,2);return l=l.replace(/(\"alterado\": true)/g,'<span style="background-color: #ce9728; padding: 2px 1px; border-radius: 4px">$1</span>'),(0,t.jsx)("pre",{dangerouslySetInnerHTML:{__html:l}})}catch(n){return e}}(e.alteracao,e.operacao)})})]}))}),(0,t.jsx)("div",{})]})]})};var I=o(30944);let b=e=>{let{rows:a,columns:o,buttonsHeader:d,modalLog:c}=e,{pageSize:u,setPageSize:m,data:x}=(0,I.L0)(),{setId:p}=(0,l.useContext)(r.X),[f,h]=(0,l.useState)(null),[v,g]=(0,l.useState)(!1);function j(e){let a=e.split("/");return"".concat(a[2],"-").concat(a[1],"-").concat(a[0])}x.slice().sort((e,a)=>"Inativo"===e.status&&"Inativo"!==a.status?1:"Inativo"!==e.status&&"Inativo"===a.status?-1:0),o.map(e=>{"date"===e.type&&(e.sortComparator=(e,a)=>{let o=j(e),t=j(a);return o.localeCompare(t)})});let D=e=>{c?(h(e),g(!0)):p(e.id)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n._,{localeText:s.F.components.MuiDataGrid.defaultProps.localeText,autoHeight:!0,columns:o,pageSize:u,rowsPerPageOptions:[10,20,30,40,50,100],components:{Toolbar:i.Z},rows:a,onCellClick(e,a){D(e.row)},onPageSizeChange:e=>m(e),sx:{"& .MuiDataGrid-cell":{cursor:"pointer",overflow:"scroll"}},componentsProps:{toolbar:{buttonsHeader:d,rows:a}},className:"min-h-[85vh]"}),(0,t.jsx)(Z,{open:v,handleClose:()=>g(!1),row:f})]})};var y=b}},function(e){e.O(0,[4738,4186,1445,1111,5999,594,5206,2187,4818,7842,2477,8428,8934,5268,6545,9291,9774,2888,179],function(){return e(e.s=59424)}),_N_E=e.O()}]);