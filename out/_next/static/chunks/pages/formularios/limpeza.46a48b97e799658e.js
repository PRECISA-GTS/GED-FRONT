(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1132],{94156:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/limpeza",function(){return o(6530)}])},28871:function(e,a,o){"use strict";var t=o(85893),i=o(67294),l=o(83830),n=o(87536),s=o(60664),r=o(40039),u=o(65698),d=o(32038),c=o(86501),m=o(11163),p=o(46099),f=o(42222),h=o(82755),D=o(92629),x=o(91757),I=o(71798),z=o(3404),g=o(51239),b=o(72819);let v=e=>{var a,o,v,C,y;let{modelID:w}=e,S=(0,m.useRouter)(),{id:j,setId:N,idNc:E,setModelID:F,setLimpezaID:Z}=(0,i.useContext)(l.X),{menu:_,user:k,loggedUnity:V,hasPermission:M}=(0,i.useContext)(r.V),[P,H]=(0,i.useState)(null),[L,O]=(0,i.useState)(null),T=j&&j>0?"edit":"new",q=(0,n.cI)({mode:"onChange"}),[R,X]=(0,i.useState)(!1),[A,B]=(0,i.useState)(!0),[U,G]=(0,i.useState)(!1),[J,K]=(0,i.useState)(!1),[Q,W]=(0,i.useState)({status:!1,errors:[]}),[Y,$]=(0,i.useState)(!1),ee=(0,z.n)("limpeza",S),ea=async()=>{try{let e={id:null!=j?j:0,modelID:null!=w?w:0,unidadeID:V.unidadeID},a=await s.h.post("/formularios/limpeza/getData",e);console.log("\uD83D\uDE80 ~ getData:",a.data),q.reset(a.data),H(a.data.header),O(a.data.blocos)}catch(o){console.log(o);return}},eo=e=>{e.preventDefault();let a=q.getValues();et(a)},et=async e=>{if(!e)return;let a={form:e,auth:{usuarioID:k.usuarioID,papelID:k.papelID,unidadeID:V.unidadeID}};try{if("new"===T){let o=await s.h.post("/formularios/limpeza/insertData",a);c.ZP.success("Dados cadastrados com sucesso!"),N(o.data.id),S.push("/formularios/limpeza")}else"edit"===T&&(await s.h.post("/formularios/limpeza/updateData/".concat(j),a),c.ZP.success("Dados atualizados com sucesso!"))}catch(t){console.log(t);return}finally{X(!R)}},ei=()=>{let e={status:!1,errors:[]};q.clearErrors(),(0,p.n9)(q,"header.dataInicio","Data Inicial",e),(0,p.n9)(q,"header.horaInicio","Hora Inicial",e),(0,p.n9)(q,"header.dataFim","Data Final",e),(0,p.n9)(q,"header.horaFim","Hora Final",e),(0,p.n9)(q,"header.departamento.id","Departamento respons\xe1vel pela limpeza",e),(0,p.n9)(q,"header.setor.id","Setor que foi limpo",e),(0,p.lz)(q,q.getValues("header.fields"),e),(0,p.IB)(q,q.getValues("blocos"),e);let a=(0,p.FU)(e);(Q.status!==a.status||Q.errors.length!==a.errors.length)&&W(a)},el=async e=>{let a=q.getValues("info.naoConformidade"),o=q.getValues("fieldsFooter");if(j){console.log("\uD83D\uDE80 ~ conclude values:",e={form:{...o,...e,naoConformidade:a},params:{id:j,usuarioID:k.usuarioID,papelID:k.papelID,unidadeID:V.unidadeID,profissionalID:k.profissionalID}}),H(null);try{await s.h.post("".concat(S.pathname,"/conclude"),e),await et(q.getValues())}catch(t){console.log(t);return}finally{G(!1),X(!R)}}},en=async e=>{let a={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:k.usuarioID,papelID:k.papelID,unidadeID:V.unidadeID}};try{await s.h.post("".concat(S.pathname,"/reOpen/").concat(j),a),c.ZP.success(I.OD.successUpdate)}catch(o){console.log(o)}finally{X(!R)}},es=e=>{let a=!0;e.forEach(e=>{e.itens.forEach(e=>{e.resposta&&1==e.resposta.bloqueiaFormulario&&(a=!1)})}),B(a)},er=()=>{N(P.modelo.id),S.push("/configuracoes/formularios/limpeza/")},eu=e=>{console.log("\uD83D\uDE80 ~ handleNewNC: ",P.limpeza.id,e.new.modelo.id),N(P.limpeza.id),Z(P.limpeza.id),F(e.new.modelo.id),S.push("/formularios/limpeza/novo/?aba=nao-conformidade")},ed=[],ec={id:1,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,t.jsx)(x.Z,{}),disabled:!M(S.pathname,"editar"),route:null,type:null,action:en,modal:!0,size:"sm",icon:"heroicons:lock-open",identification:null,ncPending:!0};return P&&P.status.id>=40&&ed.push(ec),(0,f.z)(_,"/configuracoes/formularios")&&ed.push({id:2,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:er,modal:!1,icon:"bi:gear",identification:null}),(0,i.useEffect)(()=>{ea(),setTimeout(()=>{q.trigger()},300)},[j,V,R]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("form",{onSubmit:e=>eo(e),children:[(0,t.jsx)(u.Z,{id:j,btnNew:"edit"===T&&"limpeza"==ee,btnNewModal:1===k.papelID&&"edit"===T&&"limpeza"!=ee,handleNewModal:()=>$(!0),btnCancel:!0,btnSave:(null==P?void 0:null===(a=P.status)||void 0===a?void 0:a.id)<40,btnSend:(null==P?void 0:null===(o=P.status)||void 0===o?void 0:o.id)>=30&&(null==P?void 0:null===(v=P.status)||void 0===v?void 0:v.id)<=40,btnPrint:"edit"==T,btnDelete:(null==P?void 0:null===(C=P.status)||void 0===C?void 0:C.id)<40&&"edit"===T,onclickDelete:()=>K(!0),actions:"limpeza"==ee,handleSubmit:()=>q.handleSubmit(et),handleSend(){G(!0),ei(),es(L)},iconConclusion:"solar:check-read-linear",titleConclusion:"Concluir",title:"Limpeza e Higieniza\xe7\xe3o",type:T,status:null==P?void 0:null===(y=P.status)||void 0===y?void 0:y.id,module:"limpeza",actionsData:ed}),(0,t.jsx)(d.Z,{id:j,modelID:w,form:q,header:P,block:L,setBlock:O,defaultTab:"limpeza"}),(0,t.jsx)(b.Z,{title:"Nova N\xe3o Conformidade",handleConclusion:eu,size:"lg",setOpenModal:$,openModal:Y,form:q,children:(0,t.jsx)(g.Z,{type:"form",data:P,form:q})}),P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{openModal:U,handleClose(){G(!1),ei()},title:"Concluir Limpeza e Higieniza\xe7\xe3o",text:"Deseja realmente concluir este formul\xe1rio?",info:{status:P.status.id},canChange:!0,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:el,listErrors:Q,canApprove:A,hasNaoConformidade:!0,type:"limpeza",unity:V,values:P,formularioID:4,modeloID:P.modelo.id,form:q}),(0,t.jsx)(D.Z,{open:J,handleClose:()=>K(!1),title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/recebimento-mp/nao-conformidade/delete/".concat(j),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"}})]})]})})};a.Z=v},30025:function(e,a,o){"use strict";o.r(a);var t=o(85893),i=o(67294),l=o(60664),n=o(93250),s=o(60565),r=o(40039),u=o(47842),d=o(11163),c=o(71798),m=o(30944),p=o(13529);let f=()=>{let{user:e,loggedUnity:a}=(0,i.useContext)(r.V),o=(0,d.useRouter)(),f=o.pathname,{setTitle:h}=(0,i.useContext)(s.f),{startFilter:D,setFilteredDataRecebimentoMP:x,filteredDataRecebimentoMP:I,setDataRecebimentoMP:z}=(0,m.L0)(),[g,b]=(0,i.useState)({module:"limpeza",type:"open"}),v=async()=>{await l.h.post("".concat(f,"/getList"),{unidadeID:a.unidadeID,papelID:e.papelID,usuarioID:e.usuarioID,status:g}).then(e=>{x(e.data),z(e.data),h({icon:"carbon:clean",title:"Limpeza e Higieniza\xe7\xe3o",subtitle:{id:null,count:e.data.length,new:!1}})})};(0,i.useEffect)(()=>{v(),D((0,t.jsx)(p.default,{}),!1)},[o.query,g]);let C=(0,c.OL)(f,[{headerName:"ID",field:"id",size:.4,variant:"naoConformidade"},{headerName:"Data Inicial",field:"dataInicio",size:.4,type:"date"},{headerName:"Data Final",field:"dataFim",size:.4,type:"date"},{headerName:"Setor",field:"setor",size:1},{headerName:"Modelo",field:"modelo",size:1},{headerName:"Tipo",field:"limpezaHigienizacao",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:.5,type:"statusSteps"}]);return(0,t.jsx)(t.Fragment,{children:I?(0,t.jsx)(n.Z,{result:I,columns:C,status:g,setStatus:b},I):(0,t.jsx)(u.Z,{show:!0})})};a.default=f},6530:function(e,a,o){"use strict";o.r(a);var t=o(85893),i=o(67294),l=o(83830),n=o(83097),s=o(28871),r=o(30025);let u=()=>{let{id:e,idNc:a}=(0,i.useContext)(l.X);return(0,t.jsx)(t.Fragment,{children:e&&a?(0,t.jsx)(n.Z,{id:a,limpezaID:e,modelID:null}):e&&!a?(0,t.jsx)(s.Z,{modelID:null}):(0,t.jsx)(r.default,{})})};a.default=u}},function(e){e.O(0,[4738,4186,1445,1111,5999,172,2187,137,5698,3005,3698,1509,5217,3097,9774,2888,179],function(){return e(e.s=94156)}),_N_E=e.O()}]);