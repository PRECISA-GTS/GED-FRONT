(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1132],{94156:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/limpeza",function(){return o(6530)}])},28871:function(e,a,o){"use strict";var t=o(85893),i=o(67294),l=o(83830),n=o(87536),s=o(60664),r=o(40039),u=o(65698),d=o(42567),c=o(86501),m=o(11163),p=o(46099),f=o(42222),h=o(82755),D=o(92629),x=o(91757),I=o(71798),g=o(60565),z=o(3404),v=o(51239),b=o(72819);let C=e=>{var a,o,C,y,w;let{modelID:S}=e;console.log("HeaderLimpeza");let j=(0,m.useRouter)(),{id:N,setId:E,idNc:F,setModelID:Z,setLimpezaID:_}=(0,i.useContext)(l.X),{menu:k,user:V,loggedUnity:H,hasPermission:L}=(0,i.useContext)(r.V),{setTitle:M}=(0,i.useContext)(g.f),[P,O]=(0,i.useState)(null),[T,R]=(0,i.useState)(null),q=N&&N>0?"edit":"new",X=(0,n.cI)({mode:"onChange"}),[A,B]=(0,i.useState)(!1),[U,G]=(0,i.useState)(!0),[J,K]=(0,i.useState)(!1),[Q,W]=(0,i.useState)(!1),[Y,$]=(0,i.useState)({status:!1,errors:[]}),[ee,ea]=(0,i.useState)(!1),eo=(0,z.n)("limpeza",j),et=async()=>{try{let e={id:null!=N?N:0,modelID:null!=S?S:0,unidadeID:H.unidadeID},a=await s.h.post("/formularios/limpeza/getData",e);console.log("\uD83D\uDE80 ~ getData:",a.data),X.reset(a.data),O(a.data.header),R(a.data.blocos)}catch(o){console.log(o);return}},ei=e=>{e.preventDefault();let a=X.getValues();el(a)},el=async e=>{if(!e)return;let a={form:e,auth:{usuarioID:V.usuarioID,papelID:V.papelID,unidadeID:H.unidadeID}};try{if("new"===q){let o=await s.h.post("/formularios/limpeza/insertData",a);c.ZP.success("Dados cadastrados com sucesso!"),E(o.data.id),j.push("/formularios/limpeza")}else"edit"===q&&(await s.h.post("/formularios/limpeza/updateData/".concat(N),a),c.ZP.success("Dados atualizados com sucesso!"))}catch(t){console.log(t);return}finally{B(!A)}},en=()=>{let e={status:!1,errors:[]};X.clearErrors(),(0,p.n9)(X,"header.dataInicio","Data Inicial",e),(0,p.n9)(X,"header.horaInicio","Hora Inicial",e),(0,p.n9)(X,"header.dataFim","Data Final",e),(0,p.n9)(X,"header.horaFim","Hora Final",e),(0,p.n9)(X,"header.departamento.id","Departamento respons\xe1vel pela limpeza",e),(0,p.n9)(X,"header.setor.id","Setor que foi limpo",e),(0,p.lz)(X,X.getValues("header.fields"),e),(0,p.IB)(X,X.getValues("blocos"),e);let a=(0,p.FU)(e);(Y.status!==a.status||Y.errors.length!==a.errors.length)&&$(a)},es=async e=>{let a=X.getValues("info.naoConformidade"),o=X.getValues("fieldsFooter");if(N){console.log("\uD83D\uDE80 ~ conclude values:",e={form:{...o,...e,naoConformidade:a},params:{id:N,usuarioID:V.usuarioID,papelID:V.papelID,unidadeID:H.unidadeID,profissionalID:V.profissionalID}}),O(null);try{await s.h.post("".concat(j.pathname,"/conclude"),e),await el(X.getValues())}catch(t){console.log(t);return}finally{K(!1),B(!A)}}},er=async e=>{let a={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:V.usuarioID,papelID:V.papelID,unidadeID:H.unidadeID}};try{await s.h.post("".concat(j.pathname,"/reOpen/").concat(N),a),c.ZP.success(I.OD.successUpdate)}catch(o){console.log(o)}finally{B(!A)}},eu=e=>{let a=!0;e.forEach(e=>{e.itens.forEach(e=>{e.resposta&&1==e.resposta.bloqueiaFormulario&&(a=!1)})}),G(a)},ed=()=>{E(P.modelo.id),j.push("/configuracoes/formularios/limpeza/")},ec=e=>{console.log("\uD83D\uDE80 ~ handleNewNC: ",P.limpeza.id,e.new.modelo.id),_(P.limpeza.id),Z(e.new.modelo.id),j.push("/formularios/limpeza/novo/?aba=nao-conformidade")},em=[],ep={id:1,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,t.jsx)(x.Z,{}),disabled:!L(j.pathname,"editar"),route:null,type:null,action:er,modal:!0,size:"sm",icon:"heroicons:lock-open",identification:null,ncPending:!0};return P&&P.status.id>=40&&em.push(ep),(0,f.z)(k,"/configuracoes/formularios")&&em.push({id:2,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:ed,modal:!1,icon:"bi:gear",identification:null}),(0,i.useEffect)(()=>{et(),setTimeout(()=>{X.trigger()},300)},[N,H,A]),console.log("currenttab: ",eo),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("form",{onSubmit:e=>ei(e),children:(0,t.jsx)(u.Z,{id:N,btnNew:"edit"===q&&"limpeza"==eo,btnNewModal:1===V.papelID&&"edit"===q&&"limpeza"!=eo,handleNewModal:()=>ea(!0),btnCancel:!0,btnSave:(null==P?void 0:null===(a=P.status)||void 0===a?void 0:a.id)<40,btnSend:(null==P?void 0:null===(o=P.status)||void 0===o?void 0:o.id)>=30&&(null==P?void 0:null===(C=P.status)||void 0===C?void 0:C.id)<=40,btnPrint:"edit"==q,btnDelete:(null==P?void 0:null===(y=P.status)||void 0===y?void 0:y.id)<40&&"edit"===q,onclickDelete:()=>W(!0),actions:"limpeza"==eo,handleSubmit:()=>X.handleSubmit(el),handleSend(){K(!0),en(),eu(T)},iconConclusion:"solar:check-read-linear",titleConclusion:"Concluir",title:"Limpeza e Higieniza\xe7\xe3o",type:q,status:null==P?void 0:null===(w=P.status)||void 0===w?void 0:w.id,module:"limpeza",actionsData:em})}),(0,t.jsx)(d.Z,{id:N,modelID:S,form:X,header:P,block:T,setBlock:R,defaultTab:"limpeza"}),P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{openModal:J,handleClose(){K(!1),en()},title:"Concluir Limpeza e Higieniza\xe7\xe3o",text:"Deseja realmente concluir este formul\xe1rio?",info:{status:P.status.id},canChange:!0,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:es,listErrors:Y,canApprove:U,hasNaoConformidade:!0,type:"limpeza",unity:H,values:P,formularioID:4,modeloID:P.modelo.id,form:X}),(0,t.jsx)(D.Z,{open:Q,handleClose:()=>W(!1),title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/recebimento-mp/nao-conformidade/delete/".concat(N),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"}}),(0,t.jsx)(b.Z,{title:"Nova N\xe3o Conformidade",handleConclusion:ec,size:"lg",setOpenModal:ea,openModal:ee,form:X,children:(0,t.jsx)(v.Z,{type:"form",data:P,form:X})})]})]})};a.Z=C},8316:function(e,a,o){"use strict";o.r(a);var t=o(85893),i=o(67294),l=o(60664),n=o(93250),s=o(60565),r=o(40039),u=o(47842),d=o(11163),c=o(71798),m=o(30944),p=o(13529);let f=()=>{let{user:e,loggedUnity:a}=(0,i.useContext)(r.V),o=(0,d.useRouter)(),f=o.pathname,{setTitle:h}=(0,i.useContext)(s.f),{startFilter:D,setFilteredDataRecebimentoMP:x,filteredDataRecebimentoMP:I,setDataRecebimentoMP:g}=(0,m.L0)(),[z,v]=(0,i.useState)({module:"limpeza",type:"open"}),b=async()=>{await l.h.post("".concat(f,"/getList"),{unidadeID:a.unidadeID,papelID:e.papelID,usuarioID:e.usuarioID,status:z}).then(e=>{x(e.data),g(e.data),h({icon:"carbon:clean",title:"Limpeza e Higieniza\xe7\xe3o",subtitle:{id:null,count:e.data.length,new:!1}})})};(0,i.useEffect)(()=>{b(),D((0,t.jsx)(p.default,{}),!1)},[o.query,z]);let C=(0,c.OL)(f,[{headerName:"ID",field:"id",size:.4,variant:"naoConformidade"},{headerName:"Data Inicial",field:"dataInicio",size:.4,type:"date"},{headerName:"Data Final",field:"dataFim",size:.4,type:"date"},{headerName:"Setor",field:"setor",size:1},{headerName:"Modelo",field:"modelo",size:1},{headerName:"Tipo",field:"limpezaHigienizacao",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:.5,type:"statusSteps"}]);return(0,t.jsx)(t.Fragment,{children:I?(0,t.jsx)(n.Z,{result:I,columns:C,status:z,setStatus:v},I):(0,t.jsx)(u.Z,{show:!0})})};a.default=f},6530:function(e,a,o){"use strict";o.r(a);var t=o(85893),i=o(67294),l=o(83830),n=o(8316);o(89604),o(7113);var s=o(11163);o(21609);var r=o(83097);o(51735);var u=o(28871);let d=()=>{(0,s.useRouter)();let{id:e,idNc:a}=(0,i.useContext)(l.X);return console.log("\uD83D\uDE80 ~ id:",e,a),(0,t.jsx)(t.Fragment,{children:e&&a?(0,t.jsx)(r.Z,{id:a,limpezaID:e,modelID:null}):e&&!a?(0,t.jsx)(u.Z,{}):(0,t.jsx)(n.default,{})})};a.default=d}},function(e){e.O(0,[4738,4186,1445,1111,5999,172,2187,137,5698,3005,3698,1509,7113,9520,9774,2888,179],function(){return e(e.s=94156)}),_N_E=e.O()}]);