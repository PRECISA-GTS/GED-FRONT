(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7463],{59424:function(e,o,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/formularios/fornecedor",function(){return a(90641)}])},93250:function(e,o,a){"use strict";var t=a(85893),n=a(49837),l=a(91359),r=a(69175);let s=e=>{let{result:o,columns:a,btnNew:s=!0,btnPrint:i=!0,btnBack:d,openModal:c,modalLog:u}=e;return(0,t.jsx)(n.Z,{children:(0,t.jsx)(l.Z,{sx:{pt:"0"},children:(0,t.jsx)(r.Z,{rows:o,columns:a,modalLog:u,buttonsHeader:{btnNew:s,btnPrint:i,btnBack:d,openModal:c}})})})};o.Z=s},46905:function(e,o,a){"use strict";var t=a(85893),n=a(87536),l=a(79072),r=a(55343),s=a(67836);let i=e=>{let{xs:o,md:a,title:i,name:d,disabled:c,required:u,form:m,onChange:p}=e;return(0,t.jsx)(l.ZP,{item:!0,xs:o,md:a,children:(0,t.jsx)("div",{children:(0,t.jsx)(r.Z,{fullWidth:!0,children:(0,t.jsx)(n.Qr,{name:d,control:m.control,rules:{required:u},render(e){let{field:o}=e;return(0,t.jsx)(s.Z,{label:i,value:null==o?void 0:o.value,placeholder:i,type:"date",size:"small","aria-describedby":"validation-schema-nome",disabled:c,error:!!m.formState.errors[d],onChange(e){let a=e.target.value;o.onChange(a),p&&p(a)},InputLabelProps:{shrink:!0},inputProps:{min:"1900-01-01",max:"2100-01-01"}})}})})})})};o.Z=i},55148:function(e,o,a){"use strict";var t=a(85893),n=a(79072),l=a(55343),r=a(35966),s=a(67836),i=a(87536),d=a(53934),c=a(30944);let u=e=>{let{xs:o,md:a,title:u,options:m,form:p,name:x,limitTags:f,value:h,required:v,disabled:D,multiple:g,onChange:j,className:I,keyProps:b,createNew:y,helpText:Z,helpTextPosition:C}=e,F=y?[{id:null,name:"-- Novo --"},...null!=m?m:[]]:m,{key:S}=(0,c.L0)();return(0,t.jsx)(n.ZP,{item:!0,xs:o,md:a,sx:{my:1},className:I,children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(l.Z,{fullWidth:!0,children:(0,t.jsx)(i.Qr,{name:x,control:p.control,rules:{required:v},render(e){let{field:o}=e;return(0,t.jsx)(r.Z,{options:F.map(e=>e.name),value:h,onChange(e,o){let a=F.find(e=>e.name===o);p.setValue(x,null!=a?a:null)},renderInput(e){var o;return(0,t.jsx)(s.Z,{...e,id:"customSelect",size:"small",label:u,placeholder:u,error:!!p.formState.errors[x],helperText:null===(o=p.formState.errors[x])||void 0===o?void 0:o.message})}},b||S)}})}),Z&&(0,t.jsx)("div",{className:"absolute right-[60px] top-[12px] ",children:(0,t.jsx)(d.Z,{text:Z,position:null!=C?C:"top"})})]})})};o.Z=u},52189:function(e,o,a){"use strict";var t=a(85893),n=a(64004);a(67294);var l=a(42404),r=a(17844);let s=()=>{var e,o,a,s,i,d,c,u;let m=(0,r.Z)();return m&&(0,t.jsxs)(n.G7,{style:{width:"100%"},children:[(0,t.jsx)(n.G7,{style:{padding:3,backgroundColor:"#eee",marginTop:20,border:"1px solid #ddd"},children:(0,t.jsx)(n.xv,{style:{width:"100%",textAlign:"center",fontSize:12},children:"QUALIFICA\xc7\xc3O DE FORNECEDORES"})}),(0,t.jsx)(n.G7,{style:{marginTop:20},children:(0,t.jsxs)(n.xv,{style:{fontSize:10},children:["A empresa ",(0,t.jsx)(n.xv,{children:null==m?void 0:m.unidade})," possui como norma de BPF a avalia\xe7\xe3o de seus fornecedores quanto as mat\xe9rias primas e ingredientes por estes fornecidos."]})}),"Fornecedor",(0,t.jsx)(n.G7,{style:{marginTop:20},children:(0,t.jsxs)(n.xv,{style:{fontSize:10},children:["Fornecedor: ",(0,t.jsx)(n.xv,{style:{fontWeight:"bold",fontSize:10},children:m.fornecedor})]})}),(0,t.jsx)(n.G7,{style:{marginTop:20},children:(0,t.jsxs)(n.xv,{style:{fontSize:10},children:[(null==m?void 0:null===(e=m.produtos)||void 0===e?void 0:e.length)>1?"Produtos fornecidos: ":"Produto fornecido: ",null==m?void 0:null===(o=m.produtos)||void 0===o?void 0:o.map((e,o)=>(0,t.jsxs)(n.xv,{children:[(0,t.jsx)(n.xv,{style:{fontWeight:"bold",fontSize:10},children:e.produtos}),o!==m.produtos.length-1&&", "]},o))]})}),(0,t.jsx)(n.G7,{style:{marginTop:20},children:(0,t.jsx)(n.G7,{style:l.W.containerFields,children:null===(a=m.header)||void 0===a?void 0:a.map((e,o)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.G7,{style:[l.W.fields,{width:"33%"}],children:[(0,t.jsx)(n.xv,{style:l.W.fieldTitle,children:null!==(i=e.name)&&void 0!==i?i:""}),(0,t.jsx)(n.xv,{style:l.W.fieldValue,children:null!==(d=e.value)&&void 0!==d?d:""})]}),(o+1)%3==0&&(0,t.jsx)(n.G7,{style:l.W.separator})]}))})}),null===(s=m.blocks)||void 0===s?void 0:s.map((e,o)=>(0,t.jsx)(n.G7,{style:[e,{marginTop:30}],children:(0,t.jsxs)(n.G7,{style:l.W.table,children:[(0,t.jsxs)(n.G7,{style:l.W.tableTitle,children:[(0,t.jsx)(n.xv,{style:[l.W.tableTitlecolumn,{width:"60%"}],children:e.nome}),(0,t.jsx)(n.xv,{style:[l.W.tableTitlecolumn,{width:"20%",borderLeft:"1px solid #ddd"}],children:"Resposta"}),(0,t.jsx)(n.xv,{style:[l.W.tableTitlecolumn,{width:"20%",borderLeft:"1px solid #ddd"}],children:"Observa\xe7\xe3o"})]}),e.itens.map((e,o)=>(0,t.jsxs)(n.G7,{style:l.W.tableContainer,children:[(0,t.jsx)(n.G7,{style:[l.W.tableContent,{width:"60%"}],children:(0,t.jsx)(n.xv,{style:l.W.tableContentcolumn,children:e.nome})}),(0,t.jsx)(n.G7,{style:[l.W.tableContent,{width:"20%"}],children:(0,t.jsx)(n.xv,{style:l.W.tableContentcolumn,children:null!==(c=e.resposta)&&void 0!==c?c:""})}),(0,t.jsx)(n.G7,{style:[l.W.tableContent,{width:"20%"}],children:(0,t.jsx)(n.xv,{style:l.W.tableContentcolumn,children:null!==(u=e.obsResposta)&&void 0!==u?u:""})})]}))]})},o))]})};o.Z=s},2941:function(e,o,a){"use strict";a.r(o);var t=a(85893),n=a(67294),l=a(46905),r=a(55148),s=a(51570),i=a(30944);let d=()=>{var e,o;let{form:a,setNames:d,filterDate:c,SelectFilterByName:u,data:m,setFilteredData:p,handleSearch:x,key:f}=(0,i.L0)(),{commonData:h}=(0,s.Lq)(),v=m,D=async()=>{p(v=await u(v=await u(v=await c(v=await x(v)),"status"),"quemPreenche"))};return(0,n.useEffect)(()=>{D()},[f]),(0,n.useEffect)(()=>{d(["dataInicio","dataFim","quemPreenche","status"])},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Z,{xs:12,md:6,title:"Data inicio da avaliac\xe3o",name:"dataInicio",form:a}),(0,t.jsx)(l.Z,{xs:12,md:6,title:"Data Fim da avalia\xe7\xe3o",name:"dataFim",form:a}),(0,t.jsx)(r.Z,{xs:12,md:6,title:"Status",name:"status",form:a,options:h.status,value:null===(e=a.getValues("status"))||void 0===e?void 0:e.name}),(0,t.jsx)(r.Z,{xs:12,md:6,title:"Quem preencheu",name:"quemPreenche",value:null===(o=a.getValues("quemPreenche"))||void 0===o?void 0:o.name,form:a,options:[{id:"1",name:"F\xe1brica"},{id:"2",name:"Fornecedor"}]})]})};o.default=d},90641:function(e,o,a){"use strict";a.r(o),a.d(o,{default:function(){return en}});var t=a(85893),n=a(67294),l=a(11163),r=a.n(l),s=a(60664),i=a(93250),d=a(87536),c=a(56531),u=a(99734),m=a(34282),p=a(7071),x=a(29308),f=a(23895),h=a(61953),v=a(19604),D=a(49837),g=a(91359),j=a(79072),I=a(55343),b=a(29630),y=a(46749),Z=a(86887),C=a(83830),F=a(40039),S=a(39976),E=a(47842),w=a(86501),P=a(66136),A=a(80377),N=a(22416),z=a(22841),k=a(16056);let G=e=>{let{xs:o,md:a,title:n,index:l,name:r,typePage:s,value:i,disabled:d,register:c,...u}=e;return(0,t.jsx)(j.ZP,{item:!0,xs:o,md:a,children:(0,t.jsx)(h.Z,{display:"flex",flexDirection:"column",alignItems:"start",children:(0,t.jsx)(z.Z,{control:(0,t.jsx)(k.Z,{...u,name:r,...c(r),defaultChecked:i,disabled:d,onChange(e){u.onChange&&u.onChange(e.target.checked,l,r,s)}}),label:n,size:"small",sx:{"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})})})},W=e=>{let{data:o,control:a,setValue:l,register:r,errors:s}=e,[i,d]=(0,n.useState)(!0);return l("emailDestinatario",o.email),(0,t.jsxs)("div",{className:"flex flex-col gap-2 pt-2",children:[i&&(0,t.jsx)(x.Z,{name:"emailDestinatario",type:"email",title:"E-mail do destinat\xe1rio",required:!0,control:a,errors:s.emailDestinatario}),(0,t.jsx)(x.Z,{name:"assunto",title:"Assunto",required:!0,register:r,control:a,defaultValue:"",errors:s.assunto}),(0,t.jsx)(x.Z,{name:"descricao",title:"Descri\xe7\xe3o",multiline:!0,rows:4,required:!0,control:a,defaultValue:"",errors:s.descricao}),(0,t.jsxs)(N.Z,{row:!0,children:[(0,t.jsx)(G,{name:"email",title:"E-mail",value:!0,register:r,onChange:()=>d(!i)}),(0,t.jsx)(G,{name:"alerta",title:"Alerta",value:!0,register:r})]})]})};var q=a(70190),M=a(44373);a(80587);var O=a(92945);let T=e=>{let{values:o,handleFileSelect:a,handleRemove:l,disabled:r,errors:s}=e,{settings:i}=(0,n.useContext)(P.J6),d=i.mode,[c,u]=(0,n.useState)(null),m=(0,n.useRef)(null),p=e=>{m.current.click(),u(e)};return(0,n.useEffect)(()=>{m.current&&(m.current.value="")},[a]),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:o&&o.map((e,n)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.ZP,{container:!0,spacing:2,children:(0,t.jsx)(j.ZP,{item:!0,xs:12,sm:6,children:(0,t.jsxs)(h.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(b.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},children:e.nome}),(0,t.jsx)(b.Z,{variant:"body2",children:"(".concat(e.unidadeMedida,")")})]})})},n),e.produtoAnexosDescricao&&e.produtoAnexosDescricao.length>0&&(0,t.jsx)(j.ZP,{container:!0,spacing:4,children:e.produtoAnexosDescricao.map((e,o)=>(0,t.jsx)(O.Z,{modeTheme:d,handleFileClick:p,selectedItem:c,inputRef:m,item:e,indexBlock:n,indexItem:o,handleFileSelect:a,folder:"produto",handleRemove:l,error:s,disabled:r},"".concat(n,"-").concat(o)))}),e.anexos&&0===e.anexos.length&&(0,t.jsx)(b.Z,{variant:"body2",sx:{mb:2},children:"Este produto n\xe3o exige anexos"}),n<o.length-1&&(0,t.jsx)(M.Z,{sx:{my:4}})]}))})};var H=a(50287),R=a(99384);let L=e=>{var o,a,l,r,i,d,u,m,p;let{modeloID:f,values:h,fields:v,disabled:D,register:g,errors:I,setValue:b,control:Z,getAddressByCep:C}=e;console.log("\uD83D\uDE80 ~ values:",h);let[F,S]=(0,n.useState)([]),{setDateFormat:E,dateStatus:w}=(0,R.Z)(),P=async()=>{let e=await s.h.post("/cadastros/profissional/getProfissionaisAssinatura",{formularioID:1,modeloID:f});S(e.data.preenche)};return(0,n.useEffect)(()=>{P(),h&&!h.data&&b("fieldsHeader.data",(0,y.Ux)()),h&&!h.hora&&b("fieldsHeader.hora",(0,y.Xn)())},[h]),console.log("renderiza fields static...."),(0,t.jsxs)(j.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(x.Z,{xs:12,md:2,title:"Data da abertura",name:"fieldsHeader.abertoPor.dataInicio",value:h.abertoPor.dataInicio,disabled:!0,register:g,control:Z}),(0,t.jsx)(x.Z,{xs:12,md:2,title:"Hora da abertura",name:"fieldsHeader.abertoPor.horaInicio",value:h.abertoPor.dataInicio,type:"time",disabled:!0,register:g,control:Z}),(0,t.jsx)(x.Z,{xs:12,md:8,title:"Aberto por",name:"fieldsHeader.abertoPor.profissional.nome",value:null==h?void 0:null===(o=h.abertoPor)||void 0===o?void 0:null===(a=o.profissional)||void 0===a?void 0:a.nome,disabled:!0,register:g,control:Z}),(0,t.jsx)(H.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null!==(m=null==h?void 0:h.data)&&void 0!==m?m:(0,y.Ux)(),disabled:D,register:g,control:Z,setDateFormat:E,typeValidation:"dataPassado",daysValidation:365,dateStatus:w,errors:null==I?void 0:null===(l=I.fieldsHeader)||void 0===l?void 0:l.data}),(0,t.jsx)(x.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",value:null!==(p=null==h?void 0:h.data)&&void 0!==p?p:(0,y.Xn)(),type:"time",disabled:D,register:g,control:Z,errors:null==I?void 0:null===(r=I.fieldsHeader)||void 0===r?void 0:r.hora}),(0,t.jsx)(x.Z,{xs:12,md:4,title:"CNPJ",name:"fieldsHeader.cnpj",type:"string",mask:"cnpj",disabled:!0,register:g,control:Z,errors:null==I?void 0:null===(i=I.fieldsHeader)||void 0===i?void 0:i.cnpj}),(0,t.jsx)(x.Z,{xs:12,md:4,title:"Raz\xe3o Social",name:"fieldsHeader.razaoSocial",type:"string",disabled:D,register:g,control:Z,errors:null==I?void 0:null===(d=I.fieldsHeader)||void 0===d?void 0:d.razaoSocial}),(0,t.jsx)(x.Z,{xs:12,md:4,title:"Nome Fantasia",name:"fieldsHeader.nomeFantasia",type:"string",disabled:D,register:g,control:Z,errors:null==I?void 0:null===(u=I.fieldsHeader)||void 0===u?void 0:u.nomeFantasia}),(0,t.jsx)(c.Z,{register:g,errors:I,setValue:b,control:Z,fields:v,values:v,getAddressByCep:C,disabled:D})]})};a(84220);var V=a(41088),_=a(92629),B=a(52189),Q=a(1503);let U=e=>{let{control:o,register:a}=e;return(0,t.jsx)("div",{children:(0,t.jsx)(x.Z,{name:"obs",title:"Observa\xe7\xe3o",register:a,control:o,defaultValue:"",multiline:!0,rows:6})})};var X=a(934);let J=e=>{var o,a;let l;let{id:i,makeFornecedor:c}=e,{menu:E,user:N,loggedUnity:z}=(0,n.useContext)(F.V),[k,G]=(0,n.useState)(!1),[M,O]=(0,n.useState)(!1),[H,R]=(0,n.useState)(!0),[J,K]=(0,n.useState)(!0),[Y,$]=(0,n.useState)(null),[ee,eo]=(0,n.useState)([]),[ea,et]=(0,n.useState)([]),[en,el]=(0,n.useState)(!1),[er,es]=(0,n.useState)(null),{createNewNotification:ei}=(0,n.useContext)(S.u),[ed,ec]=(0,n.useState)(!1),[eu,em]=(0,n.useState)([]),[ep,ex]=(0,n.useState)([]),[ef,eh]=(0,n.useState)([]),[ev,eD]=(0,n.useState)(null),[eg,ej]=(0,n.useState)([]),[eI,eb]=(0,n.useState)(null),[ey,eZ]=(0,n.useState)(""),[eC,eF]=(0,n.useState)(!1),[eS,eE]=(0,n.useState)(!1),[ew,eP]=(0,n.useState)({status:!1,errors:[]}),{settings:eA}=(0,n.useContext)(P.J6),{setId:eN}=(0,n.useContext)(C.X),[ez,ek]=(0,n.useState)([]),[eG,eW]=(0,n.useState)(!1),[eq,eM]=(0,n.useState)(null),{setReportParameters:eO,sendPdfToServer:eT}=(0,Q.Gc)(),{isLoading:eH,startLoading:eR,stopLoading:eL}=(0,V.Z)(),[eV,e_]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"});console.log("\uD83D\uDE80 ~ canEdit:",eV);//! Se perder Id, copia do localstorage
let eB=r(),eQ=i&&i>0?"edit":"new",eU=eB.pathname;console.log("\uD83D\uDE80 ~ staticUrl:",eU);let{reset:eX,register:eJ,getValues:eK,setValue:eY,control:e$,watch:e0,handleSubmit:e1,clearErrors:e3,setError:e2,formState:{errors:e7}}=(0,d.cI)();console.log("formFornecedor errors: ",e7);let e4=async e=>{let o={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:N.usuarioID,papelID:N.papelID,unidadeID:z.unidadeID}};try{G(!0),await s.h.post("".concat(eU,"/changeFormStatus/").concat(i),o).then(e=>{w.ZP.success(y.OD.successUpdate),G(!1),om(er,null,null)})}catch(a){console.log(a)}},e8=async e=>{try{if(!e.email&&!e.alerta)return w.ZP.error("Selecione ao menos um tipo de notifica\xe7\xe3o!");let o={titulo:e.assunto,descricao:e.descricao,url:"/formularios/fornecedor/",urlID:i,tipoNotificacaoID:3,usuarioGeradorID:N.usuarioID,usuarioID:0,unidadeID:Y.fornecedor.unidadeID,papelID:2,email:e.email,alerta:e.alerta};if(ei(o),e.email){let a={values:e,auth:{id:i,usuarioID:N.usuarioID,papelID:N.papelID,unidadeID:z.unidadeID}};await s.h.post("".concat(eU,"/sendNotification"),a)}let t=e.alerta&&e.email?"E-mail e alerta enviados com sucesso!":e.alerta&&!e.email?"Alerta criado com sucesso!":!e.alerta&&e.email?"E-mail enviado com sucesso!":null;w.ZP.success(t)}catch(n){console.log(n)}},e9=()=>{navigator.clipboard.writeText(ev),w.ZP.success("Link copiado com sucesso!")},e5=()=>{eN(Y.parFornecedorModeloID),eB.push("/configuracoes/formularios/fornecedor/")},e6={id:1,name:"Gerar novo formul\xe1rio",description:"Gerar um novo formul\xe1rio de preenchimento para este fornecedor.",component:(0,t.jsx)(q.Z,{cnpj:null==eu?void 0:eu.cnpj}),route:null,type:null,modal:!0,action:c,size:"lg",icon:"fluent:form-new-20-regular",identification:null},oe={id:2,name:"Gerar notifica\xe7\xe3o",description:"Gerar uma nova notifica\xe7\xe3o para o fornecedor, podendo ser um e-mail e/ou alerta do sistema.",component:(0,t.jsx)(W,{data:{email:null===(o=ef.find(e=>"email"==e.nomeColuna))||void 0===o?void 0:o.email}}),route:null,type:null,modal:!0,action:e8,icon:"cil:bell",identification:null},oo={id:3,name:"Copiar link do formul\xe1rio",description:"Copiar o link deste formul\xe1rio.",component:(0,t.jsx)(q.Z,{}),route:null,type:null,action:e9,modal:!1,icon:"solar:copy-outline",identification:null},oa={id:i,name:"Imprimir",nameComponent:"DadosFornecedor",type:"report",unidadeID:z.unidadeID,papelID:N.papelID,usuarioID:N.usuarioID,status:ey.status,route:"fornecedor/dadosFornecedor",icon:"fluent:print-24-regular"},ot={id:6,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,t.jsx)(U,{}),disabled:!!H,route:null,type:null,action:e4,modal:!0,icon:"heroicons:lock-open",identification:null},on=[];1==N.papelID&&(on.push(e6),ey.status>=40&&on.push(ot)),on.push(oe),on.push(oo),on.push(oa),1==N.papelID&&(l=!1,E.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(l=!0)})})}),l)&&on.push({id:5,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:e5,modal:!1,icon:"bi:gear",identification:null});let ol=async()=>{try{await s.h.post("".concat(eU,"/verifyFormPending/").concat(i),{parFormularioID:1}).then(e=>{R(e.data) //! true/false
})}catch(e){console.log(e)}};console.log("canmEDIT",eV);let or=()=>{eR();try{s.h.post("".concat(eU,"/getData/").concat(i),{type:eQ,unidadeID:z.unidadeID}).then(e=>{var o,a,t;console.log("getData: ",e.data),em(e.data.fieldsHeader),ex(e.data.fieldsFooter),eh(e.data.fields),eo(e.data.produtos),ej(e.data.blocos),et(e.data.grupoAnexo),eZ(e.data.info),$(e.data.unidade),eD(e.data.link),eb(e.data.ultimaMovimentacao),oc(e.data.blocos),eX(e.data);let n=[];for(let l=0;l<e.data.fields.length;l++){let r=e.data.fields[l].nomeColuna,s=e.data.fields[l].nomeCampo;for(let i in z){if("telefone"==r){let d=null!==(t=z.telefone1)&&void 0!==t?t:z.telefone2;eY("fields[".concat(l,"].").concat(r),null!=d?d:"")}i!==r||eK("fields[".concat(l,"].").concat(r),z[i])||(eY("fields[".concat(l,"].").concat(r),z[i]),null!==z[i]&&""!==z[i]&&n.push({name:s,value:z[i]}))}}ek(n);let c=y.WR[null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(a=o.info)||void 0===a?void 0:a.status];es(c),console.log("\uD83D\uDE80 ~ response.data.unidade:",N.papelID,e.data.unidade.quemPreenche,ey.status),e_({status:N.papelID==e.data.unidade.quemPreenche&&e.data.info.status<40,message:2==N.papelID&&e.data.info.status>=40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo e enviado pra f\xe1brica, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":1==N.papelID&&e.data.info.status<40?"Somente o fornecedor pode alterar as informa\xe7\xf5es deste formul\xe1rio!":1==N.papelID&&40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o":null,messageType:2==N.papelID?"warning":"info"}),ol()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e)}finally{eL()}},os=()=>{e3();let e=!1,o=[];null==ef||ef.forEach((a,t)=>{let n=a.tabela?"fields[".concat(t,"].").concat(a.tabela):"fields[".concat(t,"].").concat(a.nomeColuna),l=eK(n);1!==a.obrigatorio||l||(e2(n,{type:"manual",message:"Campo obrigat\xf3rio"}),o.push(null==a?void 0:a.nomeCampo),e=!0)}),ee&&ee.length>0&&ee.forEach((a,t)=>{a.produtoAnexosDescricao.forEach((n,l)=>{1===n.obrigatorio&&0==n.anexos.length&&(e2("produtos[".concat(t,"].produtoAnexosDescricao[").concat(l,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eg.forEach((a,t)=>{a.itens.forEach((a,n)=>{let l=eK("blocos[".concat(t,"].itens[").concat(n,"].resposta"));(null==a?void 0:a.obrigatorio)!==1||l||(e2("blocos[".concat(t,"].itens[").concat(n,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push(null==a?void 0:a.nome),e=!0),a.respostaConfig&&1==a.respostaConfig.anexo&&a.respostaConfig.anexosSolicitados.length>0&&a.respostaConfig.anexosSolicitados.forEach((l,r)=>{1==l.obrigatorio&&l.anexos&&0==l.anexos.length&&(e2("blocos[".concat(t,"].itens[").concat(n,"].respostaConfig.anexosSolicitados[").concat(r,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==l?void 0:l.nome)),e=!0)})})}),ea&&ea.length>0&&ea.forEach((a,t)=>{a.itens.forEach((n,l)=>{1===n.obrigatorio&&0==n.anexos.length&&(e2("grupoAnexo[".concat(t,"].itens[").concat(l,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),o.push("Anexo: ".concat(null==a?void 0:a.nome," / ").concat(null==n?void 0:n.nome)),e=!0)})}),eP({status:e,errors:o})},oi=async e=>{if(9===e.length){let o=e.replace(/[^0-9]/g,"");try{let a=await s.h.get("https://viacep.com.br/ws/".concat(o,"/json/"));a.data.localidade?(ef.forEach(async(e,o)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await eY("fields[".concat(o,"].logradouro"),a.data.logradouro),await eY("fields[".concat(o,"].bairro"),a.data.bairro),await eY("fields[".concat(o,"].cidade"),a.data.localidade),await eY("fields[".concat(o,"].estado"),a.data.uf))}),w.ZP.success("Endere\xe7o encontrado!")):w.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},od=e=>{eM(e),os(),eF(!0),O(!0)},oc=e=>{let o=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(o=!1)})}),K(o)},ou=async e=>{eT(i,eq,"fornecedor"),e.conclusion=!0,await e1(op)(e)},om=(e,o,a)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(i," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:i,tipoNotificacaoID:6,usuarioGeradorID:N.usuarioID,usuarioID:0,unidadeID:z.unidadeID,papelID:1};if(n&&(ei(n),o)){let l={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(i," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:a,tipoNotificacaoID:5,usuarioGeradorID:N.usuarioID,usuarioID:0,unidadeID:z.unidadeID,papelID:1};ei(l)}},op=async function(e){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("\uD83D\uDE80 ~ onSubmit values",e),eR(),!0===o.conclusion&&(e.status=N&&1==N.papelID?o.status:40,e.obsConclusao=o.obsConclusao);let a={form:e,auth:{usuarioID:N.usuarioID,papelID:N.papelID,unidadeID:z.unidadeID}};try{"edit"==eQ?(G(!0),await s.h.post("".concat(eU,"/updateData/").concat(i),a).then(o=>{w.ZP.success(y.OD.successUpdate),G(!1);let a=null;o.data&&o.data.naoConformidade&&o.data.id>0&&(eB.push("/formularios/fornecedor/nao-conformidade/"),eN(o.data.id),a=o.data.id),om(e.status,e.naoConformidade,a)})):"new"==eQ?await s.h.post("".concat((0,y.g_)(eU),"/insertData"),a).then(e=>{eB.push("".concat((0,y.g_)(eU))),eN(e.data),w.ZP.success(y.OD.successNew)}):w.ZP.error(y.OD.error)}catch(t){console.log(t)}finally{eL(),console.log("fun\xe7\xe3o ativada fim finally")}},ox=async(e,o)=>{eR();let a=e.target.files;if(a&&a.length>0){var t,n,l,r;let d=new FormData;for(let c=0;c<a.length;c++)d.append("files[]",a[c]);d.append("usuarioID",N.usuarioID),d.append("unidadeID",z.unidadeID),d.append("produtoAnexoID",null!==(t=o.produtoAnexoID)&&void 0!==t?t:null);try{await s.h.post("".concat(eU,"/saveAnexo/").concat(i,"/produto/").concat(N.usuarioID,"/").concat(Y.unidadeID),d);let u=eK();op(u)}catch(m){w.ZP.error(null!==(r=null===(n=m.response)||void 0===n?void 0:null===(l=n.data)||void 0===l?void 0:l.message)&&void 0!==r?r:"Erro ao atualizar anexo, tente novamente!")}finally{eL()}}},of=async(e,o)=>{let a=e.target.files;if(a&&a.length>0){var t,n,l,r;let d=new FormData;for(let c=0;c<a.length;c++)d.append("files[]",a[c]);d.append("usuarioID",N.usuarioID),d.append("unidadeID",z.unidadeID),d.append("grupoAnexoItemID",null!==(t=o.grupoAnexoItemID)&&void 0!==t?t:null);try{eR(),await s.h.post("".concat(eU,"/saveAnexo/").concat(i,"/grupo-anexo/").concat(N.usuarioID,"/").concat(Y.unidadeID),d);let u=eK();op(u)}catch(m){w.ZP.error(null!==(r=null===(n=m.response)||void 0===n?void 0:null===(l=n.data)||void 0===l?void 0:l.message)&&void 0!==r?r:"Erro ao atualizar anexo, tente novamente!")}finally{eL()}}},oh=async(e,o)=>{let a=e.target.files;if(a&&a.length>0){var t,n,l,r,d;let c=new FormData;for(let u=0;u<a.length;u++)c.append("files[]",a[u]);c.append("usuarioID",N.usuarioID),c.append("unidadeID",z.unidadeID),c.append("parFornecedorModeloBlocoID",null!==(t=o.parFornecedorModeloBlocoID)&&void 0!==t?t:null),c.append("itemOpcaoAnexoID",null!==(n=o.itemOpcaoAnexoID)&&void 0!==n?n:null);try{eR(),await s.h.post("".concat(eU,"/saveAnexo/").concat(i,"/item/").concat(N.usuarioID,"/").concat(Y.unidadeID),c);let m=eK();op(m)}catch(p){w.ZP.error(null!==(d=null===(l=p.response)||void 0===l?void 0:null===(r=l.data)||void 0===r?void 0:r.message)&&void 0!==d?d:"Erro ao atualizar anexo, tente novamente!")}finally{eL()}}},ov=async e=>{try{let o=await s.h.post("/cadastros/item/getItemConfigs",{itemID:e.itemID,alternativaItemID:e.alternativa.id}),a=eg.map(a=>({...a,itens:a.itens.map(a=>a.itemID==e.itemID?{...a,respostaConfig:{...o.data}}:a)}));ej(a)}catch(t){console.log("error",t)}},oD=async e=>{e&&await s.h.delete("".concat(eU,"/deleteAnexo/").concat(i,"/").concat(e.anexoID,"/").concat(Y.unidadeID,"/").concat(N.usuarioID,"/produto")).then(e=>{let o=eK();op(o)}).catch(e=>{var o,a,t;w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},og=async e=>{e&&await s.h.delete("".concat(eU,"/deleteAnexo/").concat(i,"/").concat(e.anexoID,"/").concat(Y.unidadeID,"/").concat(N.usuarioID,"/grupo-anexo")).then(e=>{let o=eK();op(o)}).catch(e=>{var o,a,t;w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},oj=async e=>{e&&await s.h.delete("".concat(eU,"/deleteAnexo/").concat(i,"/").concat(e.anexoID,"/").concat(Y.unidadeID,"/").concat(N.usuarioID,"/item")).then(e=>{let o=eK();op(o)}).catch(e=>{var o,a,t;w.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},oI=e=>{let o=[...eg];o.map((o,a)=>{o.itens.map((o,t)=>{eY("blocos[".concat(a,"].itens[").concat(t,"].resposta"),o.alternativas[e])})}),ej(o=>o.map(o=>({...o,itens:o.itens.map(o=>({...o,resposta:o.alternativas[e]&&o.alternativas[e].id>0?o.alternativas[e]:null}))}))),el(!en);let a=eK();op(a)};return(0,n.useEffect)(()=>{"edit"==eQ&&or()},[i,k]),(0,n.useEffect)(()=>{os()},[]),(0,n.useEffect)(()=>{eO({id:i,nameComponent:"DadosFornecedor",route:"fornecedor/dadosFornecedor",unidadeID:z.unidadeID,papelID:N.papelID,canEdit:eV,usuarioID:N.usuarioID})},[]),console.log("\uD83D\uDE80 ~ info.status:",ey.status),console.log("user",N.papelID),console.log("canEdit.status",eV.status),console.log("peding",H),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("form",{onSubmit:e1(op),children:[(0,t.jsx)(Z.Z,{btnCancel:!0,btnDelete:ey.status<40,onclickDelete:()=>eW(!0),btnSave:eV.status,btnSend:1==N.papelID&&ey.status>=30&&ey.status<=40||2==N.papelID&&ey.status<40,btnPrint:"edit"==eQ,actionsData:on,actions:!0,handleSubmit:()=>e1(op),handleSend:od,componentSaveReport:(0,t.jsx)(B.Z,{}),iconConclusion:"mdi:check-bold",titleConclusion:"Concluir Formul\xe1rio",title:"Fornecedor",btnStatus:"edit"==eQ,handleBtnStatus:()=>ec(!0),type:eQ,status:er}),(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[er&&(0,t.jsx)(p.Z,{size:"small",skin:"light",color:er.color,label:er.title,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}}),(0,t.jsx)(p.Z,{size:"small",skin:"light",color:"primary",label:((null==Y?void 0:Y.quemPreenche)==1?"F\xe1brica":"Fornecedor")+" preenche"}),(0,t.jsx)(p.Z,{size:"small",skin:"light",label:"Modelo ".concat(null==Y?void 0:Y.modelo)})]}),(0,t.jsxs)(h.Z,{display:"flex",flexDirection:"column",sx:{gap:6},children:[ez&&ez.length>0&&(0,t.jsxs)(v.Z,{severity:"info",sx:{mb:2},children:[(0,t.jsxs)("h1",{children:["Os seguintes campos foram copiados de ",(0,t.jsx)("strong",{children:"Meus Dados"}),":"]}),(0,t.jsx)("div",{className:"pt-2",children:ez.map(e=>(0,t.jsx)("div",{className:"flex opacity-80",children:(0,t.jsx)("p",{children:"- ".concat(e.name," (").concat(e.value,")")})}))})]}),ey&&""!=ey.cabecalhoModelo&&(0,t.jsx)(D.Z,{children:(0,t.jsx)(g.Z,{children:(0,t.jsx)("p",{children:ey.cabecalhoModelo})})}),(0,t.jsxs)(D.Z,{children:[(0,t.jsx)(_.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/fornecedor/delete/".concat(i),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eG,handleClose:()=>eW(!1)}),(0,t.jsx)(g.Z,{children:Y&&(0,t.jsx)(L,{modeloID:Y.parFornecedorModeloID,values:eu,fields:ef,disabled:!eV.status||H,register:eJ,errors:e7,setValue:eY,control:e$,getAddressByCep:oi})})]}),ee&&ee.length>0&&(0,t.jsx)(D.Z,{children:(0,t.jsx)(g.Z,{children:(0,t.jsx)(T,{values:ee,handleFileSelect:ox,handleRemove:oD,disabled:!eV.status||H,errors:null==e7?void 0:e7.produtos},eH)})}),eg&&eg.map((e,o)=>(0,t.jsx)(u.Z,{index:o,blockKey:"parFornecedorModeloBlocoID",handleFileSelect:oh,changeAllOptions:oI,setItemResposta:ov,handleRemoveAnexoItem:oj,setBlocos:ej,values:e,control:e$,register:eJ,setValue:eY,errors:null==e7?void 0:e7.blocos,disabled:!eV.status||H},en)),ea&&ea.map((e,o)=>(0,t.jsx)(f.Z,{values:{grupo:e,indexGrupo:o,handleFileSelect:of,handleRemove:og,folder:"grupo-anexo",disabled:!eV.status,error:e7}},o)),ey&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(D.Z,{children:(0,t.jsx)(g.Z,{children:(0,t.jsx)(j.ZP,{container:!0,spacing:4,children:(0,t.jsx)(j.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(I.Z,{fullWidth:!0,children:[(0,t.jsx)(b.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(x.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:ey.obs,disabled:!eV.status||H,control:e$})]})})})})})}),ep&&ep.concluded&&(0,t.jsx)(b.Z,{variant:"caption",children:"Conclu\xeddo por ".concat(null==ep?void 0:null===(a=ep.profissionalAprova)||void 0===a?void 0:a.nome," em ").concat(ep.dataFim," ").concat(ep.horaFim,".")}),ed&&(0,t.jsx)(m.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(i," do Fornecedor."),id:i,parFormularioID:1,formStatus:ey.status,hasFormPending:H,canChangeStatus:!H&&2==Y.quemPreenche&&ey.status>=40,openModal:ed,handleClose:()=>ec(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:e4}),(0,t.jsx)(A.Z,{openModal:eC,handleClose(){eF(!1),O(!1)},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:ey,canChange:!H,register:eJ,setValue:eY,getValues:eK,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:ou,listErrors:ew,canApprove:!0,type:"fornecedor",unity:Y}),(0,t.jsx)(X.Z,{parFormularioID:1,id:i})]})]})})};var K=a(60565),Y=a(72819);let $=e=>{let{values:o}=e;return console.log("\uD83D\uDE80 ~ FormFornecedorConclusion values:",o),(0,t.jsxs)(h.Z,{display:"flex",flexDirection:"column",sx:{gap:4},children:[(0,t.jsxs)(b.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"E-mail enviado para: "})," ",null==o?void 0:o.email]}),(0,t.jsxs)(b.Z,{variant:"body2",children:[(0,t.jsx)("strong",{children:"Link do formul\xe1rio: "})," ",null==o?void 0:o.link]})]})};var ee=a(431),eo=a(30944),ea=a(2941);let et=()=>{let{user:e,loggedUnity:o}=(0,n.useContext)(F.V),a=(0,l.useRouter)(),r=a.pathname,{setTitle:d}=(0,n.useContext)(K.f),{id:c,setId:u}=(0,n.useContext)(C.X),[m,p]=(0,n.useState)(!1),[x,f]=(0,n.useState)(!1),[h,v]=(0,n.useState)(null),{isNotFactory:D}=(0,ee.r7)(),{startFilter:g,setFilteredData:j,filteredData:I,setData:b}=(0,eo.L0)(),Z=()=>{p(!0)},S=async()=>{try{let a=await s.h.post("".concat(r,"/getList/"),{unidadeID:o.unidadeID,papelID:e.papelID,cnpj:e.cnpj?e.cnpj:null});j(a.data),b(a.data),d({title:"Fornecedor",subtitle:{id:c,count:a.data.length,new:!1}})}catch(t){console.log(t)}},P=async a=>{console.log("\uD83D\uDE80 ~ makeFornecedor values:",a);try{let t=await s.h.post("/formularios/fornecedor/makeFornecedor",{usuarioID:e.usuarioID,papelID:e.papelID,profissionalID:e.profissionalID,unidadeID:o.unidadeID,values:a.fields,habilitaQuemPreencheFormFornecedor:a.habilitaQuemPreencheFormFornecedor});console.log("\uD83D\uDE80 ~ response:",t),200==t.status&&(w.ZP.success(t.data.message),D?(f(!0),v(t.data.result),S()):u(t.data.fornecedorID))}catch(n){console.error(n),console.error("Erro ao enviar email",n)}},A=()=>{let e=null==h?void 0:h.link;e&&(navigator.clipboard.writeText(e),w.ZP.success("Link copiado com sucesso!"))};(0,n.useEffect)(()=>{let e=1===a.query.filter;S(),g((0,t.jsx)(ea.default,{}),e)},[c,a.query]),(0,n.useEffect)(()=>{a.query.f&&u(a.query.f)},[a.query]);let N=1==e.papelID?[{headerName:"ID",field:"id",size:.2},{headerName:"Fornecedor",field:"fornecedor",size:2},{headerName:"CNPJ",field:"cnpj",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:.7,type:"date"},{headerName:"Cidade",field:"cidade",size:1},{headerName:"Quem preenche",field:"quemPreenche",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1}]:2==e.papelID?[{headerName:"ID",field:"id",size:1},{headerName:"F\xe1brica",field:"fabrica",size:1},{headerName:"CNPJ",field:"cnpj",size:1},{headerName:"Data da Avalia\xe7\xe3o",field:"data",size:1,type:"date"},{headerName:"Cidade",field:"cidade",size:1},{headerName:"Respons\xe1vel",field:"responsavel",size:1},{headerName:"Status",field:{name:"status",cor:"cor"},size:1}]:[],z=(0,y.OL)(r,N);return(0,t.jsxs)(t.Fragment,{children:[I?c&&c>0?(0,t.jsx)(J,{id:c,makeFornecedor:P}):(0,t.jsx)(i.Z,{result:I,columns:z,openModal:1==e.papelID?Z:null,btnNew:1==e.papelID}):(0,t.jsx)(E.Z,{show:!0}),(0,t.jsx)(Y.Z,{title:"Habilitar Fornecedor",handleConclusion:P,setOpenModal:p,openModal:m,size:"lg",children:(0,t.jsx)(q.Z,{})}),(0,t.jsx)(Y.Z,{title:"Formul\xe1rio enviado ao fornecedor",description:"Um novo formul\xe1rio de qualifica\xe7\xe3o de fornecedor foi enviado",handleCopyLink:A,setOpenModal:f,openModal:x,children:(0,t.jsx)($,{values:h})})]})};var en=et}},function(e){e.O(0,[4738,8371,1515,7842,5061,9525,2418,4247,9774,2888,179],function(){return e(e.s=59424)}),_N_E=e.O()}]);