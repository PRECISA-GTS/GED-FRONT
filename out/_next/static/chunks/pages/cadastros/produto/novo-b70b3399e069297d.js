(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5757],{91359:function(e,t,o){"use strict";o.d(t,{Z:function(){return h}});var a=o(87462),r=o(63366),n=o(67294),s=o(86010),i=o(94780),l=o(67074),d=o(78884),c=o(1588),u=o(34867);function x(e){return(0,u.Z)("MuiCardContent",e)}(0,c.Z)("MuiCardContent",["root"]);var m=o(85893);let v=["className","component"],p=e=>{let{classes:t}=e;return(0,i.Z)({root:["root"]},x,t)},f=(0,l.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),Z=n.forwardRef(function(e,t){let o=(0,d.Z)({props:e,name:"MuiCardContent"}),{className:n,component:i="div"}=o,l=(0,r.Z)(o,v),c=(0,a.Z)({},o,{component:i}),u=p(c);return(0,m.jsx)(f,(0,a.Z)({as:i,className:(0,s.Z)(u.root,n),ownerState:c,ref:t},l))});var h=Z},59742:function(e,t,o){"use strict";o.d(t,{Z:function(){return C}});var a=o(63366),r=o(87462),n=o(67294),s=o(86010),i=o(94780),l=o(29630),d=o(78884),c=o(67074),u=o(1588),x=o(34867);function m(e){return(0,x.Z)("MuiCardHeader",e)}let v=(0,u.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var p=o(85893);let f=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],Z=e=>{let{classes:t}=e;return(0,i.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},m,t)},h=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,r.Z)({[`& .${v.title}`]:t.title,[`& .${v.subheader}`]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),g=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),j=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),b=(0,c.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"}),y=n.forwardRef(function(e,t){let o=(0,d.Z)({props:e,name:"MuiCardHeader"}),{action:n,avatar:i,className:c,component:u="div",disableTypography:x=!1,subheader:m,subheaderTypographyProps:v,title:y,titleTypographyProps:C}=o,w=(0,a.Z)(o,f),D=(0,r.Z)({},o,{component:u,disableTypography:x}),N=Z(D),P=y;null==P||P.type===l.Z||x||(P=(0,p.jsx)(l.Z,(0,r.Z)({variant:i?"body2":"h5",className:N.title,component:"span",display:"block"},C,{children:P})));let M=m;return null==M||M.type===l.Z||x||(M=(0,p.jsx)(l.Z,(0,r.Z)({variant:i?"body2":"body1",className:N.subheader,color:"text.secondary",component:"span",display:"block"},v,{children:M}))),(0,p.jsxs)(h,(0,r.Z)({className:(0,s.Z)(N.root,c),as:u,ref:t,ownerState:D},w,{children:[i&&(0,p.jsx)(g,{className:N.avatar,ownerState:D,children:i}),(0,p.jsxs)(b,{className:N.content,ownerState:D,children:[P,M]}),n&&(0,p.jsx)(j,{className:N.action,ownerState:D,children:n})]}))});var C=y},49837:function(e,t,o){"use strict";o.d(t,{Z:function(){return g}});var a=o(87462),r=o(63366),n=o(67294),s=o(86010),i=o(94780),l=o(67074),d=o(78884),c=o(70918),u=o(1588),x=o(34867);function m(e){return(0,x.Z)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var v=o(85893);let p=["className","raised"],f=e=>{let{classes:t}=e;return(0,i.Z)({root:["root"]},m,t)},Z=(0,l.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),h=n.forwardRef(function(e,t){let o=(0,d.Z)({props:e,name:"MuiCard"}),{className:n,raised:i=!1}=o,l=(0,r.Z)(o,p),c=(0,a.Z)({},o,{raised:i}),u=f(c);return(0,v.jsx)(Z,(0,a.Z)({className:(0,s.Z)(u.root,n),elevation:i?8:void 0,ref:t,ownerState:c},l))});var g=h},62386:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cadastros/produto/novo",function(){return o(90260)}])},69291:function(e,t,o){"use strict";o.d(t,{Z:function(){return I}});var a=o(85893),r=o(11163),n=o.n(r),s=o(67294),i=o(60565),l=o(83830),d=o(60664),c=o(49837),u=o(91359),x=o(79072),m=o(59742),v=o(54225),p=o(87536),f=o(86501),Z=o(47842),h=o(45061),g=o(86887),j=o(23197),b=o(29308),y=o(84220),C=o(67569),w=o(40039),D=o(21609),N=o(88475),P=o(44373);let M=e=>{let{getValues:t,removeAnexo:o,setValue:r,control:n,register:i,errors:l,type:c}=e,[u,x]=(0,s.useState)([]),m=async()=>{let e=await d.h.post("/cadastros/produto/getFormularios");console.log("--> ",e.data),x(e.data)};return(0,s.useEffect)(()=>{m()},[]),t("anexos")&&t("anexos").map((e,d)=>{var x,m,v,p,f,Z;return(0,a.jsxs)(s.Fragment,{children:[(0,a.jsx)(b.Z,{md:6,title:"Nome",name:"anexos[".concat(d,"].nome"),required:!0,control:n,errors:null==l?void 0:null===(x=l.anexos)||void 0===x?void 0:null===(m=x[d])||void 0===m?void 0:m.nome}),(0,a.jsx)(y.Z,{xs:12,md:3,title:"Formul\xe1rio",name:"anexos[".concat(d,"].formulario"),value:e.formulario,required:!0,options:null!=u?u:[],register:i,setValue:r,control:n,errors:null==l?void 0:null===(v=l.anexos)||void 0===v?void 0:null===(p=v[d])||void 0===p?void 0:p.formulario,helpText:"Formul\xe1rio em que ser\xe1 solicitado esse anexo para este produto"}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Obrigat\xf3rio",name:"anexos[".concat(d,"].obrigatorio"),value:1==e.obrigatorio,typePage:c,register:i}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"anexos[".concat(d,"].status"),value:1==e.obrigatorio,typePage:c,register:i}),(0,a.jsx)(N.Z,{xs:4,md:1,title:"Remover",index:d,removeItem:o,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"}),(0,a.jsx)(b.Z,{xs:11,md:12,multiline:!0,items:4,title:"Descri\xe7\xe3o (opcional)",name:"anexos[".concat(d,"].descricao"),control:n,errors:null==l?void 0:null===(f=l.anexos)||void 0===f?void 0:null===(Z=f[d])||void 0===Z?void 0:Z.descricao}),d<t("anexos").length-1&&(0,a.jsx)(P.Z,{})]},d)})};var S=o(41088);let R=e=>{var t,o,r,N;let{id:P,btnClose:R,handleConfirmNew:I,handleModalClose:_,newChange:E,manualUrl:T,outsideID:A}=e,[k,O]=(0,s.useState)(!1),[H,q]=(0,s.useState)(null),V=n(),F=P&&P>0?"edit":"new",U=V.pathname,{title:X}=(0,s.useContext)(i.f),{setId:z}=(0,s.useContext)(l.X),{loggedUnity:B,user:$}=(0,s.useContext)(w.V),[G,J]=(0,s.useState)([]),[K,L]=(0,s.useState)(!1),{startLoading:Q,stopLoading:W}=(0,S.Z)(),{trigger:Y,handleSubmit:ee,setValue:et,reset:eo,control:ea,getValues:er,formState:{errors:en},register:es}=(0,p.cI)({mode:"onChange"}),ei=async e=>{Q();let t={...e,unidadeID:B.unidadeID,usuarioID:$.usuarioID,removedItems:G};console.log(t);try{"new"===F?await d.h.post("cadastros/produto/new/insertData",t).then(e=>{I?I(e.data,"produtos"):(V.push("".concat((0,j.g_)(U))),z(e.data.id)),f.ZP.success(j.OD.successNew)}):"edit"===F&&(await d.h.post("".concat(U,"/updateData/").concat(P),t),f.ZP.success(j.OD.successUpdate))}catch(o){o.response&&409===o.response.status?f.ZP.error(j.OD.errorRepeated):console.log(o)}finally{W()}},el=async()=>{try{await d.h.delete("".concat(U,"/").concat(P,"/").concat($.usuarioID,"/").concat(B.unidadeID)),z(null),O(!1),f.ZP.success(j.OD.successDelete)}catch(e){e.response&&409===e.response.status?(f.ZP.error(j.OD.pendingDelete),O(!1)):console.log(e)}},ed=async()=>{try{let e="new"===F?"cadastros/produto/new/getData/".concat(B.unidadeID):"".concat(U,"/getData/").concat(P,"/").concat(B.unidadeID);await d.h.post(e).then(e=>{q(e.data),eo(e.data)})}catch(t){console.log(t)}},ec=(e,t)=>{e.produtoAnexoID&&J([...G,e.produtoAnexoID]);let o=er("anexos").filter((e,o)=>o!==t);et("anexos",o),L(!K)},eu=()=>{let e=[...er("anexos"),{nome:"",obrigatorio:1,status:1,descricao:"",observacao:""}];et("anexos",e),L(!K)};return(0,s.useEffect)(()=>{ed(),setTimeout(()=>{Y()},300)},[P]),(0,s.useEffect)(()=>{E&&ee(ei)()},[E]),(0,a.jsxs)(a.Fragment,{children:[!H&&(0,a.jsx)(Z.Z,{}),H&&(0,a.jsxs)("form",{onSubmit:ee(ei),className:"space-y-3",children:[(0,a.jsx)(g.Z,{btnCancel:!0,btnNew:!I,btnSave:!0,btnClose:R,manualUrl:T,handleModalClose:_,handleSubmit:()=>ee(ei),btnDelete:"edit"===F,onclickDelete:()=>O(!0),type:F,outsideID:A}),(0,a.jsx)(c.Z,{children:(0,a.jsx)(u.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(b.Z,{xs:11,md:5,title:"Nome",name:"fields.nome",required:!0,control:ea,errors:null==en?void 0:null===(t=en.fields)||void 0===t?void 0:t.nome}),(0,a.jsx)(y.Z,{xs:12,md:3,title:"Unidade de medida",name:"unidadeMedida.fields",value:null==H?void 0:H.unidadeMedida.fields,required:!0,options:H.unidadeMedida.options,register:es,setValue:et,control:ea,errors:null==en?void 0:null===(o=en.unidadeMedida)||void 0===o?void 0:o.fields,helpText:"Selecione a unidade de medida"}),(0,a.jsx)(y.Z,{xs:12,md:3,title:"Classificação",name:"classificacao.fields",value:null==H?void 0:null===(r=H.classificacao)||void 0===r?void 0:r.fields,options:H.classificacao.options,register:es,setValue:et,control:ea,errors:null==en?void 0:null===(N=en.classificacao)||void 0===N?void 0:N.fields,helpText:"Selecione a classificação"}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:H.fields.status,typePage:F,register:es})]})})}),(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(m.Z,{title:"Anexos"}),(0,a.jsx)(u.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(M,{getValues:er,removeAnexo:ec,setValue:et,control:ea,register:es,errors:en,type:F},K),(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.Z,{variant:"outlined",color:"primary",sx:{mt:1},startIcon:(0,a.jsx)(D.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){eu()},children:"Inserir Anexo"})})]})})]})]}),(0,a.jsx)(h.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+X.title,openModal:k,handleClose:()=>O(!1),handleSubmit:el,btnCancel:!0,btnConfirm:!0})]})};var I=R},47842:function(e,t,o){"use strict";var a=o(85893),r=o(70754);let n=e=>{let{show:t,title:o,customTextProps:n,...s}=e;return t&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center rounded-lg z-50",children:(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center gap-2 ",children:[(0,a.jsx)(r.Z,{color:"primary",...s}),(0,a.jsx)("p",{className:"opacity-80 text-sm ".concat(n),children:null!=o?o:"Carregando..."})]})})};t.Z=n},90260:function(e,t,o){"use strict";o.r(t);var a=o(85893),r=o(60565),n=o(67294),s=o(69291);let i=()=>{let{setTitle:e}=(0,n.useContext)(r.f);return(0,n.useEffect)(()=>{e({title:"Produto",subtitle:{id:null,count:null,new:!0}})},[]),(0,a.jsx)(s.Z,{})};i.acl={action:"read",subject:"acl-page"},t.default=i}},function(e){e.O(0,[6887,5061,9774,2888,179],function(){return e(e.s=62386)}),_N_E=e.O()}]);