(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1994],{8061:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cadastros/grupo-anexos",function(){return s(21829)}])},77993:function(e,t,s){"use strict";s.d(t,{Z:function(){return E}});var n=s(85893),a=s(11163),r=s.n(a),i=s(67294),o=s(60565),l=s(83830),d=s(40039),u=s(60664),c=s(49837),m=s(91359),x=s(79072),v=s(29630),h=s(54225),p=s(21609),f=s(87536),j=s(86501),Z=s(45061),g=s(47842),b=s(86887),D=s(23197),w=s(41088),I=s(84220),P=s(29308),y=s(67569),N=s(88475);let C=e=>{let{getValues:t,removeItem:s,control:a,register:r,errors:i,type:o}=e;return t("items")&&t("items").map((e,t)=>{var l,d,u,c;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P.Z,{xs:12,md:3,title:"Nome",name:"items[".concat(t,"].nome"),required:!0,control:a,errors:null==i?void 0:null===(l=i.items)||void 0===l?void 0:null===(d=l[t])||void 0===d?void 0:d.nome}),(0,n.jsx)(P.Z,{xs:12,md:6,title:"Descri\xe7\xe3o",name:"items[".concat(t,"].descricao"),required:!1,control:a,errors:null==i?void 0:null===(u=i.items)||void 0===u?void 0:null===(c=u[t])||void 0===c?void 0:c.descricao}),(0,n.jsx)(y.Z,{xs:4,md:1,title:"Ativo",index:t,name:"items[".concat(t,"].status"),value:e.status,typePage:o,register:r}),(0,n.jsx)(y.Z,{xs:4,md:1,title:"Obrigat\xf3rio",index:t,name:"items[".concat(t,"].obrigatorio"),value:e.obrigatorio,typePage:o,register:r}),(0,n.jsx)(N.Z,{xs:4,md:1,title:"Remover",index:t,removeItem:s,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"})]})})},S=e=>{var t,s,a,N;let{id:S,btnClose:E,handleConfirmNew:_,handleModalClose:q,newChange:O,manualUrl:F,outsideID:k}=e,{setId:V}=(0,i.useContext)(l.X),z=r(),[L,T]=(0,i.useState)(null),[A,R]=(0,i.useState)(!1),X=S&&S>0?"edit":"new",M=z.pathname,{title:Q}=(0,i.useContext)(o.f),{loggedUnity:U,user:W}=(0,i.useContext)(d.V),[B,G]=(0,i.useState)(!1),[H,J]=(0,i.useState)([]),[K,Y]=(0,i.useState)(!1),{startLoading:$,stopLoading:ee}=(0,w.Z)(),{trigger:et,handleSubmit:es,setValue:en,reset:ea,getValues:er,control:ei,formState:{errors:eo},register:el}=(0,f.cI)(),ed=async()=>{try{let e="new"===X?"cadastros/grupo-anexos/new/getData":"".concat(M,"/getData/").concat(S);await u.h.post(e,{unidadeID:U.unidadeID}).then(e=>{T(e.data),ea(e.data)})}catch(t){console.log(t)}},eu=()=>{let e=[...er("items"),{nome:"",descricao:"",status:!0,obrigatorio:!0}];en("items",e),Y(!K)},ec=(e,t)=>{if(1===L.items.length){j.ZP.error("\xc9 necess\xe1rio ter pelo menos um item!");return}e.id&&J([...H,e.id]);let s=er("items").filter((e,s)=>s!==t);en("items",s),Y(!K)},em=async e=>{let t={...e,usuarioID:W.usuarioID,unidadeID:U.unidadeID};$(),t.removedItems=H,t.unidade=U.unidadeID;try{"new"===X?await u.h.post("cadastros/grupo-anexos/new/insertData",t).then(e=>{_?_(e.data,"gruposAnexo"):(z.push("".concat((0,D.g_)(M))),V(e.data.id)),j.ZP.success(D.OD.successNew)}):"edit"===X&&(await u.h.post("".concat(M,"/updateData/").concat(S),t),j.ZP.success(D.OD.successUpdate)),G(!B)}catch(s){s.response&&409===s.response.status?j.ZP.error(D.OD.errorRepeated):console.log(s)}finally{ee()}},ex=async()=>{try{await u.h.delete("".concat(M,"/deleteData/").concat(S,"/").concat(W.usuarioID,"/").concat(U.unidadeID)),V(null),setOpen(!1),j.ZP.success(D.OD.successDelete),console.log("entrou")}catch(e){e.response&&409===e.response.status?(j.ZP.error(D.OD.pendingDelete),R(!1)):console.log(e)}};return(0,i.useEffect)(()=>{ed(),"new"===X&&setTimeout(()=>{et()},300)},[S]),(0,i.useEffect)(()=>{O&&es(em)()},[O]),(0,n.jsxs)(n.Fragment,{children:[!L&&(0,n.jsx)(g.Z,{}),L&&(0,n.jsxs)("form",{onSubmit:es(em),children:[(0,n.jsx)(b.Z,{btnCancel:!0,btnNew:!_,btnSave:!0,manualUrl:F,btnClose:E,handleModalClose:q,handleSubmit:()=>es(em),btnDelete:"edit"===X,onclickDelete:()=>R(!0),type:X,outsideID:k}),(0,n.jsx)(c.Z,{children:L&&(0,n.jsx)(m.Z,{children:(0,n.jsxs)(x.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(P.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:ei,errors:null==eo?void 0:null===(t=eo.fields)||void 0===t?void 0:t.nome}),(0,n.jsx)(y.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:L.fields.status,typePage:X,register:el}),(0,n.jsx)(P.Z,{xs:12,md:12,title:"Descri\xe7\xe3o",name:"fields.descricao",required:!1,control:ei,errors:null==eo?void 0:null===(s=eo.fields)||void 0===s?void 0:s.descricao}),(0,n.jsx)(I.Z,{xs:12,md:12,title:"Formul\xe1rios",name:"formulario.fields",value:null!==(N=null==L?void 0:L.formulario.fields)&&void 0!==N?N:null,multiple:!0,limitTags:5,required:!0,options:L.formulario.options,register:el,setValue:en,control:ei,errors:null==eo?void 0:null===(a=eo.formulario)||void 0===a?void 0:a.fields})]})})}),(0,n.jsx)(c.Z,{sx:{mt:4},children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(v.Z,{sx:{mb:5},children:"Itens"}),(0,n.jsx)(x.ZP,{container:!0,spacing:3,children:(0,n.jsx)(C,{getValues:er,removeItem:ec,control:ei,register:el,errors:eo,type:X},K)}),(0,n.jsx)(h.Z,{variant:"outlined",color:"primary",sx:{mt:4},startIcon:(0,n.jsx)(p.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){eu()},children:"Inserir item"})]})})]}),(0,n.jsx)(Z.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+Q.title,openModal:A,handleClose:()=>R(!1),handleSubmit:ex,btnCancel:!0,btnConfirm:!0})]})};var E=S},93250:function(e,t,s){"use strict";var n=s(85893),a=s(49837),r=s(91359),i=s(69175);let o=e=>{let{result:t,columns:s,btnNew:o=!0,btnPrint:l=!0,btnBack:d,openModal:u,modalLog:c}=e;return(0,n.jsx)(a.Z,{children:(0,n.jsx)(r.Z,{sx:{pt:"0"},children:(0,n.jsx)(i.Z,{rows:t,columns:s,modalLog:c,buttonsHeader:{btnNew:o,btnPrint:l,btnBack:d,openModal:u}})})})};t.Z=o},46905:function(e,t,s){"use strict";var n=s(85893),a=s(87536),r=s(79072),i=s(55343),o=s(67836);let l=e=>{let{xs:t,md:s,title:l,name:d,disabled:u,required:c,form:m,onChange:x}=e;return(0,n.jsx)(r.ZP,{item:!0,xs:t,md:s,children:(0,n.jsx)("div",{children:(0,n.jsx)(i.Z,{fullWidth:!0,children:(0,n.jsx)(a.Qr,{name:d,control:m.control,rules:{required:c},render(e){let{field:t}=e;return(0,n.jsx)(o.Z,{label:l,value:null==t?void 0:t.value,placeholder:l,type:"date",size:"small","aria-describedby":"validation-schema-nome",disabled:u,error:!!m.formState.errors[d],onChange(e){let s=e.target.value;t.onChange(s),x&&x(s)},InputLabelProps:{shrink:!0},inputProps:{min:"1900-01-01",max:"2100-01-01"}})}})})})})};t.Z=l},55148:function(e,t,s){"use strict";var n=s(85893),a=s(79072),r=s(55343),i=s(35966),o=s(67836),l=s(87536),d=s(53934),u=s(30944);let c=e=>{let{xs:t,md:s,title:c,options:m,form:x,name:v,limitTags:h,value:p,required:f,disabled:j,multiple:Z,onChange:g,className:b,keyProps:D,createNew:w,helpText:I,helpTextPosition:P}=e,y=w?[{id:null,name:"-- Novo --"},...null!=m?m:[]]:m,{key:N}=(0,u.L0)();return(0,n.jsx)(a.ZP,{item:!0,xs:t,md:s,sx:{my:1},className:b,children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(r.Z,{fullWidth:!0,children:(0,n.jsx)(l.Qr,{name:v,control:x.control,rules:{required:f},render(e){var t;let{field:s}=e;return(0,n.jsx)(i.Z,{options:y.map(e=>e.name),value:null!=p?p:null===(t=x.getValues(v))||void 0===t?void 0:t.name,onChange(e,t){let s=y.find(e=>e.name===t);x.setValue(v,null!=s?s:null),g&&g(t)},renderInput(e){var t;return(0,n.jsx)(o.Z,{...e,id:"customSelect",size:"small",label:c,placeholder:c,error:!!x.formState.errors[v],helperText:null===(t=x.formState.errors[v])||void 0===t?void 0:t.message})}},D||N)}})}),I&&(0,n.jsx)("div",{className:"absolute right-[60px] top-[12px] ",children:(0,n.jsx)(d.Z,{text:I,position:null!=P?P:"top"})})]})})};t.Z=c},2945:function(e,t,s){"use strict";s.r(t);var n=s(85893),a=s(67294),r=s(46905),i=s(55148),o=s(51570),l=s(30944);let d=()=>{var e,t;let{form:s,setNames:d,filterDate:u,SelectFilterByName:c,data:m,setFilteredData:x,handleSearch:v,key:h,searchText:p}=(0,l.L0)(),{commonData:f}=(0,o.Lq)(),j=m,Z=async()=>{x(j=await v(j))};return(0,a.useEffect)(()=>{Z()},[h]),(0,a.useEffect)(()=>{d([])},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Z,{xs:12,md:6,title:"Data inicio da avaliac\xe3o",name:"dataInicio",form:s}),(0,n.jsx)(r.Z,{xs:12,md:6,title:"Data Fim da avalia\xe7\xe3o",name:"dataFim",form:s}),(0,n.jsx)(i.Z,{xs:12,md:6,title:"Quem preencheu",name:"quemPreenche",value:null===(e=s.getValues("quemPreenche"))||void 0===e?void 0:e.name,form:s,options:[{id:"1",name:"F\xe1brica"},{id:"2",name:"Fornecedor"}]}),(0,n.jsx)(i.Z,{xs:12,md:6,title:"Status",name:"status",form:s,options:f.status,value:null===(t=s.getValues("status"))||void 0===t?void 0:t.name})]})};t.default=d},21829:function(e,t,s){"use strict";s.r(t);var n=s(85893),a=s(67294),r=s(60664),i=s(93250),o=s(60565),l=s(40039),d=s(83830),u=s(77993),c=s(47842),m=s(11163),x=s(23197),v=s(30944),h=s(2945);let p=()=>{let e=(0,m.useRouter)(),t=e.pathname,{loggedUnity:s}=(0,a.useContext)(l.V),{setTitle:p}=(0,a.useContext)(o.f),{id:f}=(0,a.useContext)(d.X),{filteredData:j,setFilteredData:Z,setData:g,startFilter:b}=(0,v.L0)(),D=async()=>{await r.h.post(t,{unidadeID:s.unidadeID}).then(e=>{Z(e.data),g(e.data),p({title:"Grupo de Anexos",subtitle:{id:f,count:e.data.length,new:!1}})})};(0,a.useEffect)(()=>{D(),b((0,n.jsx)(h.default,{}))},[f]);let w=(0,x.OL)(t,[{headerName:"ID",field:"id",size:.1},{headerName:"Nome",field:"nome",size:.6},{headerName:"Descri\xe7\xe3o",field:"descricao",size:.6},{headerName:"Status",field:{name:"status",cor:"cor"},size:.1}]);return(0,n.jsx)(n.Fragment,{children:j?f&&f>0?(0,n.jsx)(u.Z,{id:f}):(0,n.jsx)(i.Z,{result:j,columns:w}):(0,n.jsx)(c.Z,{})})};p.acl={action:"read",subject:"acl-page"},t.default=p}},function(e){e.O(0,[4186,1445,1111,5999,4738,2187,8371,6009,6887,5061,9175,9774,2888,179],function(){return e(e.s=8061)}),_N_E=e.O()}]);