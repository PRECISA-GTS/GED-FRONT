(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9326],{91359:function(e,i,s){"use strict";s.d(i,{Z:function(){return h}});var t=s(87462),o=s(63366),n=s(67294),a=s(86010),r=s(94780),l=s(67074),d=s(78884),c=s(1588),u=s(34867);function f(e){return(0,u.Z)("MuiCardContent",e)}(0,c.Z)("MuiCardContent",["root"]);var m=s(85893);let v=["className","component"],p=e=>{let{classes:i}=e;return(0,r.Z)({root:["root"]},f,i)},x=(0,l.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,i)=>i.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),Z=n.forwardRef(function(e,i){let s=(0,d.Z)({props:e,name:"MuiCardContent"}),{className:n,component:r="div"}=s,l=(0,o.Z)(s,v),c=(0,t.Z)({},s,{component:r}),u=p(c);return(0,m.jsx)(x,(0,t.Z)({as:r,className:(0,a.Z)(u.root,n),ownerState:c,ref:i},l))});var h=Z},49837:function(e,i,s){"use strict";s.d(i,{Z:function(){return D}});var t=s(87462),o=s(63366),n=s(67294),a=s(86010),r=s(94780),l=s(67074),d=s(78884),c=s(70918),u=s(1588),f=s(34867);function m(e){return(0,f.Z)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var v=s(85893);let p=["className","raised"],x=e=>{let{classes:i}=e;return(0,r.Z)({root:["root"]},m,i)},Z=(0,l.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,i)=>i.root})(()=>({overflow:"hidden"})),h=n.forwardRef(function(e,i){let s=(0,d.Z)({props:e,name:"MuiCard"}),{className:n,raised:r=!1}=s,l=(0,o.Z)(s,p),c=(0,t.Z)({},s,{raised:r}),u=x(c);return(0,v.jsx)(Z,(0,t.Z)({className:(0,a.Z)(u.root,n),elevation:r?8:void 0,ref:i,ownerState:c},l))});var D=h},244:function(e,i,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cadastros/setor/novo",function(){return s(29471)}])},29274:function(e,i,s){"use strict";var t=s(85893),o=s(11163),n=s.n(o),a=s(67294),r=s(60664),l=s(49837),d=s(91359),c=s(79072),u=s(80562),f=s(54225),m=s(87536),v=s(86501),p=s(45061),x=s(92477),Z=s(71798),h=s(60565),D=s(83830),j=s(40039),g=s(29308),C=s(50287),I=s(41088),w=s(21609),N=s(67569),y=s(84220);let P=e=>{var i,s,o;let{id:P}=e,[b,S]=(0,a.useState)(!1),[_,F]=(0,a.useState)(null),{setId:O}=(0,a.useContext)(D.X),M=n(),E=P&&P>0?"edit":"new",k=M.pathname,{title:R}=(0,a.useContext)(h.f),{loggedUnity:q,user:T,setUser:X}=(0,a.useContext)(j.V),{startLoading:z,stopLoading:J}=(0,I.Z)(),[V,A]=(0,a.useState)([]),B=new Date().toISOString().substring(0,10),{trigger:U,handleSubmit:G,reset:H,setValue:K,control:L,formState:{errors:Q},register:W}=(0,m.cI)({mode:"onChange"}),Y=e=>{let i=!!e.fields.profissionais.find(e=>e.profissional.id===T.profissionalID&&(!e.dataFim||""==e.dataFim||null==e.dataFim||"0000-00-00"==e.dataFim)),s=!!T.setores.find(e=>e.id===P);i&&!s?(X({...T,setores:[...T.setores,{id:e.fields.setorID,nome:e.fields.nome}]}),localStorage.setItem("userData",JSON.stringify({...T,setores:[...T.setores,{id:e.fields.setorID,nome:e.fields.nome}]}))):!i&&s&&(X({...T,setores:T.setores.filter(e=>e.id!==P)}),localStorage.setItem("userData",JSON.stringify({...T,setores:T.setores.filter(e=>e.id!==P)})))},$=async e=>{let i={...e,usuarioID:T.usuarioID,unidadeID:q.unidadeID};if(!ee(e)){v.ZP.error("N\xe3o \xe9 permitido repetir profissional ativo em um setor!");return}Y(i);try{"new"===E?await r.h.post("cadastros/setor/new/insertData",i).then(e=>{M.push("".concat((0,Z.g_)(k))),O(e.data.id),v.ZP.success(Z.OD.successNew)}):"edit"===E&&(await r.h.post("".concat(k,"/updateData/").concat(P),i),v.ZP.success(Z.OD.successUpdate))}catch(s){s.response&&409===s.response.status?v.ZP.error(Z.OD.errorRepeated):console.log(s)}finally{J()}},ee=e=>{let i=!0;return e.fields.profissionais.length>1&&e.fields.profissionais.map((s,t)=>{e.fields.profissionais.map((e,o)=>{t===o||s.profissional.id!==e.profissional.id||s.dataFim||e.dataFim||(i=!1)})}),i},ei=async()=>{try{await r.h.delete("".concat(k,"/").concat(P,"/").concat(T.usuarioID,"/").concat(q.unidadeID)),O(null),S(!1),v.ZP.success(Z.OD.successDelete)}catch(e){e.response&&409===e.response.status?(v.ZP.error(Z.OD.pendingDelete),S(!1)):console.log(e)}},es=async()=>{try{if("edit"===E){let e=await r.h.post("".concat(k,"/getData/").concat(P),{id:P});F(e.data),H(e.data)}else F({fields:{nome:"",status:1,profissionais:[]}}),H({..._,fields:{..._.fields}})}catch(i){console.log(i)}},et=async()=>{let e=await r.h.get("/cadastros/profissional?unidadeID=".concat(q.unidadeID,"&papelID=").concat(q.papelID)),i=e.data.filter(e=>1===e.statusID);A(i)};(0,a.useEffect)(()=>{es(),et(),setTimeout(()=>{U()},300)},[P]);let{fields:eo,append:en,remove:ea}=(0,m.Dq)({control:L,name:"fields.profissionais"});return(0,t.jsxs)(t.Fragment,{children:[_&&(0,t.jsxs)("form",{onSubmit:G($),children:[(0,t.jsx)(x.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,handleSubmit:()=>G($),btnDelete:"edit"===E,onclickDelete:()=>S(!0),type:E}),(0,t.jsx)(l.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(g.Z,{xs:12,md:11,title:"Nome",name:"fields.nome",required:!0,control:L,errors:null==Q?void 0:null===(i=Q.fields)||void 0===i?void 0:i.nome}),(0,t.jsx)(N.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==_?void 0:null===(s=_.fields)||void 0===s?void 0:s.status,typePage:E,register:W}),(0,t.jsx)(c.ZP,{item:!0,xs:12,children:(0,t.jsxs)("div",{className:"flex items-center gap-2 pb-1 pt-2",children:[(0,t.jsx)("div",{className:"",children:(0,t.jsx)(w.Z,{icon:"material-symbols:engineering-outline",className:"text-3xl"})}),(0,t.jsx)("div",{className:"flex flex-col gap-0",children:(0,t.jsx)("p",{className:"text-xl",children:"Profissionais"})})]})}),eo.map((e,i)=>{var s,n,r,l,d,f,m,v,p,x,Z,h,D,j,g;return(0,t.jsxs)(a.Fragment,{children:[(0,t.jsx)("input",{type:"hidden",name:"fields.profissionais[".concat(i,"].id"),value:e.id}),(0,t.jsx)(y.Z,{xs:12,md:7,title:"Profissional",name:"fields.profissionais[".concat(i,"].profissional"),value:null==_?void 0:null===(s=_.fields)||void 0===s?void 0:null===(n=s.profissionais)||void 0===n?void 0:null===(r=n[i])||void 0===r?void 0:r.profissional,required:!0,options:null!=V?V:[],register:W,setValue:K,control:L,errors:null==Q?void 0:null===(l=Q.fields)||void 0===l?void 0:null===(d=l.profissionais)||void 0===d?void 0:null===(f=d[i])||void 0===f?void 0:f.profissional,opacity:0===e.status}),(0,t.jsx)(C.Z,{xs:12,md:2,title:"Data In\xedcio",name:"fields.profissionais[".concat(i,"].dataInicio"),value:null!==(o=null==_?void 0:null===(m=_.fields)||void 0===m?void 0:null===(v=m.profissionais)||void 0===v?void 0:null===(p=v[i])||void 0===p?void 0:p.dataInicio)&&void 0!==o?o:B,required:!0,register:W,control:L,errors:null==Q?void 0:null===(x=Q.fields)||void 0===x?void 0:null===(Z=x.profissionais)||void 0===Z?void 0:null===(h=Z[i])||void 0===h?void 0:h.dataInicio,opacity:0===e.status}),(0,t.jsx)(C.Z,{xs:12,md:2,title:"Data Fim",name:"fields.profissionais[".concat(i,"].dataFim"),value:null==_?void 0:null===(D=_.fields)||void 0===D?void 0:null===(j=D.profissionais)||void 0===j?void 0:null===(g=j[i])||void 0===g?void 0:g.dataFim,register:W,control:L,opacity:0===e.status}),(0,t.jsx)(c.ZP,{item:!0,xs:12,md:1,className:"flex items-center",children:(0,t.jsx)(u.Z,{color:"error",size:"small",onClick:()=>ea(i),children:(0,t.jsx)(w.Z,{icon:"tabler:trash-filled"})})})]},e.id)}),(0,t.jsx)(c.ZP,{item:!0,xs:12,children:(0,t.jsx)(f.Z,{variant:"outlined",color:"primary",onClick(){en({id:null,dataInicio:new Date}),U()},startIcon:(0,t.jsx)(w.Z,{icon:"material-symbols:add-circle-outline-rounded"}),children:"Inserir Profissional"})})]})})})]}),(0,t.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+R.title,openModal:b,handleClose:()=>S(!1),handleSubmit:ei,btnCancel:!0,btnConfirm:!0})]})};i.Z=P},29471:function(e,i,s){"use strict";s.r(i);var t=s(85893),o=s(60565),n=s(67294),a=s(29274);let r=()=>{let{setTitle:e}=(0,n.useContext)(o.f);return(0,n.useEffect)(()=>{e({title:"Setor",subtitle:{id:null,count:null,new:!0}})},[]),(0,t.jsx)(a.Z,{})};i.default=r}},function(e){e.O(0,[2477,8934,9774,2888,179],function(){return e(e.s=244)}),_N_E=e.O()}]);