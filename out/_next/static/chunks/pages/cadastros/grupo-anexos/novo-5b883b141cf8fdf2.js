(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1673],{91359:function(e,t,o){"use strict";o.d(t,{Z:function(){return g}});var r=o(87462),s=o(63366),n=o(67294),i=o(86010),a=o(94780),l=o(67074),u=o(78884),d=o(1588),c=o(34867);function m(e){return(0,c.Z)("MuiCardContent",e)}(0,d.Z)("MuiCardContent",["root"]);var x=o(85893);let v=["className","component"],f=e=>{let{classes:t}=e;return(0,a.Z)({root:["root"]},m,t)},Z=(0,l.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),p=n.forwardRef(function(e,t){let o=(0,u.Z)({props:e,name:"MuiCardContent"}),{className:n,component:a="div"}=o,l=(0,s.Z)(o,v),d=(0,r.Z)({},o,{component:a}),c=f(d);return(0,x.jsx)(Z,(0,r.Z)({as:a,className:(0,i.Z)(c.root,n),ownerState:d,ref:t},l))});var g=p},49837:function(e,t,o){"use strict";o.d(t,{Z:function(){return h}});var r=o(87462),s=o(63366),n=o(67294),i=o(86010),a=o(94780),l=o(67074),u=o(78884),d=o(70918),c=o(1588),m=o(34867);function x(e){return(0,m.Z)("MuiCard",e)}(0,c.Z)("MuiCard",["root"]);var v=o(85893);let f=["className","raised"],Z=e=>{let{classes:t}=e;return(0,a.Z)({root:["root"]},x,t)},p=(0,l.ZP)(d.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),g=n.forwardRef(function(e,t){let o=(0,u.Z)({props:e,name:"MuiCard"}),{className:n,raised:a=!1}=o,l=(0,s.Z)(o,f),d=(0,r.Z)({},o,{raised:a}),c=Z(d);return(0,v.jsx)(p,(0,r.Z)({className:(0,i.Z)(c.root,n),elevation:a?8:void 0,ref:t,ownerState:d},l))});var h=g},87830:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cadastros/grupo-anexos/novo",function(){return o(61888)}])},77993:function(e,t,o){"use strict";o.d(t,{Z:function(){return _}});var r=o(85893),s=o(11163),n=o.n(s),i=o(67294),a=o(60565),l=o(83830),u=o(40039),d=o(60664),c=o(49837),m=o(91359),x=o(79072),v=o(29630),f=o(54225),Z=o(21609),p=o(87536),g=o(86501),h=o(45061),j=o(47842),D=o(86887),C=o(23197),w=o(41088),b=o(84220),I=o(29308),P=o(67569),y=o(88475);let N=e=>{let{getValues:t,removeItem:o,control:s,register:n,errors:i,type:a}=e;return t("items")&&t("items").map((e,t)=>{var l,u,d,c;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.Z,{xs:12,md:3,title:"Nome",name:"items[".concat(t,"].nome"),required:!0,control:s,errors:null==i?void 0:null===(l=i.items)||void 0===l?void 0:null===(u=l[t])||void 0===u?void 0:u.nome}),(0,r.jsx)(I.Z,{xs:12,md:6,title:"Descri\xe7\xe3o",name:"items[".concat(t,"].descricao"),required:!1,control:s,errors:null==i?void 0:null===(d=i.items)||void 0===d?void 0:null===(c=d[t])||void 0===c?void 0:c.descricao}),(0,r.jsx)(P.Z,{xs:4,md:1,title:"Ativo",index:t,name:"items[".concat(t,"].status"),value:e.status,typePage:a,register:n}),(0,r.jsx)(P.Z,{xs:4,md:1,title:"Obrigat\xf3rio",index:t,name:"items[".concat(t,"].obrigatorio"),value:e.obrigatorio,typePage:a,register:n}),(0,r.jsx)(y.Z,{xs:4,md:1,title:"Remover",index:t,removeItem:o,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"})]})})},S=e=>{var t,o,s,y;let{id:S,btnClose:_,handleConfirmNew:E,handleModalClose:M,newChange:O,manualUrl:R,outsideID:k}=e,{setId:q}=(0,i.useContext)(l.X),T=n(),[A,F]=(0,i.useState)(null),[V,X]=(0,i.useState)(!1),U=S&&S>0?"edit":"new",z=T.pathname,{title:B}=(0,i.useContext)(a.f),{loggedUnity:G,user:H}=(0,i.useContext)(u.V),[J,K]=(0,i.useState)(!1),[L,Q]=(0,i.useState)([]),[W,Y]=(0,i.useState)(!1),{startLoading:$,stopLoading:ee}=(0,w.Z)(),{trigger:et,handleSubmit:eo,setValue:er,reset:es,getValues:en,control:ei,formState:{errors:ea},register:el}=(0,p.cI)(),eu=async()=>{try{let e="new"===U?"cadastros/grupo-anexos/new/getData":"".concat(z,"/getData/").concat(S);await d.h.post(e,{unidadeID:G.unidadeID}).then(e=>{F(e.data),es(e.data)})}catch(t){console.log(t)}},ed=()=>{let e=[...en("items"),{nome:"",descricao:"",status:!0,obrigatorio:!0}];er("items",e),Y(!W)},ec=(e,t)=>{if(1===A.items.length){g.ZP.error("\xc9 necess\xe1rio ter pelo menos um item!");return}e.id&&Q([...L,e.id]);let o=en("items").filter((e,o)=>o!==t);er("items",o),Y(!W)},em=async e=>{let t={...e,usuarioID:H.usuarioID,unidadeID:G.unidadeID};$(),t.removedItems=L,t.unidade=G.unidadeID;try{"new"===U?await d.h.post("cadastros/grupo-anexos/new/insertData",t).then(e=>{E?E(e.data,"gruposAnexo"):(T.push("".concat((0,C.g_)(z))),q(e.data.id)),g.ZP.success(C.OD.successNew)}):"edit"===U&&(await d.h.post("".concat(z,"/updateData/").concat(S),t),g.ZP.success(C.OD.successUpdate)),K(!J)}catch(o){o.response&&409===o.response.status?g.ZP.error(C.OD.errorRepeated):console.log(o)}finally{ee()}},ex=async()=>{try{await d.h.delete("".concat(z,"/deleteData/").concat(S,"/").concat(H.usuarioID,"/").concat(G.unidadeID)),q(null),setOpen(!1),g.ZP.success(C.OD.successDelete),console.log("entrou")}catch(e){e.response&&409===e.response.status?(g.ZP.error(C.OD.pendingDelete),X(!1)):console.log(e)}};return(0,i.useEffect)(()=>{eu(),"new"===U&&setTimeout(()=>{et()},300)},[S]),(0,i.useEffect)(()=>{O&&eo(em)()},[O]),(0,r.jsxs)(r.Fragment,{children:[!A&&(0,r.jsx)(j.Z,{}),A&&(0,r.jsxs)("form",{onSubmit:eo(em),children:[(0,r.jsx)(D.Z,{btnCancel:!0,btnNew:!E,btnSave:!0,manualUrl:R,btnClose:_,handleModalClose:M,handleSubmit:()=>eo(em),btnDelete:"edit"===U,onclickDelete:()=>X(!0),type:U,outsideID:k}),(0,r.jsx)(c.Z,{children:A&&(0,r.jsx)(m.Z,{children:(0,r.jsxs)(x.ZP,{container:!0,spacing:4,children:[(0,r.jsx)(I.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:ei,errors:null==ea?void 0:null===(t=ea.fields)||void 0===t?void 0:t.nome}),(0,r.jsx)(P.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:A.fields.status,typePage:U,register:el}),(0,r.jsx)(I.Z,{xs:12,md:12,title:"Descri\xe7\xe3o",name:"fields.descricao",required:!1,control:ei,errors:null==ea?void 0:null===(o=ea.fields)||void 0===o?void 0:o.descricao}),(0,r.jsx)(b.Z,{xs:12,md:12,title:"Formul\xe1rios",name:"formulario.fields",value:null!==(y=null==A?void 0:A.formulario.fields)&&void 0!==y?y:null,multiple:!0,limitTags:5,required:!0,options:A.formulario.options,register:el,setValue:er,control:ei,errors:null==ea?void 0:null===(s=ea.formulario)||void 0===s?void 0:s.fields})]})})}),(0,r.jsx)(c.Z,{sx:{mt:4},children:(0,r.jsxs)(m.Z,{children:[(0,r.jsx)(v.Z,{sx:{mb:5},children:"Itens"}),(0,r.jsx)(x.ZP,{container:!0,spacing:3,children:(0,r.jsx)(N,{getValues:en,removeItem:ec,control:ei,register:el,errors:ea,type:U},W)}),(0,r.jsx)(f.Z,{variant:"outlined",color:"primary",sx:{mt:4},startIcon:(0,r.jsx)(Z.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ed()},children:"Inserir item"})]})})]}),(0,r.jsx)(h.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+B.title,openModal:V,handleClose:()=>X(!1),handleSubmit:ex,btnCancel:!0,btnConfirm:!0})]})};var _=S},61888:function(e,t,o){"use strict";o.r(t);var r=o(85893),s=o(60565),n=o(67294),i=o(77993);let a=()=>{let{setTitle:e}=(0,n.useContext)(s.f);return(0,n.useEffect)(()=>{e({title:"Grupo de Anexos",subtitle:{id:null,count:null,new:!0}})},[]),(0,r.jsx)(i.Z,{})};a.acl={action:"read",subject:"acl-page"},t.default=a}},function(e){e.O(0,[4186,1445,1111,5999,2187,7105,6887,5061,9774,2888,179],function(){return e(e.s=87830)}),_N_E=e.O()}]);