(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1673],{91359:function(e,t,o){"use strict";o.d(t,{Z:function(){return g}});var s=o(87462),r=o(63366),n=o(67294),i=o(86010),a=o(94780),l=o(67074),c=o(78884),d=o(1588),u=o(34867);function m(e){return(0,u.Z)("MuiCardContent",e)}(0,d.Z)("MuiCardContent",["root"]);var x=o(85893);let f=["className","component"],v=e=>{let{classes:t}=e;return(0,a.Z)({root:["root"]},m,t)},p=(0,l.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),Z=n.forwardRef(function(e,t){let o=(0,c.Z)({props:e,name:"MuiCardContent"}),{className:n,component:a="div"}=o,l=(0,r.Z)(o,f),d=(0,s.Z)({},o,{component:a}),u=v(d);return(0,x.jsx)(p,(0,s.Z)({as:a,className:(0,i.Z)(u.root,n),ownerState:d,ref:t},l))});var g=Z},49837:function(e,t,o){"use strict";o.d(t,{Z:function(){return h}});var s=o(87462),r=o(63366),n=o(67294),i=o(86010),a=o(94780),l=o(67074),c=o(78884),d=o(70918),u=o(1588),m=o(34867);function x(e){return(0,m.Z)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var f=o(85893);let v=["className","raised"],p=e=>{let{classes:t}=e;return(0,a.Z)({root:["root"]},x,t)},Z=(0,l.ZP)(d.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),g=n.forwardRef(function(e,t){let o=(0,c.Z)({props:e,name:"MuiCard"}),{className:n,raised:a=!1}=o,l=(0,r.Z)(o,v),d=(0,s.Z)({},o,{raised:a}),u=p(d);return(0,f.jsx)(Z,(0,s.Z)({className:(0,i.Z)(u.root,n),elevation:a?8:void 0,ref:t,ownerState:d},l))});var h=g},87830:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cadastros/grupo-anexos/novo",function(){return o(61888)}])},77993:function(e,t,o){"use strict";o.d(t,{Z:function(){return _}});var s=o(85893),r=o(11163),n=o.n(r),i=o(67294),a=o(60565),l=o(83830),c=o(40039),d=o(60664),u=o(49837),m=o(91359),x=o(79072),f=o(29630),v=o(54225),p=o(21609),Z=o(87536),g=o(86501),h=o(45061),j=o(47842),C=o(86887),D=o(64165),w=o(41088),b=o(84220),y=o(29308),I=o(67569),N=o(88475);let P=e=>{let{getValues:t,removeItem:o,control:r,register:n,errors:i,type:a}=e;return t("items")&&t("items").map((e,t)=>{var l,c,d,u;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Z,{xs:12,md:3,title:"Nome",name:"items[".concat(t,"].nome"),required:!0,control:r,errors:null==i?void 0:null===(l=i.items)||void 0===l?void 0:null===(c=l[t])||void 0===c?void 0:c.nome}),(0,s.jsx)(y.Z,{xs:12,md:6,title:"Descri\xe7\xe3o",name:"items[".concat(t,"].descricao"),required:!1,control:r,errors:null==i?void 0:null===(d=i.items)||void 0===d?void 0:null===(u=d[t])||void 0===u?void 0:u.descricao}),(0,s.jsx)(I.Z,{xs:4,md:1,title:"Ativo",index:t,name:"items[".concat(t,"].status"),value:e.status,typePage:a,register:n}),(0,s.jsx)(I.Z,{xs:4,md:1,title:"Obrigat\xf3rio",index:t,name:"items[".concat(t,"].obrigatorio"),value:e.obrigatorio,typePage:a,register:n}),(0,s.jsx)(N.Z,{xs:4,md:1,title:"Remover",index:t,removeItem:o,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"})]})})},S=e=>{var t,o,r,N;let{id:S,btnClose:_,handleConfirmNew:E,handleModalClose:M,newChange:O,manualUrl:R,outsideID:k}=e,{setId:q}=(0,i.useContext)(l.X),T=n(),[A,F]=(0,i.useState)(null),[V,X]=(0,i.useState)(!1),z=S&&S>0?"edit":"new",U=T.pathname,{title:B}=(0,i.useContext)(a.f),{loggedUnity:G,user:H}=(0,i.useContext)(c.V),[J,K]=(0,i.useState)(!1),[L,Q]=(0,i.useState)([]),[W,Y]=(0,i.useState)(!1),{startLoading:$,stopLoading:ee}=(0,w.Z)(),{trigger:et,handleSubmit:eo,setValue:es,reset:er,getValues:en,control:ei,formState:{errors:ea},register:el}=(0,Z.cI)({mode:"onChange"}),ec=async()=>{try{let e="new"===z?"cadastros/grupo-anexos/new/getData":"".concat(U,"/getData/").concat(S);await d.hi.post(e,{unidadeID:G.unidadeID}).then(e=>{F(e.data),er(e.data)})}catch(t){console.log(t)}},ed=()=>{let e=[...en("items"),{nome:"",descricao:"",status:!0,obrigatorio:!0}];es("items",e),Y(!W)},eu=(e,t)=>{if(1===A.items.length){g.ZP.error("\xc9 necess\xe1rio ter pelo menos um item!");return}e.id&&Q([...L,e.id]);let o=en("items").filter((e,o)=>o!==t);es("items",o),Y(!W)},em=async e=>{let t={...e,usuarioID:H.usuarioID,unidadeID:G.unidadeID};$(),t.removedItems=L,t.unidade=G.unidadeID;try{"new"===z?await d.hi.post("cadastros/grupo-anexos/new/insertData",t).then(e=>{E?E(e.data,"gruposAnexo"):(T.push("".concat((0,D.g_)(U))),q(e.data.id)),g.ZP.success(D.OD.successNew)}):"edit"===z&&(await d.hi.post("".concat(U,"/updateData/").concat(S),t),g.ZP.success(D.OD.successUpdate)),K(!J)}catch(o){o.response&&409===o.response.status?g.ZP.error(D.OD.errorRepeated):console.log(o)}finally{ee()}},ex=async()=>{try{await d.hi.delete("".concat(U,"/deleteData/").concat(S,"/").concat(H.usuarioID,"/").concat(G.unidadeID)),q(null),setOpen(!1),g.ZP.success(D.OD.successDelete),console.log("entrou")}catch(e){e.response&&409===e.response.status?(g.ZP.error(D.OD.pendingDelete),X(!1)):console.log(e)}};return(0,i.useEffect)(()=>{ec(),setTimeout(()=>{et()},300)},[S]),(0,i.useEffect)(()=>{O&&eo(em)()},[O]),(0,s.jsxs)(s.Fragment,{children:[!A&&(0,s.jsx)(j.Z,{}),A&&(0,s.jsxs)("form",{onSubmit:eo(em),children:[(0,s.jsx)(C.Z,{btnCancel:!0,btnNew:!E,btnSave:!0,manualUrl:R,btnClose:_,handleModalClose:M,handleSubmit:()=>eo(em),btnDelete:"edit"===z,onclickDelete:()=>X(!0),type:z,outsideID:k}),(0,s.jsx)(u.Z,{children:A&&(0,s.jsx)(m.Z,{children:(0,s.jsxs)(x.ZP,{container:!0,spacing:4,children:[(0,s.jsx)(y.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:ei,errors:null==ea?void 0:null===(t=ea.fields)||void 0===t?void 0:t.nome}),(0,s.jsx)(I.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:A.fields.status,typePage:z,register:el}),(0,s.jsx)(y.Z,{xs:12,md:12,title:"Descri\xe7\xe3o",name:"fields.descricao",required:!1,control:ei,errors:null==ea?void 0:null===(o=ea.fields)||void 0===o?void 0:o.descricao}),(0,s.jsx)(b.Z,{xs:12,md:12,title:"Formul\xe1rios",name:"formulario.fields",value:null!==(N=null==A?void 0:A.formulario.fields)&&void 0!==N?N:null,multiple:!0,limitTags:5,required:!0,options:A.formulario.options,register:el,setValue:es,control:ei,errors:null==ea?void 0:null===(r=ea.formulario)||void 0===r?void 0:r.fields})]})})}),(0,s.jsx)(u.Z,{sx:{mt:4},children:(0,s.jsxs)(m.Z,{children:[(0,s.jsx)(f.Z,{sx:{mb:5},children:"Itens"}),(0,s.jsx)(x.ZP,{container:!0,spacing:3,children:(0,s.jsx)(P,{getValues:en,removeItem:eu,control:ei,register:el,errors:ea,type:z},W)}),(0,s.jsx)(v.Z,{variant:"outlined",color:"primary",sx:{mt:4},startIcon:(0,s.jsx)(p.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ed()},children:"Inserir item"})]})})]}),(0,s.jsx)(h.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+B.title,openModal:V,handleClose:()=>X(!1),handleSubmit:ex,btnCancel:!0,btnConfirm:!0})]})};var _=S},47842:function(e,t,o){"use strict";var s=o(85893),r=o(70754);let n=e=>{let{show:t,title:o,customTextProps:n,...i}=e;return t&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center rounded-lg z-50",children:(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center gap-2 ",children:[(0,s.jsx)(r.Z,{color:"primary",...i}),(0,s.jsx)("p",{className:"opacity-80 text-sm ".concat(n),children:null!=o?o:"Carregando..."})]})})};t.Z=n},61888:function(e,t,o){"use strict";o.r(t);var s=o(85893),r=o(60565),n=o(67294),i=o(77993);let a=()=>{let{setTitle:e}=(0,n.useContext)(r.f);return(0,n.useEffect)(()=>{e({title:"Grupo de Anexos",subtitle:{id:null,count:null,new:!0}})},[]),(0,s.jsx)(i.Z,{})};a.acl={action:"read",subject:"acl-page"},t.default=a}},function(e){e.O(0,[6887,5061,9774,2888,179],function(){return e(e.s=87830)}),_N_E=e.O()}]);