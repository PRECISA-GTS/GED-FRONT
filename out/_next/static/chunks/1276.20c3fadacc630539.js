"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1276],{88771:function(e,a,s){var t=s(85893),i=s(11163),n=s.n(i),l=s(67294),o=s(60664),c=s(49837),d=s(91359),r=s(79072),u=s(87536),m=s(86501),x=s(45061),f=s(47842),h=s(65698),p=s(71798),j=s(60565),Z=s(83830),D=s(29308),g=s(67569),b=s(41088),v=s(40039);let w=e=>{var a;let{id:s,newChange:i,manualUrl:w,handleModalClose:C,handleConfirmNew:y,btnClose:S,outsideID:I}=e,[P,N]=(0,l.useState)(!1),[O,k]=(0,l.useState)(null),q=n(),M=s&&s>0?"edit":"new",V=q.pathname,{title:T}=(0,l.useContext)(j.f),{setId:z}=(0,l.useContext)(Z.X),{loggedUnity:E,user:U}=(0,l.useContext)(v.V),{startLoading:J,stopLoading:K}=(0,b.Z)(),L=(0,u.cI)({mode:"onChange"}),_=async e=>{let a={...e,usuarioID:U.usuarioID,unidadeID:E.unidadeID};J();try{"new"===M?await o.h.post("/cadastros/classificacao-produto/new/insertData",a).then(e=>{I?y(e.data):(q.push("/cadastros/classificacao-produto"),z(e.data)),m.ZP.success(p.OD.successNew)}):"edit"===M&&(await o.h.post("/cadastros/classificacao-produto/updateData/".concat(s),a),m.ZP.success(p.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(p.OD.errorRepeated):console.log(t)}finally{K()}},A=async()=>{try{await o.h.delete("".concat(V,"/").concat(s,"/").concat(U.usuarioID,"/").concat(E.unidadeID)),z(null),N(!1),m.ZP.success(p.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(p.OD.pendingDelete),N(!1)):console.log(e)}},F=async()=>{try{"edit"===M?await o.h.post("".concat(V,"/getData/").concat(s),{id:s}).then(e=>{k(e.data),L.reset(e.data)}):k({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{F(),setTimeout(()=>{L.trigger()},300)},[s]),(0,t.jsxs)(t.Fragment,{children:[!O&&(0,t.jsx)(f.Z,{}),O&&(0,t.jsxs)("form",{onSubmit:L.handleSubmit(_),id:"formItem",children:[(0,t.jsx)(h.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,disabled:!1,manualUrl:w,btnClose:S,handleModalClose:C,handleSubmit:()=>L.handleSubmit(_),btnDelete:"edit"===M,onclickDelete:()=>N(!0),type:M,outsideID:I}),(0,t.jsx)(c.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(r.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(D.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:L}),(0,t.jsx)(g.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==O?void 0:null===(a=O.fields)||void 0===a?void 0:a.status,typePage:M,form:L})]})})})]}),(0,t.jsx)(x.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+T.title,openModal:P,handleClose:()=>N(!1),handleSubmit:A,btnCancel:!0,btnConfirm:!0})]})};a.Z=w},31276:function(e,a,s){s.d(a,{Z:function(){return M}});var t=s(85893),i=s(11163),n=s.n(i),l=s(67294),o=s(60565),c=s(83830),d=s(60664),r=s(49837),u=s(91359),m=s(79072),x=s(87536),f=s(86501),h=s(47842),p=s(45061),j=s(65698),Z=s(71798),D=s(29308),g=s(84220);s(67569);var b=s(40039),v=s(21609);s(88475);var w=s(41088),C=s(88771),y=s(1322),S=s(3893),I=s(17575),P=s(80562),N=s(54225),O=s(42222);let k=e=>{let{form:a,data:s,type:i}=e,{fields:n,append:o,remove:c}=(0,x.Dq)({control:a.control,name:"fields.analises"}),d=e=>({minimo:a.watch("fields.analises[".concat(e,"].minimo")),maximo:a.watch("fields.analises[".concat(e,"].maximo"))}),f=e=>{a.setValue("fields.analises[".concat(e,"].status"),1===a.watch("fields.analises[".concat(e,"].status"))?0:1)};return a.watch("fields.usaLaboratorio")&&(0,t.jsx)(r.Z,{children:(0,t.jsx)(u.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsxs)("div",{className:"flex items-center gap-2 pb-1 pt-2",children:[(0,t.jsx)("div",{className:"",children:(0,t.jsx)(v.Z,{icon:"entypo:lab-flask",className:"text-3xl"})}),(0,t.jsx)("div",{className:"flex flex-col gap-0",children:(0,t.jsx)("p",{className:"text-xl",children:"An\xe1lises"})})]})}),n.map((e,s)=>{let{minimo:n,maximo:o}=d(s);return(0,t.jsxs)(l.Fragment,{children:[(0,t.jsx)("input",{type:"hidden",name:"fields.analises[".concat(s,"].id"),value:e.id}),(0,t.jsx)(D.Z,{xs:12,md:3,title:"Nome",name:"fields.analises[".concat(s,"].nome"),required:!0,form:a,opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"Unidade",name:"fields.analises[".concat(s,"].unidade"),required:!0,form:a,helpText:"%, UI/g",opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"M\xednimo",name:"fields.analises[".concat(s,"].minimo"),required:!a.watch("fields.analises[".concat(s,"].maximo")),form:a,mask:"fractioned3",errorText:(0,O.JK)(a.watch("fields.analises[".concat(s,"].minimo")))>=(0,O.JK)(a.watch("fields.analises[".concat(s,"].maximo")))&&"O m\xednimo deve ser menor que o m\xe1ximo",opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"M\xe1ximo",name:"fields.analises[".concat(s,"].maximo"),required:!a.watch("fields.analises[".concat(s,"].minimo")),form:a,mask:"fractioned3",errorText:(0,O.JK)(a.watch("fields.analises[".concat(s,"].minimo")))>=(0,O.JK)(a.watch("fields.analises[".concat(s,"].maximo")))&&"O m\xe1ximo deve ser maior que o m\xednimo",opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsx)(D.Z,{xs:12,md:2,title:"Ajuda/Dica/M\xe9todo",name:"fields.analises[".concat(s,"].ajuda"),form:a,opacity:0===a.getValues("fields.analises")[s].status}),(0,t.jsxs)(m.ZP,{item:!0,xs:12,md:1,className:"flex items-center",children:["edit"===i&&(0,t.jsx)(I.Z,{title:1===a.getValues("fields.analises[".concat(s,"].status"))?"Desativar item":"Ativar item",placement:"top",children:(0,t.jsx)(P.Z,{color:1===a.getValues("fields.analises[".concat(s,"].status"))?"error":"primary",size:"small",onClick:()=>f(s),children:(0,t.jsx)(v.Z,{icon:1===a.getValues("fields.analises[".concat(s,"].status"))?"heroicons-outline:ban":"tabler:check"})})}),(0,t.jsx)(I.Z,{title:"Remover item",placement:"top",children:(0,t.jsx)(P.Z,{color:"error",size:"small",onClick:()=>c(s),children:(0,t.jsx)(v.Z,{icon:"tabler:trash-filled"})})})]})]},e.id)}),(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsx)(N.Z,{variant:"outlined",color:"primary",onClick(){o({id:null,nome:"",unidade:"",minimo:"",maximo:"",ajuda:""}),a.trigger()},startIcon:(0,t.jsx)(v.Z,{icon:"material-symbols:add-circle-outline-rounded"}),children:"Inserir"})})]})})})},q=e=>{var a;let{id:s,btnClose:i,handleConfirmNew:v,handleModalClose:I,newChange:P,manualUrl:N,outsideID:q}=e,[M,V]=(0,l.useState)(!1),[T,z]=(0,l.useState)(null),E=n(),U=s&&s>0?"edit":"new",J=E.pathname,{title:K}=(0,l.useContext)(o.f),{setId:L}=(0,l.useContext)(c.X),{loggedUnity:_,user:A}=(0,l.useContext)(b.V),[F,R]=(0,l.useState)([]),[H,X]=(0,l.useState)(!1),{startLoading:B,stopLoading:G}=(0,w.Z)(),[Q,W]=(0,l.useState)(!1),[Y,$]=(0,l.useState)(!1),ee=(0,x.cI)({mode:"onChange"}),ea=e=>{let a=!0;return e.analises&&e.analises.length>0&&e.analises.map((e,s)=>{(0,O.JK)(e.minimo)>=(0,O.JK)(e.maximo)&&(f.ZP.error("O valor m\xednimo da an\xe1lise deve ser menor que o valor m\xe1ximo!"),a=!1)}),a},es=async e=>{let a={...e,unidadeID:_.unidadeID,usuarioID:A.usuarioID,removedItems:F};if(ea(a.fields)){console.log("onSubmit: ",a),B();try{"new"===U?await d.h.post("cadastros/produto/new/insertData",a).then(e=>{v?v(e.data,"produtos"):(E.push("".concat((0,Z.g_)(J))),L(e.data.id)),f.ZP.success(Z.OD.successNew)}):"edit"===U&&(await d.h.post("".concat(J,"/updateData/").concat(s),a),f.ZP.success(Z.OD.successUpdate))}catch(t){t.response&&409===t.response.status?f.ZP.error(Z.OD.errorRepeated):console.log(t)}finally{G()}}},et=async()=>{try{await d.h.delete("".concat(J,"/").concat(s,"/").concat(A.usuarioID,"/").concat(_.unidadeID)),L(null),V(!1),f.ZP.success(Z.OD.successDelete)}catch(e){e.response&&409===e.response.status?(f.ZP.error(Z.OD.pendingDelete),V(!1)):console.log(e)}},ei=async()=>{try{let e="new"===U?"cadastros/produto/new/getData/".concat(_.unidadeID):"".concat(J,"/getData/").concat(s,"/").concat(_.unidadeID);await d.h.post(e).then(e=>{console.log("\uD83D\uDE80 ~ getData:",e.data),z(e.data),ee.reset(e.data)})}catch(a){console.log(a)}},en=()=>{W(!0)},el=async()=>{$(!0)},eo=e=>{W(!1),ee.setValue("classificacao.fields",e),$(!Y)};return(0,l.useEffect)(()=>{ei(),setTimeout(()=>{ee.trigger()},300)},[s]),(0,l.useEffect)(()=>{P&&ee.handleSubmit(es)()},[P]),(0,t.jsxs)(t.Fragment,{children:[!T&&(0,t.jsx)(h.Z,{}),T&&(0,t.jsxs)("form",{onSubmit:ee.handleSubmit(es),className:"space-y-3",children:[(0,t.jsx)(j.Z,{btnCancel:!0,btnNew:!v,btnSave:!0,btnClose:i,manualUrl:N,handleModalClose:I,handleSubmit:()=>ee.handleSubmit(es),btnDelete:"edit"===U,onclickDelete:()=>V(!0),type:U,outsideID:q}),(0,t.jsx)(r.Z,{children:(0,t.jsx)(u.Z,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(D.Z,{xs:11,md:4,title:"Nome",name:"fields.nome",required:!0,form:ee}),(0,t.jsx)(g.Z,{xs:12,md:3,title:"Unidade de medida",name:"unidadeMedida.fields",value:null==T?void 0:T.unidadeMedida.fields,required:!0,options:T.unidadeMedida.options,form:ee,helpText:"Selecione a unidade de medida"}),(0,t.jsx)(g.Z,{xs:12,md:3,title:"Classificação",name:"classificacao.fields",value:null==T?void 0:null===(a=T.classificacao)||void 0===a?void 0:a.fields,options:T.classificacao.options,helpText:"Selecione a classificação",createNew:en,form:ee}),(0,t.jsx)(S.Z,{xs:"12",md:"2",title:"Limpeza",name:"fields.limpeza",value:T.fields.limpeza,form:ee,helpText:"Este produto ser\xe1 listado nos formul\xe1rios do POP2 de Limpeza e Higieniza\xe7\xe3o"}),(0,t.jsx)(S.Z,{xs:"12",md:"2",title:"Usa Laborat\xf3rio",name:"fields.usaLaboratorio",value:T.fields.usaLaboratorio,form:ee,helpText:"Habilita o uso do laborat\xf3rio com a inser\xe7\xe3o de itens de an\xe1lise"})]})})}),(0,t.jsx)(k,{form:ee,data:T.analises,type:U})]}),(0,t.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+K.title,openModal:M,handleClose:()=>V(!1),handleSubmit:et,btnCancel:!0,btnConfirm:!0}),(0,t.jsx)(y.Z,{title:"Nova Classifica\xe7\xe3o de Produto",size:"md",openModal:Q,setOpenModal:W,handleSave:el,children:(0,t.jsx)(C.Z,{manualUrl:"/cadastros/classificacao-produto",btnClose:!0,handleModalClose:()=>W(!1),newChange:Y,handleConfirmNew:eo,outsideID:!0})})]})};var M=q}}]);