"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9291],{88771:function(e,t,a){var s=a(85893),o=a(11163),n=a.n(o),i=a(67294),l=a(60664),c=a(49837),d=a(91359),r=a(79072),u=a(87536),m=a(86501),x=a(45061),p=a(47842),h=a(92477),f=a(71798),Z=a(60565),D=a(83830),g=a(29308),j=a(67569),b=a(41088),v=a(40039);let C=e=>{var t;let{id:a,newChange:o,manualUrl:C,handleModalClose:w,handleConfirmNew:y,btnClose:S,outsideID:I}=e,[P,N]=(0,i.useState)(!1),[O,E]=(0,i.useState)(null),M=n(),V=a&&a>0?"edit":"new",q=M.pathname,{title:A}=(0,i.useContext)(Z.f),{setId:k}=(0,i.useContext)(D.X),{loggedUnity:T,user:F}=(0,i.useContext)(v.V),{startLoading:U,stopLoading:_}=(0,b.Z)(),R=(0,u.cI)({mode:"onChange"}),z=async e=>{let t={...e,usuarioID:F.usuarioID,unidadeID:T.unidadeID};U();try{"new"===V?await l.h.post("/cadastros/classificacao-produto/new/insertData",t).then(e=>{I?y(e.data):(M.push("/cadastros/classificacao-produto"),k(e.data)),m.ZP.success(f.OD.successNew)}):"edit"===V&&(await l.h.post("/cadastros/classificacao-produto/updateData/".concat(a),t),m.ZP.success(f.OD.successUpdate))}catch(s){s.response&&409===s.response.status?m.ZP.error(f.OD.errorRepeated):console.log(s)}finally{_()}},X=async()=>{try{await l.h.delete("".concat(q,"/").concat(a,"/").concat(F.usuarioID,"/").concat(T.unidadeID)),k(null),N(!1),m.ZP.success(f.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(f.OD.pendingDelete),N(!1)):console.log(e)}},B=async()=>{try{"edit"===V?await l.h.post("".concat(q,"/getData/").concat(a),{id:a}).then(e=>{E(e.data),R.reset(e.data)}):E({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,i.useEffect)(()=>{B(),setTimeout(()=>{R.trigger()},300)},[a]),(0,s.jsxs)(s.Fragment,{children:[!O&&(0,s.jsx)(p.Z,{}),O&&(0,s.jsxs)("form",{onSubmit:R.handleSubmit(z),id:"formItem",children:[(0,s.jsx)(h.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,disabled:!1,manualUrl:C,btnClose:S,handleModalClose:w,handleSubmit:()=>R.handleSubmit(z),btnDelete:"edit"===V,onclickDelete:()=>N(!0),type:V,outsideID:I}),(0,s.jsx)(c.Z,{children:(0,s.jsx)(d.Z,{children:(0,s.jsxs)(r.ZP,{container:!0,spacing:5,children:[(0,s.jsx)(g.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:R}),(0,s.jsx)(j.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==O?void 0:null===(t=O.fields)||void 0===t?void 0:t.status,typePage:V,form:R})]})})})]}),(0,s.jsx)(x.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+A.title,openModal:P,handleClose:()=>N(!1),handleSubmit:X,btnCancel:!0,btnConfirm:!0})]})};t.Z=C},69291:function(e,t,a){a.d(t,{Z:function(){return V}});var s=a(85893),o=a(11163),n=a.n(o),i=a(67294),l=a(60565),c=a(83830),d=a(60664),r=a(49837),u=a(91359),m=a(79072),x=a(59742),p=a(54225),h=a(87536),f=a(86501),Z=a(47842),D=a(45061),g=a(92477),j=a(71798),b=a(29308),v=a(84220),C=a(67569),w=a(40039),y=a(21609),S=a(88475),I=a(44373);let P=e=>{let{removeAnexo:t,type:a,form:o}=e,[n,l]=(0,i.useState)([]),c=async()=>{let e=await d.h.post("/cadastros/produto/getFormularios");l(e.data)};return(0,i.useEffect)(()=>{c()},[]),o.getValues("anexos")&&o.getValues("anexos").map((e,l)=>(0,s.jsxs)(i.Fragment,{children:[(0,s.jsx)(b.Z,{md:6,title:"Nome",name:"anexos[".concat(l,"].nome"),required:!0,form:o}),(0,s.jsx)(v.Z,{xs:12,md:3,title:"Formul\xe1rio",name:"anexos[".concat(l,"].formulario"),value:e.formulario,required:!0,options:null!=n?n:[],form:o,helpText:"Formul\xe1rio em que ser\xe1 solicitado esse anexo para este produto"}),(0,s.jsx)(C.Z,{xs:1,md:1,title:"Obrigat\xf3rio",name:"anexos[".concat(l,"].obrigatorio"),value:1==e.obrigatorio,typePage:a,form:o}),(0,s.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"anexos[".concat(l,"].status"),value:1==e.obrigatorio,typePage:a,form:o}),(0,s.jsx)(S.Z,{xs:4,md:1,title:"Remover",index:l,removeItem:t,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"}),(0,s.jsx)(b.Z,{xs:11,md:12,multiline:!0,items:4,title:"Descri\xe7\xe3o (opcional)",name:"anexos[".concat(l,"].descricao"),form:o}),l<o.getValues("anexos").length-1&&(0,s.jsx)(I.Z,{})]},l))};var N=a(41088),O=a(88771),E=a(1322);let M=e=>{var t;let{id:a,btnClose:o,handleConfirmNew:S,handleModalClose:I,newChange:M,manualUrl:V,outsideID:q}=e,[A,k]=(0,i.useState)(!1),[T,F]=(0,i.useState)(null),U=n(),_=a&&a>0?"edit":"new",R=U.pathname,{title:z}=(0,i.useContext)(l.f),{setId:X}=(0,i.useContext)(c.X),{loggedUnity:B,user:G}=(0,i.useContext)(w.V),[H,J]=(0,i.useState)([]),[K,L]=(0,i.useState)(!1),{startLoading:Q,stopLoading:W}=(0,N.Z)(),[Y,$]=(0,i.useState)(!1),[ee,et]=(0,i.useState)(!1),ea=(0,h.cI)({mode:"onChange"}),es=async e=>{Q();let t={...e,unidadeID:B.unidadeID,usuarioID:G.usuarioID,removedItems:H};console.log(t);try{"new"===_?await d.h.post("cadastros/produto/new/insertData",t).then(e=>{S?S(e.data,"produtos"):(U.push("".concat((0,j.g_)(R))),X(e.data.id)),f.ZP.success(j.OD.successNew)}):"edit"===_&&(await d.h.post("".concat(R,"/updateData/").concat(a),t),f.ZP.success(j.OD.successUpdate))}catch(s){s.response&&409===s.response.status?f.ZP.error(j.OD.errorRepeated):console.log(s)}finally{W()}},eo=async()=>{try{await d.h.delete("".concat(R,"/").concat(a,"/").concat(G.usuarioID,"/").concat(B.unidadeID)),X(null),k(!1),f.ZP.success(j.OD.successDelete)}catch(e){e.response&&409===e.response.status?(f.ZP.error(j.OD.pendingDelete),k(!1)):console.log(e)}},en=async()=>{try{let e="new"===_?"cadastros/produto/new/getData/".concat(B.unidadeID):"".concat(R,"/getData/").concat(a,"/").concat(B.unidadeID);await d.h.post(e).then(e=>{F(e.data),ea.reset(e.data)})}catch(t){console.log(t)}},ei=(e,t)=>{e.produtoAnexoID&&J([...H,e.produtoAnexoID]);let a=ea.getValues("anexos").filter((e,a)=>a!==t);ea.setValue("anexos",a),L(!K)},el=()=>{let e=[...ea.getValues("anexos"),{nome:"",obrigatorio:1,status:1,descricao:"",observacao:""}];ea.setValue("anexos",e),L(!K)},ec=()=>{$(!0)},ed=async()=>{et(!0)},er=e=>{$(!1),ea.setValue("classificacao.fields",e),et(!ee)};return(0,i.useEffect)(()=>{en(),setTimeout(()=>{ea.trigger()},300)},[a]),(0,i.useEffect)(()=>{M&&ea.handleSubmit(es)()},[M]),(0,s.jsxs)(s.Fragment,{children:[!T&&(0,s.jsx)(Z.Z,{}),T&&(0,s.jsxs)("form",{onSubmit:ea.handleSubmit(es),className:"space-y-3",children:[(0,s.jsx)(g.Z,{btnCancel:!0,btnNew:!S,btnSave:!0,btnClose:o,manualUrl:V,handleModalClose:I,handleSubmit:()=>ea.handleSubmit(es),btnDelete:"edit"===_,onclickDelete:()=>k(!0),type:_,outsideID:q}),(0,s.jsx)(r.Z,{children:(0,s.jsx)(u.Z,{children:(0,s.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,s.jsx)(b.Z,{xs:11,md:5,title:"Nome",name:"fields.nome",required:!0,form:ea}),(0,s.jsx)(v.Z,{xs:12,md:3,title:"Unidade de medida",name:"unidadeMedida.fields",value:null==T?void 0:T.unidadeMedida.fields,required:!0,options:T.unidadeMedida.options,form:ea,helpText:"Selecione a unidade de medida"}),(0,s.jsx)(v.Z,{xs:12,md:3,title:"Classificação",name:"classificacao.fields",value:null==T?void 0:null===(t=T.classificacao)||void 0===t?void 0:t.fields,options:T.classificacao.options,helpText:"Selecione a classificação",createNew:ec,form:ea}),(0,s.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:T.fields.status,typePage:_,form:ea})]})})}),(0,s.jsxs)(r.Z,{children:[(0,s.jsx)(x.Z,{title:"Anexos"}),(0,s.jsx)(u.Z,{children:(0,s.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,s.jsx)(P,{removeAnexo:ei,type:_,form:ea},K),(0,s.jsx)(m.ZP,{item:!0,xs:12,children:(0,s.jsx)(p.Z,{variant:"outlined",color:"primary",sx:{mt:1},startIcon:(0,s.jsx)(y.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){el()},children:"Inserir Anexo"})})]})})]})]}),(0,s.jsx)(D.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+z.title,openModal:A,handleClose:()=>k(!1),handleSubmit:eo,btnCancel:!0,btnConfirm:!0}),(0,s.jsx)(E.Z,{title:"Nova Classifica\xe7\xe3o de Produto",size:"md",openModal:Y,setOpenModal:$,handleSave:ed,children:(0,s.jsx)(O.Z,{manualUrl:"/cadastros/classificacao-produto",btnClose:!0,handleModalClose:()=>$(!1),newChange:ee,handleConfirmNew:er,outsideID:!0})})]})};var V=M}}]);