"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7340],{17340:function(e,t,a){a.d(t,{Z:function(){return V}});var s=a(85893),n=a(11163),o=a.n(n),i=a(67294),l=a(60565),r=a(83830),c=a(60664),d=a(49837),u=a(91359),m=a(79072),x=a(44373),h=a(87536),f=a(86501),p=a(47842),v=a(45061),j=a(92477),g=a(71798),Z=a(29308),b=a(84220),y=a(21609);a(67569);var C=a(40039),D=a(29630),I=a(61953),S=a(54225),k=a(3893),w=a(88475);let F=e=>{let{data:t,index:a,indexAnexo:n,handleRemoveAnexo:o,form:i}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z.Z,{xs:12,md:9,title:"Nome",name:"fields.opcoes[".concat(a,"].anexos[").concat(n,"].nome"),required:!0,form:i}),(0,s.jsx)(k.Z,{xs:6,md:2,title:"Obrigat\xf3rio",name:"fields.opcoes[".concat(a,"].anexos[").concat(n,"].obrigatorio"),value:t.obrigatorio,form:i}),(0,s.jsx)(w.Z,{xs:6,md:1,title:0==n?"Remover":"",index:a,removeItem:()=>o(t,a,n),item:t,pending:!1,textSuccess:"Remover este anexo",textError:"Este anexo n\xe3o pode mais ser removido pois possui v\xednculo atrelado a ele"})]})};a(74865);let P=e=>{let{data:t,addAnexo:a,register:n,handleRemoveAnexo:o,form:l}=e,[r,c]=(0,i.useState)(!1),[x,h]=(0,i.useState)((()=>{let e=[];return t&&t.map(t=>{e.push(1==t.anexo)}),e})()),f=e=>{let t=[...x];t[e]=!t[e],h(t)};return t&&t.map((e,t)=>(0,s.jsx)(d.Z,{sx:{mt:3},children:(0,s.jsxs)(u.Z,{children:[(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Z,{variant:"h6",sx:{my:3},children:(0,s.jsxs)(I.Z,{display:"flex",alignItems:"center",sx:{gap:2},children:[(0,s.jsx)(y.Z,{icon:"akar-icons:edit"}),(0,s.jsx)("p",{children:e.nome})]})}),(0,s.jsxs)(I.Z,{display:"flex",alignItems:"center",sx:{gap:4},children:[(0,s.jsx)(I.Z,{children:(0,s.jsx)(k.Z,{title:"Solicita anexo",name:"fields.opcoes[".concat(t,"].anexo"),onClick:()=>f(t),value:e.anexo,form:l})}),(0,s.jsx)(I.Z,{children:(0,s.jsx)(k.Z,{title:"Gera N\xe3o Conformidade (NC)",name:"fields.opcoes[".concat(t,"].bloqueiaFormulario"),value:e.bloqueiaFormulario,form:l,helpText:"Se marcada esta resposta, bloqueia a aprova\xe7\xe3o do formul\xe1rio e obrigatoriamente gera uma n\xe3o conformidade (Plano de a\xe7\xe3o)"})}),(0,s.jsx)(I.Z,{children:(0,s.jsx)(k.Z,{title:"Observa\xe7\xe3o",name:"fields.opcoes[".concat(t,"].observacao"),value:e.observacao,form:l})})]})]}),x[t]&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Z,{variant:"body1",sx:{my:3},children:"Anexos do item"}),(0,s.jsx)(m.ZP,{container:!0,spacing:4,children:e.anexos.map((e,a)=>(0,s.jsx)(F,{index:t,indexAnexo:a,data:e,handleRemoveAnexo:o,form:l},r))}),(0,s.jsx)(I.Z,{sx:{mt:3},children:(0,s.jsx)(S.Z,{type:"button",variant:"outlined",startIcon:(0,s.jsx)(y.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick:()=>a(t),children:"Inserir"})})]})]})}))};var A=a(41088),N=a(19604);let E=e=>{let{data:t}=e,a=o(),{setId:n}=(0,i.useContext)(r.X),l=(e,t)=>{a.push(t),n(e)};return t&&t.length>0&&(0,s.jsx)(d.Z,{className:"mt-2",children:(0,s.jsxs)(u.Z,{children:[(0,s.jsxs)(D.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700,mb:6},className:"flex items-center gap-1",children:[(0,s.jsx)(y.Z,{icon:"clarity:form-line",className:"text-primary"}),"Formul\xe1rios que cont\xe9m este item"]}),t.map((e,t)=>(0,s.jsx)(N.Z,{severity:"info",onClick:()=>l(e.id,e.rota),sx:{mt:2,cursor:"pointer"},children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["".concat(e.nome," (ciclo de ").concat(e.ciclo," ").concat(1===e.ciclo?"dia":"dias",")"),(0,s.jsx)(y.Z,{icon:"ci:external-link"})]})},t))]})})},q=e=>{var t,a,n,y,D,I,S;let{id:k,btnClose:w,handleModalClose:F,setNewChange:N,newChange:q,outsideID:V,handleConfirmNew:z,manualUrl:O}=e,[R,T]=(0,i.useState)(!1),[M,_]=(0,i.useState)(!1),[$,U]=(0,i.useState)(!1),[W,X]=(0,i.useState)(!1),[G,K]=(0,i.useState)(null),L=o(),B=k&&k>0?"edit":"new",H=L.pathname,{title:J}=(0,i.useContext)(l.f),{setId:Q}=(0,i.useContext)(r.X),{loggedUnity:Y,user:ee}=(0,i.useContext)(C.V),{startLoading:et,stopLoading:ea}=(0,A.Z)(),es=null!==(S=L.pathname.split("/")[3])&&void 0!==S?S:"item",en=(0,h.cI)({mode:"onChange"}),eo=async e=>{et();let t={...e,usuarioID:ee.usuarioID,unidadeID:Y.unidadeID};try{"new"===B?await c.h.post("cadastros/item/new/insertData",t).then(e=>{V?(Q(V),z(e.data)):(L.push("".concat((0,g.g_)(H))),Q(e.data)),f.ZP.success(g.OD.successNew)}):"edit"===B&&(await c.h.post("/cadastros/item/updateData/".concat(k),t),f.ZP.success(g.OD.successUpdate),ec()),setSavingForm(!savingForm)}catch(a){a.response&&409===a.response.status?f.ZP.error(g.OD.errorRepeated):console.log(a)}finally{ea()}},ei=async()=>{try{await c.h.delete("".concat(H,"/").concat(k,"/").concat(ee.usuarioID,"/").concat(Y.unidadeID)),Q(null),T(!1),f.ZP.success(g.OD.successDelete)}catch(e){e.response&&409===e.response.status?(f.ZP.error(g.OD.pendingDelete),T(!1)):console.log(e)}},el=async()=>{try{await c.h.post("".concat(H,"/inactivate/").concat(k),{usuarioID:ee.usuarioID,unidadeID:Y.unidadeID}),_(!1),f.ZP.success("Dado inativado com sucesso!")}catch(e){console.log(e)}finally{X(!W)}},er=async()=>{try{await c.h.post("".concat(H,"/activate/").concat(k),{usuarioID:ee.usuarioID,unidadeID:Y.unidadeID}),U(!1),f.ZP.success("Dado ativado com sucesso!")}catch(e){console.log(e)}finally{X(!W)}},ec=async()=>{try{await c.h.post("new"===B?"cadastros/item/new/getData":"cadastros/item/getData/".concat(k),{type:es}).then(e=>{console.log("\uD83D\uDE80 ~ formType response.data:",e.data),K(e.data),console.log("\uD83D\uDE80 ~ getData:",e.data),en.reset(e.data)})}catch(e){console.log(e)}},ed=e=>{let t=[...en.getValues("fields.opcoes")];t[e].anexos.push({nome:"",obrigatorio:!1});let a={...G,fields:{...G.fields,opcoes:t}};K(a),en.setValue("fields.opcoes",t)},eu=async e=>{try{let t=await c.h.post("cadastros/item/getAlternatives",{alternativa:e});t.data&&(X(!W),en.setValue("fields.opcoes",t.data),K({...G,fields:{...G.fields,opcoes:t.data}}))}catch(a){console.log(a)}},em=(e,t,a)=>{let s=[...en.getValues("fields.opcoes")];s[t].anexos.splice(a,1);let n={...G,fields:{...G.fields,opcoes:s}};K(n),en.setValue("fields.opcoes",s),X(!W)};return(0,i.useEffect)(()=>{ec(),setTimeout(()=>{en.trigger()},300)},[k,W]),(0,i.useEffect)(()=>{q&&handleSubmit(eo)()},[q]),(0,s.jsxs)(s.Fragment,{children:[!G&&(0,s.jsx)(p.Z,{}),G&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("form",{onSubmit:en.handleSubmit(eo),id:"formItem",children:[(0,s.jsx)(j.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,disabled:G.fields.pending,manualUrl:O,btnClose:w,handleModalClose:F,handleSubmit:()=>en.handleSubmit(eo),btnDelete:"edit"===B&&!G.fields.pending,onclickDelete:()=>T(!0),type:B,outsideID:V,btnInactivate:"edit"===B&&!!G.fields.pending&&1===G.fields.status,onClickInactivate:()=>_(!0),btnActivate:"edit"===B&&0===G.fields.status,onClickActivate:()=>U(!0)}),(0,s.jsx)(d.Z,{children:(0,s.jsx)(u.Z,{children:(0,s.jsxs)(m.ZP,{container:!0,spacing:5,children:[(0,s.jsx)(b.Z,{xs:12,md:12,title:"Formul\xe1rios",name:"fields.formulario",value:null==G?void 0:null===(t=G.fields)||void 0===t?void 0:t.formulario,required:!0,options:null==G?void 0:null===(a=G.fields)||void 0===a?void 0:a.opcoesForm,disabled:"novo"!==es&&"item"!==es,form:en}),(0,s.jsx)(Z.Z,{xs:12,md:12,title:"Nome",name:"fields.nome",required:!0,form:en}),(0,s.jsx)(b.Z,{xs:12,md:12,title:"Alternativa",name:"fields.alternativa",value:null==G?void 0:null===(n=G.fields)||void 0===n?void 0:n.alternativa,onChange:eu,required:!0,options:null==G?void 0:null===(y=G.fields)||void 0===y?void 0:null===(D=y.alternativa)||void 0===D?void 0:D.opcoes,form:en}),(0,s.jsx)(Z.Z,{xs:12,md:12,multiline:!0,rows:4,title:"Ajuda do item (mostrado em (?))",name:"fields.ajuda",form:en}),(0,s.jsx)(x.Z,{})]})})})]}),(0,s.jsx)(P,{data:null==G?void 0:null===(I=G.fields)||void 0===I?void 0:I.opcoes,handleRemoveAnexo:em,addAnexo:ed,form:en},W),(0,s.jsx)(E,{data:G.fields.models})]}),(0,s.jsx)(v.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+J.title,openModal:R,handleClose:()=>T(!1),handleSubmit:ei,btnCancel:!0,btnConfirm:!0}),(0,s.jsx)(v.Z,{text:"Tem certeza que deseja inativar?",title:"Inativar "+J.title,openModal:M,handleClose:()=>_(!1),handleSubmit:el,btnCancel:!0,btnConfirm:!0}),(0,s.jsx)(v.Z,{text:"Tem certeza que deseja ativar?",title:"Ativar "+J.title,openModal:$,handleClose:()=>U(!1),handleSubmit:er,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary"})]})};var V=q},45061:function(e,t,a){var s=a(85893),n=a(54225),o=a(1890),i=a(77745),l=a(95398),r=a(76779),c=a(44642);a(21609);var d=a(19604),u=a(29630),m=a(55343),x=a(67836),h=a(67294),f=a(82747);a(84220),a(29308),a(67569),a(3893),a(88475);let p=e=>{let{title:t,text:a,handleClose:p,openModal:v,handleSubmit:j,cnpj:g,nomeFornecedor:Z,gruposAnexo:b,email:y,setEmail:C,inputEmail:D,btnCancel:I,btnConfirm:S,grupoAnexosFornecedor:k,btnCancelColor:w,btnConfirmColor:F,closeAfterSave:P,listErrors:A}=e,[N,E]=(0,h.useState)(!1);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(o.Z,{open:v,"aria-labelledby":"form-dialog-title",disableEscapeKeyDown:!0,onClose(e,t){"backdropClick"!==t&&p()},children:[(0,s.jsx)(i.Z,{id:"form-dialog-title",children:t}),(0,s.jsxs)(l.Z,{children:[(0,s.jsxs)(c.Z,{sx:{mb:3},children:[a,A&&A.status&&(0,s.jsxs)(d.Z,{variant:"outlined",severity:"error",sx:{mt:2},children:["Por favor, verifique os campos abaixo:",(0,s.jsx)(u.Z,{variant:"subtitle1",color:"error",sx:{mt:2},children:A.errors.map((e,t)=>(0,s.jsxs)(u.Z,{variant:"body2",color:"error",children:["- ",e]},t))})]})]}),D&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(m.Z,{sx:{mt:2},fullWidth:!0,children:[(0,s.jsx)(x.Z,{defaultValue:"",type:"email",label:"E-mail do Fornecedor (opcional)",placeholder:"E-mail do Fornecedor (opcional)","aria-describedby":"validation-schema-nome",name:"email",error:(null==y?void 0:y.length)>0&&N,inputProps:{onChange(e){C(e.target.value),E(!(0,f.dI)(e.target.value))}}}),(null==y?void 0:y.length)>0&&N&&(0,s.jsx)(u.Z,{variant:"body2",color:"error",children:"Por favor, insira um e-mail v\xe1lido!"})]}),(0,s.jsx)(d.Z,{severity:"info",sx:{mt:2},children:"Se o e-mail for preenchido, o mesmo receber\xe1 as instru\xe7\xf5es de cadastro e preenchimento do formul\xe1rio no e-mail."})]})]}),(0,s.jsxs)(r.Z,{className:"dialog-actions-dense",children:[I&&(0,s.jsx)(n.Z,{variant:"outlined",color:"primary",onClick:p,children:"Cancelar"}),S&&(0,s.jsx)(n.Z,{variant:"contained",disabled:D&&(null==y?void 0:y.length)>0&&N||A&&A.status,color:F||"error",onClick:D&&g?()=>{j(g,Z,b,y),P&&p()}:D&&!g?()=>{j(y),P&&p()}:()=>{j(),P&&p()},children:"Confirmar"})]})]})})};t.Z=p},67569:function(e,t,a){var s=a(85893),n=a(79072),o=a(61953),i=a(29630),l=a(22841),r=a(75158);let c=e=>{let{form:t,xs:a,md:c,title:d,index:u,name:m,typePage:x,value:h,edit:f,className:p}=e;return(0,s.jsx)(n.ZP,{item:!0,xs:a,md:c,className:p,children:(0,s.jsxs)(o.Z,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,s.jsx)(i.Z,{variant:"caption",children:u&&0!=u?"":d}),(0,s.jsx)(l.Z,{control:(0,s.jsx)(r.Z,{size:"small",sx:{ml:4},...t.register(m),defaultChecked:!0==h||1==h||"new"==x,onChange(e){f&&t.setValue(f,!0)}})})]})})};t.Z=c},3893:function(e,t,a){var s=a(85893),n=a(79072),o=a(61953),i=a(22841),l=a(75158),r=a(53934);let c=e=>{let{form:t,xs:a,md:c,title:d,name:u,value:m,disabled:x,onClick:h,helpText:f,helpTextPosition:p}=e;return(0,s.jsx)(n.ZP,{item:!0,xs:null!=a?a:"12",md:null!=c?c:"12",children:(0,s.jsx)(o.Z,{display:"flex",alignItems:"center",justifyContent:"start",sx:{gap:0},children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{control:(0,s.jsx)(l.Z,{name:u,onClick:h,...t.register(u),defaultChecked:m,disabled:x}),label:d,size:"small",sx:{marginRight:"4px","&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}}),f&&(0,s.jsx)(r.Z,{text:f,position:null!=p?p:"top"})]})})})};t.Z=c},88475:function(e,t,a){var s=a(85893),n=a(79072),o=a(61953),i=a(29630),l=a(17575),r=a(80562),c=a(21609);let d=e=>{let{xs:t,md:a,icon:d,color:u,title:m,removeItem:x,item:h,pending:f,index:p,textSuccess:v,textError:j}=e;return v=v||"Remover este item",j=j||"Este item n\xe3o pode ser removido pois possui cadastros vinculados a ele",(0,s.jsx)(n.ZP,{item:!0,xs:t,md:a,children:(0,s.jsxs)(o.Z,{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,s.jsx)(i.Z,{variant:"caption",children:m}),(0,s.jsx)(l.Z,{title:1==f?j:v,children:(0,s.jsx)(r.Z,{color:null!=u?u:"error",size:"small",onClick(){1!=f&&x(h,p)},sx:{opacity:1==f?.5:1,cursor:1==f?"default":"pointer"},children:(0,s.jsx)(c.Z,{icon:null!=d?d:"tabler:trash-filled"})})})]})})};t.Z=d},82747:function(e,t,a){function s(e){if(!e||14!==(e=null==e?void 0:e.replace(/[^\d]+/g,"")).length||/^(\d)\1+$/.test(e))return!1;let t=e.length-2,a=e.substring(0,t),s=e.substring(t),n=0,o=t-7;for(let i=t;i>=1;i--)n+=a.charAt(t-i)*o--,o<2&&(o=9);let l=n%11<2?0:11-n%11;if(l!=s.charAt(0))return!1;t+=1,a=e.substring(0,t),n=0,o=t-7;for(let r=t;r>=1;r--)n+=a.charAt(t-r)*o--,o<2&&(o=9);return(l=n%11<2?0:11-n%11)==s.charAt(1)}function n(e){let t;if(!e||11!==(e=e.replace(/[^\d]+/g,"")).length||/^(\d)\1+$/.test(e))return!1;let a=0;for(let s=1;s<=9;s++)a+=parseInt(e.substring(s-1,s))*(11-s);if((10==(t=10*a%11)||11===t)&&(t=0),t!==parseInt(e.substring(9,10)))return!1;a=0;for(let n=1;n<=10;n++)a+=parseInt(e.substring(n-1,n))*(12-n);return(10==(t=10*a%11)||11===t)&&(t=0),t===parseInt(e.substring(10,11))}function o(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}a.d(t,{dI:function(){return o},sw:function(){return n},zk:function(){return s}})}}]);