"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5519],{25519:function(e,n,t){t.d(n,{Z:function(){return W}});var i=t(85893),a=t(11163),s=t.n(a),o=t(67294),r=t(83830),d=t(60664),l=t(21609),c=t(47842),u=t(66136),m=t(7071),x=t(76992),h=t(29618),p=t(29630),v=t(47028),j=t(79072),g=t(67569);let Z=e=>{let{submenu:n,indexUnit:t,indexMenuGroup:a,indexMenu:s,indexSubmenu:o,register:r,setValue:d}=e;return(0,i.jsxs)(j.ZP,{container:!0,spacing:5,sx:{my:2},children:[(0,i.jsx)(j.ZP,{item:!0,xs:4,md:8,children:(0,i.jsx)(p.Z,{variant:"subtitle1",children:n.nome})}),(0,i.jsx)("input",{type:"hidden",value:n.rota,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].rota"),...r("units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].rota"))}),(0,i.jsx)(g.Z,{xs:2,md:1,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].ler"),value:n.ler,register:r,setValue:d,edit:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,i.jsx)(g.Z,{xs:2,md:1,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].inserir"),value:n.inserir,register:r,setValue:d,edit:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,i.jsx)(g.Z,{xs:2,md:1,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].editar"),value:n.editar,register:r,setValue:d,edit:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].edit")}),(0,i.jsx)(g.Z,{xs:2,md:1,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].excluir"),value:n.excluir,register:r,setValue:d,edit:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].submenu[").concat(o,"].edit")})]})},f=e=>{let{menu:n,indexUnit:t,indexMenuGroup:a,indexMenu:s,expandedItem:o,handleChangeItem:r,register:d,setValue:c}=e;return n.rota?(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(j.ZP,{container:!0,spacing:5,sx:{my:2},children:[(0,i.jsx)(j.ZP,{item:!0,xs:4,md:8,children:(0,i.jsx)(p.Z,{variant:"subtitle1",children:n.nome})}),(0,i.jsx)("input",{type:"hidden",value:n.rota,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].rota"),...d("units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].rota"))}),(0,i.jsx)(g.Z,{xs:2,md:1,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].ler"),value:n.ler,register:d,setValue:c,edit:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].edit")}),(0,i.jsx)(g.Z,{xs:2,md:1,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].inserir"),value:n.inserir,register:d,setValue:c,edit:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].edit")}),(0,i.jsx)(g.Z,{xs:2,md:1,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].editar"),value:n.editar,register:d,setValue:c,edit:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].edit")}),(0,i.jsx)(g.Z,{xs:2,md:1,name:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].excluir"),value:n.excluir,register:d,setValue:c,edit:"units[".concat(t,"].menu[").concat(a,"].menu[").concat(s,"].edit")})]})}):(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(x.Z,{expanded:o==="item-".concat(t,"-").concat(a,"-").concat(s),onChange:r("item-".concat(t,"-").concat(a,"-").concat(s)),sx:{border:"1px solid #e0e0e0",boxShadow:"none"},children:[(0,i.jsx)(h.Z,{id:"controlled-panel-header-1","aria-controls":"controlled-panel-content-1",expandIcon:(0,i.jsx)(l.Z,{icon:"mdi:chevron-down"}),sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(p.Z,{children:n.nome})}),(0,i.jsx)(v.Z,{children:n.submenu&&n.submenu.map((e,n)=>(0,i.jsx)(Z,{submenu:e,indexUnit:t,indexMenuGroup:a,indexMenu:s,indexSubmenu:n,register:d,setValue:c},n))})]})})},b=e=>{let{unit:n,indexUnit:t,expanded:a,expandedItem:s,handleChange:r,handleChangeItem:d,control:c,register:m,setValue:g}=e,{settings:Z}=(0,o.useContext)(u.J6),b=Z.mode;return(0,i.jsxs)(x.Z,{expanded:a==="panel-".concat(t),onChange:r("panel-".concat(t)),sx:{border:"".concat("dark"===b?"1px solid #65656E":"1px solid #C5C6CD"),boxShadow:"none"},children:[(0,i.jsx)(h.Z,{id:"controlled-panel-header-1","aria-controls":"controlled-panel-content-1",expandIcon:(0,i.jsx)(l.Z,{icon:"mdi:chevron-down"}),sx:{display:"flex",alignItems:"center"},children:(0,i.jsx)(p.Z,{children:"Permiss\xf5es de Acesso"})}),(0,i.jsx)(v.Z,{children:n.menu&&n.menu.map((e,n)=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(j.ZP,{container:!0,spacing:5,sx:{my:2},children:[(0,i.jsx)(j.ZP,{item:!0,xs:4,md:8,children:(0,i.jsx)(p.Z,{variant:"body2",children:e.nome})}),(0,i.jsx)(j.ZP,{item:!0,xs:2,md:1,children:(0,i.jsx)(p.Z,{variant:"body2",sx:{textAlign:"center"},children:"Ler"})}),(0,i.jsx)(j.ZP,{item:!0,xs:2,md:1,children:(0,i.jsx)(p.Z,{variant:"body2",sx:{textAlign:"center"},children:"Inserir"})}),(0,i.jsx)(j.ZP,{item:!0,xs:2,md:1,children:(0,i.jsx)(p.Z,{variant:"body2",sx:{textAlign:"center"},children:"Editar"})}),(0,i.jsx)(j.ZP,{item:!0,xs:2,md:1,children:(0,i.jsx)(p.Z,{variant:"body2",sx:{textAlign:"center"},children:"Excluir"})})]}),e.menu&&e.menu.map((e,a)=>(0,i.jsx)(f,{menu:e,indexUnit:t,indexMenuGroup:n,expandedItem:s,handleChangeItem:d,indexMenu:a,register:m,setValue:g},a))]}))})]})};var C=t(50287);t(84220);var w=t(49837),y=t(91359),D=t(17575),I=t(80562),P=t(55343),S=t(44731),V=t(54225),k=t(58316),F=t(39063),A=t(9041),E=t(35966),O=t(67836),U=t(87536),q=t(86501),N=t(45061),z=t(71798),M=t(92477),R=t(40039);t(13860),t(57548);var _=t(29308);let L=e=>{var n,t,a,x,h,v,g,Z,f,L,W,G,T,J,X,B,H,K,Q;let{id:Y}=e,{setId:$}=(0,o.useContext)(r.X),{user:ee,setUser:en,loggedUnity:et}=(0,o.useContext)(R.V),{settings:ei}=(0,o.useContext)(u.J6),ea=ei.mode,es=s(),eo=Y&&Y>0?"edit":"new",er=es.pathname,[ed,el]=(0,o.useState)(!1),[ec,eu]=(0,o.useState)(),[em,ex]=(0,o.useState)(!1),[eh,ep]=(0,o.useState)(!1),[ev,ej]=(0,o.useState)(null),eg=(0,U.cI)({});ec&&ec.units&&ec.units.map((e,n)=>{setValue("units[".concat(n,"].papel"),e.papel),setValue("units[".concat(n,"].cargo"),e.cargos)});let[eZ,ef]=(0,o.useState)({showPassword:!1,showConfirmPassword:!1}),eb=()=>{ef({...eZ,showPassword:!eZ.showPassword})},eC=()=>{ef({...eZ,showConfirmPassword:!eZ.showConfirmPassword})},[ew,ey]=(0,o.useState)(!1),eD=async e=>{try{"new"===eo?await d.h.post("".concat((0,z.g_)(er),"/new/insertData"),e).then(e=>{es.push("".concat((0,z.g_)(er))),$(e.data.id),q.ZP.success(z.OD.successNew)}):"edit"===eo&&(e.permissionUserLogged=ee.admin,ew||(delete e.fields.senha,delete e.fields.confirmarSenha),await d.h.post("".concat(er,"/updateData/").concat(Y),e),q.ZP.success(z.OD.successUpdate))}catch(n){n.response&&409===n.response.status?q.ZP.error(z.OD.errorRepeated):console.log(n)}},eI=async()=>{try{await d.h.delete("".concat(er,"/").concat(Y)),$(null),el(!1),q.ZP.success(z.OD.successDelete)}catch(e){e.response&&409===e.response.status?(q.ZP.error(z.OD.pendingDelete),el(!1)):console.log(e)}},eP=()=>{let e=[...ec.units];e.push({unidade:null,papel:null,cargos:[],status:!0}),eu({...ec,units:e})},eS=e=>(n,t)=>{ex(!!t&&e)},eV=e=>(n,t)=>{ep(!!t&&e)},ek=(0,o.useRef)(null),eF=()=>{ek.current.click()},eA=async e=>{let n=e.target.files[0];if(n){let t=new FormData;t.append("file",n);let i=n.type.includes("image");if(!i){q.ZP.error("O arquivo selecionado n\xe3o \xe9 uma imagem!");return}await d.h.post("".concat(er,"/photo-profile/").concat(Y,"/").concat(et.unidadeID),t).then(e=>{console.log("Response ===> ",e),ej(e.data),ee.usuarioID==Y&&en({...ee,imagem:e.data}),q.ZP.success("Foto de perfil atualizada com sucesso!")}).catch(e=>{var n,t,i;q.ZP.error(null!==(i=null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)&&void 0!==i?i:"Erro ao atualizar foto de perfil, tente novamente!")})}},eE=async()=>{try{await d.h.delete("".concat(er,"/photo-profile/").concat(Y)),ej(null),ee.usuarioID==Y&&en({...ee,imagem:null}),q.ZP.success("Foto de perfil removida com sucesso!")}catch(e){console.log(e),q.ZP.error("Erro ao remover foto de perfil, tente novamente!")}},eO=async()=>{if("edit"==eo)try{let e="".concat(er,"/getData/").concat(Y,"?unidadeID=").concat(et.unidadeID,"&papelID=").concat(et.papelID,"&admin=").concat(ee.admin);await d.h.post(e).then(e=>{console.log("\uD83D\uDE80 ~ response:",e.data),eu(e.data),ej(e.data.fields.imagem),eg.reset(e.data)})}catch(n){console.log(n)}else eu({})};return(0,o.useEffect)(()=>{eO()},[Y]),(0,i.jsxs)(i.Fragment,{children:[!ec&&(0,i.jsx)(c.Z,{}),ec&&(0,i.jsxs)("form",{onSubmit:eg.handleSubmit(eD),children:[("new"==eo||ec)&&(0,i.jsxs)(w.Z,{children:[(0,i.jsx)(M.Z,{btnCancel:!0,btnSave:!0,handleSubmit:()=>eg.handleSubmit(eD),btnDelete:"edit"===eo,onclickDelete:()=>el(!0),type:eo}),(0,i.jsxs)(y.Z,{children:[(0,i.jsx)("input",{type:"hidden",value:ee.admin,name:"admin",...register("admin")}),(0,i.jsx)("input",{type:"hidden",value:null==ec?void 0:ec.usuarioUnidadeID,name:"usuarioUnidadeID",...register("usuarioUnidadeID")}),(0,i.jsx)("input",{type:"hidden",value:null==et?void 0:et.unidadeID,name:"unidadeID",...register("unidadeID")}),(0,i.jsx)("input",{type:"hidden",value:null==et?void 0:et.papelID,name:"papelID",...register("papelID")}),(0,i.jsxs)(j.ZP,{container:!0,spacing:5,children:["edit"==eo&&(0,i.jsx)(j.ZP,{item:!0,xs:12,md:2,children:(0,i.jsxs)(j.ZP,{item:!0,xs:12,md:12,sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"250px",position:"relative",border:"".concat("dark"===ea?"1px solid #65656E":"1px solid #C5C6CD"),borderRadius:"8px"},children:[ev&&(0,i.jsx)(D.Z,{title:"Apagar foto do perfil",placement:"top",children:(0,i.jsx)(I.Z,{size:"small",sx:{position:"absolute",top:"8px",right:"8px",zIndex:"20",color:"white",opacity:"0.8",backgroundColor:"#FF4D49","&:hover":{backgroundColor:"#FF4D49",opacity:"1"}},onClick:eE,children:(0,i.jsx)(l.Z,{icon:"material-symbols:delete-outline"})})}),(0,i.jsx)(D.Z,{title:ev?"Alterar foto":"Inserir foto",placement:"top",children:(0,i.jsxs)(P.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},children:[(0,i.jsx)("input",{type:"file",ref:ek,style:{display:"none"},onChange:eA}),(0,i.jsx)(S.Z,{variant:"rounded",alt:"Victor Anderson",sx:{width:"97%",height:"97%",cursor:"pointer"},src:ev,onClick:eF})]})})]})}),(0,i.jsx)(j.ZP,{item:!0,xs:12,md:"edit"===eo?10:12,children:(0,i.jsxs)(j.ZP,{container:!0,spacing:5,children:[(0,i.jsx)(_.Z,{xs:12,md:4,title:"Nome",name:"fields.nome",value:null==ec?void 0:null===(n=ec.fields)||void 0===n?void 0:n.nome,required:!0,form:eg}),(0,i.jsx)(C.Z,{xs:12,md:4,title:"Data de Nascimento",value:null==ec?void 0:null===(t=ec.fields)||void 0===t?void 0:t.dataNascimento,name:"fields.dataNascimento",form:eg}),(0,i.jsx)(_.Z,{xs:12,md:4,title:"E-mail",name:"fields.email",value:null==ec?void 0:null===(a=ec.fields)||void 0===a?void 0:a.email,required:!0,form:eg}),(0,i.jsx)(_.Z,{xs:12,md:4,title:"CPF",name:"fields.cpf",mask:"cpf",value:null==ec?void 0:null===(x=ec.fields)||void 0===x?void 0:x.cpf,required:!0,form:eg}),(0,i.jsx)(_.Z,{xs:12,md:4,title:"RG",name:"fields.rg",value:null==ec?void 0:null===(h=ec.fields)||void 0===h?void 0:h.rg,form:eg}),(0,i.jsx)(_.Z,{xs:12,md:4,title:"Registro Conselho Classe",name:"fields.registroConselhoClasse",value:null==ec?void 0:null===(v=ec.fields)||void 0===v?void 0:v.registroConselhoClasse,form:eg}),ec&&0==ee.admin&&(0,i.jsx)(i.Fragment,{}),ec&&"edit"==eo&&(0,i.jsx)(j.ZP,{item:!0,xs:12,md:4,children:(0,i.jsx)(P.Z,{fullWidth:!0,children:(0,i.jsx)(V.Z,{variant:"outlined",startIcon:(0,i.jsx)(l.Z,{icon:"mdi:lock-reset"}),onClick(){ey(!ew),ew&&(setValue("senha",null),setValue("confirmarSenha",null))},sx:{height:"56px"},children:"Alterar Senha"})})}),("new"==eo||ew)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.ZP,{item:!0,xs:12,md:4,children:(0,i.jsxs)(P.Z,{fullWidth:!0,children:[(0,i.jsx)(k.Z,{htmlFor:"input-confirm-password",children:"Senha"}),(0,i.jsx)(F.Z,{label:"Senha",id:"input-password",type:eZ.showPassword?"text":"password",name:"fields.senha",...register("fields.senha",{required:"new"==eo}),error:null===(g=eg.formState)||void 0===g?void 0:null===(Z=g.errors)||void 0===Z?void 0:null===(f=Z.fields)||void 0===f?void 0:f.senha,endAdornment:(0,i.jsx)(A.Z,{position:"end",children:(0,i.jsx)(I.Z,{edge:"end",onClick:eb,children:(0,i.jsx)(l.Z,{icon:eZ.showPassword?"mdi:eye-outline":"mdi:eye-off-outline"})})})})]})}),(0,i.jsx)(j.ZP,{item:!0,xs:12,md:4,children:(0,i.jsxs)(P.Z,{fullWidth:!0,children:[(0,i.jsx)(k.Z,{htmlFor:"input-confirm-password",color:(null===(W=null===(L=eg.formState)||void 0===L?void 0:L.errors.confirmarSenha)||void 0===W?void 0:W.message)?"error":"",children:"Confirmar Senha"}),(0,i.jsx)(F.Z,{label:"Confirmar Senha",id:"input-password",type:eZ.showConfirmPassword?"text":"password",name:"fields.confirmarSenha",...register("fields.confirmarSenha",{required:"new"==eo,validate:e=>e===watch("fields.senha")||"As senhas n\xe3o conferem."}),error:null===(G=eg.formState)||void 0===G?void 0:G.errors.confirmarSenha,endAdornment:(0,i.jsx)(A.Z,{position:"end",children:(0,i.jsx)(I.Z,{edge:"end",onClick:eC,children:(0,i.jsx)(l.Z,{icon:eZ.showConfirmPassword?"mdi:eye-outline":"mdi:eye-off-outline"})})})}),(null===(J=null===(T=eg.formState)||void 0===T?void 0:T.errors.confirmarSenha)||void 0===J?void 0:J.message)&&(0,i.jsx)(p.Z,{variant:"body2",color:"error",children:null===(B=null===(X=eg.formState)||void 0===X?void 0:X.errors.confirmarSenha)||void 0===B?void 0:B.message})]})})]})]})})]})]})]}),ec&&1==ee.admin&&"edit"===eo&&(0,i.jsxs)(i.Fragment,{children:[ec.units&&ec.units.map((e,n)=>{var t,a;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"hidden",value:e.usuarioUnidadeID,name:"units[".concat(n,"].usuarioUnidadeID"),...register("units[".concat(n,"].usuarioUnidadeID"))}),(0,i.jsxs)(w.Z,{sx:{mt:4},children:[(0,i.jsxs)(y.Z,{children:[(0,i.jsxs)(p.Z,{variant:"subtitle1",sx:{fontWeight:600},children:[e.unidade?e.unidade.nome:"Nova Unidade",(null===(t=e.unidade)||void 0===t?void 0:t.id)===et.unidadeID&&(null===(a=e.papel)||void 0===a?void 0:a.id)===et.papelID&&(0,i.jsx)(m.Z,{size:"small",skin:"light",color:"success",label:"Atual",sx:{mx:2,"& .MuiChip-label":{textTransform:"capitalize"}}})]}),(0,i.jsxs)(j.ZP,{container:!0,spacing:5,sx:{my:2},children:[e.unidadeID?(0,i.jsx)("input",{type:"hidden",value:e.unidadeID,name:"units[".concat(n,"].unidadeID"),...register("units[".concat(n,"].unidadeID"))}):(0,i.jsx)(j.ZP,{item:!0,xs:12,md:3,children:(0,i.jsx)(E.Z,{options:ec.unidadesOptions,getOptionLabel:e=>e.nome,defaultValue:null!==(H=null==e?void 0:e.unidade)&&void 0!==H?H:null,name:"units[".concat(n,"].unidade"),...register("units[".concat(n,"].unidade"),{required:!1}),onChange(e,t){let i=t?{id:null==t?void 0:t.unidadeID,nome:null==t?void 0:t.nome}:null;setValue("units[".concat(n,"].unidade"),i)},renderInput(e){var t,a,s;return(0,i.jsx)(O.Z,{...e,label:"Selecione a unidade",placeholder:"Selecionar unidade","aria-describedby":"formulario-error",error:null===(a=null===(t=eg.formState)||void 0===t?void 0:t.errors.units)||void 0===a?void 0:null===(s=a[n])||void 0===s?void 0:s.unidade})}})}),(0,i.jsx)(j.ZP,{item:!0,xs:12,md:3,children:(0,i.jsx)(E.Z,{options:ec.papelOptions,getOptionLabel:e=>e.nome,defaultValue:null!==(K=e.papel)&&void 0!==K?K:null,name:"units[".concat(n,"].papel"),...register("units[".concat(n,"].papel"),{required:!1}),onChange(e,t){let i=t?{id:null==t?void 0:t.id,nome:null==t?void 0:t.nome,edit:!0}:null;setValue("units[".concat(n,"].papel"),i)},renderInput(e){var t,a,s;return(0,i.jsx)(O.Z,{...e,label:"Selecione o papel",placeholder:"Selecione o papel","aria-describedby":"formulario-error",error:null===(a=null===(t=eg.formState)||void 0===t?void 0:t.errors.units)||void 0===a?void 0:null===(s=a[n])||void 0===s?void 0:s.papel})}})}),(0,i.jsx)(j.ZP,{item:!0,xs:12,md:e.unidadeID?6:3,children:(0,i.jsx)(E.Z,{multiple:!0,limitTags:2,options:ec.cargosOptions,getOptionLabel:e=>e.nome||"",defaultValue:null!==(Q=e.cargos)&&void 0!==Q?Q:[],name:"units[".concat(n,"].cargo[]"),...register("units[".concat(n,"].cargo"),{required:!1}),onChange(e,t){let i=t?t.map(e=>({id:null==e?void 0:e.id,nome:null==e?void 0:e.nome,edit:!0})):[];setValue("units[".concat(n,"].cargo"),i)},renderInput(e){var t,a,s;return(0,i.jsx)(O.Z,{...e,label:"Cargos",placeholder:"Cargos",error:null===(a=null===(t=eg.formState)||void 0===t?void 0:t.errors.units)||void 0===a?void 0:null===(s=a[n])||void 0===s?void 0:s.cargo})}})})]}),(0,i.jsx)(b,{unit:e,indexUnit:n,expanded:em,expandedItem:eh,handleChange:eS,handleChangeItem:eV,control:eg.control,register:eg.register,setValue:eg.setValue})]}),(0,i.jsx)(y.Z,{})]})]})}),(0,i.jsx)(j.ZP,{container:!0,spacing:5,sx:{my:2},children:(0,i.jsx)(j.ZP,{item:!0,xs:12,md:3,children:(0,i.jsx)(V.Z,{startIcon:(0,i.jsx)(l.Z,{icon:"material-symbols:add-circle-outline-rounded"}),variant:"outlined",onClick(){eP()},children:"Inserir unidade"})})})]})]}),(0,i.jsx)(N.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir dado",openModal:ed,handleClose:()=>el(!1),handleSubmit:eI,btnCancel:!0,btnConfirm:!0})]})};var W=L}}]);