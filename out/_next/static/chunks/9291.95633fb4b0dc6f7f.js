"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9291],{88771:function(e,t,s){var a=s(85893),o=s(11163),n=s.n(o),i=s(67294),l=s(60664),r=s(49837),c=s(91359),d=s(79072),u=s(87536),x=s(86501),m=s(45061),p=s(47842),v=s(86887),h=s(64165),f=s(60565),Z=s(83830),g=s(29308),D=s(67569),j=s(41088),b=s(40039);let C=e=>{var t,s;let{id:o,newChange:C,manualUrl:w,handleModalClose:y,handleConfirmNew:I,btnClose:S,outsideID:P}=e,[N,O]=(0,i.useState)(!1),[M,E]=(0,i.useState)(null),q=n(),A=o&&o>0?"edit":"new",k=q.pathname,{title:T}=(0,i.useContext)(f.f),{setId:V}=(0,i.useContext)(Z.X),{loggedUnity:F,user:U}=(0,i.useContext)(b.V),{startLoading:_,stopLoading:R}=(0,j.Z)(),{trigger:z,handleSubmit:X,reset:B,register:G,control:H,formState:{errors:J}}=(0,u.cI)({mode:"onChange"}),K=async e=>{let t={...e,usuarioID:U.usuarioID,unidadeID:F.unidadeID};_();try{"new"===A?await l.h.post("/cadastros/classificacao-produto/new/insertData",t).then(e=>{P?I(e.data):(q.push("/cadastros/classificacao-produto"),V(e.data)),x.ZP.success(h.OD.successNew)}):"edit"===A&&(await l.h.post("/cadastros/classificacao-produto/updateData/".concat(o),t),x.ZP.success(h.OD.successUpdate))}catch(s){s.response&&409===s.response.status?x.ZP.error(h.OD.errorRepeated):console.log(s)}finally{R()}},L=async()=>{try{await l.h.delete("".concat(k,"/").concat(o,"/").concat(U.usuarioID,"/").concat(F.unidadeID)),V(null),O(!1),x.ZP.success(h.OD.successDelete)}catch(e){e.response&&409===e.response.status?(x.ZP.error(h.OD.pendingDelete),O(!1)):console.log(e)}},Q=async()=>{try{"edit"===A?await l.h.post("".concat(k,"/getData/").concat(o),{id:o}).then(e=>{E(e.data),B(e.data)}):E({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,i.useEffect)(()=>{Q(),setTimeout(()=>{z()},300)},[o]),(0,a.jsxs)(a.Fragment,{children:[!M&&(0,a.jsx)(p.Z,{}),M&&(0,a.jsxs)("form",{onSubmit:X(K),id:"formItem",children:[(0,a.jsx)(v.Z,{btnCancel:!0,btnNew:!0,btnSave:!0,disabled:!1,manualUrl:w,btnClose:S,handleModalClose:y,handleSubmit:()=>X(K),btnDelete:"edit"===A,onclickDelete:()=>O(!0),type:A,outsideID:P}),(0,a.jsx)(r.Z,{children:(0,a.jsx)(c.Z,{children:(0,a.jsxs)(d.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(g.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:H,errors:null==J?void 0:null===(t=J.fields)||void 0===t?void 0:t.nome}),(0,a.jsx)(D.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==M?void 0:null===(s=M.fields)||void 0===s?void 0:s.status,typePage:A,register:G})]})})})]}),(0,a.jsx)(m.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+T.title,openModal:N,handleClose:()=>O(!1),handleSubmit:L,btnCancel:!0,btnConfirm:!0})]})};t.Z=C},69291:function(e,t,s){s.d(t,{Z:function(){return q}});var a=s(85893),o=s(11163),n=s.n(o),i=s(67294),l=s(60565),r=s(83830),c=s(60664),d=s(49837),u=s(91359),x=s(79072),m=s(59742),p=s(54225),v=s(87536),h=s(86501),f=s(47842),Z=s(45061),g=s(86887),D=s(64165),j=s(29308),b=s(84220),C=s(67569),w=s(40039),y=s(21609),I=s(88475),S=s(44373);let P=e=>{let{getValues:t,removeAnexo:s,setValue:o,control:n,register:l,errors:r,type:d}=e,[u,x]=(0,i.useState)([]),m=async()=>{let e=await c.h.post("/cadastros/produto/getFormularios");console.log("--> ",e.data),x(e.data)};return(0,i.useEffect)(()=>{m()},[]),t("anexos")&&t("anexos").map((e,c)=>{var x,m,p,v,h,f;return(0,a.jsxs)(i.Fragment,{children:[(0,a.jsx)(j.Z,{md:6,title:"Nome",name:"anexos[".concat(c,"].nome"),required:!0,control:n,errors:null==r?void 0:null===(x=r.anexos)||void 0===x?void 0:null===(m=x[c])||void 0===m?void 0:m.nome}),(0,a.jsx)(b.Z,{xs:12,md:3,title:"Formul\xe1rio",name:"anexos[".concat(c,"].formulario"),value:e.formulario,required:!0,options:null!=u?u:[],register:l,setValue:o,control:n,errors:null==r?void 0:null===(p=r.anexos)||void 0===p?void 0:null===(v=p[c])||void 0===v?void 0:v.formulario,helpText:"Formul\xe1rio em que ser\xe1 solicitado esse anexo para este produto"}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Obrigat\xf3rio",name:"anexos[".concat(c,"].obrigatorio"),value:1==e.obrigatorio,typePage:d,register:l}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"anexos[".concat(c,"].status"),value:1==e.obrigatorio,typePage:d,register:l}),(0,a.jsx)(I.Z,{xs:4,md:1,title:"Remover",index:c,removeItem:s,item:e,pending:e.hasPending,textSuccess:"Remover este item",textError:"Este item n\xe3o pode mais ser removido pois possui anexo vinculado a ele"}),(0,a.jsx)(j.Z,{xs:11,md:12,multiline:!0,items:4,title:"Descri\xe7\xe3o (opcional)",name:"anexos[".concat(c,"].descricao"),control:n,errors:null==r?void 0:null===(h=r.anexos)||void 0===h?void 0:null===(f=h[c])||void 0===f?void 0:f.descricao}),c<t("anexos").length-1&&(0,a.jsx)(S.Z,{})]},c)})};var N=s(41088),O=s(88771),M=s(1322);let E=e=>{var t,s,o,I;let{id:S,btnClose:E,handleConfirmNew:q,handleModalClose:A,newChange:k,manualUrl:T,outsideID:V}=e,[F,U]=(0,i.useState)(!1),[_,R]=(0,i.useState)(null),z=n(),X=S&&S>0?"edit":"new",B=z.pathname,{title:G}=(0,i.useContext)(l.f),{setId:H}=(0,i.useContext)(r.X),{loggedUnity:J,user:K}=(0,i.useContext)(w.V),[L,Q]=(0,i.useState)([]),[W,Y]=(0,i.useState)(!1),{startLoading:$,stopLoading:ee}=(0,N.Z)(),[et,es]=(0,i.useState)(!1),[ea,eo]=(0,i.useState)(!1),{trigger:en,handleSubmit:ei,setValue:el,reset:er,control:ec,getValues:ed,formState:{errors:eu},register:ex}=(0,v.cI)({mode:"onChange"}),em=async e=>{$();let t={...e,unidadeID:J.unidadeID,usuarioID:K.usuarioID,removedItems:L};console.log(t);try{"new"===X?await c.h.post("cadastros/produto/new/insertData",t).then(e=>{q?q(e.data,"produtos"):(z.push("".concat((0,D.g_)(B))),H(e.data.id)),h.ZP.success(D.OD.successNew)}):"edit"===X&&(await c.h.post("".concat(B,"/updateData/").concat(S),t),h.ZP.success(D.OD.successUpdate))}catch(s){s.response&&409===s.response.status?h.ZP.error(D.OD.errorRepeated):console.log(s)}finally{ee()}},ep=async()=>{try{await c.h.delete("".concat(B,"/").concat(S,"/").concat(K.usuarioID,"/").concat(J.unidadeID)),H(null),U(!1),h.ZP.success(D.OD.successDelete)}catch(e){e.response&&409===e.response.status?(h.ZP.error(D.OD.pendingDelete),U(!1)):console.log(e)}},ev=async()=>{try{let e="new"===X?"cadastros/produto/new/getData/".concat(J.unidadeID):"".concat(B,"/getData/").concat(S,"/").concat(J.unidadeID);await c.h.post(e).then(e=>{R(e.data),er(e.data)})}catch(t){console.log(t)}},eh=(e,t)=>{e.produtoAnexoID&&Q([...L,e.produtoAnexoID]);let s=ed("anexos").filter((e,s)=>s!==t);el("anexos",s),Y(!W)},ef=()=>{let e=[...ed("anexos"),{nome:"",obrigatorio:1,status:1,descricao:"",observacao:""}];el("anexos",e),Y(!W)},eZ=()=>{es(!0)},eg=async()=>{eo(!0)},eD=e=>{es(!1),el("classificacao.fields",e),eo(!ea)};return(0,i.useEffect)(()=>{ev(),setTimeout(()=>{en()},300)},[S]),(0,i.useEffect)(()=>{k&&ei(em)()},[k]),(0,a.jsxs)(a.Fragment,{children:[!_&&(0,a.jsx)(f.Z,{}),_&&(0,a.jsxs)("form",{onSubmit:ei(em),className:"space-y-3",children:[(0,a.jsx)(g.Z,{btnCancel:!0,btnNew:!q,btnSave:!0,btnClose:E,manualUrl:T,handleModalClose:A,handleSubmit:()=>ei(em),btnDelete:"edit"===X,onclickDelete:()=>U(!0),type:X,outsideID:V}),(0,a.jsx)(d.Z,{children:(0,a.jsx)(u.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(j.Z,{xs:11,md:5,title:"Nome",name:"fields.nome",required:!0,control:ec,errors:null==eu?void 0:null===(t=eu.fields)||void 0===t?void 0:t.nome}),(0,a.jsx)(b.Z,{xs:12,md:3,title:"Unidade de medida",name:"unidadeMedida.fields",value:null==_?void 0:_.unidadeMedida.fields,required:!0,options:_.unidadeMedida.options,register:ex,setValue:el,control:ec,errors:null==eu?void 0:null===(s=eu.unidadeMedida)||void 0===s?void 0:s.fields,helpText:"Selecione a unidade de medida"}),(0,a.jsx)(b.Z,{xs:12,md:3,title:"Classificação",name:"classificacao.fields",value:null==_?void 0:null===(o=_.classificacao)||void 0===o?void 0:o.fields,options:_.classificacao.options,register:ex,setValue:el,control:ec,errors:null==eu?void 0:null===(I=eu.classificacao)||void 0===I?void 0:I.fields,helpText:"Selecione a classificação",createNew:eZ}),(0,a.jsx)(C.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:_.fields.status,typePage:X,register:ex})]})})}),(0,a.jsxs)(d.Z,{children:[(0,a.jsx)(m.Z,{title:"Anexos"}),(0,a.jsx)(u.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(P,{getValues:ed,removeAnexo:eh,setValue:el,control:ec,register:ex,errors:eu,type:X},W),(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{variant:"outlined",color:"primary",sx:{mt:1},startIcon:(0,a.jsx)(y.Z,{icon:"material-symbols:add-circle-outline-rounded"}),onClick(){ef()},children:"Inserir Anexo"})})]})})]})]}),(0,a.jsx)(Z.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+G.title,openModal:F,handleClose:()=>U(!1),handleSubmit:ep,btnCancel:!0,btnConfirm:!0}),(0,a.jsx)(M.Z,{title:"Nova Classifica\xe7\xe3o de Produto",size:"md",openModal:et,setOpenModal:es,handleSave:eg,children:(0,a.jsx)(O.Z,{manualUrl:"/cadastros/classificacao-produto",btnClose:!0,handleModalClose:()=>es(!1),newChange:ea,handleConfirmNew:eD,outsideID:!0})})]})};var q=E}}]);