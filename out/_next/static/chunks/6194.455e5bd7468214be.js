"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6194],{62094:function(e,a,t){var o=t(85893),n=t(11163),s=t.n(n),l=t(67294),i=t(60664),r=t(49837),d=t(91359),c=t(79072),u=t(87536),m=t(86501),p=t(45061),x=t(71798),h=t(92477),f=t(47842),g=t(60565),D=t(83830),v=t(29308),b=t(67569),j=t(41088),I=t(40039);let Z=e=>{let{id:a,btnClose:t,handleModalClose:n,setNewChange:Z,newChange:C,outsideID:y,handleConfirmNew:S,manualUrl:w}=e,[P,E]=(0,l.useState)(!1),[F,M]=(0,l.useState)(null),{setId:N}=(0,l.useContext)(D.X),A=s(),V=a&&a>0?"edit":"new",k=A.pathname,{title:O}=(0,l.useContext)(g.f),{startLoading:R,stopLoading:_}=(0,j.Z)(),{user:H,loggedUnity:z}=(0,l.useContext)(I.V),q=(0,u.cI)({mode:"onChange"}),T=async e=>{let t={...e,usuarioID:H.usuarioID,unidadeID:z.unidadeID};R();try{"new"===V?await i.h.post("cadastros/tipo-veiculo/new/insertData",t).then(e=>{y?(N(y),S(e.data.value)):(A.push("".concat((0,x.g_)(k))),N(e.data.id)),m.ZP.success(x.OD.successNew)}):"edit"===V&&(await i.h.post("".concat(k,"/updateData/").concat(a),t),m.ZP.success(x.OD.successUpdate))}catch(o){o.response&&409===o.response.status?m.ZP.error(x.OD.errorRepeated):console.log(o)}finally{_()}},U=async()=>{try{await i.h.delete("".concat(k,"/").concat(a,"/").concat(H.usuarioID,"/").concat(z.unidadeID)),N(null),E(!1),m.ZP.success(x.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(x.OD.pendingDelete),E(!1)):console.log(e)}},B=async()=>{try{"edit"===V?await i.h.post("".concat(k,"/getData/").concat(a),{id:a}).then(e=>{M(e.data),q.reset(e.data)}):M({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{B(),setTimeout(()=>{q.trigger()},300)},[a]),(0,o.jsxs)(o.Fragment,{children:[!F&&(0,o.jsx)(f.Z,{}),F&&(0,o.jsxs)("form",{onSubmit:q.handleSubmit(T),children:[(0,o.jsx)(h.Z,{btnCancel:!0,btnNew:!S,btnSave:!0,manualUrl:w,btnClose:t,handleModalClose:n,handleSubmit:()=>q.handleSubmit(T),btnDelete:"edit"===V,onclickDelete:()=>E(!0),type:V,outsideID:y}),(0,o.jsx)(r.Z,{children:(0,o.jsx)(d.Z,{children:(0,o.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,o.jsx)(v.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:q}),(0,o.jsx)(b.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==F?void 0:F.fields.status,typePage:V,form:q})]})})})]}),(0,o.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+O.title,openModal:P,handleClose:()=>E(!1),handleSubmit:U,btnCancel:!0,btnConfirm:!0})]})};a.Z=Z},76904:function(e,a,t){var o=t(85893),n=t(11163),s=t.n(n),l=t(67294),i=t(60664),r=t(49837),d=t(91359),c=t(79072),u=t(87536),m=t(86501),p=t(45061),x=t(92477),h=t(71798),f=t(60565),g=t(83830),D=t(40039),v=t(29308),b=t(67569),j=t(41088);let I=e=>{let{id:a,btnClose:t,handleModalClose:n,setNewChange:I,newChange:Z,outsideID:C,handleConfirmNew:y,manualUrl:S}=e,[w,P]=(0,l.useState)(!1),[E,F]=(0,l.useState)(null),{setId:M}=(0,l.useContext)(g.X),N=s(),A=a&&a>0?"edit":"new",V=N.pathname,{title:k}=(0,l.useContext)(f.f),{loggedUnity:O,user:R}=(0,l.useContext)(D.V),{startLoading:_,stopLoading:H}=(0,j.Z)(),z=(0,u.cI)({mode:"onChange"}),q=async e=>{let t={...e,usuarioID:R.usuarioID,unidadeID:O.unidadeID};try{"new"===A?await i.h.post("cadastros/transportador/new/insertData",t).then(e=>{C?(M(C),y(e.data.value)):(N.push("".concat((0,h.g_)(V))),M(e.data.id)),m.ZP.success(h.OD.successNew)}):"edit"===A&&(await i.h.post("".concat(V,"/updateData/").concat(a),t),m.ZP.success(h.OD.successUpdate))}catch(o){o.response&&409===o.response.status?m.ZP.error(h.OD.errorRepeated):console.log(o)}finally{H()}},T=async()=>{try{await i.h.delete("".concat(V,"/").concat(a,"/").concat(R.usuarioID,"/").concat(O.unidadeID)),M(null),P(!1),m.ZP.success(h.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(h.OD.pendingDelete),P(!1)):console.log(e)}},U=async()=>{try{"edit"===A?await i.h.post("".concat(V,"/getData/").concat(a),{id:a}).then(e=>{F(e.data),z.reset(e.data)}):F({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{U(),setTimeout(()=>{z.trigger()},300)},[a]),(0,o.jsxs)(o.Fragment,{children:[E&&(0,o.jsxs)("form",{onSubmit:z.handleSubmit(q),children:[(0,o.jsx)(x.Z,{btnCancel:!0,btnNew:!y,btnSave:!0,manualUrl:S,btnClose:t,handleModalClose:n,handleSubmit:()=>z.handleSubmit(q),btnDelete:"edit"===A,onclickDelete:()=>P(!0),type:A,outsideID:C}),(0,o.jsx)(r.Z,{children:(0,o.jsx)(d.Z,{children:(0,o.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,o.jsx)(v.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,form:z}),(0,o.jsx)(b.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==E?void 0:E.fields.status,typePage:A,form:z})]})})})]}),(0,o.jsx)(p.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+k.title,openModal:w,handleClose:()=>P(!1),handleSubmit:T,btnCancel:!0,btnConfirm:!0})]})};a.Z=I},36194:function(e,a,t){t.d(a,{Z:function(){return Q}});var o=t(85893),n=t(67294),s=t(87536),l=t(99734),i=t(34282),r=t(29308),d=t(23895),c=t(7071),u=t(61953),m=t(49837),p=t(91359),x=t(29630),h=t(79072),f=t(55343),g=t(11163),D=t.n(g),v=t(71798),b=t(60664),j=t(92477),I=t(83830),Z=t(40039),C=t(39976),y=t(86501),S=t(66136),w=t(82755),P=t(44373),E=t(56531),F=t(50287),M=t(84220),N=t(44731);let A=e=>{var a,t,s;let{value:l}=e,{settings:i}=(0,n.useContext)(S.J6);return(0,o.jsx)(m.Z,{style:{height:"100%"},children:(0,o.jsx)(p.Z,{sx:{textAlign:"center"},children:(0,o.jsx)("div",{className:"flex flex-col items-center gap-1",children:(null==l?void 0:l.nome_)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"flex justify-center",children:(0,o.jsx)(N.Z,{variant:"rounded",sx:{width:70,height:70},className:"p-1 ".concat("dark"===i.mode?"!bg-[#e0e0e0]":"!bg-[#f5f5f5]"),children:(0,o.jsx)("img",{src:null!==(a=null==l?void 0:l.foto)&&void 0!==a?a:"/imageDefault/factory.svg",alt:"Imagem da logo da f\xe1brica"})})}),(0,o.jsx)(x.Z,{variant:"subtitle1",sx:{fontWeight:600},children:null==l?void 0:l.nome_}),(0,o.jsx)(x.Z,{variant:"subtitle2",children:null==l?void 0:l.cnpj_}),l.email?(0,o.jsx)(x.Z,{variant:"subtitle2",children:null==l?void 0:l.email}):(0,o.jsx)(x.Z,{variant:"subtitle2",color:"error",sx:{textTransform:"italic"},children:"E-mail n\xe3o informado"}),(null==l?void 0:l.telefone)&&(0,o.jsx)(x.Z,{variant:"subtitle2",children:null!==(t=null==l?void 0:l.telefone)&&void 0!==t?t:"--"}),(null==l?void 0:l.cidade)&&(0,o.jsx)(x.Z,{variant:"subtitle2",children:null!==(s=null==l?void 0:l.cidade)&&void 0!==s?s:"--"})]}):(0,o.jsx)(x.Z,{variant:"subtitle1",children:"-- Selecione um fornecedor --"})})})})};var V=t(22841),k=t(75158);t(3893);var O=t(21609);let R=e=>{let{value:a,index:t,apresentacoes:n,disabled:s,form:l}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.Z,{xs:12,md:2,title:"Quantidade",name:"produtos[".concat(t,"].quantidade"),disabled:s,mask:"fractioned3",form:l}),(0,o.jsx)(F.Z,{xs:12,md:2,title:"Data da fabrica\xe7\xe3o",value:a.dataFabricacao,name:"produtos[".concat(t,"].dataFabricacao"),disabled:s,typeValidation:"dataPassado",form:l}),(0,o.jsx)(r.Z,{xs:12,md:2,title:"N\xba Lote",name:"produtos[".concat(t,"].lote"),disabled:s,form:l}),(0,o.jsx)(M.Z,{xs:12,md:4,title:"Apresenta\xe7\xe3o",name:"produtos[".concat(t,"].apresentacao"),type:"string",options:null!=n?n:[],disabled:s,form:l}),(0,o.jsx)(F.Z,{xs:12,md:2,title:"Data de validade",value:a.dataValidade,name:"produtos[".concat(t,"].dataValidade"),disabled:s,form:l})]})},_=e=>{let{form:a,index:t,produto:s,setProdutos:l,handleCheck:i,disabled:r}=e;console.log("\uD83D\uDE80 ~ produto:",s);let[d,c]=(0,n.useState)([]),m=async()=>{try{let e=await b.h.get("/cadastros/apresentacao");c(e.data)}catch(a){console.log("\uD83D\uDE80 ~ error:",a)}};return(0,n.useEffect)(()=>{m()},[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(h.ZP,{container:!0,spacing:4,sx:{pb:2},children:[(0,o.jsx)("input",{type:"hidden",value:s.produtoID,name:"produtos[".concat(t,"].produtoID"),...a.register("produtos[".concat(t,"].produtoID"))}),(0,o.jsx)(h.ZP,{item:!0,xs:12,md:4,children:(0,o.jsx)(V.Z,{control:(0,o.jsx)(k.Z,{onClick:e=>i(e,t),checked:!!s.checked_,disabled:r}),label:s.nome,size:"small",sx:{marginRight:"4px","&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})}),(0,o.jsx)(h.ZP,{item:!0,xs:12,md:8,children:(0,o.jsx)(u.Z,{display:"flex",alignItems:"center",justifyContent:"end",sx:{gap:4,mt:3},children:(0,o.jsxs)(x.Z,{variant:"body2",children:["\xdaltima avalia\xe7\xe3o: ",s.ultimaAvaliacao]})})}),s.checked_&&(0,o.jsx)(R,{value:s,apresentacoes:d,index:t,disabled:r,form:a},s.produtoID)]})})};var H=t(22991);let z=e=>{var a,t;let{form:s,recebimentoMpID:l,modelo:i,values:d,fields:c,disabled:f,getAddressByCep:g,nameSelected:D,setNameSelected:v,columnSelected:j,setColumnSelected:I,openModalNew:C,setOpenModalNew:y,newChange:S,setNewChange:w,setProdutos:N,produtos:V}=e,{user:k,loggedUnity:R}=(0,n.useContext)(Z.V),[z,q]=(0,n.useState)([]),[T,U]=(0,n.useState)([]),[B,G]=(0,n.useState)(null),W=async()=>{let e=await b.h.post("/cadastros/setor/getProfissionaisSetoresAssinatura",{formularioID:2,modeloID:i.id,unidadeID:R.unidadeID});q(e.data.preenche),X(e.data.preenche)},L=async()=>{let e=await b.h.post("/formularios/fornecedor/getFornecedoresAprovados",{unidadeID:R.unidadeID,recebimentoMpID:l,modelo:i});U(e.data),J(d.fornecedor,e.data)},X=e=>{let a=k.profissionalID,t=e.find(e=>e.id===a);t&&t.id>0&&s.setValue("fieldsHeader.profissional",t)},J=(e,a)=>{var t,o;if(!e){G(null),N([]);return}let n=V.filter(e=>!0===e.checked_).map(e=>e.produtoID),l=null===(t=a.find(a=>a.id===e.id))||void 0===t?void 0:null===(o=t.produtos)||void 0===o?void 0:o.map(e=>n.includes(e.produtoID)?{...e,checked_:!0}:e);N(l),s.setValue("produtos",l)},K=(e,a)=>{let{checked:t}=e.target;s.setValue("produtos[".concat(a,"].checked_"),t);let o=V.map((e,o)=>o===a?{...e,checked_:t}:e);N(o)};return(0,n.useEffect)(()=>{L(),W()},[d]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(m.Z,{style:{height:"100%"},children:(0,o.jsxs)(p.Z,{children:[(0,o.jsxs)(h.ZP,{container:!0,alignItems:"stretch",spacing:6,children:[(0,o.jsx)(h.ZP,{item:!0,xs:12,sx:{textAlign:"right"},children:(0,o.jsx)(H.Z,{data:null!==(a=null==d?void 0:d.setores)&&void 0!==a?a:[]})}),(0,o.jsx)(h.ZP,{item:!0,xs:12,md:10,children:(0,o.jsxs)(h.ZP,{container:!0,spacing:4,children:[(0,o.jsx)(F.Z,{xs:12,md:2,title:"Data do recebimento",name:"fieldsHeader.data",type:"date",value:null!==(t=null==d?void 0:d.data)&&void 0!==t?t:new Date,disabled:f,typeValidation:"dataPassado",daysValidation:365,alertRequired:!0,form:s}),(0,o.jsx)(r.Z,{xs:12,md:2,title:"Hora do recebimento",name:"fieldsHeader.hora",type:"time",disabled:f,alertRequired:!0,form:s}),(0,o.jsx)(M.Z,{xs:12,md:4,title:"Profissional preenchimento",name:"fieldsHeader.profissional",type:"string",options:z,disabled:f,alertRequired:!0,form:s}),(0,o.jsx)(E.Z,{fields:c,values:c,getAddressByCep:g,disabled:f,nameSelected:D,setNameSelected:v,columnSelected:j,setColumnSelected:I,openModalNew:C,setOpenModalNew:y,newChange:S,setNewChange:w,form:s}),(0,o.jsx)(M.Z,{xs:12,md:12,title:"Fornecedor",name:"fieldsHeader.fornecedor",type:"string",options:null!=T?T:[],onChange:e=>J(e,T),value:null==d?void 0:d.fornecedor,disabled:f,form:s,alertRequired:!0})]})}),(0,o.jsx)(h.ZP,{item:!0,xs:12,md:2,children:(0,o.jsx)(A,{value:B})})]}),(0,o.jsxs)(h.ZP,{container:!0,alignItems:"stretch",spacing:6,sx:{mt:2},children:[(0,o.jsxs)(h.ZP,{item:!0,xs:12,children:[(0,o.jsxs)(x.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},className:"flex items-center gap-1",children:[(0,o.jsx)(O.Z,{icon:"ph:plant",className:"text-primary"}),"Produtos aprovados do fornecedor"]}),V&&0==V.length&&(0,o.jsx)(x.Z,{color:"warning",variant:"subtitle1",className:"italic",children:(0,o.jsxs)(u.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,o.jsx)(O.Z,{icon:"typcn:warning",color:"#FFC107"}),(0,o.jsx)("p",{children:"Nenhum fornecedor selecionado!"})]})})]}),(0,o.jsx)(h.ZP,{item:!0,xs:12,children:V&&V.map((e,a)=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(_,{index:a,produto:e,setProdutos:N,handleCheck:K,disabled:f,form:s},a),a<V.length-1&&(0,o.jsx)(P.Z,{})]}))})]})]})})})};var q=t(41088),T=t(92629),U=t(1503),B=t(76904),G=t(1322),W=t(62094),L=t(934),X=t(91757),J=t(60565);t(16247);let K=e=>{var a;let t;let{id:g,model:P}=e,{menu:E,user:F,hasPermission:M,loggedUnity:N,hasSectorPermission:A}=(0,n.useContext)(Z.V),[V,k]=(0,n.useState)(!1),{setTitle:O}=(0,n.useContext)(J.f),[R,_]=(0,n.useState)(!1),[H,K]=(0,n.useState)(!1),[Q,Y]=(0,n.useState)(!1),[$,ee]=(0,n.useState)(!1),[ea,et]=(0,n.useState)(!1),[eo,en]=(0,n.useState)(null),[es,el]=(0,n.useState)(!0),[ei,er]=(0,n.useState)(null),[ed,ec]=(0,n.useState)([]),[eu,em]=(0,n.useState)([]),[ep,ex]=(0,n.useState)(null),{createNewNotification:eh}=(0,n.useContext)(C.u),[ef,eg]=(0,n.useState)(!1),[eD,ev]=(0,n.useState)([]),[eb,ej]=(0,n.useState)([]),[eI,eZ]=(0,n.useState)([]),[eC,ey]=(0,n.useState)(null),[eS,ew]=(0,n.useState)([]),[eP,eE]=(0,n.useState)(null),[eF,eM]=(0,n.useState)(""),[eN,eA]=(0,n.useState)(!1),[eV,ek]=(0,n.useState)(!1),[eO,eR]=(0,n.useState)({status:!1,errors:[]}),[e_,eH]=(0,n.useState)(null),{settings:ez}=(0,n.useContext)(S.J6),{setId:eq}=(0,n.useContext)(I.X),{isLoading:eT,startLoading:eU,stopLoading:eB}=(0,q.Z)(),[eG,eW]=(0,n.useState)(!1),{setReportParameters:eL,sendPdfToServer:eX}=(0,U.Gc)(),[eJ,eK]=(0,n.useState)(!1),[eQ,eY]=(0,n.useState)(!1),[e$,e0]=(0,n.useState)(null),[e1,e2]=(0,n.useState)(null),[e3,e7]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),e4=D(),e9=g&&g>0?"edit":"new",e6="edit"==e9?e4.pathname:(0,v.g_)(e4.pathname),e8=(0,s.cI)({mode:"onChange"}),e5=()=>{eq(ei.modelo.id),e4.push("/configuracoes/formularios/recebimento-mp/")},ae=async e=>{let a={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:F.usuarioID,papelID:F.papelID,unidadeID:N.unidadeID}};try{ee(!0),await b.h.post("".concat(e6,"/changeFormStatus/").concat(g),a).then(e=>{y.ZP.success(v.OD.successUpdate),ee(!1),ap(ep,null,null)})}catch(t){console.log(t)}finally{k(!V)}},aa={id:1,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,o.jsx)(X.Z,{}),disabled:!!ea||!M(e4.pathname,"editar"),route:null,type:null,action:ae,modal:!0,size:"sm",icon:"heroicons:lock-open",identification:null},at=[];1==F.papelID&&eF.status>=40&&at.push(aa),1==F.papelID&&(t=!1,E.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(t=!0)})})}),t)&&at.push({id:2,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:e5,modal:!1,icon:"bi:gear",identification:null});let ao=async()=>{},an=()=>{eU();try{b.h.post("".concat(e6,"/getData"),{id:null!=g?g:0,type:e9,profissionalID:F.profissionalID,unidadeID:N.unidadeID,modeloID:null!=P?P:0}).then(e=>{var a,t,o,n;console.log("getData: ",e.data),ev(e.data.fieldsHeader),ej(e.data.fieldsFooter),eZ(e.data.fields),ec(e.data.produtos),ew(e.data.blocos),em(e.data.grupoAnexo),eM(e.data.info),er(e.data.unidade),ey(e.data.link),eE(e.data.ultimaMovimentacao),au(e.data.blocos),en(e.data.naoConformidade) //! Seta não conformidades
,e8.reset(e.data);let s=v.WR[null==e?void 0:null===(a=e.data)||void 0===a?void 0:null===(t=a.info)||void 0===t?void 0:t.status];ex(s),e7({status:!!(1==F.papelID&&e.data.info.status<40&&A(null!==(n=null===(o=e.data.fieldsHeader)||void 0===o?void 0:o.setores)&&void 0!==n?n:[])),message:e.data.info.status>40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":e.data.info.status<40?"Formul\xe1rio aberto para preenchimento!":40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o!":null,messageType:"info"}),ao()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e)}finally{eB()}},as=!1,al=[],ai=(e,a)=>{e8.setError(e,{type:"manual",message:"Campo obrigat\xf3rio"}),al.push(a),as=!0},ar=()=>{e8.clearErrors(),e8.getValues("fieldsHeader.data")||ai("fieldsHeader.data","Data da avalia\xe7\xe3o"),e8.getValues("fieldsHeader.hora")||ai("fieldsHeader.hora","Hora da avalia\xe7\xe3o"),null==eI||eI.forEach((e,a)=>{let t=e.tabela?"fields[".concat(a,"].").concat(e.tabela):"fields[".concat(a,"].").concat(e.nomeColuna),o=e8.getValues(t);1!==e.obrigatorio||o||ai(t,null==e?void 0:e.nomeCampo)}),ed&&ed.length>0&&ed.forEach((e,a)=>{e.produtoAnexosDescricao&&e.produtoAnexosDescricao.forEach((t,o)=>{1===t.obrigatorio&&0==t.anexos.length&&(e8.setError("produtos[".concat(a,"].produtoAnexosDescricao[").concat(o,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),al.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==t?void 0:t.nome)),as=!0)})}),eS.forEach((e,a)=>{e.itens.forEach((e,t)=>{let o=e8.getValues("blocos[".concat(a,"].itens[").concat(t,"].resposta"));(null==e?void 0:e.obrigatorio)!==1||o||(e8.setError("blocos[".concat(a,"].itens[").concat(t,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),al.push(null==e?void 0:e.nome),as=!0),e.respostaConfig&&1==e.respostaConfig.anexo&&e.respostaConfig.anexosSolicitados.length>0&&e.respostaConfig.anexosSolicitados.forEach((o,n)=>{1==o.obrigatorio&&o.anexos&&0==o.anexos.length&&(e8.setError("blocos[".concat(a,"].itens[").concat(t,"].respostaConfig.anexosSolicitados[").concat(n,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),al.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==o?void 0:o.nome)),as=!0)})})}),eu&&eu.length>0&&eu.forEach((e,a)=>{e.itens.forEach((t,o)=>{1===t.obrigatorio&&0==t.anexos.length&&(e8.setError("grupoAnexo[".concat(a,"].itens[").concat(o,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),al.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==t?void 0:t.nome)),as=!0)})}),eR({status:as,errors:al})},ad=async e=>{if(9===e.length){let a=e.replace(/[^0-9]/g,"");try{let t=await b.h.get("https://viacep.com.br/ws/".concat(a,"/json/"));t.data.localidade?(eI.forEach(async(e,a)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await setValue("fields[".concat(a,"].logradouro"),t.data.logradouro),await setValue("fields[".concat(a,"].bairro"),t.data.bairro),await setValue("fields[".concat(a,"].cidade"),t.data.localidade),await setValue("fields[".concat(a,"].estado"),t.data.uf))}),y.ZP.success("Endere\xe7o encontrado!")):y.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(o){console.error(o)}}},ac=e=>{eH(e),ar(),au(eS),eA(!0)},au=e=>{let a=!0;e.forEach(e=>{e.itens.forEach(e=>{e.resposta&&1==e.resposta.bloqueiaFormulario&&(a=!1)})}),el(a)},am=async e=>{e.conclusion=!0,await e8.handleSubmit(ax)(e)},ap=(e,a,t)=>{let o=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(o),descricao:"O formul\xe1rio de Fornecedor #".concat(g," est\xe1 ").concat(o,"."),url:"/formularios/fornecedor/",urlID:g,tipoNotificacaoID:6,usuarioGeradorID:F.usuarioID,usuarioID:0,unidadeID:N.unidadeID,papelID:1};if(n&&(eh(n),a)){let s={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(g," est\xe1 ").concat(o," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:t,tipoNotificacaoID:5,usuarioGeradorID:F.usuarioID,usuarioID:0,unidadeID:N.unidadeID,papelID:1};eh(s)}},ax=async function(e){var a,t;let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===o.conclusion&&(e.concluiForm=!0,e.info.status=null!==(a=o.status)&&void 0!==a?a:eF.status,e.obsConclusao=o.obsConclusao);let n={form:e,auth:{usuarioID:F.usuarioID,profissionalID:null!==(t=F.profissionalID)&&void 0!==t?t:0,papelID:F.papelID,unidadeID:N.unidadeID}};if(!0!=g){eA(!1);try{"edit"==e9?await b.h.post("".concat(e6,"/updateData/").concat(g),n).then(a=>{y.ZP.success(v.OD.successUpdate),ap(e.status,e.naoConformidade,null)}):"new"==e9?await b.h.post("".concat(e6,"/insertData"),n).then(e=>{eq(e.data.recebimentoMpID),e4.push("".concat(e6)),y.ZP.success(v.OD.successNew)}):y.ZP.error(v.OD.error)}catch(s){console.log("erro da fun\xe7\xe3o update/email",s)}finally{k(!V)}}},ah=async(e,a)=>{_(!0);let t=e.target.files;if(t&&t.length>0){var o;let n=new FormData;for(let s=0;s<t.length;s++)n.append("files[]",t[s]);n.append("usuarioID",F.usuarioID),n.append("unidadeID",N.unidadeID),n.append("grupoAnexoItemID",null!==(o=a.grupoAnexoItemID)&&void 0!==o?o:null),await b.h.post("".concat(e6,"/saveAnexo/").concat(g,"/grupo-anexo/").concat(F.usuarioID,"/").concat(ei.unidadeID),n).then(e=>{let a=e8.getValues();ax(a)}).catch(e=>{var a,t,o;y.ZP.error(null!==(o=null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)&&void 0!==o?o:"Erro ao atualizar anexo, tente novamente!")}).finally(()=>{_(!1),k(!V)})}},af=async(e,a)=>{Y(!0);let t=e.target.files;if(t&&t.length>0){var o,n;let s=new FormData;for(let l=0;l<t.length;l++)s.append("files[]",t[l]);s.append("usuarioID",F.usuarioID),s.append("unidadeID",N.unidadeID),s.append("parRecebimentoMpModeloBlocoID",null!==(o=a.parRecebimentoMpModeloBlocoID)&&void 0!==o?o:null),s.append("itemOpcaoAnexoID",null!==(n=a.itemOpcaoAnexoID)&&void 0!==n?n:null),await b.h.post("".concat(e6,"/saveAnexo/").concat(g,"/item/").concat(F.usuarioID,"/").concat(ei.unidadeID),s).then(e=>{let a=e8.getValues();ax(a)}).catch(e=>{var a,t,o;y.ZP.error(null!==(o=null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)&&void 0!==o?o:"Erro ao atualizar anexo, tente novamente!!!!")}).finally(()=>{Y(!1),k(!V)})}},ag=async e=>{e&&await b.h.delete("".concat(e6,"/deleteAnexo/").concat(g,"/").concat(e.anexoID,"/").concat(ei.unidadeID,"/").concat(F.usuarioID,"/item")).then(e=>{let a=e8.getValues();ax(a)}).catch(e=>{var a,t,o;y.ZP.error(null!==(o=null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)&&void 0!==o?o:"Erro ao remover anexo, tente novamente!")}).finally(()=>{an()})},aD=e=>{e.preventDefault();let a=e8.getValues();ax(a)};(0,n.useEffect)(()=>{O({title:"Recebimento de MP",subtitle:{id:g,count:1,new:!1}}),an()},[g,V]),(0,n.useEffect)(()=>{ar()},[eT]);let av=async e=>{eY(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("form",{onSubmit:e=>aD(e),children:[(0,o.jsx)(j.Z,{id:g,btnCancel:!0,btnSave:!eF.concluido,btnSend:1==F.papelID&&eF.status>=30&&!eF.concluido,btnPrint:"edit"==e9,btnDelete:eF.status<40,onclickDelete:()=>eW(!0),handleSubmit:()=>e8.handleSubmit(ax),handleSend:ac,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir",title:"Recebimento de MP",btnStatus:1==F.papelID&&"edit"==e9,handleBtnStatus:()=>eg(!0),type:e9,status:ep,actions:at.length>0,actionsData:at,module:"recebimentoMp",actionsNC:eF.naoConformidade&&eF.status>40},g),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"flex gap-2 mb-2",children:[ep&&(0,o.jsx)(c.Z,{size:"small",skin:"light",color:ep.color,label:ep.title,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}}),ei&&ei.modelo&&(0,o.jsx)(c.Z,{size:"small",HeaderFiel:!0,skin:"light",label:ei.modelo.nome,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}})]}),(0,o.jsxs)(u.Z,{display:"flex",flexDirection:"column",sx:{gap:6},children:[eF&&""!=eF.cabecalhoModelo&&(0,o.jsx)(m.Z,{children:(0,o.jsx)(p.Z,{children:(0,o.jsx)(x.Z,{variant:"subtitle1",children:eF.cabecalhoModelo})})}),ei&&(0,o.jsx)(z,{nameSelected:e1,setNameSelected:e2,columnSelected:e$,setColumnSelected:e0,openModalNew:eQ,setOpenModalNew:eY,newChange:eJ,setNewChange:eK,recebimentoMpID:g,modelo:ei.modelo,values:eD,fields:eI,disabled:!e3.status,getAddressByCep:ad,setProdutos:ec,produtos:ed,form:e8},ei.unidadeID),eS&&eS.map((e,a)=>(0,o.jsx)(l.Z,{form:e8,index:a,bloco:e,blockKey:"parRecebimentoMpModeloBlocoID",setBlocos:ew,blocos:eS,disabled:ea,handleFileSelect:af,handleRemoveAnexoItem:ag,status:eF.status})),eu&&eu.map((e,a)=>{var t;return(0,o.jsx)(d.Z,{values:{grupo:e,loadingFile:R,indexGrupo:a,handleFileSelect:ah,handleRemove:handleRemoveAnexoGroup,folder:"grupo-anexo",disabled:!e3.status,error:null===(t=e8.formState)||void 0===t?void 0:t.errors}},a)}),eF&&(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(m.Z,{children:(0,o.jsx)(p.Z,{children:(0,o.jsx)(h.ZP,{container:!0,spacing:4,children:(0,o.jsx)(h.ZP,{item:!0,xs:12,md:12,children:(0,o.jsxs)(f.Z,{fullWidth:!0,children:[(0,o.jsx)(x.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,o.jsx)(r.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:eF.obs,disabled:!e3.status,form:e8})]})})})})})}),(0,o.jsx)(L.Z,{id:g,parFormularioID:2},V),ef&&(0,o.jsx)(i.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(g," do Recebimento de MP."),id:g,parFormularioID:2,formStatus:eF.status,hasFormPending:ea,canChangeStatus:!1,openModal:ef,handleClose:()=>eg(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:!1}),(0,o.jsx)(w.Z,{openModal:eN,handleClose(){eA(!1),ar()},title:"Concluir Recebimento de MP",text:"Deseja realmente concluir este formul\xe1rio?",info:eF,canChange:!ea,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:am,listErrors:eO,canApprove:es,hasNaoConformidade:!0,type:"recebimentoMp",unity:ei,values:eb,formularioID:2,modeloID:null==ei?void 0:null===(a=ei.modelo)||void 0===a?void 0:a.id,form:e8}),(0,o.jsx)(T.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/recebimento-mp/delete/".concat(g),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eG,handleClose:()=>eW(!1)})]})]})]}),(0,o.jsx)(G.Z,{title:"transportadorID"==e$?"Novo transportador":"tipoVeiculoID"==e$?"Novo tipo de veiculo":"",size:"md",openModal:eQ,setOpenModal:eY,children:"transportadorID"==e$?(0,o.jsx)(B.Z,{btnClose:!0,handleModalClose:()=>eY(!1),setNewChange:eK,newChange:eJ,outsideID:!0,handleConfirmNew:av,manualUrl:"/cadastros/transportador"}):"tipoVeiculoID"==e$?(0,o.jsx)(W.Z,{btnClose:!0,handleModalClose:()=>eY(!1),setNewChange:eK,newChange:eJ,outsideID:!0,handleConfirmNew:av,manualUrl:"/cadastros/tipo-veiculo"}):null})]})};var Q=K}}]);