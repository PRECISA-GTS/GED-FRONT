"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3113],{91359:function(e,o,a){a.d(o,{Z:function(){return g}});var t=a(87462),n=a(63366),s=a(67294),l=a(86010),r=a(94780),i=a(67074),d=a(78884),c=a(1588),u=a(34867);function m(e){return(0,u.Z)("MuiCardContent",e)}(0,c.Z)("MuiCardContent",["root"]);var x=a(85893);let p=["className","component"],f=e=>{let{classes:o}=e;return(0,r.Z)({root:["root"]},m,o)},h=(0,i.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,o)=>o.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),v=s.forwardRef(function(e,o){let a=(0,d.Z)({props:e,name:"MuiCardContent"}),{className:s,component:r="div"}=a,i=(0,n.Z)(a,p),c=(0,t.Z)({},a,{component:r}),u=f(c);return(0,x.jsx)(h,(0,t.Z)({as:r,className:(0,l.Z)(u.root,s),ownerState:c,ref:o},i))});var g=v},49837:function(e,o,a){a.d(o,{Z:function(){return b}});var t=a(87462),n=a(63366),s=a(67294),l=a(86010),r=a(94780),i=a(67074),d=a(78884),c=a(70918),u=a(1588),m=a(34867);function x(e){return(0,m.Z)("MuiCard",e)}(0,u.Z)("MuiCard",["root"]);var p=a(85893);let f=["className","raised"],h=e=>{let{classes:o}=e;return(0,r.Z)({root:["root"]},x,o)},v=(0,i.ZP)(c.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,o)=>o.root})(()=>({overflow:"hidden"})),g=s.forwardRef(function(e,o){let a=(0,d.Z)({props:e,name:"MuiCard"}),{className:s,raised:r=!1}=a,i=(0,n.Z)(a,f),c=(0,t.Z)({},a,{raised:r}),u=h(c);return(0,p.jsx)(v,(0,t.Z)({className:(0,l.Z)(u.root,s),elevation:r?8:void 0,ref:o,ownerState:c},i))});var b=g},62094:function(e,o,a){var t=a(85893),n=a(11163),s=a.n(n),l=a(67294),r=a(60664),i=a(49837),d=a(91359),c=a(79072),u=a(87536),m=a(86501),x=a(45061),p=a(64165),f=a(86887),h=a(47842),v=a(60565),g=a(83830),b=a(29308),D=a(67569),j=a(41088),Z=a(40039);let C=e=>{var o;let{id:a,btnClose:n,handleModalClose:C,setNewChange:I,newChange:y,outsideID:S,handleConfirmNew:P,manualUrl:w}=e,[F,N]=(0,l.useState)(!1),[M,E]=(0,l.useState)(null),{setId:V}=(0,l.useContext)(g.X),k=s(),A=a&&a>0?"edit":"new",O=k.pathname,{title:R}=(0,l.useContext)(v.f),{startLoading:H,stopLoading:q}=(0,j.Z)(),{user:z,loggedUnity:_}=(0,l.useContext)(Z.V),{trigger:T,handleSubmit:B,reset:W,control:U,formState:{errors:G},register:X}=(0,u.cI)({mode:"onChange"}),L=async e=>{let o={...e,usuarioID:z.usuarioID,unidadeID:_.unidadeID};H();try{"new"===A?await r.h.post("cadastros/tipo-veiculo/new/insertData",o).then(e=>{S?(V(S),P(e.data.value)):(k.push("".concat((0,p.g_)(O))),V(e.data.id)),m.ZP.success(p.OD.successNew)}):"edit"===A&&(await r.h.post("".concat(O,"/updateData/").concat(a),o),m.ZP.success(p.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(p.OD.errorRepeated):console.log(t)}finally{q()}},J=async()=>{try{await r.h.delete("".concat(O,"/").concat(a,"/").concat(z.usuarioID,"/").concat(_.unidadeID)),V(null),N(!1),m.ZP.success(p.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(p.OD.pendingDelete),N(!1)):console.log(e)}},K=async()=>{try{"edit"===A?await r.h.post("".concat(O,"/getData/").concat(a),{id:a}).then(e=>{E(e.data),W(e.data)}):E({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{K(),setTimeout(()=>{T()},300)},[a]),(0,t.jsxs)(t.Fragment,{children:[!M&&(0,t.jsx)(h.Z,{}),M&&(0,t.jsxs)("form",{onSubmit:B(L),children:[(0,t.jsx)(f.Z,{btnCancel:!0,btnNew:!P,btnSave:!0,manualUrl:w,btnClose:n,handleModalClose:C,handleSubmit:()=>B(L),btnDelete:"edit"===A,onclickDelete:()=>setOpenDelete(!0),type:A,outsideID:S}),(0,t.jsx)(i.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(b.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:U,errors:null==G?void 0:null===(o=G.fields)||void 0===o?void 0:o.nome}),(0,t.jsx)(D.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==M?void 0:M.fields.status,typePage:A,register:X})]})})})]}),(0,t.jsx)(x.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+R.title,openModal:F,handleClose:()=>N(!1),handleSubmit:J,btnCancel:!0,btnConfirm:!0})]})};o.Z=C},76904:function(e,o,a){var t=a(85893),n=a(11163),s=a.n(n),l=a(67294),r=a(60664),i=a(49837),d=a(91359),c=a(79072),u=a(87536),m=a(86501),x=a(45061),p=a(86887),f=a(64165),h=a(60565),v=a(83830),g=a(40039),b=a(29308),D=a(67569),j=a(41088);let Z=e=>{var o;let{id:a,btnClose:n,handleModalClose:Z,setNewChange:C,newChange:I,outsideID:y,handleConfirmNew:S,manualUrl:P}=e,[w,F]=(0,l.useState)(!1),[N,M]=(0,l.useState)(null),{setId:E}=(0,l.useContext)(v.X),V=s(),k=a&&a>0?"edit":"new",A=V.pathname,{title:O}=(0,l.useContext)(h.f),{loggedUnity:R,user:H}=(0,l.useContext)(g.V),{startLoading:q,stopLoading:z}=(0,j.Z)(),{trigger:_,handleSubmit:T,reset:B,control:W,formState:{errors:U},register:G}=(0,u.cI)({mode:"onChange"}),X=async e=>{let o={...e,usuarioID:H.usuarioID,unidadeID:R.unidadeID};try{"new"===k?await r.h.post("cadastros/transportador/new/insertData",o).then(e=>{y?(E(y),S(e.data.value)):(V.push("".concat((0,f.g_)(A))),E(e.data.id)),m.ZP.success(f.OD.successNew)}):"edit"===k&&(await r.h.post("".concat(A,"/updateData/").concat(a),o),m.ZP.success(f.OD.successUpdate))}catch(t){t.response&&409===t.response.status?m.ZP.error(f.OD.errorRepeated):console.log(t)}finally{z()}},L=async()=>{try{await r.h.delete("".concat(A,"/").concat(a,"/").concat(H.usuarioID,"/").concat(R.unidadeID)),E(null),F(!1),m.ZP.success(f.OD.successDelete)}catch(e){e.response&&409===e.response.status?(m.ZP.error(f.OD.pendingDelete),F(!1)):console.log(e)}},J=async()=>{try{"edit"===k?await r.h.post("".concat(A,"/getData/").concat(a),{id:a}).then(e=>{M(e.data),B(e.data)}):M({fields:{nome:"",status:1}})}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{J(),setTimeout(()=>{_()},300)},[a]),(0,t.jsxs)(t.Fragment,{children:[N&&(0,t.jsxs)("form",{onSubmit:T(X),children:[(0,t.jsx)(p.Z,{btnCancel:!0,btnNew:!S,btnSave:!0,manualUrl:P,btnClose:n,handleModalClose:Z,handleSubmit:()=>T(X),btnDelete:"edit"===k,onclickDelete:()=>setOpenDelete(!0),type:k,outsideID:y}),(0,t.jsx)(i.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(c.ZP,{container:!0,spacing:5,children:[(0,t.jsx)(b.Z,{xs:11,md:11,title:"Nome",name:"fields.nome",required:!0,control:W,errors:null==U?void 0:null===(o=U.fields)||void 0===o?void 0:o.nome}),(0,t.jsx)(D.Z,{xs:1,md:1,title:"Ativo",name:"fields.status",value:null==N?void 0:N.fields.status,typePage:k,register:G})]})})})]}),(0,t.jsx)(x.Z,{text:"Tem certeza que deseja excluir?",title:"Excluir "+O.title,openModal:w,handleClose:()=>F(!1),handleSubmit:L,btnCancel:!0,btnConfirm:!0})]})};o.Z=Z},24527:function(e,o,a){var t=a(85893),n=a(79072),s=a(49837),l=a(91359),r=a(61953),i=a(29630),d=a(21609),c=a(62097);let u=e=>{let{xs:o,md:a,icon:u,id:m,title:x,subtitle:p,action:f,handleClick:h,linkedsForms:v}=e,g=(0,c.Z)();return(0,t.jsx)(n.ZP,{item:!0,xs:o,md:a,children:(0,t.jsx)(s.Z,{sx:{"&:hover":{backgroundColor:"".concat(g.palette.action.hover)},height:"100%",display:"flex",flexDirection:"column"},onClick:h,className:"cursor-pointer shadow-xl transition-all",children:(0,t.jsx)(l.Z,{className:"text-center",sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:(0,t.jsxs)(r.Z,{display:"flex",flexDirection:"column",alignItems:"center",sx:{gap:3,padding:6},children:[(0,t.jsx)(d.Z,{icon:u,width:38,className:"text-[#F8D552]"}),(0,t.jsx)(i.Z,{variant:"h6",className:"!font-extrabold",children:x}),(0,t.jsx)(i.Z,{variant:"subtitle2",children:p}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(d.Z,{icon:"new"==f?"icon-park-solid:add-one":"edit"==f?"grommet-icons:form-next-link":"tabler:select",width:16}),(0,t.jsx)(i.Z,{variant:"body2",color:"primary",children:"new"==f?"Criar novo":"edit"==f?"Acessar":"Selecionar"})]}),(e=>{if(!v)return;let o=v.find(o=>o===e);return!o})(m)&&(0,t.jsx)(i.Z,{variant:"body2",color:"error",children:"Formul\xe1rio n\xe3o vinculado"})]})})})})};o.Z=u},47842:function(e,o,a){var t=a(85893),n=a(70754);let s=e=>{let{show:o,title:a,customTextProps:s,...l}=e;return o&&(0,t.jsx)("div",{className:"fixed inset-0 flex items-center justify-center rounded-lg z-50",children:(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center gap-2 ",children:[(0,t.jsx)(n.Z,{color:"primary",...l}),(0,t.jsx)("p",{className:"opacity-80 text-sm ".concat(s),children:null!=a?a:"Carregando..."})]})})};o.Z=s},73113:function(e,o,a){a.d(o,{Z:function(){return ei}});var t=a(85893),n=a(67294),s=a(87536),l=a(99734),r=a(34282),i=a(29308),d=a(23895),c=a(7071),u=a(61953),m=a(49837),x=a(91359),p=a(29630),f=a(79072),h=a(55343),v=a(11163),g=a.n(v),b=a(64165),D=a(60664),j=a(86887),Z=a(83830),C=a(40039),I=a(39976),y=a(47842),S=a(86501),P=a(66136),w=a(80377),F=a(56531),N=a(50287),M=a(84220),E=a(44731);let V=e=>{var o,a,s;let{value:l}=e,{settings:r}=(0,n.useContext)(P.J6);return(0,t.jsx)(m.Z,{style:{height:"100%"},children:(0,t.jsx)(x.Z,{sx:{textAlign:"center"},children:(0,t.jsx)("div",{className:"flex flex-col items-center gap-1",children:(null==l?void 0:l.nome_)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(E.Z,{variant:"rounded",sx:{width:70,height:70},className:"p-1 ".concat("dark"===r.mode?"!bg-[#e0e0e0]":"!bg-[#f5f5f5]"),children:(0,t.jsx)("img",{src:null!==(o=null==l?void 0:l.foto)&&void 0!==o?o:"/imageDefault/factory.svg",alt:"Imagem da logo da f\xe1brica"})})}),(0,t.jsx)(p.Z,{variant:"subtitle1",sx:{fontWeight:600},children:null==l?void 0:l.nome_}),(0,t.jsx)(p.Z,{variant:"subtitle2",children:null==l?void 0:l.cnpj_}),l.email?(0,t.jsx)(p.Z,{variant:"subtitle2",children:null==l?void 0:l.email}):(0,t.jsx)(p.Z,{variant:"subtitle2",color:"error",sx:{textTransform:"italic"},children:"E-mail n\xe3o informado"}),(null==l?void 0:l.telefone)&&(0,t.jsx)(p.Z,{variant:"subtitle2",children:null!==(a=null==l?void 0:l.telefone)&&void 0!==a?a:"--"}),(null==l?void 0:l.cidade)&&(0,t.jsx)(p.Z,{variant:"subtitle2",children:null!==(s=null==l?void 0:l.cidade)&&void 0!==s?s:"--"})]}):(0,t.jsx)(p.Z,{variant:"subtitle1",children:"-- Selecione um fornecedor --"})})})})};var k=a(22841),A=a(75158),O=a(44373),R=a(3893),H=a(21609);let q=e=>{var o,a,n,s,l,r,d,c,u,m;let{value:x,index:p,apresentacoes:f,setValue:h,register:v,control:g,errors:b,disabled:D}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Z,{xs:12,md:2,title:"Quantidade",name:"produtos[".concat(p,"].quantidade"),register:v,control:g,errors:null==b?void 0:null===(o=b.produtos)||void 0===o?void 0:null===(a=o[p])||void 0===a?void 0:a.quantidade,disabled:D,mask:"fractioned3"}),(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data da fabrica\xe7\xe3o",value:x.dataFabricacao,name:"produtos[".concat(p,"].dataFabricacao"),control:g,errors:null==b?void 0:null===(n=b.produtos)||void 0===n?void 0:null===(s=n[p])||void 0===s?void 0:s.dataFabricacao,disabled:D,typeValidation:"dataPassado"}),(0,t.jsx)(i.Z,{xs:12,md:2,title:"N\xba Lote",name:"produtos[".concat(p,"].lote"),register:v,control:g,errors:null==b?void 0:null===(l=b.produtos)||void 0===l?void 0:null===(r=l[p])||void 0===r?void 0:r.lote,disabled:D}),(0,t.jsx)(M.Z,{xs:12,md:4,title:"Apresenta\xe7\xe3o",name:"produtos[".concat(p,"].apresentacao"),type:"string",options:null!=f?f:[],register:v,setValue:h,control:g,errors:null==b?void 0:null===(d=b.produtos)||void 0===d?void 0:null===(c=d[p])||void 0===c?void 0:c.apresentacao,disabled:D}),(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data de validade",value:x.dataValidade,name:"produtos[".concat(p,"].dataValidade"),control:g,errors:null==b?void 0:null===(u=b.produtos)||void 0===u?void 0:null===(m=u[p])||void 0===m?void 0:m.dataValidade,disabled:D})]})},z=e=>{let{produtos:o,setProdutos:a,getValues:s,setValue:l,register:r,control:i,errors:d,disabled:c}=e,[m,x]=(0,n.useState)([]),h=async()=>{try{let e=await D.h.get("/cadastros/apresentacao");x(e.data)}catch(o){console.log("\uD83D\uDE80 ~ error:",o)}},v=(e,t)=>{let{checked:n}=e.target;l("produtos[".concat(t,"].checked_"),n);let s=[...o];s[t].checked_=n,a(s)};return(0,n.useEffect)(()=>{h()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700,mb:2},children:"Produtos aprovados do fornecedor"}),o&&0==o.length&&(0,t.jsx)(p.Z,{color:"warning",variant:"subtitle1",className:"italic",children:(0,t.jsxs)(u.Z,{display:"flex",alignItems:"center",sx:{gap:1},children:[(0,t.jsx)(H.Z,{icon:"typcn:warning",color:"#FFC107"}),(0,t.jsx)("p",{children:"Nenhum fornecedor selecionado!"})]})}),o&&o.length>0&&o.map((e,a)=>(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"hidden",value:e.produtoID,name:"produtos[".concat(a,"].produtoID"),...r("produtos[".concat(a,"].produtoID"))}),(0,t.jsxs)(f.ZP,{container:!0,spacing:4,sx:{pb:2},children:[(0,t.jsx)(f.ZP,{item:!0,xs:12,md:4,children:(0,t.jsx)(k.Z,{control:(0,t.jsx)(A.Z,{onClick:e=>v(e,a),defaultChecked:e.checked_,disabled:c}),label:e.nome,size:"small",sx:{marginRight:"4px","&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:8,children:(0,t.jsx)(u.Z,{display:"flex",alignItems:"center",justifyContent:"end",sx:{gap:4,mt:3},children:(0,t.jsxs)(p.Z,{variant:"body2",children:["\xdaltima avalia\xe7\xe3o: ",e.ultimaAvaliacao]})})}),e&&e.checked_&&(0,t.jsx)(q,{value:e,apresentacoes:m,index:a,setValue:l,register:r,control:i,errors:d,disabled:c},a)]}),a<o.length-1&&(0,t.jsx)(O.Z,{})]},a))]})};var _=a(22991);let T=e=>{var o,a,s,l,r,d,c,u,p;let{recebimentoMpID:h,modelo:v,values:g,produtosRecebimento:b,fields:j,disabled:Z,register:I,errors:y,getValues:S,setValue:P,control:w,getAddressByCep:E,nameSelected:k,setNameSelected:A,columnSelected:O,setColumnSelected:R,openModalNew:H,setOpenModalNew:q,newChange:T,setNewChange:B}=e,{user:W,loggedUnity:U}=(0,n.useContext)(C.V),[G,X]=(0,n.useState)([]),[L,J]=(0,n.useState)([]),[K,Q]=(0,n.useState)(null),[Y,$]=(0,n.useState)([]),[ee,eo]=(0,n.useState)(!1),ea=async()=>{let e=await D.h.post("/cadastros/setor/getProfissionaisSetoresAssinatura",{formularioID:2,modeloID:v.id,unidadeID:U.unidadeID});X(e.data.preenche),en(e.data.preenche)},et=async()=>{let e=await D.h.post("/formularios/fornecedor/getFornecedoresAprovados",{unidadeID:U.unidadeID,recebimentoMpID:h,modelo:v});J(e.data),es(g.fornecedor,e.data,!1)},en=e=>{let o=W.profissionalID,a=e.find(e=>e.id===o);a&&a.id>0&&P("fieldsHeader.profissional",a)},es=(e,o,a)=>{if(eo(!ee),!e){Q(null),$([]);return}o&&o.forEach(o=>{o.id===e.id&&(!a&&b&&b.length>0&&b.map(e=>{o.produtos.forEach(o=>{o.produtoID===e.produto.id&&(o.checked_=!0)})}),a&&o.produtos.forEach(e=>{e.checked_=!1}),Q(o),$(o.produtos))})};return(0,n.useEffect)(()=>{et(),ea()},[]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.Z,{style:{height:"100%"},children:(0,t.jsxs)(x.Z,{children:[(0,t.jsxs)(f.ZP,{container:!0,alignItems:"stretch",spacing:6,children:[(0,t.jsx)(f.ZP,{item:!0,xs:12,sx:{textAlign:"right"},children:(0,t.jsx)(_.Z,{data:null!==(u=null==g?void 0:g.setores)&&void 0!==u?u:[]})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:10,children:(0,t.jsxs)(f.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data da abertura",name:"fieldsHeader.abertoPor.dataInicio",type:"date",value:null==g?void 0:null===(o=g.abertoPor)||void 0===o?void 0:o.dataInicio,disabled:!0,control:w,alertRequired:!0}),(0,t.jsx)(i.Z,{xs:12,md:2,title:"Hora da abertura",name:"fieldsHeader.abertoPor.horaInicio",type:"time",disabled:!0,register:I,control:w,alertRequired:!0}),(0,t.jsx)(i.Z,{xs:12,md:8,title:"Profissional que abriu",name:"fieldsHeader.abertoPor.profissional.nome",value:null==g?void 0:null===(a=g.abertoPor)||void 0===a?void 0:null===(s=a.profissional)||void 0===s?void 0:s.nome,disabled:!0,register:I,control:w,alertRequired:!0}),(0,t.jsx)(N.Z,{xs:12,md:2,title:"Data da avalia\xe7\xe3o",name:"fieldsHeader.data",type:"date",value:null!==(p=null==g?void 0:g.data)&&void 0!==p?p:new Date,disabled:Z,register:I,control:w,typeValidation:"dataPassado",daysValidation:365,errors:null==y?void 0:null===(l=y.fieldsHeader)||void 0===l?void 0:l.data,alertRequired:!0}),(0,t.jsx)(i.Z,{xs:12,md:2,title:"Hora da avalia\xe7\xe3o",name:"fieldsHeader.hora",type:"time",disabled:Z,register:I,control:w,errors:null==y?void 0:null===(r=y.fieldsHeader)||void 0===r?void 0:r.hora,alertRequired:!0}),(0,t.jsx)(M.Z,{xs:12,md:4,title:"Profissional preenchimento",name:"fieldsHeader.profissional",type:"string",options:G,disabled:Z,register:I,setValue:P,control:w,errors:null==y?void 0:null===(d=y.fieldsHeader)||void 0===d?void 0:d.profissional,alertRequired:!0}),(0,t.jsx)(F.Z,{register:I,errors:y,setValue:P,control:w,fields:j,values:j,getAddressByCep:E,disabled:Z,nameSelected:k,setNameSelected:A,getValues:S,columnSelected:O,setColumnSelected:R,openModalNew:H,setOpenModalNew:q,newChange:T,setNewChange:B}),(0,t.jsx)(M.Z,{xs:12,md:12,title:"Fornecedor",name:"fieldsHeader.fornecedor",type:"string",options:L,onChange:e=>es(e,L,!0),value:null==g?void 0:g.fornecedor,disabled:Z,register:I,setValue:P,control:w,errors:null==y?void 0:null===(c=y.fieldsHeader)||void 0===c?void 0:c.fornecedor,alertRequired:!0})]})}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:2,children:(0,t.jsx)(V,{value:K})})]}),(0,t.jsx)(f.ZP,{container:!0,alignItems:"stretch",spacing:6,sx:{mt:2},children:(0,t.jsx)(f.ZP,{item:!0,xs:12,children:(0,t.jsx)(z,{produtos:Y,setProdutos:$,getValues:S,setValue:P,register:I,control:w,errors:y,disabled:Z},ee)})})]})})})};a(30381);var B=a(41088),W=a(92629),U=a(1503),G=a(54225),X=a(62135);let L=e=>{var o,a;let{index:s,value:l,info:r,papelID:d,produtos:c,handlePreenchimentoFornecedor:u,getValues:m,register:x,control:p,setValue:h,errors:v}=e,[g,b]=(0,n.useState)(null!==(o=l.tipo)&&void 0!==o?o:1),D=e=>{b(e),h("naoConformidade.itens[".concat(s,"].tipo"),e)};return(0,t.jsxs)(t.Fragment,{children:[1==d&&(0,t.jsx)(R.Z,{xs:12,md:4,onClick:u,title:"Fornecedor preenche?",name:"naoConformidade.itens[".concat(s,"].fornecedorPreenche"),value:l.fornecedorPreenche,disabled:r.concluido,register:x,helpText:"Se marcado, o fornecedor deve preencher o plano de a\xe7\xe3o com seu acesso ao sistema."}),(0,t.jsxs)(f.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(N.Z,{xs:12,md:3,title:"Data",name:"naoConformidade.itens[".concat(s,"].data"),type:"date",value:null==l?void 0:l.data,disabled:r.concluido||1!=d,register:x,control:p,typeValidation:"dataPassado",daysValidation:999999999999,errors:null}),(0,t.jsx)(i.Z,{xs:12,md:3,title:"Hora",name:"naoConformidade.itens[".concat(s,"].hora"),disabled:r.concluido||1!=d,type:"time",register:x,control:p,errors:null}),(0,t.jsx)(M.Z,{xs:12,md:6,title:"Profissional preenchimento",name:"naoConformidade.itens[".concat(s,"].profissionalPreenchimento"),disabled:r.concluido||1!=d,type:"string",options:null!==(a=l.profissionaisOptions.preenchimento)&&void 0!==a?a:[],register:x,setValue:h,control:p,errors:null}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:3,children:(0,t.jsxs)(X.Z,{color:"primary",fullWidth:!0,className:"mt-1",disabled:r.concluido||1!=d,children:[(0,t.jsx)(G.Z,{onClick:()=>D(1),variant:1===g?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 px-1",children:[(0,t.jsx)(H.Z,{icon:"ph:plant"}),(0,t.jsx)("p",{className:"capitalize",children:"Produto"})]})}),(0,t.jsx)(G.Z,{onClick:()=>D(2),variant:2===g?"contained":"outlined",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 py-[2px] px-1",children:[(0,t.jsx)(H.Z,{icon:"mdi:truck-fast-outline"}),(0,t.jsx)("p",{className:"capitalize",children:"Transporte"})]})})]})}),(0,t.jsx)(M.Z,{xs:12,md:9,title:"Produto",name:"naoConformidade.itens[".concat(s,"].produto"),type:"string",disabled:1!=g||r.concluido||1!=d,options:null!=c?c:[],register:x,setValue:h,control:p,errors:null}),l.dynamicFields&&l.dynamicFields.length>0&&l.dynamicFields.map((e,o)=>(0,t.jsx)(i.Z,{xs:12,md:12,multiline:!0,rows:4,title:e.nomeCampo,value:e.valor,disabled:r.concluido||1!=d,name:"naoConformidade.itens[".concat(s,"].dynamicFields[").concat(o,"].value"),required:1==e.obrigatorio,register:x,control:p},o))]})]})},J=e=>{let{index:o,value:a,info:s,papelID:l,register:r,control:d,setValue:c,errors:u}=e,{settings:m}=(0,n.useContext)(P.J6);return(0,t.jsx)(t.Fragment,{children:a&&a.fornecedorPreenche&&(0,t.jsxs)("div",{className:"".concat("dark"==m.mode?"bg-[#353D39]":"bg-[#E2EAE4]"," p-5 rounded-xl border border-[#4A8B57]"),children:[(0,t.jsx)(p.Z,{variant:"subtitle1",color:"primary",sx:{fontWeight:700,pb:5},children:"Preenchimento realizado pelo Fornecedor"}),(0,t.jsxs)(f.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(i.Z,{xs:12,md:12,multiline:!0,rows:4,title:"Observa\xe7\xf5es do Fornecedor",name:"naoConformidade.itens[".concat(o,"].obsFornecedor"),disabled:s.concluido||2!=l,control:d,errors:null}),(0,t.jsx)(N.Z,{xs:12,md:3,title:"Data",name:"naoConformidade.itens[".concat(o,"].dataFornecedor"),type:"date",value:null==a?void 0:a.dataFornecedor,register:r,disabled:s.concluido||2!=l,control:d,typeValidation:"dataPassado",daysValidation:999999999999,errors:null}),(0,t.jsx)(i.Z,{xs:12,md:3,title:"Hora",name:"naoConformidade.itens[".concat(o,"].horaFornecedor"),disabled:s.concluido||2!=l,type:"time",register:r,control:d,errors:null}),(0,t.jsx)(M.Z,{xs:12,md:6,title:"Profissional preenchimento",name:"naoConformidade.itens[".concat(o,"].usuarioFornecedor"),disabled:s.concluido||2!=l,type:"string",options:[],register:r,setValue:c,control:d,errors:null})]})]})})};var K=a(8519),Q=a(41470);let Y=e=>{var o;let{index:a,value:n,info:s,papelID:l,register:r,control:d,setValue:c,handleChangeStatus:u,errors:m}=e,x=[{id:1,nome:"Conforme"},{id:2,nome:"N\xe3o Conforme"}];return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(f.ZP,{container:!0,spacing:4,sx:{paddingTop:2},children:[(0,t.jsx)(i.Z,{xs:12,md:12,multiline:!0,rows:4,title:"Conclus\xe3o",name:"naoConformidade.itens[".concat(a,"].conclusao"),disabled:s.concluido||1!=l,control:d,errors:null}),(0,t.jsx)(f.ZP,{item:!0,xs:12,md:12,children:(0,t.jsx)(Q.Z,{row:!0,name:"naoConformidade.itens[".concat(a,"].status"),defaultValue:null==n?void 0:n.status,onChange:e=>u(a,e.target.value),sx:{mt:0},children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(p.Z,{variant:"subtitle2",sx:{pb:0},children:"Avalia\xe7\xe3o Final:"}),x&&x.map((e,o)=>(0,t.jsx)(k.Z,{value:e.id,label:e.nome,control:(0,t.jsx)(K.Z,{disabled:!1,error:!1,sx:{pr:2}}),disabled:s.concluido||1!=l,fullWidth:!0,sx:{"& .MuiFormControlLabel-label":{fontSize:"0.8rem",color:"text.secondary"},"&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}},o))]})})}),(0,t.jsx)(N.Z,{xs:12,md:3,title:"Data",name:"naoConformidade.itens[".concat(a,"].dataConclusao"),type:"date",value:null==n?void 0:n.dataConclusao,disabled:s.concluido||1!=l,register:r,control:d,typeValidation:"dataPassado",daysValidation:999999999999,errors:null}),(0,t.jsx)(i.Z,{xs:12,md:3,title:"Hora",name:"naoConformidade.itens[".concat(a,"].horaConclusao"),disabled:s.concluido||1!=l,type:"time",register:r,control:d,errors:null}),(0,t.jsx)(M.Z,{xs:12,md:6,title:"Profissional preenchimento",name:"naoConformidade.itens[".concat(a,"].profissionalConclusao"),disabled:s.concluido||1!=l,type:"string",options:null!==(o=n.profissionaisOptions.conclusao)&&void 0!==o?o:[],register:r,setValue:c,control:d,errors:null})]})})};var $=a(72819),ee=a(24527);let eo=e=>{let{recebimentoMpID:o,values:a,info:s,getValues:l,register:r,control:i,setValue:d,errors:c}=e,{user:u,loggedUnity:h}=(0,n.useContext)(C.V),{settings:v}=(0,n.useContext)(P.J6),[g,j]=(0,n.useState)(!1),[Z,I]=(0,n.useState)([]),[y,w]=(0,n.useState)(!1),F=()=>{j(!g)},N=()=>{if(0==Z.length){S.ZP.error("N\xe3o h\xe1 nenhum modelo de n\xe3o conformidade cadastrado para esta unidade! Por favor cadastre em Configura\xe7\xf5es > Formul\xe1rios.");return}if(1==Z.length){M(Z[0]);return}Z.length>1&&w(!0)},M=e=>{var o,a;console.log("\uD83D\uDE80 ~ model:",e);let t=l("naoConformidade.itens");t.push({parRecebimentoMpNaoConformidadeModeloID:e.parRecebimentoMpNaoConformidadeModeloID,modelo:{id:e.parRecebimentoMpNaoConformidadeModeloID,nome:e.nome},profissionalPreenchimento:null,produto:null,profissionalConclusao:null,data:new Date,hora:(0,b.Xn)(),dataFornecedor:new Date,horaFornecedor:(0,b.Xn)(),dataConclusao:new Date,horaConclusao:(0,b.Xn)(),profissionaisOptions:{preenchimento:null!==(o=e.profissionaisOptions.preenchimento)&&void 0!==o?o:[],conclusao:null!==(a=e.profissionaisOptions.conclusao)&&void 0!==a?a:[]},dynamicFields:e.dynamicFields}),d("naoConformidade.itens",t),j(!g),S.ZP.success("N\xe3o conformidade inserida. Preencha os campos...")},E=(e,o)=>{let a=l("naoConformidade.itens");a[e].status=o,d("naoConformidade.itens",a)},V=async()=>{try{let e=await D.h.get("/formularios/recebimento-mp/getNaoConformidadeModels/".concat(h.unidadeID));I(e.data)}catch(o){console.log("\uD83D\uDE80 ~ getNcModels ~ error",o)}},k=()=>(0,t.jsx)(f.ZP,{container:!0,spacing:4,children:Z&&Z.length>0&&Z.map((e,o)=>(0,t.jsx)(ee.Z,{xs:12,md:6,icon:"fluent:form-multiple-48-regular",title:e.nome,action:"select",subtitle:"Ciclo de ".concat(e.ciclo," dias"),handleClick(){M(e),w(!1)}},o))});return(0,n.useEffect)(()=>{V()},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"".concat("dark"==v.mode?"bg-[#3C2F38]":"bg-[#F8E2E2]"," p-3 rounded-xl  text-center"),children:(0,t.jsx)(p.Z,{color:"error",variant:"subtitle1",sx:{fontWeight:700},children:"Plano de A\xe7\xe3o"})}),l("naoConformidade.itens")&&l("naoConformidade.itens").map((e,o)=>(0,t.jsx)(m.Z,{children:(0,t.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",gap:"6px"},children:[(0,t.jsx)(p.Z,{variant:"body1",children:e.modelo.nome}),(0,t.jsx)(L,{index:o,value:e,handlePreenchimentoFornecedor:F,getValues:l,info:s,papelID:u.papelID,produtos:a.produtos,register:r,control:i,setValue:d,errors:c},o),(0,t.jsx)(J,{index:o,value:e,info:s,papelID:u.papelID,register:r,control:i,setValue:d,errors:c},o),(0,t.jsx)(Y,{index:o,value:e,info:s,papelID:u.papelID,register:r,control:i,setValue:d,handleChangeStatus:E,errors:c},o)]})},o)),!s.concluido&&1==u.papelID&&(0,t.jsx)(f.ZP,{container:!0,spacing:4,children:(0,t.jsx)(f.ZP,{item:!0,xs:12,children:(0,t.jsx)(G.Z,{variant:"outlined",color:"primary",onClick:N,startIcon:(0,t.jsx)(H.Z,{icon:"material-symbols:add-circle-outline-rounded"}),sx:{mt:2},children:"Inserir nova n\xe3o conformidade"})})})]}),(0,t.jsx)($.Z,{title:"Modelo de N\xe3o Conformidade",description:"Selecione o modelo de n\xe3o conformidade que deseja inserir. O mesmo pode ser gerenciado em Configura\xe7\xf5es > Formul\xe1rios.",setOpenModal:w,openModal:y,children:(0,t.jsx)(k,{})})]})};var ea=a(76904),et=a(1322),en=a(62094),es=a(934),el=a(91757);let er=e=>{var o,a,v;let F;let{id:N,model:M}=e,{menu:E,user:V,loggedUnity:k,hasSectorPermission:A}=(0,n.useContext)(C.V),[O,R]=(0,n.useState)(!1),[H,q]=(0,n.useState)(!1),[z,_]=(0,n.useState)(!1),[G,X]=(0,n.useState)(!1),[L,J]=(0,n.useState)(!1),[K,Q]=(0,n.useState)(!1),[Y,$]=(0,n.useState)(null),[ee,er]=(0,n.useState)(!0),[ei,ed]=(0,n.useState)(null),[ec,eu]=(0,n.useState)([]),[em,ex]=(0,n.useState)([]),[ep,ef]=(0,n.useState)(null),{createNewNotification:eh}=(0,n.useContext)(I.u),[ev,eg]=(0,n.useState)(!1),[eb,eD]=(0,n.useState)([]),[ej,eZ]=(0,n.useState)([]),[eC,eI]=(0,n.useState)([]),[ey,eS]=(0,n.useState)(null),[eP,ew]=(0,n.useState)([]),[eF,eN]=(0,n.useState)(null),[eM,eE]=(0,n.useState)(""),[eV,ek]=(0,n.useState)(!1),[eA,eO]=(0,n.useState)(!1),[eR,eH]=(0,n.useState)({status:!1,errors:[]}),[eq,ez]=(0,n.useState)(null),{settings:e_}=(0,n.useContext)(P.J6),{setId:eT}=(0,n.useContext)(Z.X),{isLoading:eB,startLoading:eW,stopLoading:eU}=(0,B.Z)(),[eG,eX]=(0,n.useState)(!1),{setReportParameters:eL,sendPdfToServer:eJ}=(0,U.Gc)(),[eK,eQ]=(0,n.useState)(!1),[eY,e$]=(0,n.useState)(!1),[e0,e1]=(0,n.useState)(null),[e2,e3]=(0,n.useState)(null),[e9,e8]=(0,n.useState)({status:!1,message:"Voc\xea n\xe3o tem permiss\xf5es",messageType:"info"}),e6=g(),e7=N&&N>0?"edit":"new",e4="edit"==e7?e6.pathname:(0,b.g_)(e6.pathname),{reset:e5,register:oe,getValues:oo,setValue:oa,control:ot,watch:on,handleSubmit:os,clearErrors:ol,setError:or,formState:{errors:oi}}=(0,s.cI)(),od=()=>{eT(ei.modelo.id),e6.push("/configuracoes/formularios/recebimento-mp/")},oc=async e=>{let o={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:V.usuarioID,papelID:V.papelID,unidadeID:k.unidadeID}};try{J(!0),await D.h.post("".concat(e4,"/changeFormStatus/").concat(N),o).then(e=>{S.ZP.success(b.OD.successUpdate),J(!1),oC(ep,null,null)})}catch(a){console.log(a)}finally{R(!O)}},ou={id:1,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,t.jsx)(el.Z,{}),disabled:!!K,route:null,type:null,action:oc,modal:!0,size:"sm",icon:"heroicons:lock-open",identification:null},om=[];1==V.papelID&&eM.status>=40&&om.push(ou),1==V.papelID&&(F=!1,E.map(e=>{e.menu.map(e=>{e.submenu&&e.submenu.length>0&&e.submenu.map(e=>{"/configuracoes/formularios"==e.rota&&(F=!0)})})}),F)&&om.push({id:2,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:od,modal:!1,icon:"bi:gear",identification:null});let ox=async()=>{},op=()=>{eW();try{D.h.post("".concat(e4,"/getData"),{id:null!=N?N:0,type:e7,profissionalID:V.profissionalID,unidadeID:k.unidadeID,modeloID:null!=M?M:0}).then(e=>{var o,a,t,n;console.log("getData: ",e.data),eD(e.data.fieldsHeader),eZ(e.data.fieldsFooter),eI(e.data.fields),eu(e.data.produtos),ew(e.data.blocos),ex(e.data.grupoAnexo),eE(e.data.info),ed(e.data.unidade),eS(e.data.link),eN(e.data.ultimaMovimentacao),oj(e.data.blocos),$(e.data.naoConformidade) //! Seta n√£o conformidades
,e5(e.data);let s=b.WR[null==e?void 0:null===(o=e.data)||void 0===o?void 0:null===(a=o.info)||void 0===a?void 0:a.status];ef(s),e8({status:!!(1==V.papelID&&e.data.info.status<40&&A(null!==(n=null===(t=e.data.fieldsHeader)||void 0===t?void 0:t.setores)&&void 0!==n?n:[])),message:e.data.info.status>40?"Esse formul\xe1rio j\xe1 foi conclu\xeddo, n\xe3o \xe9 mais poss\xedvel alterar as informa\xe7\xf5es!":e.data.info.status<40?"Formul\xe1rio aberto para preenchimento!":40==e.data.info.status?"Este formul\xe1rio est\xe1 aguardando aprova\xe7\xe3o!":null,messageType:"info"}),ox()}).catch(e=>{console.log("\uD83D\uDE80 ~ error:",e)})}catch(e){console.log("\uD83D\uDE80 ~ error:",e)}finally{eU()}},of=!1,oh=[],ov=(e,o)=>{or(e,{type:"manual",message:"Campo obrigat\xf3rio"}),oh.push(o),of=!0},og=()=>{ol(),oo("fieldsHeader.data")||ov("fieldsHeader.data","Data da avalia\xe7\xe3o"),oo("fieldsHeader.hora")||ov("fieldsHeader.hora","Hora da avalia\xe7\xe3o"),null==eC||eC.forEach((e,o)=>{let a=e.tabela?"fields[".concat(o,"].").concat(e.tabela):"fields[".concat(o,"].").concat(e.nomeColuna),t=oo(a);1!==e.obrigatorio||t||ov(a,null==e?void 0:e.nomeCampo)}),ec&&ec.length>0&&ec.forEach((e,o)=>{e.produtoAnexosDescricao&&e.produtoAnexosDescricao.forEach((a,t)=>{1===a.obrigatorio&&0==a.anexos.length&&(or("produtos[".concat(o,"].produtoAnexosDescricao[").concat(t,"].anexos"),{type:"manual",message:"Campo obrigat\xf3rio"}),oh.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==a?void 0:a.nome)),of=!0)})}),console.log("\uD83D\uDE80 ~ block:",eP),eP.forEach((e,o)=>{e.itens.forEach((e,a)=>{let t=oo("blocos[".concat(o,"].itens[").concat(a,"].resposta"));(null==e?void 0:e.obrigatorio)!==1||t||(or("blocos[".concat(o,"].itens[").concat(a,"].resposta"),{type:"manual",message:"Campo obrigat\xe1rio"}),oh.push(null==e?void 0:e.nome),of=!0),e.respostaConfig&&1==e.respostaConfig.anexo&&e.respostaConfig.anexosSolicitados.length>0&&e.respostaConfig.anexosSolicitados.forEach((t,n)=>{1==t.obrigatorio&&t.anexos&&0==t.anexos.length&&(or("blocos[".concat(o,"].itens[").concat(a,"].respostaConfig.anexosSolicitados[").concat(n,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),oh.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==t?void 0:t.nome)),of=!0)})})}),em&&em.length>0&&em.forEach((e,o)=>{e.itens.forEach((a,t)=>{1===a.obrigatorio&&0==a.anexos.length&&(or("grupoAnexo[".concat(o,"].itens[").concat(t,"].anexos"),{type:"manual",message:"Campo obrigat\xe1rio"}),oh.push("Anexo: ".concat(null==e?void 0:e.nome," / ").concat(null==a?void 0:a.nome)),of=!0)})}),eH({status:of,errors:oh})},ob=async e=>{if(9===e.length){let o=e.replace(/[^0-9]/g,"");try{let a=await D.h.get("https://viacep.com.br/ws/".concat(o,"/json/"));a.data.localidade?(eC.forEach(async(e,o)=>{("logradouro"===e.nomeColuna||"bairro"===e.nomeColuna||"cidade"===e.nomeColuna||"estado"===e.nomeColuna)&&(await oa("fields[".concat(o,"].logradouro"),a.data.logradouro),await oa("fields[".concat(o,"].bairro"),a.data.bairro),await oa("fields[".concat(o,"].cidade"),a.data.localidade),await oa("fields[".concat(o,"].estado"),a.data.uf))}),S.ZP.success("Endere\xe7o encontrado!")):S.ZP.error("Endere\xe7o n\xe3o encontrado!")}catch(t){console.error(t)}}},oD=e=>{ez(e),og(),ek(!0)},oj=e=>{let o=!0;e.forEach(e=>{e.itens.forEach(e=>{e.respostaConfig&&1==e.respostaConfig.bloqueiaFormulario&&(o=!1)})}),er(o)},oZ=async e=>{e.conclusion=!0,await os(oI)(e)},oC=(e,o,a)=>{let t=30==e?"Em preenchimento":40==e?"Conclu\xeddo":50==e?"Reprovado":60==e?"Aprovado parcialmente":70==e?"Aprovado":"Pendente",n={titulo:"Formul\xe1rio de Fornecedor ".concat(t),descricao:"O formul\xe1rio de Fornecedor #".concat(N," est\xe1 ").concat(t,"."),url:"/formularios/fornecedor/",urlID:N,tipoNotificacaoID:6,usuarioGeradorID:V.usuarioID,usuarioID:0,unidadeID:k.unidadeID,papelID:1};if(n&&(eh(n),o)){let s={titulo:"Fornecedor gerado",descricao:"O formul\xe1rio de Fornecedor #".concat(N," est\xe1 ").concat(t," e gerou uma n\xe3o conformidade."),url:"/formularios/fornecedor/nao-conformidade/",urlID:a,tipoNotificacaoID:5,usuarioGeradorID:V.usuarioID,usuarioID:0,unidadeID:k.unidadeID,papelID:1};eh(s)}},oI=async function(e){var o,a;let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===t.conclusion&&(e.concluiForm=!0,e.info.status=null!==(o=t.status)&&void 0!==o?o:eM.status,e.obsConclusao=t.obsConclusao);let n={form:e,auth:{usuarioID:V.usuarioID,profissionalID:null!==(a=V.profissionalID)&&void 0!==a?a:0,papelID:V.papelID,unidadeID:k.unidadeID}};if(console.log("\uD83D\uDE80 ~ onSubmit data:",n),eW(),!0!=N){ek(!1);try{"edit"==e7?(J(!0),await D.h.post("".concat(e4,"/updateData/").concat(N),n).then(o=>{S.ZP.success(b.OD.successUpdate),J(!1),oC(e.status,e.naoConformidade,null)})):"new"==e7?await D.h.post("".concat(e4,"/insertData"),n).then(e=>{eT(e.data.recebimentoMpID),e6.push("".concat(e4)),S.ZP.success(b.OD.successNew)}):S.ZP.error(b.OD.error)}catch(s){console.log("errro da fun\xe7\xe3o update/email",s)}finally{eU(),R(!O)}}},oy=async(e,o)=>{q(!0);let a=e.target.files;if(a&&a.length>0){var t;let n=new FormData;for(let s=0;s<a.length;s++)n.append("files[]",a[s]);n.append("usuarioID",V.usuarioID),n.append("unidadeID",k.unidadeID),n.append("grupoAnexoItemID",null!==(t=o.grupoAnexoItemID)&&void 0!==t?t:null),await D.h.post("".concat(e4,"/saveAnexo/").concat(N,"/grupo-anexo/").concat(V.usuarioID,"/").concat(ei.unidadeID),n).then(e=>{q(!1);let o=oo();oI(o)}).catch(e=>{var o,a,t;q(!1),S.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},oS=async(e,o)=>{console.log("\uD83D\uDE80 ~ handleFileSelectItem item:",o),X(!0);let a=e.target.files;if(a&&a.length>0){var t,n;let s=new FormData;for(let l=0;l<a.length;l++)s.append("files[]",a[l]);s.append("usuarioID",V.usuarioID),s.append("unidadeID",k.unidadeID),s.append("parRecebimentoMpModeloBlocoID",null!==(t=o.parRecebimentoMpModeloBlocoID)&&void 0!==t?t:null),s.append("itemOpcaoAnexoID",null!==(n=o.itemOpcaoAnexoID)&&void 0!==n?n:null),await D.h.post("".concat(e4,"/saveAnexo/").concat(N,"/item/").concat(V.usuarioID,"/").concat(ei.unidadeID),s).then(e=>{X(!1);let o=oo();oI(o)}).catch(e=>{var o,a,t;X(!1),S.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!!!!")})}},oP=async e=>{e&&await D.h.delete("".concat(e4,"/deleteAnexo/").concat(N,"/").concat(e.anexoID,"/").concat(ei.unidadeID,"/").concat(V.usuarioID,"/item")).then(e=>{let o=oo();oI(o)}).catch(e=>{var o,a,t;S.ZP.error(null!==(t=null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})},ow=e=>{e.preventDefault();let o=oo();oI(o)};(0,n.useEffect)(()=>{op()},[N,L]),(0,n.useEffect)(()=>{og()},[eB]);let oF=async e=>{e$(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Z,{show:eB}),(0,t.jsxs)("form",{onSubmit:e=>ow(e),children:[!eB&&(0,t.jsx)(j.Z,{btnCancel:!0,btnSave:!eM.concluido,btnSend:1==V.papelID&&eM.status>=30&&!eM.concluido,btnPrint:"edit"==e7,btnDelete:eM.status<40,onclickDelete:()=>eX(!0),actionsData:om,actions:!0,handleSubmit:()=>os(oI),handleSend:oD,iconConclusion:"mdi:check-bold",titleConclusion:"Concluir Formul\xe1rio",title:"Recebimento de MP",btnStatus:1==V.papelID&&"edit"==e7,handleBtnStatus:()=>eg(!0),type:e7,status:ep,setores:null!==(v=null==ej?void 0:ej.setores)&&void 0!==v?v:[]}),(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[ep&&(0,t.jsx)(c.Z,{size:"small",skin:"light",color:ep.color,label:ep.title,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}}),ei&&ei.modelo&&(0,t.jsx)(c.Z,{size:"small",HeaderFiel:!0,skin:"light",label:ei.modelo.nome,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}})]}),(0,t.jsxs)(u.Z,{display:"flex",flexDirection:"column",sx:{gap:6},children:[eM&&""!=eM.cabecalhoModelo&&(0,t.jsx)(m.Z,{children:(0,t.jsx)(x.Z,{children:(0,t.jsx)(p.Z,{variant:"subtitle1",children:eM.cabecalhoModelo})})}),ei&&(0,t.jsx)(T,{nameSelected:e2,setNameSelected:e3,columnSelected:e0,setColumnSelected:e1,openModalNew:eY,setOpenModalNew:e$,newChange:eK,setNewChange:eQ,recebimentoMpID:N,modelo:ei.modelo,values:eb,produtosRecebimento:ec,fields:eC,getValues:oo,disabled:!e9.status,register:oe,errors:oi,setValue:oa,control:ot,getAddressByCep:ob}),eP&&eP.map((e,o)=>(0,t.jsx)(l.Z,{bloco:e,index:o,blockKey:"parRecebimentoMpModeloBlocoID",setBlocos:ew,setValue:oa,blocos:eP,getValues:oo,register:oe,control:ot,disabled:K,errors:null==oi?void 0:oi.blocos,handleFileSelect:oS,handleRemoveAnexoItem:oP,status:eM.status})),em&&em.map((e,o)=>(0,t.jsx)(d.Z,{values:{grupo:e,loadingFile:H,indexGrupo:o,handleFileSelect:oy,handleRemove:handleRemoveAnexoGroup,folder:"grupo-anexo",disabled:!e9.status,error:oi}},o)),eM&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(m.Z,{children:(0,t.jsx)(x.Z,{children:(0,t.jsx)(f.ZP,{container:!0,spacing:4,children:(0,t.jsx)(f.ZP,{item:!0,xs:12,md:12,children:(0,t.jsxs)(h.Z,{fullWidth:!0,children:[(0,t.jsx)(p.Z,{variant:"subtitle1",sx:{fontWeight:600,mb:2},children:"Observa\xe7\xf5es (campo de uso exclusivo da validadora)"}),(0,t.jsx)(i.Z,{title:"Observa\xe7\xe3o (opcional)",name:"info.obs",multiline:!0,rows:4,value:eM.obs,disabled:!e9.status,control:ot})]})})})})})}),ej&&ej.concluded&&(null===(o=ej.conclusion)||void 0===o?void 0:o.profissional)&&(0,t.jsx)(p.Z,{variant:"caption",children:"Conclu\xeddo por ".concat(ej.conclusion.profissional.nome," em ").concat(ej.conclusion.dataFim," ").concat(ej.conclusion.horaFim,".")}),eM.naoConformidade&&(0,t.jsx)(eo,{recebimentoMpID:N,values:Y,info:eM,getValues:oo,register:oe,control:ot,setValue:oa,errors:oi}),(0,t.jsx)(es.Z,{id:N,parFormularioID:2},O),ev&&(0,t.jsx)(r.Z,{title:"Hist\xf3rico do Formul\xe1rio",text:"Listagem do hist\xf3rico das movimenta\xe7\xf5es do formul\xe1rio ".concat(N," do Recebimento de MP."),id:N,parFormularioID:2,formStatus:eM.status,hasFormPending:K,canChangeStatus:!1,openModal:ev,handleClose:()=>eg(!1),btnCancel:!0,btnConfirm:!0,handleSubmit:!1}),(0,t.jsx)(w.Z,{openModal:eV,handleClose(){ek(!1),og()},title:"Concluir Formul\xe1rio",text:"Deseja realmente concluir este formul\xe1rio?",info:eM,canChange:!K,register:oe,setValue:oa,getValues:oo,control:ot,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:oZ,listErrors:eR,canApprove:ee,hasNaoConformidade:!0,type:"recebimentoMp",unity:ei,values:ej,formularioID:2,errors:oi,modeloID:null==ei?void 0:null===(a=ei.modelo)||void 0===a?void 0:a.id}),(0,t.jsx)(W.Z,{title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formulario?",params:{route:"formularios/recebimento-mp/delete/".concat(N),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},open:eG,handleClose:()=>eX(!1)})]})]}),(0,t.jsx)(et.Z,{title:"transportadorID"==e0?"Novo transportador":"tipoVeiculoID"==e0?"Novo tipo de veiculo":"",size:"md",openModal:eY,setOpenModal:e$,children:"transportadorID"==e0?(0,t.jsx)(ea.Z,{btnClose:!0,handleModalClose:()=>e$(!1),setNewChange:eQ,newChange:eK,outsideID:!0,handleConfirmNew:oF,manualUrl:"/cadastros/transportador"}):"tipoVeiculoID"==e0?(0,t.jsx)(en.Z,{btnClose:!0,handleModalClose:()=>e$(!1),setNewChange:eQ,newChange:eK,outsideID:!0,handleConfirmNew:oF,manualUrl:"/cadastros/tipo-veiculo"}):null})]})};var ei=er}}]);