"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3097],{51735:function(e,a,o){var t=o(85893),i=o(11163),l=o(67294),n=o(66136),s=o(3404),r=o(83830);let d=e=>{let{tabs:a,headerInfoComponent:o,defaultTab:d,type:u}=e,{settings:c}=(0,l.useContext)(n.J6),m=(0,i.useRouter)(),p=m.query.aba||d,{setIdNc:x}=(0,l.useContext)(r.X),[h,f]=(0,l.useState)(p),v=e=>{e!==h&&((0,s.H)(e,m),f(e))};return(0,l.useEffect)(()=>{p!==h&&f(p)},[p]),(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,t.jsx)("div",{className:"".concat("list"!==u?"sticky top-[7.8rem] z-50":""," ").concat("dark"===c.mode?"bg-[#161c24]":"bg-[#F7F7F9]"),children:(0,t.jsx)("div",{className:"flex gap-2",children:a.map(e=>(0,t.jsx)("button",{className:"py-3 px-12 border-b-2 ".concat(h===e.value?"border-[#4A8B57]":"border-transparent","\n                        ").concat(e.disabled?"cursor-not-allowed opacity-20":"cursor-pointer","\n\n                        "),onClick(a){a.preventDefault(),e.disabled||(v(e.value),x(null))},children:(0,t.jsxs)("div",{className:"flex items-center gap-1 ",children:[e.icon&&(0,t.jsx)("div",{className:h===e.value?"text-[#4A8B57]":"",children:(0,t.jsx)(e.icon,{})}),(0,t.jsx)("p",{className:"text-[14px] ".concat(h===e.value?"text-[#4A8B57]":""),children:e.title})]})},e.value))})}),o,(0,t.jsx)("div",{className:"tab-content",children:a.map(e=>(0,t.jsx)("div",{className:"tab-panel ".concat(h===e.value?"block":"hidden"),children:h===e.value&&e.content},e.value))})]})};a.Z=d},43195:function(e,a,o){o.d(a,{Z:function(){return q}});var t=o(85893),i=o(67294),l=o(934),n=o(40039),s=o(60565),r=o(49837),d=o(91359),u=o(79072),c=o(29308),m=o(50287),p=o(83542),x=o(84220),h=o(60664),f=o(3893),v=o(7071);let D=e=>{var a;let{form:o,data:l,disabled:s}=e,{loggedUnity:D}=(0,i.useContext)(n.V),[g,b]=(0,i.useState)([]),[j,I]=(0,i.useState)([]),[z,Z]=(0,i.useState)([]),[y,C]=(0,i.useState)([]),[w,S]=(0,i.useState)([]);if(!l)return;let N=async()=>{try{if(!D)return;let e=await h.hi.post("/cadastros/departamento",{unidadeID:D.unidadeID});b(e.data)}catch(a){console.log(a)}},q=async()=>{try{if(!D)return;let e=await h.hi.post("/cadastros/profissional/getProfissionais",{unidadeID:D.unidadeID});I(e.data),P(null==l?void 0:l.departamento,e.data,!1)}catch(a){console.log(a)}},V=async()=>{try{if(!D)return;let e=await h.hi.post("/cadastros/setor/getSetores",{unidadeID:D.unidadeID});C(e.data)}catch(a){console.log(a)}},k=async()=>{try{if(!D)return;let e=await h.hi.post("/formularios/fornecedor/getFornecedoresPrestadorServico",{unidadeID:D.unidadeID});S(e.data)}catch(a){console.log(a)}},P=(e,a,t)=>{let i=a.filter(a=>{if(a.departamentos){let o=a.departamentos.split(",").map(Number);return o.includes(null==e?void 0:e.id)}return!1});Z(i),t&&o.setValue("header.profissional",null)};return(0,i.useEffect)(()=>{N(),q(),V(),k()},[D]),(0,t.jsx)(r.Z,{children:(0,t.jsx)(d.Z,{children:(0,t.jsxs)(u.ZP,{container:!0,spacing:6,className:"items-center",children:[(0,t.jsx)(u.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(v.Z,{size:"small",HeaderFiel:!0,skin:"light",color:l.status.color,label:l.status.label,sx:{"& .MuiChip-label":{textTransform:"capitalize"}}})})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,md:6,sx:{textAlign:"right"},children:(0,t.jsx)(p.Z,{data:null!==(a=null==l?void 0:l.departamentosPreenchimento)&&void 0!==a?a:[]})}),(0,t.jsx)(m.Z,{xs:12,md:2,title:"Data Inicial",type:"date",required:!0,name:"header.dataInicio",value:l.dataInicio,disabled:s,typeValidation:"dataPassado",daysValidation:999999,form:o}),(0,t.jsx)(c.Z,{xs:12,md:2,title:"Hora Inicial",name:"header.horaInicio",type:"time",required:!0,disabled:s,form:o}),(0,t.jsx)(m.Z,{xs:12,md:2,title:"Data Final",type:"date",required:!0,name:"header.dataFim",value:l.dataFim,disabled:s,typeValidation:"dataPassado",daysValidation:999999,form:o}),(0,t.jsx)(c.Z,{xs:12,md:2,title:"Hora Final",name:"header.horaFim",type:"time",required:!0,disabled:s,form:o}),(0,t.jsx)(f.Z,{xs:6,md:4,title:"Prestador de servi\xe7o",name:"header.prestadorServico",value:l.prestadorServico,form:o,disabled:s,helpText:"Limpeza realizada por uma empresa terceira"}),o.watch("header.prestadorServico")&&(0,t.jsx)(x.Z,{xs:12,md:4,title:"Fornecedor prestador de servi\xe7o",name:"header.fornecedor",value:null==l?void 0:l.fornecedor,options:null!=w?w:[],disabled:s,form:o,helpText:"Todos os fornecedor ativos prestadores de serviço"}),!o.watch("header.prestadorServico")&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{xs:12,md:4,title:"Departamento respons\xe1vel pela limpeza",name:"header.departamento",onChange:e=>P(e,j,!0),disabled:s,required:!0,value:null==l?void 0:l.departamento,options:null!=g?g:[],form:o}),(0,t.jsx)(x.Z,{xs:12,md:4,title:"Profissional respons\xe1vel pela limpeza",name:"header.profissional",disabled:s,value:null==l?void 0:l.profissional,options:null!=z?z:[],form:o})]}),(0,t.jsx)(x.Z,{xs:12,md:4,title:"Setor que foi limpo",name:"header.setor",value:null==l?void 0:l.setor,disabled:s,required:!0,options:null!=y?y:[],form:o,helpText:"Setor que foi limpo pelo profissional respons\xe1vel pela limpeza"})]})})})};var g=o(11163),b=o.n(g);o(86501);var j=o(27666),I=o(61953),z=o(87536),Z=o(53934),y=o(15811);let C=e=>{let{form:a,data:o,index:l}=e,{loggedUnity:s}=(0,i.useContext)(n.V),[r,d]=(0,i.useState)([]),c=async()=>{try{if(!s)return;let e=await h.hi.post("/cadastros/produto/getProdutosLimpeza",{unidadeID:s.unidadeID});d(e.data)}catch(a){console.log(a)}},m=e=>{let{e:o,item:t,index:i,indexItem:l}=e,n=t.alternativas.find(e=>e.id==o.target.value);a.setValue("blocos[0].equipamentos[".concat(i,"].itens[").concat(l,"].resposta"),n)};return(0,i.useEffect)(()=>{c()},[]),(0,t.jsxs)(u.ZP,{container:!0,spacing:4,children:[(0,t.jsx)(x.Z,{xs:12,md:8,title:"Produtos utilizados na limpeza",name:"blocos[0].equipamentos.".concat(l,".produtos"),multiple:!0,options:null!=r?r:[],form:a,disabled:a.getValues("header.status.id")>=40,helpText:"Produtos utilizados na limpeza do equipamento."}),(0,t.jsx)(f.Z,{form:a,xs:6,md:4,title:"Higieniza\xe7\xe3o",name:"blocos[0].equipamentos.".concat(l,".higienizacao"),disabled:a.getValues("header.status.id")>=40,value:null==o?void 0:o.higienizacao}),a.watch("blocos[0].equipamentos.".concat(l,".itens"))&&a.watch("blocos[0].equipamentos.".concat(l,".itens")).map((e,o)=>(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(y.Z,{form:a,blockKey:"limpezaID",index:l,indexItem:o,item:e,updateResponse:m,disabled:a.getValues("header.status.id")>=40},l)}))]})};var w=o(83830);let S=e=>{let{form:a}=e,{loggedUnity:o}=(0,i.useContext)(n.V),{id:l}=(0,i.useContext)(w.X),{fields:s,append:u,remove:c}=(0,z.Dq)({control:a.control,name:"blocos[0].equipamentos"}),m=async()=>{if(a.watch("header.setor"))try{var e;let t={id:l,unidadeID:o.unidadeID,setorID:null===(e=a.watch("header.setor"))||void 0===e?void 0:e.id};console.log("\uD83D\uDE80 ~ values:",t);let i=await h.hi.post("/formularios/limpeza/getEquipamentos",t);console.log("\uD83D\uDE80 ~ response:",i.data),c(),u(i.data),console.log("\uD83D\uDE80 ~ response:",i.data)}catch(n){console.log(n)}},p=(e,o)=>{let{checked:t}=e.target;a.setValue("blocos[0].equipamentos.".concat(o,".checked"),t)};return(0,i.useEffect)(()=>{m()},[a.watch("header.setor")]),a.watch("header.setor")&&s.map((e,o)=>(0,t.jsx)(r.Z,{children:(0,t.jsxs)(d.Z,{children:[(0,t.jsxs)(I.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",sx:{gap:2},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(f.Z,{form:a,xs:6,md:6,title:e.nome,name:"blocos[0].equipamentos.".concat(o,".checked"),onClick:e=>p(e,o),disabled:a.getValues("header.status.id")>=40,value:null==e?void 0:e.checked}),(null==e?void 0:e.orientacoesLimpeza)&&(0,t.jsx)(Z.Z,{text:e.orientacoesLimpeza})]}),(0,t.jsx)("div",{children:"Validade ..."})]},e.id),a.watch("blocos[0].equipamentos.".concat(o,".checked"))&&(0,t.jsx)(C,{form:a,data:e,index:o})]})}))},N=e=>{var a,o;let{id:r,header:d,block:u,setBlock:c,form:m,onSubmit:p}=e,x=b(),h=r&&r>0?"edit":"new",{user:f,loggedUnity:v}=(0,i.useContext)(n.V),{setTitle:g}=(0,i.useContext)(s.f),[I,z]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{g({icon:"carbon:clean",title:"Limpeza e Higieniza\xe7\xe3o",subtitle:{id:r,count:1,new:!1}})},[r,v,null===(a=x.query)||void 0===a?void 0:a.aba]),d&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("input",{type:"hidden",...m.register("type"),value:"limpeza"}),(0,t.jsx)(D,{form:m,data:d,disabled:(null===(o=d.status)||void 0===o?void 0:o.id)>=40}),"new"===h&&(0,t.jsx)(j.Z,{}),"edit"===h&&(0,t.jsx)(S,{form:m}),(0,t.jsx)(l.Z,{id:r,parFormularioID:4},I)]})})};var q=N},83097:function(e,a,o){var t=o(85893),i=o(67294),l=o(65698),n=o(40039),s=o(60565),r=o(87536),d=o(60664),u=o(11163),c=o.n(u),m=o(86501),p=o(6624),x=o(92629),h=o(91757),f=o(83830),v=o(71798),D=o(72819),g=o(51239),b=o(42222),j=o(46099),I=o(32038);let z=e=>{var a,o,u,z,Z,y;let{id:C,limpezaID:w,modelID:S}=e;console.log("\uD83D\uDE80 ~~ Limpeza HeaderLimpezaNC:",w,C,S);let N=c(),q=C&&C>0?"edit":"new";console.log("\uD83D\uDE80 ~ type:",q);let{menu:V,user:k,loggedUnity:P,hasPermission:E}=(0,i.useContext)(n.V),{setTitle:F}=(0,i.useContext)(s.f),[L,H]=(0,i.useState)(null),[B,T]=(0,i.useState)(null),[M,A]=(0,i.useState)(!1),[R,_]=(0,i.useState)(!1),[O,K]=(0,i.useState)({status:!1,errors:[]}),[X,J]=(0,i.useState)(!1),[Q,U]=(0,i.useState)(!1),{setId:W,setIdNc:Y,setModelID:G,setLimpezaID:$}=(0,i.useContext)(f.X),ee=(0,r.cI)({mode:"onChange"}),ea=e=>{let a=!0;return e.forEach(e=>{e.novaQuantidade&&(0,b.JK)(e.novaQuantidade)>(0,b.JK)(e.quantidade)&&(a=!1)}),a},eo=async e=>{let a=ee.getValues("productsConclude");if(C&&L.limpeza.id){if(!ea(null!=a?a:[])){m.ZP.error("Quantidade não pode ser maior que a quantidade da limpeza e higieniza\xe7\xe3o!");return}e={form:{...e,products:a,prazo:ee.getValues("header.prazoSolucao"),data:ee.getValues("header.data"),data_:ee.getValues("header.data")&&ee.getValues("header.data").split("-").reverse().join("/"),hora:ee.getValues("header.hora"),transporte:ee.getValues("header.transporte"),produto:ee.getValues("header.produto")},params:{id:C,limpezaID:L.limpeza.id,usuarioID:k.usuarioID,papelID:k.papelID,unidadeID:P.unidadeID,profissionalID:k.profissionalID}},H(null);try{await d.hi.post("/formularios/limpeza/nao-conformidade/conclude",e),await en(ee.getValues())}catch(o){console.log(o);return}finally{_(!1),A(!M)}}},et=async e=>{let a={status:30,observacao:null==e?void 0:e.obs,auth:{usuarioID:k.usuarioID,papelID:k.papelID,unidadeID:P.unidadeID}};try{await d.hi.post("/formularios/limpeza/nao-conformidade/reOpen/".concat(C),a),m.ZP.success(v.OD.successUpdate)}catch(o){console.log(o)}finally{A(!M)}},ei=async()=>{try{let e={id:null!=C?C:0,modelID:null!=S?S:0,limpezaID:null!=w?w:0,unidadeID:P.unidadeID,papelID:k.papelID};console.log("\uD83D\uDE80 ~ values:",e);let a=await d.hi.post("/formularios/limpeza/nao-conformidade/getData",e);console.log("\uD83D\uDE80 ~ response:",a),204===a.status&&(W(null),N.push("/formularios/limpeza/?aba=nao-conformidade")),console.log("\uD83D\uDE80 ~ getData: ",a.data),ee.reset(a.data),H(a.data.header),T(a.data.blocos)}catch(o){console.log(o);return}},el=e=>{e.preventDefault();let a=ee.getValues();en(a)},en=async e=>{if(!e)return;let a={form:e,auth:{usuarioID:k.usuarioID,profissionalID:k.profissionalID,papelID:k.papelID,unidadeID:P.unidadeID}};console.log("\uD83D\uDE80 ~ onSubmit:",a);try{if("new"===q){let o=await d.hi.post("/formularios/limpeza/nao-conformidade/insertData",a);m.ZP.success("Dados cadastrados com sucesso!"),Y(o.data.id),N.push("/formularios/limpeza/?aba=nao-conformidade")}else"edit"===q&&(await d.hi.post("/formularios/limpeza/nao-conformidade/updateData/".concat(C),a),m.ZP.success("Dados atualizados com sucesso!"))}catch(t){console.log(t);return}finally{A(!M)}},es=()=>{Y(L.modelo.id),N.push("/configuracoes/formularios/limpeza-naoconformidade/")},er=e=>{console.log("handleNew: ",L.limpeza.id,e.new.modelo.id),W(L.limpeza.id),$(L.limpeza.id),G(e.new.modelo.id),N.push("/formularios/limpeza/novo/?aba=nao-conformidade")},ed=[],eu={id:1,name:"Reabrir formul\xe1rio",description:"Reabrir formul\xe1rio para preenchimento.",component:(0,t.jsx)(h.Z,{}),disabled:!E(N.pathname,"editar"),route:null,type:null,action:et,modal:!0,size:"sm",icon:"heroicons:lock-open",identification:null};1==k.papelID&&L&&L.status.id>=40&&ed.push(eu),1==k.papelID&&(0,b.z)(V,"/configuracoes/formularios")&&ed.push({id:2,name:"Configura\xe7\xf5es do formul\xe1rio",description:"Alterar as configura\xe7\xf5es do modelo de formul\xe1rio.",route:null,type:null,action:es,modal:!1,icon:"bi:gear",identification:null});let ec=()=>{let e={status:!1,errors:[]};ee.clearErrors(),(0,j.n9)(ee,"header.data","Data",e),(0,j.n9)(ee,"header.hora","Hora",e),(0,j.lz)(ee,ee.getValues("header.fields"),e),(0,j.IB)(ee,ee.getValues("blocos"),e);let a=(0,j.FU)(e);(O.status!==a.status||O.errors.length!==a.errors.length)&&K(a)};return(0,i.useEffect)(()=>{F({icon:"typcn:warning-outline",title:"N\xe3o conformidade da Limpeza e Higieniza\xe7\xe3o",subtitle:{id:C,count:1,new:!1}}),ei(),setTimeout(()=>{ee.trigger()},300)},[C,M,k]),L&&(0,t.jsxs)("form",{onSubmit:e=>el(e),children:[(0,t.jsx)(l.Z,{btnNewModal:1===k.papelID&&"edit"===q,handleNewModal:()=>J(!0),btnCancel:!0,setIdNc:Y,btnSave:(null==L?void 0:null===(a=L.status)||void 0===a?void 0:a.id)<40,btnSend:1===k.papelID&&(null==L?void 0:null===(o=L.status)||void 0===o?void 0:o.id)>=30&&(null==L?void 0:null===(u=L.status)||void 0===u?void 0:u.id)<=40||2===k.papelID&&(null==L?void 0:null===(z=L.status)||void 0===z?void 0:z.id)===30,btnPrint:"edit"==q,btnDelete:1===k.papelID&&(null==L?void 0:null===(Z=L.status)||void 0===Z?void 0:Z.id)<40&&"edit"===q,onclickDelete:()=>U(!0),actionsData:ed,actions:1===k.papelID,handleSubmit:()=>ee.handleSubmit(en),handleSend(){_(!0),ec()},iconConclusion:"solar:check-read-linear",titleConclusion:"Concluir",title:"N\xe3o conformidade da Limpeza e Higieniza\xe7\xe3o",type:q,status:null==L?void 0:null===(y=L.status)||void 0===y?void 0:y.id}),(0,t.jsx)(I.Z,{idNc:C,id:w,modelID:S,form:ee,header:L,block:B,setBlock:T,defaultTab:"nao-conformidade",change:M,onSubmit:en}),(0,t.jsx)(D.Z,{title:"Nova N\xe3o Conformidade",handleConclusion:er,size:"lg",setOpenModal:J,openModal:X,form:ee,children:(0,t.jsx)(g.Z,{type:"form",data:L,form:ee})}),(0,t.jsx)(p.Z,{openModal:R,handleClose(){_(!1)},title:"Concluir N\xe3o Conformidade da Limpeza e Higieniza\xe7\xe3o",text:"Deseja realmente concluir este formul\xe1rio?",status:L.status.id,canChange:!0,btnCancel:!0,btnConfirm:!0,btnConfirmColor:"primary",conclusionForm:eo,type:"limpezaNaoConformidade",listErrors:O,unity:P,values:null,formularioID:5,modeloID:L.modelo.id,produtos:ee.getValues("header.equipamentos"),form:ee,departamentos:L.departamentosConclusao}),(0,t.jsx)(x.Z,{open:Q,handleClose:()=>U(!1),title:"Excluir Formul\xe1rio",description:"Tem certeza que deseja exluir o formul\xe1rio?",params:{route:"formularios/limpeza/nao-conformidade/delete/".concat(C),messageSucceded:"Formul\xe1rio exclu\xeddo com sucesso!",MessageError:"Dado possui pend\xeancia!"},setIdNc:Y})]})};a.Z=z},32038:function(e,a,o){o.d(a,{Z:function(){return L}});var t=o(85893),i=o(51735),l=o(21609),n=o(43195),s=o(11163),r=o(67294),d=o(83830),u=o(66198),c=o(934),m=o(40039),p=o(27666),x=o(60664),h=o(49837),f=o(91359),v=o(79072),D=o(29630),g=o(44373),b=o(22841),j=o(75158),I=o(29308);let z=e=>{let{form:a,index:o,value:i,handleCheck:l,disabled:n,change:s}=e;return(0,t.jsxs)(v.ZP,{container:!0,sx:{pb:2},children:[(0,t.jsx)("input",{type:"hidden",value:i.equipamentoID,name:"header.equipamentos[".concat(o,"].equipamentoID"),...a.register("header.equipamentos[".concat(o,"].equipamentoID"))}),(0,t.jsx)(v.ZP,{item:!0,xs:12,md:12,children:(0,t.jsx)(b.Z,{control:(0,t.jsx)(j.Z,{onClick:e=>l(e,o),checked:!!i.checked_,disabled:n}),label:"".concat(i.nome),size:"small",sx:{marginRight:"4px","&:hover":{"& .MuiFormControlLabel-label":{color:"primary.main"}}}})}),i.checked_&&(0,t.jsx)(v.ZP,{container:!0,spacing:4,sx:{py:2},children:(0,t.jsx)(I.Z,{xs:12,md:12,title:"Descri\xe7\xe3o da N\xe3o Conformidade do equipamento",name:"header.equipamentos[".concat(o,"].descricao"),form:a,multiline:!0,rows:3})})]})};var Z=o(87536);let y=e=>{let{form:a,data:o,disabled:i}=e;if(!o)return;let[n,s]=(0,r.useState)(o.equipamentos),{fields:d,update:u}=(0,Z.Dq)({control:a.control,name:"header.equipamentos"}),c=(e,o)=>{let{checked:t}=e.target;a.setValue("header.equipamentos[".concat(o,"].checked_"),t),u(o,{...d[o],checked_:t})};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(v.ZP,{container:!0,sx:{mt:4},children:[(0,t.jsx)(v.ZP,{item:!0,xs:12,children:(0,t.jsxs)(D.Z,{color:"primary",variant:"subtitle1",sx:{fontWeight:700},className:"flex items-center gap-1",children:[(0,t.jsx)(l.Z,{icon:"game-icons:manual-meat-grinder",className:"text-primary"}),"Selecione os equipamentos com N\xe3o Conformidade"]})}),(0,t.jsx)(v.ZP,{item:!0,xs:12,children:d&&d.map((e,o)=>(0,t.jsxs)(r.Fragment,{children:[(0,t.jsx)(z,{index:o,value:e,setEquipment:s,handleCheck:c,disabled:i,form:a},o),o<d.length-1&&(0,t.jsx)(g.Z,{})]},e.id))})]})})};var C=o(50287),w=o(12570),S=o(83542);let N=e=>{var a;let{form:o,data:i,disabled:l}=e;if(!i)return;let n=()=>{let e=o.getValues("header.data"),a=parseInt(o.getValues("header.prazoSolucao"),10);if(!e||isNaN(a))return"--";let t=new Date(e+"T00:00:00");t.setDate(t.getDate()+a);let i=String(t.getDate()).padStart(2,"0"),l=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear(),s=new Intl.DateTimeFormat("pt-BR",{weekday:"long"}).format(t),r="".concat(i,"/").concat(l,"/").concat(n," (").concat(s,")");return r};return(0,r.useEffect)(()=>{n()},[o.watch("header.data"),o.watch("header.prazoSolucao")]),(0,t.jsx)(h.Z,{children:(0,t.jsx)(f.Z,{children:(0,t.jsxs)(v.ZP,{container:!0,spacing:6,className:"items-center",children:[(0,t.jsx)(v.ZP,{item:!0,xs:12,sx:{textAlign:"right"},children:(0,t.jsx)(S.Z,{data:null!==(a=null==i?void 0:i.departamentosPreenchimento)&&void 0!==a?a:[]})}),(0,t.jsx)(C.Z,{xs:12,md:3,title:"Data",type:"date",required:!0,name:"header.data",value:i.data,disabled:l,typeValidation:"dataPassado",daysValidation:999999,form:o}),(0,t.jsx)(I.Z,{xs:12,md:3,title:"Hora",name:"header.hora",type:"time",required:!0,disabled:l,form:o}),(0,t.jsx)(I.Z,{xs:12,md:3,title:"Prazo para a solu\xe7\xe3o (em dias)",name:"header.prazoSolucao",disabled:l,type:"number",form:o,onChange(e){o.setValue("header.prazoSolucao",e),n()},helpText:"Informe o prazo pra solu\xe7\xe3o da n\xe3o conformidade. Ser\xe1 gerado um alerta no vencimento do prazo."}),(0,t.jsxs)(v.ZP,{item:!0,xs:12,md:3,children:[(0,t.jsx)("label",{className:"opacity-60",children:"Vencimento"}),(0,t.jsx)("p",{children:n()})]}),(0,t.jsx)(v.ZP,{item:!0,xs:12,md:12,children:(0,t.jsx)(y,{form:o,data:i,disabled:l})}),(0,t.jsx)(w.Z,{form:o,fields:i.fields,disabled:l})]})})})},q=e=>{var a;let{id:o,header:i,block:l,setBlock:n,form:s,change:d,onSubmit:h}=e,f=o&&o>0?"edit":"new",{user:v,loggedUnity:D}=(0,r.useContext)(m.V),g=async(e,a)=>{let t=e.target.files;if(t&&t.length>0){var i,l;let n=new FormData;for(let r=0;r<t.length;r++)n.append("files[]",t[r]);n.append("usuarioID",v.usuarioID),n.append("unidadeID",D.unidadeID),n.append("parLimpezaNaoConformidadeModeloBlocoID",null!==(i=a.parLimpezaNaoConformidadeModeloBlocoID)&&void 0!==i?i:null),n.append("itemOpcaoAnexoID",null!==(l=a.itemOpcaoAnexoID)&&void 0!==l?l:null),await x.hi.post("/formularios/limpeza/nao-conformidade/saveAnexo/".concat(o,"/item/").concat(v.usuarioID,"/").concat(D.unidadeID),n).then(e=>{h(s.getValues())}).catch(e=>{var a,o,t;toast.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao atualizar anexo, tente novamente!")})}},b=async e=>{e&&await x.hi.delete("/formularios/limpeza/nao-conformidade/deleteAnexo/".concat(o,"/").concat(e.anexoID,"/").concat(D.unidadeID,"/").concat(v.usuarioID,"/item")).then(e=>{let a=s.getValues();h(a)}).catch(e=>{var a,o,t;toast.error(null!==(t=null===(a=e.response)||void 0===a?void 0:null===(o=a.data)||void 0===o?void 0:o.message)&&void 0!==t?t:"Erro ao remover anexo, tente novamente!")})};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(N,{form:s,data:i,disabled:(null===(a=i.status)||void 0===a?void 0:a.id)>=40||1!=v.papelID}),"new"===f&&(0,t.jsx)(p.Z,{}),"edit"===f&&(0,t.jsx)(u.Z,{form:s,data:l,blockKeyName:"parLimpezaNaoConformidadeModeloBlocoID",setBlock:n,handleFileSelect:g,handleRemoveFile:b,status:i.status.id,disabled:i.status.id>=40}),(0,t.jsx)(c.Z,{id:o,parFormularioID:5},d)]})};var V=o(15217);let k=e=>{let{form:a,header:o,block:i,setBlock:l,change:n,onSubmit:u}=e,c=(0,s.useRouter)(),{idNc:m,id:p}=(0,r.useContext)(d.X),x=c.asPath.includes("/novo");return console.log("\uD83D\uDE80 ~ Controller idNc:",x),m||x?(0,t.jsx)(q,{id:m,limpezaID:p,modelID:null,form:a,header:o,block:i,setBlock:l,change:n,onSubmit:u}):(0,t.jsx)(V.default,{limpezaID:p})};var P=o(12073),E=o(60565);let F=e=>{var a;let{id:o,idNc:d,form:u,header:c,block:m,setBlock:p,defaultTab:x,change:v,onSubmit:D}=e,g=(0,s.useRouter)(),b=g.asPath.includes("/novo"),{setTitle:j}=(0,r.useContext)(E.f),I=[{value:"limpeza",title:"Limpeza e Higieniza\xe7\xe3o",icon:()=>(0,t.jsx)(l.Z,{icon:"carbon:clean"}),content:(0,t.jsx)(n.Z,{id:o,form:u,header:c,block:m,setBlock:p,onSubmit:D}),disabled:!1},{value:"nao-conformidade",title:"N\xe3o Conformidade ".concat((null==c?void 0:c.totalNc)>0?"(".concat(null==c?void 0:c.totalNc,")"):""),icon:()=>(0,t.jsx)(l.Z,{icon:"typcn:warning-outline"}),content:(0,t.jsx)(k,{form:u,header:c,block:m,setBlock:p,change:v,onSubmit:D}),disabled:!o||!d&&(null==c||!c.naoConformidade)&&!b}],z=()=>{if(o)return(0,t.jsx)(h.Z,{children:(0,t.jsx)(f.Z,{className:"space-y-2 ",children:(0,t.jsx)(P.Z,{data:c})})})};return(0,r.useEffect)(()=>{j({icon:"carbon:clean",title:"Limpeza e Higieniza\xe7\xe3o",subtitle:{id:o,count:1,new:!1}})},[o,null===(a=g.query)||void 0===a?void 0:a.aba]),(0,t.jsx)(i.Z,{tabs:I,headerInfoComponent:(0,t.jsx)(z,{}),defaultTab:x})};var L=F},3404:function(e,a,o){o.d(a,{H:function(){return i},n:function(){return t}});let t=(e,a)=>(null==a?void 0:a.query.aba)||e,i=(e,a)=>{a.push({pathname:a.pathname,query:{...null==a?void 0:a.query,aba:e}},void 0,{shallow:!0})}}}]);